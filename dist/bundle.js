/*! For license information please see bundle.js.LICENSE.txt */
!function(){var e={"./node_modules/plyr/dist/plyr.min.js":function(e,t,n){var i=["premium","referrerPolicy"];function a(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);s=!0);}catch(e){o=!0,a=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw a}}return r}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}"object"==typeof navigator&&(e.exports=function(){"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={addCSS:!0,thumbWidth:15,watch:!0};function p(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}var m=function(e){return null!=e?e.constructor:null},f=function(e,t){return!!(e&&t&&e instanceof t)},g=function(e){return m(e)===String},y=function(e){return Array.isArray(e)},v=function(e){return f(e,NodeList)},b=g,w=y,k=v,T=function(e){return f(e,Element)},S=function(e){return f(e,Event)},A=function(e){return function(e){return null==e}(e)||(g(e)||y(e)||v(e))&&!e.length||function(e){return m(e)===Object}(e)&&!Object.keys(e).length};var C=function(){function e(t,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),T(t)?this.element=t:b(t)&&(this.element=document.querySelector(t)),T(this.element)&&A(this.element.rangeTouch)&&(this.config=u({},h,{},n),this.init())}return function(e,n,i){n&&t(e.prototype,n),i&&t(e,i)}(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,n=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(e){t.element[n](e,(function(e){return t.set(e)}),!1)}))}},{key:"get",value:function(t){if(!e.enabled||!S(t))return null;var n,i=t.target,a=t.changedTouches[0],r=parseFloat(i.getAttribute("min"))||0,s=parseFloat(i.getAttribute("max"))||100,o=parseFloat(i.getAttribute("step"))||1,l=i.getBoundingClientRect(),c=100/l.width*(this.config.thumbWidth/2)/100;return 0>(n=100/l.width*(a.clientX-l.left))?n=0:100<n&&(n=100),50>n?n-=(100-2*n)*c:50<n&&(n+=2*(n-50)*c),r+function(e,t){if(1>t){var n=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}(t);return parseFloat(e.toFixed(n))}return Math.round(e/t)*t}(n/100*(s-r),o)}},{key:"set",value:function(t){e.enabled&&S(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),function(e,t){if(e&&t){var n=new Event(t,{bubbles:!0});e.dispatchEvent(n)}}(t.target,"touchend"===t.type?"change":"input"))}}],[{key:"setup",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=null;if(A(t)||b(t)?i=Array.from(document.querySelectorAll(b(t)?t:'input[type="range"]')):T(t)?i=[t]:k(t)?i=Array.from(t):w(t)&&(i=t.filter(T)),A(i))return null;var a=u({},h,{},n);if(b(t)&&a.watch){var r=new MutationObserver((function(n){Array.from(n).forEach((function(n){Array.from(n.addedNodes).forEach((function(n){T(n)&&p(n,t)&&new e(n,a)}))}))}));r.observe(document.body,{childList:!0,subtree:!0})}return i.map((function(t){return new e(t,n)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}(),E=function(e){return null!=e?e.constructor:null},P=function(e,t){return Boolean(e&&t&&e instanceof t)},M=function(e){return null==e},x=function(e){return E(e)===Object},L=function(e){return E(e)===String},N=function(e){return E(e)===Function},j=function(e){return Array.isArray(e)},I=function(e){return P(e,NodeList)},_=function(e){return M(e)||(L(e)||j(e)||I(e))&&!e.length||x(e)&&!Object.keys(e).length},O=M,q=x,D=function(e){return E(e)===Number&&!Number.isNaN(e)},H=L,R=function(e){return E(e)===Boolean},F=N,V=j,B=I,U=function(e){return null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument},W=function(e){return P(e,Event)},z=function(e){return P(e,KeyboardEvent)},K=function(e){return P(e,TextTrack)||!M(e)&&L(e.kind)},Y=function(e){if(P(e,window.URL))return!0;if(!L(e))return!1;var t=e;e.startsWith("http://")&&e.startsWith("https://")||(t="http://".concat(e));try{return!_(new URL(t).hostname)}catch(e){return!1}},$=_,Q=function(){var e=document.createElement("span"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n=Object.keys(t).find((function(t){return void 0!==e.style[t]}));return!!H(n)&&t[n]}();function X(e,t){setTimeout((function(){try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}}),t)}var J={isIE:Boolean(window.document.documentMode),isEdge:window.navigator.userAgent.includes("Edge"),isWebkit:"WebkitAppearance"in document.documentElement.style&&!/Edge/.test(navigator.userAgent),isIPhone:/(iPhone|iPod)/gi.test(navigator.platform),isIos:"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1||/(iPad|iPhone|iPod)/gi.test(navigator.platform)};function G(e,t){return t.split(".").reduce((function(e,t){return e&&e[t]}),e)}function Z(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(!n.length)return e;var a=n.shift();return q(a)?(Object.keys(a).forEach((function(t){q(a[t])?(Object.keys(e).includes(t)||Object.assign(e,{[t]:{}}),Z(e[t],a[t])):Object.assign(e,{[t]:a[t]})})),Z.apply(void 0,[e].concat(n))):e}function ee(e,t){var n=e.length?e:[e];Array.from(n).reverse().forEach((function(e,n){var i=n>0?t.cloneNode(!0):t,a=e.parentNode,r=e.nextSibling;i.appendChild(e),r?a.insertBefore(i,r):a.appendChild(i)}))}function te(e,t){U(e)&&!$(t)&&Object.entries(t).filter((function(e){var t=d(e,2)[1];return!O(t)})).forEach((function(t){var n=d(t,2),i=n[0],a=n[1];return e.setAttribute(i,a)}))}function ne(e,t,n){var i=document.createElement(e);return q(t)&&te(i,t),H(n)&&(i.innerText=n),i}function ie(e,t,n,i){U(t)&&t.appendChild(ne(e,n,i))}function ae(e){B(e)||V(e)?Array.from(e).forEach(ae):U(e)&&U(e.parentNode)&&e.parentNode.removeChild(e)}function re(e){if(U(e))for(var t=e.childNodes.length;t>0;)e.removeChild(e.lastChild),t-=1}function se(e,t){return U(t)&&U(t.parentNode)&&U(e)?(t.parentNode.replaceChild(e,t),e):null}function oe(e,t){if(!H(e)||$(e))return{};var n={},i=Z({},t);return e.split(",").forEach((function(e){var t=e.trim(),a=t.replace(".",""),r=t.replace(/[[\]]/g,"").split("="),s=d(r,1)[0],o=r.length>1?r[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":H(i.class)?n.class="".concat(i.class," ").concat(a):n.class=a;break;case"#":n.id=t.replace("#","");break;case"[":n[s]=o}})),Z(i,n)}function le(e,t){if(U(e)){var n=t;R(n)||(n=!e.hidden),e.hidden=n}}function ce(e,t,n){if(B(e))return Array.from(e).map((function(e){return ce(e,t,n)}));if(U(e)){var i="toggle";return void 0!==n&&(i=n?"add":"remove"),e.classList[i](t),e.classList.contains(t)}return!1}function ue(e,t){return U(e)&&e.classList.contains(t)}function de(e,t){var n=Element.prototype;return(n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function he(e){return this.elements.container.querySelectorAll(e)}function pe(e){return this.elements.container.querySelector(e)}function me(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];U(e)&&(e.focus({preventScroll:!0}),t&&ce(e,this.config.classNames.tabFocus))}var fe={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},ge={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,t,n){var i=J.isIPhone&&n&&ge.playsinline,a=ge[e]||"html5"!==t;return{api:a,ui:a&&ge.rangeInput&&("video"!==e||!J.isIPhone||i)}},pip:!(J.isIPhone||!F(ne("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||ne("video").disablePictureInPicture)),airplay:F(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if($(e))return!1;var t=d(e.split("/"),1)[0],n=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(fe).includes(n)&&(n+='; codecs="'.concat(fe[e],'"'));try{return Boolean(n&&this.media.canPlayType(n).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:function(){var e=document.createElement("input");return e.type="range","range"===e.type}(),touch:"ontouchstart"in document.documentElement,transitions:!1!==Q,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},ye=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){return e=!0,null}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e}();function ve(e,t,n){var i=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e&&"addEventListener"in e&&!$(t)&&F(n)){var o=t.split(" "),l=s;ye&&(l={passive:r,capture:s}),o.forEach((function(t){i&&i.eventListeners&&a&&i.eventListeners.push({element:e,type:t,callback:n,options:l}),e[a?"addEventListener":"removeEventListener"](t,n,l)}))}}function be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];ve.call(this,e,t,n,!0,i,a)}function we(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];ve.call(this,e,t,n,!1,i,a)}function ke(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function s(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];we(e,n,s,a,r),i.apply(t,l)};ve.call(this,e,n,s,!0,a,r)}function Te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(U(e)&&!$(t)){var a=new CustomEvent(t,{bubbles:n,detail:c(c({},i),{},{plyr:this})});e.dispatchEvent(a)}}function Se(){this&&this.eventListeners&&(this.eventListeners.forEach((function(e){var t=e.element,n=e.type,i=e.callback,a=e.options;t.removeEventListener(n,i,a)})),this.eventListeners=[])}function Ae(){var e=this;return new Promise((function(t){return e.ready?setTimeout(t,0):be.call(e,e.elements.container,"ready",t)})).then((function(){}))}function Ce(e){(function(e){return P(e,Promise)&&N(e.then)})(e)&&e.then(null,(function(){}))}function Ee(e){return V(e)?e.filter((function(t,n){return e.indexOf(t)===n})):e}function Pe(e,t){return V(e)&&e.length?e.reduce((function(e,n){return Math.abs(n-t)<Math.abs(e-t)?n:e})):null}function Me(e){return!(!window||!window.CSS)&&window.CSS.supports(e)}var xe=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce((function(e,t){var n=d(t,2),i=n[0],a=n[1];return c(c({},e),{},{[i/a]:[i,a]})}),{});function Le(e){return!!(V(e)||H(e)&&e.includes(":"))&&(V(e)?e:e.split(":")).map(Number).every(D)}function Ne(e){if(!V(e)||!e.every(D))return null;var t=d(e,2),n=t[0],i=t[1],a=function e(t,n){return 0===n?t:e(n,t%n)}(n,i);return[n/a,i/a]}function je(e){var t=function(e){return Le(e)?e.split(":").map(Number):null},n=t(e);if(null===n&&(n=t(this.config.ratio)),null===n&&!$(this.embed)&&V(this.embed.ratio)&&(n=this.embed.ratio),null===n&&this.isHTML5){var i=this.media;n=[i.videoWidth,i.videoHeight]}return Ne(n)}function Ie(e){if(!this.isVideo)return{};var t=this.elements.wrapper,n=je.call(this,e);if(!V(n))return{};var i=d(Ne(n),2),a=i[0],r=i[1],s=100/a*r;if(Me("aspect-ratio: ".concat(a,"/").concat(r))?t.style.aspectRatio="".concat(a,"/").concat(r):t.style.paddingBottom="".concat(s,"%"),this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){var o=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),l=(o-s)/(o/50);this.fullscreen.active?t.style.paddingBottom=null:this.media.style.transform="translateY(-".concat(l,"%)")}else this.isHTML5&&t.classList.add(this.config.classNames.videoFixedRatio);return{padding:s,ratio:n}}function _e(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.05,i=e/t,a=Pe(Object.keys(xe),i);return Math.abs(a-i)<=n?xe[a]:[e,t]}var Oe={getSources(){var e=this;return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter((function(t){var n=t.getAttribute("type");return!!$(n)||ge.mime.call(e,n)})):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:Oe.getSources.call(this).map((function(e){return Number(e.getAttribute("size"))})).filter(Boolean)},setup(){if(this.isHTML5){var e=this;e.options.speed=e.config.speed.options,$(this.config.ratio)||Ie.call(e),Object.defineProperty(e.media,"quality",{get(){var t=Oe.getSources.call(e).find((function(t){return t.getAttribute("src")===e.source}));return t&&Number(t.getAttribute("size"))},set(t){if(e.quality!==t){if(e.config.quality.forced&&F(e.config.quality.onChange))e.config.quality.onChange(t);else{var n=Oe.getSources.call(e).find((function(e){return Number(e.getAttribute("size"))===t}));if(!n)return;var i=e.media,a=i.currentTime,r=i.paused,s=i.preload,o=i.readyState,l=i.playbackRate;e.media.src=n.getAttribute("src"),("none"!==s||o)&&(e.once("loadedmetadata",(function(){e.speed=l,e.currentTime=a,r||Ce(e.play())})),e.media.load())}Te.call(e,e.media,"qualitychange",!1,{quality:t})}}})}},cancelRequests(){this.isHTML5&&(ae(Oe.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function qe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return $(e)?e:e.toString().replace(/{(\d+)}/g,(function(e,t){return n[t].toString()}))}var De=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(new RegExp(e.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),t.toString())},He=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString().replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}))};function Re(e){var t=document.createElement("div");return t.appendChild(e),t.innerHTML}var Fe={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},Ve={get(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if($(e)||$(t))return"";var n=G(t.i18n,e);if($(n))return Object.keys(Fe).includes(e)?Fe[e]:"";var i={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(i).forEach((function(e){var t=d(e,2),i=t[0],a=t[1];n=De(n,i,a)})),n}},Be=function(){function t(n){var i=this;r(this,t),e(this,"get",(function(e){if(!t.supported||!i.enabled)return null;var n=window.localStorage.getItem(i.key);if($(n))return null;var a=JSON.parse(n);return H(e)&&e.length?a[e]:a})),e(this,"set",(function(e){if(t.supported&&i.enabled&&q(e)){var n=i.get();$(n)&&(n={}),Z(n,e);try{window.localStorage.setItem(i.key,JSON.stringify(n))}catch(e){}}})),this.enabled=n.config.storage.enabled,this.key=n.config.storage.key}return o(t,null,[{key:"supported",get:function(){try{if(!("localStorage"in window))return!1;var e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}}]),t}();function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";return new Promise((function(n,i){try{var a=new XMLHttpRequest;if(!("withCredentials"in a))return;a.addEventListener("load",(function(){if("text"===t)try{n(JSON.parse(a.responseText))}catch(e){n(a.responseText)}else n(a.response)})),a.addEventListener("error",(function(){throw new Error(a.status)})),a.open("GET",e,!0),a.responseType=t,a.send()}catch(e){i(e)}}))}function We(e,t){if(H(e)){var n=H(t),i=function(){return null!==document.getElementById(t)},a=function(e,t){e.innerHTML=t,n&&i()||document.body.insertAdjacentElement("afterbegin",e)};if(!n||!i()){var r=Be.supported,s=document.createElement("div");if(s.setAttribute("hidden",""),n&&s.setAttribute("id",t),r){var o=window.localStorage.getItem("cache-".concat(t));if(null!==o){var l=JSON.parse(o);a(s,l.content)}}Ue(e).then((function(e){if(!$(e)){if(r)try{window.localStorage.setItem("cache-".concat(t),JSON.stringify({content:e}))}catch(e){}a(s,e)}})).catch((function(){}))}}}var ze=function(e){return Math.trunc(e/60/60%60,10)};function Ke(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!D(e))return Ke(void 0,t,n);var i,a=function(e){return"0".concat(e).slice(-2)},r=ze(e),s=(i=e,Math.trunc(i/60%60,10)),o=function(e){return Math.trunc(e%60,10)}(e);return r=t||r>0?"".concat(r,":"):"","".concat(n&&e>0?"-":"").concat(r).concat(a(s),":").concat(a(o))}var Ye={getIconUrl(){var e=new URL(this.config.iconUrl,window.location),t=window.location.host?window.location.host:window.top.location.host,n=e.host!==t||J.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:n}},findElements(){try{return this.elements.controls=pe.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:he.call(this,this.config.selectors.buttons.play),pause:pe.call(this,this.config.selectors.buttons.pause),restart:pe.call(this,this.config.selectors.buttons.restart),rewind:pe.call(this,this.config.selectors.buttons.rewind),fastForward:pe.call(this,this.config.selectors.buttons.fastForward),mute:pe.call(this,this.config.selectors.buttons.mute),pip:pe.call(this,this.config.selectors.buttons.pip),airplay:pe.call(this,this.config.selectors.buttons.airplay),settings:pe.call(this,this.config.selectors.buttons.settings),captions:pe.call(this,this.config.selectors.buttons.captions),fullscreen:pe.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=pe.call(this,this.config.selectors.progress),this.elements.inputs={seek:pe.call(this,this.config.selectors.inputs.seek),volume:pe.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:pe.call(this,this.config.selectors.display.buffer),currentTime:pe.call(this,this.config.selectors.display.currentTime),duration:pe.call(this,this.config.selectors.display.duration)},U(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(".".concat(this.config.classNames.tooltip))),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,t){var n="http://www.w3.org/2000/svg",i=Ye.getIconUrl.call(this),a="".concat(i.cors?"":i.url,"#").concat(this.config.iconPrefix),r=document.createElementNS(n,"svg");te(r,Z(t,{"aria-hidden":"true",focusable:"false"}));var s=document.createElementNS(n,"use"),o="".concat(a,"-").concat(e);return"href"in s&&s.setAttributeNS("http://www.w3.org/1999/xlink","href",o),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),r.appendChild(s),r},createLabel(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ve.get(e,this.config);return ne("span",c(c({},t),{},{class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")}),n)},createBadge(e){if($(e))return null;var t=ne("span",{class:this.config.classNames.menu.value});return t.appendChild(ne("span",{class:this.config.classNames.menu.badge},e)),t},createButton(e,t){var n=this,i=Z({},t),a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return e=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return e=De(e,"-"," "),e=De(e,"_"," "),e=He(e),De(e," ","")}(e),e.charAt(0).toLowerCase()+e.slice(1)}(e),r={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach((function(e){Object.keys(i).includes(e)&&(r[e]=i[e],delete i[e])})),"button"!==r.element||Object.keys(i).includes("type")||(i.type="button"),Object.keys(i).includes("class")?i.class.split(" ").some((function(e){return e===n.config.classNames.control}))||Z(i,{class:"".concat(i.class," ").concat(this.config.classNames.control)}):i.class=this.config.classNames.control,e){case"play":r.toggle=!0,r.label="play",r.labelPressed="pause",r.icon="play",r.iconPressed="pause";break;case"mute":r.toggle=!0,r.label="mute",r.labelPressed="unmute",r.icon="volume",r.iconPressed="muted";break;case"captions":r.toggle=!0,r.label="enableCaptions",r.labelPressed="disableCaptions",r.icon="captions-off",r.iconPressed="captions-on";break;case"fullscreen":r.toggle=!0,r.label="enterFullscreen",r.labelPressed="exitFullscreen",r.icon="enter-fullscreen",r.iconPressed="exit-fullscreen";break;case"play-large":i.class+=" ".concat(this.config.classNames.control,"--overlaid"),a="play",r.label="play",r.icon="play";break;default:$(r.label)&&(r.label=a),$(r.icon)&&(r.icon=e)}var s=ne(r.element);return r.toggle?(s.appendChild(Ye.createIcon.call(this,r.iconPressed,{class:"icon--pressed"})),s.appendChild(Ye.createIcon.call(this,r.icon,{class:"icon--not-pressed"})),s.appendChild(Ye.createLabel.call(this,r.labelPressed,{class:"label--pressed"})),s.appendChild(Ye.createLabel.call(this,r.label,{class:"label--not-pressed"}))):(s.appendChild(Ye.createIcon.call(this,r.icon)),s.appendChild(Ye.createLabel.call(this,r.label))),Z(i,oe(this.config.selectors.buttons[a],i)),te(s,i),"play"===a?(V(this.elements.buttons[a])||(this.elements.buttons[a]=[]),this.elements.buttons[a].push(s)):this.elements.buttons[a]=s,s},createRange(e,t){var n=ne("input",Z(oe(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":Ve.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=n,Ye.updateRangeFill.call(this,n),C.setup(n),n},createProgress(e,t){var n=ne("progress",Z(oe(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){n.appendChild(ne("span",null,"0"));var i={played:"played",buffer:"buffered"}[e],a=i?Ve.get(i,this.config):"";n.innerText="% ".concat(a.toLowerCase())}return this.elements.display[e]=n,n},createTime(e,t){var n=oe(this.config.selectors.display[e],t),i=ne("div",Z(n,{class:"".concat(n.class?n.class:""," ").concat(this.config.classNames.display.time," ").trim(),"aria-label":Ve.get(e,this.config)}),"00:00");return this.elements.display[e]=i,i},bindMenuItemShortcuts(e,t){var n=this;be.call(this,e,"keydown keyup",(function(i){if(["Space","ArrowUp","ArrowDown","ArrowRight"].includes(i.key)&&(i.preventDefault(),i.stopPropagation(),"keydown"!==i.type)){var a,r=de(e,'[role="menuitemradio"]');!r&&["Space","ArrowRight"].includes(i.key)?Ye.showMenuPanel.call(n,t,!0):"Space"!==i.key&&("ArrowDown"===i.key||r&&"ArrowRight"===i.key?(a=e.nextElementSibling,U(a)||(a=e.parentNode.firstElementChild)):(a=e.previousElementSibling,U(a)||(a=e.parentNode.lastElementChild)),me.call(n,a,!0))}}),!1),be.call(this,e,"keyup",(function(e){"Return"===e.key&&Ye.focusFirstMenuItem.call(n,null,!0)}))},createMenuItem(e){var t=this,n=e.value,i=e.list,a=e.type,r=e.title,s=e.badge,o=void 0===s?null:s,l=e.checked,c=void 0!==l&&l,u=oe(this.config.selectors.inputs[a]),d=ne("button",Z(u,{type:"button",role:"menuitemradio",class:"".concat(this.config.classNames.control," ").concat(u.class?u.class:"").trim(),"aria-checked":c,value:n})),h=ne("span");h.innerHTML=r,U(o)&&h.appendChild(o),d.appendChild(h),Object.defineProperty(d,"checked",{enumerable:!0,get:function(){return"true"===d.getAttribute("aria-checked")},set(e){e&&Array.from(d.parentNode.children).filter((function(e){return de(e,'[role="menuitemradio"]')})).forEach((function(e){return e.setAttribute("aria-checked","false")})),d.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(d,"click keyup",(function(e){if(!z(e)||"Space"===e.key){switch(e.preventDefault(),e.stopPropagation(),d.checked=!0,a){case"language":t.currentTrack=Number(n);break;case"quality":t.quality=n;break;case"speed":t.speed=parseFloat(n)}Ye.showMenuPanel.call(t,"home",z(e))}}),a,!1),Ye.bindMenuItemShortcuts.call(this,d,a),i.appendChild(d)},formatTime(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return D(e)?Ke(e,ze(this.duration)>0,t):e},updateTimeDisplay(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];U(e)&&D(t)&&(e.innerText=Ye.formatTime(t,n))},updateVolume(){this.supported.ui&&(U(this.elements.inputs.volume)&&Ye.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),U(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;U(e)&&(e.value=t,Ye.updateRangeFill.call(this,e))},updateProgress(e){var t=this;if(this.supported.ui&&W(e)){var n,i,a=0;if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":n=this.currentTime,i=this.duration,a=0===n||0===i||Number.isNaN(n)||Number.isNaN(i)?0:(n/i*100).toFixed(2),"timeupdate"===e.type&&Ye.setRange.call(this,this.elements.inputs.seek,a);break;case"playing":case"progress":!function(e,n){var i=D(n)?n:0,a=U(e)?e:t.elements.display.buffer;if(U(a)){a.value=i;var r=a.getElementsByTagName("span")[0];U(r)&&(r.childNodes[0].nodeValue=i)}}(this.elements.display.buffer,100*this.buffered)}}},updateRangeFill(e){var t=W(e)?e.target:e;if(U(t)&&"range"===t.getAttribute("type")){if(de(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);var n=Ye.formatTime(this.currentTime),i=Ye.formatTime(this.duration),a=Ve.get("seekLabel",this.config);t.setAttribute("aria-valuetext",a.replace("{currentTime}",n).replace("{duration}",i))}else if(de(t,this.config.selectors.inputs.volume)){var r=100*t.value;t.setAttribute("aria-valuenow",r),t.setAttribute("aria-valuetext","".concat(r.toFixed(1),"%"))}else t.setAttribute("aria-valuenow",t.value);J.isWebkit&&t.style.setProperty("--value",t.value/t.max*100+"%")}},updateSeekTooltip(e){var t,n;if(this.config.tooltips.seek&&U(this.elements.inputs.seek)&&U(this.elements.display.seekTooltip)&&0!==this.duration){var i=this.elements.display.seekTooltip,a="".concat(this.config.classNames.tooltip,"--visible"),r=function(e){return ce(i,a,e)};if(this.touch)r(!1);else{var s=0,o=this.elements.progress.getBoundingClientRect();if(W(e))s=100/o.width*(e.pageX-o.left);else{if(!ue(i,a))return;s=parseFloat(i.style.left,10)}s<0?s=0:s>100&&(s=100);var l=this.duration/100*s;i.innerText=Ye.formatTime(l);var c=null===(t=this.config.markers)||void 0===t||null===(n=t.points)||void 0===n?void 0:n.find((function(e){return e.time===Math.round(l)}));c&&i.insertAdjacentHTML("afterbegin","".concat(c.label,"<br>")),i.style.left="".concat(s,"%"),W(e)&&["mouseenter","mouseleave"].includes(e.type)&&r("mouseenter"===e.type)}}},timeUpdate(e){var t=!U(this.elements.display.duration)&&this.config.invertTime;Ye.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||Ye.updateProgress.call(this,e)},durationUpdate(){if(this.supported.ui&&(this.config.invertTime||!this.currentTime)){if(this.duration>=Math.pow(2,32))return le(this.elements.display.currentTime,!0),void le(this.elements.progress,!0);U(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);var e=U(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&Ye.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&Ye.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&Ye.setMarkers.call(this),Ye.updateSeekTooltip.call(this)}},toggleMenuButton(e,t){le(this.elements.settings.buttons[e],!t)},updateSetting(e,t,n){var i=this.elements.settings.panels[e],a=null,r=t;if("captions"===e)a=this.currentTrack;else{if(a=$(n)?this[e]:n,$(a)&&(a=this.config[e].default),!$(this.options[e])&&!this.options[e].includes(a))return void this.debug.warn("Unsupported value of '".concat(a,"' for ").concat(e));if(!this.config[e].options.includes(a))return void this.debug.warn("Disabled value of '".concat(a,"' for ").concat(e))}if(U(r)||(r=i&&i.querySelector('[role="menu"]')),U(r)){this.elements.settings.buttons[e].querySelector(".".concat(this.config.classNames.menu.value)).innerHTML=Ye.getLabel.call(this,e,a);var s=r&&r.querySelector('[value="'.concat(a,'"]'));U(s)&&(s.checked=!0)}},getLabel(e,t){switch(e){case"speed":return 1===t?Ve.get("normal",this.config):"".concat(t,"&times;");case"quality":if(D(t)){var n=Ve.get("qualityLabel.".concat(t),this.config);return n.length?n:"".concat(t,"p")}return He(t);case"captions":return Xe.getLabel.call(this);default:return null}},setQualityMenu(e){var t=this;if(U(this.elements.settings.panels.quality)){var n="quality",i=this.elements.settings.panels.quality.querySelector('[role="menu"]');V(e)&&(this.options.quality=Ee(e).filter((function(e){return t.config.quality.options.includes(e)})));var a=!$(this.options.quality)&&this.options.quality.length>1;if(Ye.toggleMenuButton.call(this,n,a),re(i),Ye.checkMenu.call(this),a){var r=function(e){var n=Ve.get("qualityBadge.".concat(e),t.config);return n.length?Ye.createBadge.call(t,n):null};this.options.quality.sort((function(e,n){var i=t.config.quality.options;return i.indexOf(e)>i.indexOf(n)?1:-1})).forEach((function(e){Ye.createMenuItem.call(t,{value:e,list:i,type:n,title:Ye.getLabel.call(t,"quality",e),badge:r(e)})})),Ye.updateSetting.call(this,n,i)}}},setCaptionsMenu(){var e=this;if(U(this.elements.settings.panels.captions)){var t="captions",n=this.elements.settings.panels.captions.querySelector('[role="menu"]'),i=Xe.getTracks.call(this),a=Boolean(i.length);if(Ye.toggleMenuButton.call(this,t,a),re(n),Ye.checkMenu.call(this),a){var r=i.map((function(t,i){return{value:i,checked:e.captions.toggled&&e.currentTrack===i,title:Xe.getLabel.call(e,t),badge:t.language&&Ye.createBadge.call(e,t.language.toUpperCase()),list:n,type:"language"}}));r.unshift({value:-1,checked:!this.captions.toggled,title:Ve.get("disabled",this.config),list:n,type:"language"}),r.forEach(Ye.createMenuItem.bind(this)),Ye.updateSetting.call(this,t,n)}}},setSpeedMenu(){var e=this;if(U(this.elements.settings.panels.speed)){var t="speed",n=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter((function(t){return t>=e.minimumSpeed&&t<=e.maximumSpeed}));var i=!$(this.options.speed)&&this.options.speed.length>1;Ye.toggleMenuButton.call(this,t,i),re(n),Ye.checkMenu.call(this),i&&(this.options.speed.forEach((function(i){Ye.createMenuItem.call(e,{value:i,list:n,type:t,title:Ye.getLabel.call(e,"speed",i)})})),Ye.updateSetting.call(this,t,n))}},checkMenu(){var e=this.elements.settings.buttons,t=!$(e)&&Object.values(e).some((function(e){return!e.hidden}));le(this.elements.settings.menu,!t)},focusFirstMenuItem(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.elements.settings.popup.hidden){var n=e;U(n)||(n=Object.values(this.elements.settings.panels).find((function(e){return!e.hidden})));var i=n.querySelector('[role^="menuitem"]');me.call(this,i,t)}},toggleMenu(e){var t=this.elements.settings.popup,n=this.elements.buttons.settings;if(U(t)&&U(n)){var i=t.hidden,a=i;if(R(e))a=e;else if(z(e)&&"Escape"===e.key)a=!1;else if(W(e)){var r=F(e.composedPath)?e.composedPath()[0]:e.target,s=t.contains(r);if(s||!s&&e.target!==n&&a)return}n.setAttribute("aria-expanded",a),le(t,!a),ce(this.elements.container,this.config.classNames.menu.open,a),a&&z(e)?Ye.focusFirstMenuItem.call(this,null,!0):a||i||me.call(this,n,z(e))}},getMenuSize(e){var t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);var n=t.scrollWidth,i=t.scrollHeight;return ae(t),{width:n,height:i}},showMenuPanel(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.elements.container.querySelector("#plyr-settings-".concat(this.id,"-").concat(t));if(U(i)){var a=i.parentNode,r=Array.from(a.children).find((function(e){return!e.hidden}));if(ge.transitions&&!ge.reducedMotion){a.style.width="".concat(r.scrollWidth,"px"),a.style.height="".concat(r.scrollHeight,"px");var s=Ye.getMenuSize.call(this,i);be.call(this,a,Q,(function t(n){n.target===a&&["width","height"].includes(n.propertyName)&&(a.style.width="",a.style.height="",we.call(e,a,Q,t))})),a.style.width="".concat(s.width,"px"),a.style.height="".concat(s.height,"px")}le(r,!0),le(i,!1),Ye.focusFirstMenuItem.call(this,i,n)}},setDownloadUrl(){var e=this.elements.buttons.download;U(e)&&e.setAttribute("href",this.download)},create(e){var t=this,n=Ye.bindMenuItemShortcuts,i=Ye.createButton,a=Ye.createProgress,r=Ye.createRange,s=Ye.createTime,o=Ye.setQualityMenu,l=Ye.setSpeedMenu,c=Ye.showMenuPanel;this.elements.controls=null,V(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(i.call(this,"play-large"));var u=ne("div",oe(this.config.selectors.controls.wrapper));this.elements.controls=u;var d={class:"plyr__controls__item"};return Ee(V(this.config.controls)?this.config.controls:[]).forEach((function(o){if("restart"===o&&u.appendChild(i.call(t,"restart",d)),"rewind"===o&&u.appendChild(i.call(t,"rewind",d)),"play"===o&&u.appendChild(i.call(t,"play",d)),"fast-forward"===o&&u.appendChild(i.call(t,"fast-forward",d)),"progress"===o){var l=ne("div",{class:"".concat(d.class," plyr__progress__container")}),h=ne("div",oe(t.config.selectors.progress));if(h.appendChild(r.call(t,"seek",{id:"plyr-seek-".concat(e.id)})),h.appendChild(a.call(t,"buffer")),t.config.tooltips.seek){var p=ne("span",{class:t.config.classNames.tooltip},"00:00");h.appendChild(p),t.elements.display.seekTooltip=p}t.elements.progress=h,l.appendChild(t.elements.progress),u.appendChild(l)}if("current-time"===o&&u.appendChild(s.call(t,"currentTime",d)),"duration"===o&&u.appendChild(s.call(t,"duration",d)),"mute"===o||"volume"===o){var m=t.elements.volume;if(U(m)&&u.contains(m)||(m=ne("div",Z({},d,{class:"".concat(d.class," plyr__volume").trim()})),t.elements.volume=m,u.appendChild(m)),"mute"===o&&m.appendChild(i.call(t,"mute")),"volume"===o&&!J.isIos){var f={max:1,step:.05,value:t.config.volume};m.appendChild(r.call(t,"volume",Z(f,{id:"plyr-volume-".concat(e.id)})))}}if("captions"===o&&u.appendChild(i.call(t,"captions",d)),"settings"===o&&!$(t.config.settings)){var g=ne("div",Z({},d,{class:"".concat(d.class," plyr__menu").trim(),hidden:""}));g.appendChild(i.call(t,"settings",{"aria-haspopup":!0,"aria-controls":"plyr-settings-".concat(e.id),"aria-expanded":!1}));var y=ne("div",{class:"plyr__menu__container",id:"plyr-settings-".concat(e.id),hidden:""}),v=ne("div"),b=ne("div",{id:"plyr-settings-".concat(e.id,"-home")}),w=ne("div",{role:"menu"});b.appendChild(w),v.appendChild(b),t.elements.settings.panels.home=b,t.config.settings.forEach((function(i){var a=ne("button",Z(oe(t.config.selectors.buttons.settings),{type:"button",class:"".concat(t.config.classNames.control," ").concat(t.config.classNames.control,"--forward"),role:"menuitem","aria-haspopup":!0,hidden:""}));n.call(t,a,i),be.call(t,a,"click",(function(){c.call(t,i,!1)}));var r=ne("span",null,Ve.get(i,t.config)),s=ne("span",{class:t.config.classNames.menu.value});s.innerHTML=e[i],r.appendChild(s),a.appendChild(r),w.appendChild(a);var o=ne("div",{id:"plyr-settings-".concat(e.id,"-").concat(i),hidden:""}),l=ne("button",{type:"button",class:"".concat(t.config.classNames.control," ").concat(t.config.classNames.control,"--back")});l.appendChild(ne("span",{"aria-hidden":!0},Ve.get(i,t.config))),l.appendChild(ne("span",{class:t.config.classNames.hidden},Ve.get("menuBack",t.config))),be.call(t,o,"keydown",(function(e){"ArrowLeft"===e.key&&(e.preventDefault(),e.stopPropagation(),c.call(t,"home",!0))}),!1),be.call(t,l,"click",(function(){c.call(t,"home",!1)})),o.appendChild(l),o.appendChild(ne("div",{role:"menu"})),v.appendChild(o),t.elements.settings.buttons[i]=a,t.elements.settings.panels[i]=o})),y.appendChild(v),g.appendChild(y),u.appendChild(g),t.elements.settings.popup=y,t.elements.settings.menu=g}if("pip"===o&&ge.pip&&u.appendChild(i.call(t,"pip",d)),"airplay"===o&&ge.airplay&&u.appendChild(i.call(t,"airplay",d)),"download"===o){var k=Z({},d,{element:"a",href:t.download,target:"_blank"});t.isHTML5&&(k.download="");var T=t.config.urls.download;!Y(T)&&t.isEmbed&&Z(k,{icon:"logo-".concat(t.provider),label:t.provider}),u.appendChild(i.call(t,"download",k))}"fullscreen"===o&&u.appendChild(i.call(t,"fullscreen",d))})),this.isHTML5&&o.call(this,Oe.getQualityOptions.call(this)),l.call(this),u},inject(){var e=this;if(this.config.loadSprite){var t=Ye.getIconUrl.call(this);t.cors&&We(t.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());var n=null;this.elements.controls=null;var i,a={id:this.id,seektime:this.config.seekTime,title:this.config.title},r=!0;if(F(this.config.controls)&&(this.config.controls=this.config.controls.call(this,a)),this.config.controls||(this.config.controls=[]),U(this.config.controls)||H(this.config.controls)?n=this.config.controls:(n=Ye.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:Xe.getLabel.call(this)}),r=!1),r&&H(this.config.controls)&&(n=function(e){var t=e;return Object.entries(a).forEach((function(e){var n=d(e,2),i=n[0],a=n[1];t=De(t,"{".concat(i,"}"),a)})),t}(n)),H(this.config.selectors.controls.container)&&(i=document.querySelector(this.config.selectors.controls.container)),U(i)||(i=this.elements.container),i[U(n)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",n),U(this.elements.controls)||Ye.findElements.call(this),!$(this.elements.buttons)){var s=function(t){var n=e.config.classNames.controlPressed;Object.defineProperty(t,"pressed",{enumerable:!0,get:function(){return ue(t,n)},set(){ce(t,n,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}})};Object.values(this.elements.buttons).filter(Boolean).forEach((function(e){V(e)||B(e)?Array.from(e).filter(Boolean).forEach(s):s(e)}))}if(J.isEdge&&X(i),this.config.tooltips.controls){var o=this.config,l=o.classNames,c=o.selectors,u="".concat(c.controls.wrapper," ").concat(c.labels," .").concat(l.hidden),h=he.call(this,u);Array.from(h).forEach((function(t){ce(t,e.config.classNames.hidden,!1),ce(t,e.config.classNames.tooltip,!0)}))}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch(e){}},setMarkers(){var e,t,n=this;if(this.duration&&!this.elements.markers){var i=null===(e=this.config.markers)||void 0===e||null===(t=e.points)||void 0===t?void 0:t.filter((function(e){var t=e.time;return t>0&&t<n.duration}));if(null!=i&&i.length){var a=document.createDocumentFragment(),r=document.createDocumentFragment(),s=null,o="".concat(this.config.classNames.tooltip,"--visible"),l=function(e){return ce(s,o,e)};i.forEach((function(e){var t=ne("span",{class:n.config.classNames.marker},""),i=e.time/n.duration*100+"%";s&&(t.addEventListener("mouseenter",(function(){e.label||(s.style.left=i,s.innerHTML=e.label,l(!0))})),t.addEventListener("mouseleave",(function(){l(!1)}))),t.addEventListener("click",(function(){n.currentTime=e.time})),t.style.left=i,r.appendChild(t)})),a.appendChild(r),this.config.tooltips.seek||(s=ne("span",{class:this.config.classNames.tooltip},""),a.appendChild(s)),this.elements.markers={points:r,tip:s},this.elements.progress.appendChild(a)}}}};function $e(e){var t=e;if(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]){var n=document.createElement("a");n.href=t,t=n.href}try{return new URL(t)}catch(e){return null}}function Qe(e){var t=new URLSearchParams;return q(e)&&Object.entries(e).forEach((function(e){var n=d(e,2),i=n[0],a=n[1];t.set(i,a)})),t}var Xe={setup(){if(this.supported.ui)if(!this.isVideo||this.isYouTube||this.isHTML5&&!ge.textTracks)V(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ye.setCaptionsMenu.call(this);else{var e,t;if(U(this.elements.captions)||(this.elements.captions=ne("div",oe(this.config.selectors.captions)),e=this.elements.captions,t=this.elements.wrapper,U(e)&&U(t)&&t.parentNode.insertBefore(e,t.nextSibling)),J.isIE&&window.URL){var n=this.media.querySelectorAll("track");Array.from(n).forEach((function(e){var t=e.getAttribute("src"),n=$e(t);null!==n&&n.hostname!==window.location.href.hostname&&["http:","https:"].includes(n.protocol)&&Ue(t,"blob").then((function(t){e.setAttribute("src",window.URL.createObjectURL(t))})).catch((function(){ae(e)}))}))}var i=Ee((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map((function(e){return e.split("-")[0]}))),a=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===a&&(a=d(i,1)[0]);var r=this.storage.get("captions");if(R(r)||(r=this.config.captions.active),Object.assign(this.captions,{toggled:!1,active:r,language:a,languages:i}),this.isHTML5){var s=this.config.captions.update?"addtrack removetrack":"removetrack";be.call(this,this.media.textTracks,s,Xe.update.bind(this))}setTimeout(Xe.update.bind(this),0)}},update(){var e=this,t=Xe.getTracks.call(this,!0),n=this.captions,i=n.active,a=n.language,r=n.meta,s=n.currentTrackNode,o=Boolean(t.find((function(e){return e.language===a})));this.isHTML5&&this.isVideo&&t.filter((function(e){return!r.get(e)})).forEach((function(t){e.debug.log("Track added",t),r.set(t,{default:"showing"===t.mode}),"showing"===t.mode&&(t.mode="hidden"),be.call(e,t,"cuechange",(function(){return Xe.updateCues.call(e)}))})),(o&&this.language!==a||!t.includes(s))&&(Xe.setLanguage.call(this,a),Xe.toggle.call(this,i&&o)),this.elements&&ce(this.elements.container,this.config.classNames.captions.enabled,!$(t)),V(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ye.setCaptionsMenu.call(this)},toggle(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.supported.ui){var i=this.captions.toggled,r=this.config.classNames.captions.active,s=O(e)?!i:e;if(s!==i){if(n||(this.captions.active=s,this.storage.set({captions:s})),!this.language&&s&&!n){var o=Xe.getTracks.call(this),l=Xe.findTrack.call(this,[this.captions.language].concat(a(this.captions.languages)),!0);return this.captions.language=l.language,void Xe.set.call(this,o.indexOf(l))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=s),ce(this.elements.container,r,s),this.captions.toggled=s,Ye.updateSetting.call(this,"captions"),Te.call(this,this.media,s?"captionsenabled":"captionsdisabled")}setTimeout((function(){s&&t.captions.toggled&&(t.captions.currentTrackNode.mode="hidden")}))}},set(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Xe.getTracks.call(this);if(-1!==e)if(D(e))if(e in n){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;var i=n[e],a=(i||{}).language;this.captions.currentTrackNode=i,Ye.updateSetting.call(this,"captions"),t||(this.captions.language=a,this.storage.set({language:a})),this.isVimeo&&this.embed.enableTextTrack(a),Te.call(this,this.media,"languagechange")}Xe.toggle.call(this,!0,t),this.isHTML5&&this.isVideo&&Xe.updateCues.call(this)}else this.debug.warn("Track not found",e);else this.debug.warn("Invalid caption argument",e);else Xe.toggle.call(this,!1,t)},setLanguage(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(H(e)){var n=e.toLowerCase();this.captions.language=n;var i=Xe.getTracks.call(this),a=Xe.findTrack.call(this,[n]);Xe.set.call(this,i.indexOf(a),t)}else this.debug.warn("Invalid language argument",e)},getTracks(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Array.from((this.media||{}).textTracks||[]).filter((function(n){return!e.isHTML5||t||e.captions.meta.has(n)})).filter((function(e){return["captions","subtitles"].includes(e.kind)}))},findTrack(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Xe.getTracks.call(this),r=function(e){return Number((n.captions.meta.get(e)||{}).default)},s=Array.from(a).sort((function(e,t){return r(t)-r(e)}));return e.every((function(e){return t=s.find((function(t){return t.language===e})),!t})),t||(i?s[0]:void 0)},getCurrentTrack(){return Xe.getTracks.call(this)[this.currentTrack]},getLabel(e){var t=e;return!K(t)&&ge.textTracks&&this.captions.toggled&&(t=Xe.getCurrentTrack.call(this)),K(t)?$(t.label)?$(t.language)?Ve.get("enabled",this.config):e.language.toUpperCase():t.label:Ve.get("disabled",this.config)},updateCues(e){if(this.supported.ui)if(U(this.elements.captions))if(O(e)||Array.isArray(e)){var t=e;if(!t){var n=Xe.getCurrentTrack.call(this);t=Array.from((n||{}).activeCues||[]).map((function(e){return e.getCueAsHTML()})).map(Re)}var i=t.map((function(e){return e.trim()})).join("\n");if(i!==this.elements.captions.innerHTML){re(this.elements.captions);var a=ne("span",oe(this.config.selectors.caption));a.innerHTML=i,this.elements.captions.appendChild(a),Te.call(this,this.media,"cuechange")}}else this.debug.warn("updateCues: Invalid input",e);else this.debug.warn("No captions element to render to")}},Je={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.7.2/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isIos:"plyr--is-ios",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},tabFocus:"plyr__tab-focus",previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},Ge="picture-in-picture",Ze={html5:"html5",youtube:"youtube",vimeo:"vimeo"},et="video",tt=function(){},nt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r(this,e),this.enabled=window.console&&t,this.enabled&&this.log("Debugging enabled")}return o(e,[{key:"log",get:function(){return this.enabled?Function.prototype.bind.call(console.log,console):tt}},{key:"warn",get:function(){return this.enabled?Function.prototype.bind.call(console.warn,console):tt}},{key:"error",get:function(){return this.enabled?Function.prototype.bind.call(console.error,console):tt}}]),e}(),it=function(){function t(n){var i=this;r(this,t),e(this,"onChange",(function(){if(i.enabled){var e=i.player.elements.buttons.fullscreen;U(e)&&(e.pressed=i.active);var t=i.target===i.player.media?i.target:i.player.elements.container;Te.call(i.player,t,i.active?"enterfullscreen":"exitfullscreen",!0)}})),e(this,"toggleFallback",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e?i.scrollPosition={x:window.scrollX||0,y:window.scrollY||0}:window.scrollTo(i.scrollPosition.x,i.scrollPosition.y),document.body.style.overflow=e?"hidden":"",ce(i.target,i.player.config.classNames.fullscreen.fallback,e),J.isIos){var t=document.head.querySelector('meta[name="viewport"]'),n="viewport-fit=cover";t||(t=document.createElement("meta")).setAttribute("name","viewport");var a=H(t.content)&&t.content.includes(n);e?(i.cleanupViewport=!a,a||(t.content+=",".concat(n))):i.cleanupViewport&&(t.content=t.content.split(",").filter((function(e){return e.trim()!==n})).join(","))}i.onChange()})),e(this,"trapFocus",(function(e){if(!J.isIos&&i.active&&"Tab"===e.key){var t=document.activeElement,n=he.call(i.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),a=d(n,1)[0],r=n[n.length-1];t!==r||e.shiftKey?t===a&&e.shiftKey&&(r.focus(),e.preventDefault()):(a.focus(),e.preventDefault())}})),e(this,"update",(function(){var e;i.enabled?(e=i.forceFallback?"Fallback (forced)":t.native?"Native":"Fallback",i.player.debug.log("".concat(e," fullscreen enabled"))):i.player.debug.log("Fullscreen not supported and fallback disabled"),ce(i.player.elements.container,i.player.config.classNames.fullscreen.enabled,i.enabled)})),e(this,"enter",(function(){i.enabled&&(J.isIos&&i.player.config.fullscreen.iosNative?i.player.isVimeo?i.player.embed.requestFullscreen():i.target.webkitEnterFullscreen():!t.native||i.forceFallback?i.toggleFallback(!0):i.prefix?$(i.prefix)||i.target["".concat(i.prefix,"Request").concat(i.property)]():i.target.requestFullscreen({navigationUI:"hide"}))})),e(this,"exit",(function(){if(i.enabled)if(J.isIos&&i.player.config.fullscreen.iosNative)i.target.webkitExitFullscreen(),Ce(i.player.play());else if(!t.native||i.forceFallback)i.toggleFallback(!1);else if(i.prefix){if(!$(i.prefix)){var e="moz"===i.prefix?"Cancel":"Exit";document["".concat(i.prefix).concat(e).concat(i.property)]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)})),e(this,"toggle",(function(){i.active?i.exit():i.enter()})),this.player=n,this.prefix=t.prefix,this.property=t.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===n.config.fullscreen.fallback,this.player.elements.fullscreen=n.config.fullscreen.container&&function(e,t){return(Element.prototype.closest||function(){var e=this;do{if(de.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}(this.player.elements.container,n.config.fullscreen.container),be.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":"".concat(this.prefix,"fullscreenchange"),(function(){i.onChange()})),be.call(this.player,this.player.elements.container,"dblclick",(function(e){U(i.player.elements.controls)&&i.player.elements.controls.contains(e.target)||i.player.listeners.proxy(e,i.toggle,"fullscreen")})),be.call(this,this.player.elements.container,"keydown",(function(e){return i.trapFocus(e)})),this.update()}return o(t,[{key:"usingNative",get:function(){return t.native&&!this.forceFallback}},{key:"enabled",get:function(){return(t.native||this.player.config.fullscreen.fallback)&&this.player.config.fullscreen.enabled&&this.player.supported.ui&&this.player.isVideo}},{key:"active",get:function(){if(!this.enabled)return!1;if(!t.native||this.forceFallback)return ue(this.target,this.player.config.classNames.fullscreen.fallback);var e=this.prefix?this.target.getRootNode()["".concat(this.prefix).concat(this.property,"Element")]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}},{key:"target",get:function(){return J.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen||this.player.elements.container}}],[{key:"native",get:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},{key:"prefix",get:function(){if(F(document.exitFullscreen))return"";var e="";return["webkit","moz","ms"].some((function(t){return!(!F(document["".concat(t,"ExitFullscreen")])&&!F(document["".concat(t,"CancelFullScreen")])||(e=t,0))})),e}},{key:"property",get:function(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}}]),t}();function at(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise((function(n,i){var a=new Image,r=function(){delete a.onload,delete a.onerror,(a.naturalWidth>=t?n:i)(a)};Object.assign(a,{onload:r,onerror:r,src:e})}))}var rt={addStyleHook(){ce(this.elements.container,this.config.selectors.container.replace(".",""),!0),ce(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){var e=this;if(this.listeners.media(),!this.supported.ui)return this.debug.warn("Basic support only for ".concat(this.provider," ").concat(this.type)),void rt.toggleNativeControls.call(this,!0);U(this.elements.controls)||(Ye.inject.call(this),this.listeners.controls()),rt.toggleNativeControls.call(this),this.isHTML5&&Xe.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,Ye.updateVolume.call(this),Ye.timeUpdate.call(this),Ye.durationUpdate.call(this),rt.checkPlaying.call(this),ce(this.elements.container,this.config.classNames.pip.supported,ge.pip&&this.isHTML5&&this.isVideo),ce(this.elements.container,this.config.classNames.airplay.supported,ge.airplay&&this.isHTML5),ce(this.elements.container,this.config.classNames.isIos,J.isIos),ce(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout((function(){Te.call(e,e.media,"ready")}),0),rt.setTitle.call(this),this.poster&&rt.setPoster.call(this,this.poster,!1).catch((function(){})),this.config.duration&&Ye.durationUpdate.call(this),this.config.mediaMetadata&&Ye.setMediaMetadata.call(this)},setTitle(){var e=Ve.get("play",this.config);if(H(this.config.title)&&!$(this.config.title)&&(e+=", ".concat(this.config.title)),Array.from(this.elements.buttons.play||[]).forEach((function(t){t.setAttribute("aria-label",e)})),this.isEmbed){var t=pe.call(this,"iframe");if(!U(t))return;var n=$(this.config.title)?"video":this.config.title,i=Ve.get("frameTitle",this.config);t.setAttribute("title",i.replace("{title}",n))}},togglePoster(e){ce(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e){var t=this;return arguments.length>1&&void 0!==arguments[1]&&!arguments[1]||!this.poster?(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),Ae.call(this).then((function(){return at(e)})).catch((function(n){throw e===t.poster&&rt.togglePoster.call(t,!1),n})).then((function(){if(e!==t.poster)throw new Error("setPoster cancelled by later call to setPoster")})).then((function(){return Object.assign(t.elements.poster.style,{backgroundImage:"url('".concat(e,"')"),backgroundSize:""}),rt.togglePoster.call(t,!0),e}))):Promise.reject(new Error("Poster already set"))},checkPlaying(e){var t=this;ce(this.elements.container,this.config.classNames.playing,this.playing),ce(this.elements.container,this.config.classNames.paused,this.paused),ce(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach((function(e){Object.assign(e,{pressed:t.playing}),e.setAttribute("aria-label",Ve.get(t.playing?"pause":"play",t.config))})),W(e)&&"timeupdate"===e.type||rt.toggleControls.call(this)},checkLoading(e){var t=this;this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout((function(){ce(t.elements.container,t.config.classNames.loading,t.loading),rt.toggleControls.call(t)}),this.loading?250:0)},toggleControls(e){var t=this.elements.controls;if(t&&this.config.hideControls){var n=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||n))}},migrateStyles(){var e=this;Object.values(c({},this.media.style)).filter((function(e){return!$(e)&&H(e)&&e.startsWith("--plyr")})).forEach((function(t){e.elements.container.style.setProperty(t,e.media.style.getPropertyValue(t)),e.media.style.removeProperty(t)})),$(this.media.style)&&this.media.removeAttribute("style")}},st=function(){function t(n){var i=this;r(this,t),e(this,"firstTouch",(function(){var e=i.player,t=e.elements;e.touch=!0,ce(t.container,e.config.classNames.isTouch,!0)})),e(this,"setTabFocus",(function(e){var t=i.player,n=t.elements,a=e.key,r=e.type,s=e.timeStamp;if(clearTimeout(i.focusTimer),"keydown"!==r||"Tab"===a){"keydown"===r&&(i.lastKeyDown=s);var o=s-i.lastKeyDown<=20;("focus"!==r||o)&&(function(){var e=t.config.classNames.tabFocus;ce(he.call(t,".".concat(e)),e,!1)}(),"focusout"!==r&&(i.focusTimer=setTimeout((function(){var e=document.activeElement;n.container.contains(e)&&ce(document.activeElement,t.config.classNames.tabFocus,!0)}),10)))}})),e(this,"global",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=i.player;t.config.keyboard.global&&ve.call(t,window,"keydown keyup",i.handleKey,e,!1),ve.call(t,document.body,"click",i.toggleMenu,e),ke.call(t,document.body,"touchstart",i.firstTouch),ve.call(t,document.body,"keydown focus blur focusout",i.setTabFocus,e,!1,!0)})),e(this,"container",(function(){var e=i.player,t=e.config,n=e.elements,a=e.timers;!t.keyboard.global&&t.keyboard.focused&&be.call(e,n.container,"keydown keyup",i.handleKey,!1),be.call(e,n.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",(function(t){var i=n.controls;i&&"enterfullscreen"===t.type&&(i.pressed=!1,i.hover=!1);var r=0;["touchstart","touchmove","mousemove"].includes(t.type)&&(rt.toggleControls.call(e,!0),r=e.touch?3e3:2e3),clearTimeout(a.controls),a.controls=setTimeout((function(){return rt.toggleControls.call(e,!1)}),r)}));var r=function(){if(e.isVimeo&&!e.config.vimeo.premium){var t=n.wrapper,i=e.fullscreen.active,a=d(je.call(e),2),r=a[0],s=a[1],o=Me("aspect-ratio: ".concat(r," / ").concat(s));if(i){var l=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],c=l[1],u=l[0]/c>r/s;o?(t.style.width=u?"auto":"100%",t.style.height=u?"100%":"auto"):(t.style.maxWidth=u?c/s*r+"px":null,t.style.margin=u?"0 auto":null)}else o?(t.style.width=null,t.style.height=null):(t.style.maxWidth=null,t.style.margin=null)}},s=function(){clearTimeout(a.resized),a.resized=setTimeout(r,50)};be.call(e,n.container,"enterfullscreen exitfullscreen",(function(t){e.fullscreen.target===n.container&&(!e.isEmbed&&$(e.config.ratio)||(r(),("enterfullscreen"===t.type?be:we).call(e,window,"resize",s)))}))})),e(this,"media",(function(){var e=i.player,t=e.elements;if(be.call(e,e.media,"timeupdate seeking seeked",(function(t){return Ye.timeUpdate.call(e,t)})),be.call(e,e.media,"durationchange loadeddata loadedmetadata",(function(t){return Ye.durationUpdate.call(e,t)})),be.call(e,e.media,"ended",(function(){e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())})),be.call(e,e.media,"progress playing seeking seeked",(function(t){return Ye.updateProgress.call(e,t)})),be.call(e,e.media,"volumechange",(function(t){return Ye.updateVolume.call(e,t)})),be.call(e,e.media,"playing play pause ended emptied timeupdate",(function(t){return rt.checkPlaying.call(e,t)})),be.call(e,e.media,"waiting canplay seeked playing",(function(t){return rt.checkLoading.call(e,t)})),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){var n=pe.call(e,".".concat(e.config.classNames.video));if(!U(n))return;be.call(e,t.container,"click",(function(a){([t.container,n].includes(a.target)||n.contains(a.target))&&(e.touch&&e.config.hideControls||(e.ended?(i.proxy(a,e.restart,"restart"),i.proxy(a,(function(){Ce(e.play())}),"play")):i.proxy(a,(function(){Ce(e.togglePlay())}),"play")))}))}e.supported.ui&&e.config.disableContextMenu&&be.call(e,t.wrapper,"contextmenu",(function(e){e.preventDefault()}),!1),be.call(e,e.media,"volumechange",(function(){e.storage.set({volume:e.volume,muted:e.muted})})),be.call(e,e.media,"ratechange",(function(){Ye.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})})),be.call(e,e.media,"qualitychange",(function(t){Ye.updateSetting.call(e,"quality",null,t.detail.quality)})),be.call(e,e.media,"ready qualitychange",(function(){Ye.setDownloadUrl.call(e)}));var a=e.config.events.concat(["keyup","keydown"]).join(" ");be.call(e,e.media,a,(function(n){var i=n.detail,a=void 0===i?{}:i;"error"===n.type&&(a=e.media.error),Te.call(e,t.container,n.type,!0,a)}))})),e(this,"proxy",(function(e,t,n){var a=i.player,r=a.config.listeners[n],s=!0;F(r)&&(s=r.call(a,e)),!1!==s&&F(t)&&t.call(a,e)})),e(this,"bind",(function(e,t,n,a){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=i.player,o=s.config.listeners[a],l=F(o);be.call(s,e,t,(function(e){return i.proxy(e,n,a)}),r&&!l)})),e(this,"controls",(function(){var e=i.player,t=e.elements,n=J.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach((function(t){i.bind(t,"click",(function(){Ce(e.togglePlay())}),"play")})),i.bind(t.buttons.restart,"click",e.restart,"restart"),i.bind(t.buttons.rewind,"click",(function(){e.lastSeekTime=Date.now(),e.rewind()}),"rewind"),i.bind(t.buttons.fastForward,"click",(function(){e.lastSeekTime=Date.now(),e.forward()}),"fastForward"),i.bind(t.buttons.mute,"click",(function(){e.muted=!e.muted}),"mute"),i.bind(t.buttons.captions,"click",(function(){return e.toggleCaptions()})),i.bind(t.buttons.download,"click",(function(){Te.call(e,e.media,"download")}),"download"),i.bind(t.buttons.fullscreen,"click",(function(){e.fullscreen.toggle()}),"fullscreen"),i.bind(t.buttons.pip,"click",(function(){e.pip="toggle"}),"pip"),i.bind(t.buttons.airplay,"click",e.airplay,"airplay"),i.bind(t.buttons.settings,"click",(function(t){t.stopPropagation(),t.preventDefault(),Ye.toggleMenu.call(e,t)}),null,!1),i.bind(t.buttons.settings,"keyup",(function(t){["Space","Enter"].includes(t.key)&&("Enter"!==t.key?(t.preventDefault(),t.stopPropagation(),Ye.toggleMenu.call(e,t)):Ye.focusFirstMenuItem.call(e,null,!0))}),null,!1),i.bind(t.settings.menu,"keydown",(function(t){"Escape"===t.key&&Ye.toggleMenu.call(e,t)})),i.bind(t.inputs.seek,"mousedown mousemove",(function(e){var n=t.progress.getBoundingClientRect(),i=100/n.width*(e.pageX-n.left);e.currentTarget.setAttribute("seek-value",i)})),i.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",(function(t){var n=t.currentTarget,i="play-on-seeked";if(!z(t)||["ArrowLeft","ArrowRight"].includes(t.key)){e.lastSeekTime=Date.now();var a=n.hasAttribute(i),r=["mouseup","touchend","keyup"].includes(t.type);a&&r?(n.removeAttribute(i),Ce(e.play())):!r&&e.playing&&(n.setAttribute(i,""),e.pause())}})),J.isIos){var a=he.call(e,'input[type="range"]');Array.from(a).forEach((function(e){return i.bind(e,n,(function(e){return X(e.target)}))}))}i.bind(t.inputs.seek,n,(function(t){var n=t.currentTarget,i=n.getAttribute("seek-value");$(i)&&(i=n.value),n.removeAttribute("seek-value"),e.currentTime=i/n.max*e.duration}),"seek"),i.bind(t.progress,"mouseenter mouseleave mousemove",(function(t){return Ye.updateSeekTooltip.call(e,t)})),i.bind(t.progress,"mousemove touchmove",(function(t){var n=e.previewThumbnails;n&&n.loaded&&n.startMove(t)})),i.bind(t.progress,"mouseleave touchend click",(function(){var t=e.previewThumbnails;t&&t.loaded&&t.endMove(!1,!0)})),i.bind(t.progress,"mousedown touchstart",(function(t){var n=e.previewThumbnails;n&&n.loaded&&n.startScrubbing(t)})),i.bind(t.progress,"mouseup touchend",(function(t){var n=e.previewThumbnails;n&&n.loaded&&n.endScrubbing(t)})),J.isWebkit&&Array.from(he.call(e,'input[type="range"]')).forEach((function(t){i.bind(t,"input",(function(t){return Ye.updateRangeFill.call(e,t.target)}))})),e.config.toggleInvert&&!U(t.display.duration)&&i.bind(t.display.currentTime,"click",(function(){0!==e.currentTime&&(e.config.invertTime=!e.config.invertTime,Ye.timeUpdate.call(e))})),i.bind(t.inputs.volume,n,(function(t){e.volume=t.target.value}),"volume"),i.bind(t.controls,"mouseenter mouseleave",(function(n){t.controls.hover=!e.touch&&"mouseenter"===n.type})),t.fullscreen&&Array.from(t.fullscreen.children).filter((function(e){return!e.contains(t.container)})).forEach((function(n){i.bind(n,"mouseenter mouseleave",(function(n){t.controls&&(t.controls.hover=!e.touch&&"mouseenter"===n.type)}))})),i.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",(function(e){t.controls.pressed=["mousedown","touchstart"].includes(e.type)})),i.bind(t.controls,"focusin",(function(){var n=e.config,a=e.timers;ce(t.controls,n.classNames.noTransition,!0),rt.toggleControls.call(e,!0),setTimeout((function(){ce(t.controls,n.classNames.noTransition,!1)}),0);var r=i.touch?3e3:4e3;clearTimeout(a.controls),a.controls=setTimeout((function(){return rt.toggleControls.call(e,!1)}),r)})),i.bind(t.inputs.volume,"wheel",(function(t){var n=t.webkitDirectionInvertedFromDevice,i=[t.deltaX,-t.deltaY].map((function(e){return n?-e:e})),a=d(i,2),r=a[0],s=a[1],o=Math.sign(Math.abs(r)>Math.abs(s)?r:s);e.increaseVolume(o/50);var l=e.media.volume;(1===o&&l<1||-1===o&&l>0)&&t.preventDefault()}),"volume",!1)})),this.player=n,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.setTabFocus=this.setTabFocus.bind(this),this.firstTouch=this.firstTouch.bind(this)}return o(t,[{key:"handleKey",value:function(e){var t,n=this.player,i=n.elements,a=e.key,r=e.type,s=e.altKey,o=e.ctrlKey,l=e.metaKey,c=e.shiftKey,u="keydown"===r,d=u&&a===this.lastKey;if(!(s||o||l||c)&&a)if(u){var h=document.activeElement;if(U(h)){var p=n.config.selectors.editable;if(h!==i.inputs.seek&&de(h,p))return;if("Space"===e.key&&de(h,'button, [role^="menuitem"]'))return}switch(["Space","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(a)&&(e.preventDefault(),e.stopPropagation()),a){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":d||(t=parseInt(a,10),n.currentTime=n.duration/10*t);break;case"Space":case"k":d||Ce(n.togglePlay());break;case"ArrowUp":n.increaseVolume(.1);break;case"ArrowDown":n.decreaseVolume(.1);break;case"m":d||(n.muted=!n.muted);break;case"ArrowRight":n.forward();break;case"ArrowLeft":n.rewind();break;case"f":n.fullscreen.toggle();break;case"c":d||n.toggleCaptions();break;case"l":n.loop=!n.loop}"Escape"===a&&!n.fullscreen.usingNative&&n.fullscreen.active&&n.fullscreen.toggle(),this.lastKey=a}else this.lastKey=null}},{key:"toggleMenu",value:function(e){Ye.toggleMenu.call(this.player,e)}}]),t}();"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self&&self;var ot=function(e,t){return function(e,t){e.exports=function(){var e=function(){},t={},n={},i={};function a(e,t){e=e.push?e:[e];var a,r,s,o=[],l=e.length,c=l;for(a=function(e,n){n.length&&o.push(e),--c||t(o)};l--;)r=e[l],(s=n[r])?a(r,s):(i[r]=i[r]||[]).push(a)}function r(e,t){if(e){var a=i[e];if(n[e]=t,a)for(;a.length;)a[0](e,t),a.splice(0,1)}}function s(t,n){t.call&&(t={success:t}),n.length?(t.error||e)(n):(t.success||e)(t)}function o(t,n,i,a){var r,s,l=document,c=i.async,u=(i.numRetries||0)+1,d=i.before||e,h=t.replace(/[\?|#].*$/,""),p=t.replace(/^(css|img)!/,"");a=a||0,/(^css!|\.css$)/.test(h)?((s=l.createElement("link")).rel="stylesheet",s.href=p,(r="hideFocus"in s)&&s.relList&&(r=0,s.rel="preload",s.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(h)?(s=l.createElement("img")).src=p:((s=l.createElement("script")).src=t,s.async=void 0===c||c),s.onload=s.onerror=s.onbeforeload=function(e){var l=e.type[0];if(r)try{s.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((a+=1)<u)return o(t,n,i,a)}else if("preload"==s.rel&&"style"==s.as)return s.rel="stylesheet";n(t,l,e.defaultPrevented)},!1!==d(t,s)&&l.head.appendChild(s)}function l(e,t,n){var i,a,r=(e=e.push?e:[e]).length,s=r,l=[];for(i=function(e,n,i){if("e"==n&&l.push(e),"b"==n){if(!i)return;l.push(e)}--r||t(l)},a=0;a<s;a++)o(e[a],i,n)}function c(e,n,i){var a,o;if(n&&n.trim&&(a=n),o=(a?i:n)||{},a){if(a in t)throw"LoadJS";t[a]=!0}function c(t,n){l(e,(function(e){s(o,e),t&&s({success:t,error:n},e),r(a,e)}),o)}if(o.returnPromise)return new Promise(c);c()}return c.ready=function(e,t){return a(e,(function(e){s(t,e)})),c},c.done=function(e){r(e,[])},c.reset=function(){t={},n={},i={}},c.isDefined=function(e){return e in t},c}()}(t={exports:{}}),t.exports}();function lt(e){return new Promise((function(t,n){ot(e,{success:t,error:n})}))}function ct(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,Te.call(this,this.media,e?"play":"pause"))}var ut={setup(){var e=this;ce(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,Ie.call(e),q(window.Vimeo)?ut.ready.call(e):lt(e.config.urls.vimeo.sdk).then((function(){ut.ready.call(e)})).catch((function(t){e.debug.warn("Vimeo SDK (player.js) failed to load",t)}))},ready(){var e=this,t=this,n=t.config.vimeo,a=n.premium,r=n.referrerPolicy,s=function(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(n,i),o=t.media.getAttribute("src"),l="";$(o)?(o=t.media.getAttribute(t.config.attributes.embed.id),l=t.media.getAttribute(t.config.attributes.embed.hash)):l=function(e){var t=e.match(/^.*(vimeo.com\/|video\/)(\d+)(\?.*&*h=|\/)+([\d,a-f]+)/);return t&&5===t.length?t[4]:null}(o);var u=l?{h:l}:{};a&&Object.assign(s,{controls:!1,sidedock:!1});var h,p=Qe(c(c({loop:t.config.loop.active,autoplay:t.autoplay,muted:t.muted,gesture:"media",playsinline:!this.config.fullscreen.iosNative},u),s)),m=$(h=o)?null:D(Number(h))?h:h.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:h,f=ne("iframe"),g=qe(t.config.urls.vimeo.iframe,m,p);if(f.setAttribute("src",g),f.setAttribute("allowfullscreen",""),f.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),$(r)||f.setAttribute("referrerPolicy",r),a||!n.customControls)f.setAttribute("data-poster",t.poster),t.media=se(f,t.media);else{var y=ne("div",{class:t.config.classNames.embedContainer,"data-poster":t.poster});y.appendChild(f),t.media=se(y,t.media)}n.customControls||Ue(qe(t.config.urls.vimeo.api,g)).then((function(e){!$(e)&&e.thumbnail_url&&rt.setPoster.call(t,e.thumbnail_url).catch((function(){}))})),t.embed=new window.Vimeo.Player(f,{autopause:t.config.autopause,muted:t.muted}),t.media.paused=!0,t.media.currentTime=0,t.supported.ui&&t.embed.disableTextTrack(),t.media.play=function(){return ct.call(t,!0),t.embed.play()},t.media.pause=function(){return ct.call(t,!1),t.embed.pause()},t.media.stop=function(){t.pause(),t.currentTime=0};var v=t.media.currentTime;Object.defineProperty(t.media,"currentTime",{get:function(){return v},set(e){var n=t.embed,i=t.media,a=t.paused,r=t.volume,s=a&&!n.hasPlayed;i.seeking=!0,Te.call(t,i,"seeking"),Promise.resolve(s&&n.setVolume(0)).then((function(){return n.setCurrentTime(e)})).then((function(){return s&&n.pause()})).then((function(){return s&&n.setVolume(r)})).catch((function(){}))}});var b=t.config.speed.selected;Object.defineProperty(t.media,"playbackRate",{get:function(){return b},set(e){t.embed.setPlaybackRate(e).then((function(){b=e,Te.call(t,t.media,"ratechange")})).catch((function(){t.options.speed=[1]}))}});var w=t.config.volume;Object.defineProperty(t.media,"volume",{get:function(){return w},set(e){t.embed.setVolume(e).then((function(){w=e,Te.call(t,t.media,"volumechange")}))}});var k=t.config.muted;Object.defineProperty(t.media,"muted",{get:function(){return k},set(e){var n=!!R(e)&&e;t.embed.setVolume(n?0:t.config.volume).then((function(){k=n,Te.call(t,t.media,"volumechange")}))}});var T,S=t.config.loop;Object.defineProperty(t.media,"loop",{get:function(){return S},set(e){var n=R(e)?e:t.config.loop.active;t.embed.setLoop(n).then((function(){S=n}))}}),t.embed.getVideoUrl().then((function(e){T=e,Ye.setDownloadUrl.call(t)})).catch((function(t){e.debug.warn(t)})),Object.defineProperty(t.media,"currentSrc",{get:function(){return T}}),Object.defineProperty(t.media,"ended",{get:function(){return t.currentTime===t.duration}}),Promise.all([t.embed.getVideoWidth(),t.embed.getVideoHeight()]).then((function(n){var i=d(n,2),a=i[0],r=i[1];t.embed.ratio=_e(a,r),Ie.call(e)})),t.embed.setAutopause(t.config.autopause).then((function(e){t.config.autopause=e})),t.embed.getVideoTitle().then((function(n){t.config.title=n,rt.setTitle.call(e)})),t.embed.getCurrentTime().then((function(e){v=e,Te.call(t,t.media,"timeupdate")})),t.embed.getDuration().then((function(e){t.media.duration=e,Te.call(t,t.media,"durationchange")})),t.embed.getTextTracks().then((function(e){t.media.textTracks=e,Xe.setup.call(t)})),t.embed.on("cuechange",(function(e){var n=e.cues,i=(void 0===n?[]:n).map((function(e){return function(e){var t=document.createDocumentFragment(),n=document.createElement("div");return t.appendChild(n),n.innerHTML=e,t.firstChild.innerText}(e.text)}));Xe.updateCues.call(t,i)})),t.embed.on("loaded",(function(){t.embed.getPaused().then((function(e){ct.call(t,!e),e||Te.call(t,t.media,"playing")})),U(t.embed.element)&&t.supported.ui&&t.embed.element.setAttribute("tabindex",-1)})),t.embed.on("bufferstart",(function(){Te.call(t,t.media,"waiting")})),t.embed.on("bufferend",(function(){Te.call(t,t.media,"playing")})),t.embed.on("play",(function(){ct.call(t,!0),Te.call(t,t.media,"playing")})),t.embed.on("pause",(function(){ct.call(t,!1)})),t.embed.on("timeupdate",(function(e){t.media.seeking=!1,v=e.seconds,Te.call(t,t.media,"timeupdate")})),t.embed.on("progress",(function(e){t.media.buffered=e.percent,Te.call(t,t.media,"progress"),1===parseInt(e.percent,10)&&Te.call(t,t.media,"canplaythrough"),t.embed.getDuration().then((function(e){e!==t.media.duration&&(t.media.duration=e,Te.call(t,t.media,"durationchange"))}))})),t.embed.on("seeked",(function(){t.media.seeking=!1,Te.call(t,t.media,"seeked")})),t.embed.on("ended",(function(){t.media.paused=!0,Te.call(t,t.media,"ended")})),t.embed.on("error",(function(e){t.media.error=e,Te.call(t,t.media,"error")})),n.customControls&&setTimeout((function(){return rt.build.call(t)}),0)}};function dt(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,Te.call(this,this.media,e?"play":"pause"))}function ht(e){return e.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}var pt={setup(){var e=this;if(ce(this.elements.wrapper,this.config.classNames.embed,!0),q(window.YT)&&F(window.YT.Player))pt.ready.call(this);else{var t=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=function(){F(t)&&t(),pt.ready.call(e)},lt(this.config.urls.youtube.sdk).catch((function(t){e.debug.warn("YouTube API failed to load",t)}))}},getTitle(e){var t=this;Ue(qe(this.config.urls.youtube.api,e)).then((function(e){if(q(e)){var n=e.title,i=e.height,a=e.width;t.config.title=n,rt.setTitle.call(t),t.embed.ratio=_e(a,i)}Ie.call(t)})).catch((function(){Ie.call(t)}))},ready(){var e=this,t=e.config.youtube,n=e.media&&e.media.getAttribute("id");if($(n)||!n.startsWith("youtube-")){var i=e.media.getAttribute("src");$(i)&&(i=e.media.getAttribute(this.config.attributes.embed.id));var a,r=$(a=i)?null:a.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:a,s=ne("div",{id:"".concat(e.provider,"-").concat(Math.floor(1e4*Math.random())),"data-poster":t.customControls?e.poster:void 0});if(e.media=se(s,e.media),t.customControls){var o=function(e){return"https://i.ytimg.com/vi/".concat(r,"/").concat(e,"default.jpg")};at(o("maxres"),121).catch((function(){return at(o("sd"),121)})).catch((function(){return at(o("hq"))})).then((function(t){return rt.setPoster.call(e,t.src)})).then((function(t){t.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")})).catch((function(){}))}e.embed=new window.YT.Player(e.media,{videoId:r,host:ht(t),playerVars:Z({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui&&t.customControls?0:1,disablekb:1,playsinline:e.config.fullscreen.iosNative?0:1,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},t),events:{onError(t){if(!e.media.error){var n=t.data,i={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[n]||"An unknown error occured";e.media.error={code:n,message:i},Te.call(e,e.media,"error")}},onPlaybackRateChange(t){var n=t.target;e.media.playbackRate=n.getPlaybackRate(),Te.call(e,e.media,"ratechange")},onReady(n){if(!F(e.media.play)){var i=n.target;pt.getTitle.call(e,r),e.media.play=function(){dt.call(e,!0),i.playVideo()},e.media.pause=function(){dt.call(e,!1),i.pauseVideo()},e.media.stop=function(){i.stopVideo()},e.media.duration=i.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get:function(){return Number(i.getCurrentTime())},set(t){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,Te.call(e,e.media,"seeking"),i.seekTo(t)}}),Object.defineProperty(e.media,"playbackRate",{get:function(){return i.getPlaybackRate()},set(e){i.setPlaybackRate(e)}});var a=e.config.volume;Object.defineProperty(e.media,"volume",{get:function(){return a},set(t){a=t,i.setVolume(100*a),Te.call(e,e.media,"volumechange")}});var s=e.config.muted;Object.defineProperty(e.media,"muted",{get:function(){return s},set(t){var n=R(t)?t:s;s=n,i[n?"mute":"unMute"](),i.setVolume(100*a),Te.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get:function(){return i.getVideoUrl()}}),Object.defineProperty(e.media,"ended",{get:function(){return e.currentTime===e.duration}});var o=i.getAvailablePlaybackRates();e.options.speed=o.filter((function(t){return e.config.speed.options.includes(t)})),e.supported.ui&&t.customControls&&e.media.setAttribute("tabindex",-1),Te.call(e,e.media,"timeupdate"),Te.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval((function(){e.media.buffered=i.getVideoLoadedFraction(),(null===e.media.lastBuffered||e.media.lastBuffered<e.media.buffered)&&Te.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,1===e.media.buffered&&(clearInterval(e.timers.buffering),Te.call(e,e.media,"canplaythrough"))}),200),t.customControls&&setTimeout((function(){return rt.build.call(e)}),50)}},onStateChange(n){var i=n.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(n.data)&&(e.media.seeking=!1,Te.call(e,e.media,"seeked")),n.data){case-1:Te.call(e,e.media,"timeupdate"),e.media.buffered=i.getVideoLoadedFraction(),Te.call(e,e.media,"progress");break;case 0:dt.call(e,!1),e.media.loop?(i.stopVideo(),i.playVideo()):Te.call(e,e.media,"ended");break;case 1:t.customControls&&!e.config.autoplay&&e.media.paused&&!e.embed.hasPlayed?e.media.pause():(dt.call(e,!0),Te.call(e,e.media,"playing"),e.timers.playing=setInterval((function(){Te.call(e,e.media,"timeupdate")}),50),e.media.duration!==i.getDuration()&&(e.media.duration=i.getDuration(),Te.call(e,e.media,"durationchange")));break;case 2:e.muted||e.embed.unMute(),dt.call(e,!1);break;case 3:Te.call(e,e.media,"waiting")}Te.call(e,e.elements.container,"statechange",!1,{code:n.data})}}})}}},mt={setup(){this.media?(ce(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),ce(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&ce(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=ne("div",{class:this.config.classNames.video}),ee(this.media,this.elements.wrapper),this.elements.poster=ne("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?Oe.setup.call(this):this.isYouTube?pt.setup.call(this):this.isVimeo&&ut.setup.call(this)):this.debug.warn("No media element found!")}},ft=function(){function t(n){var i=this;r(this,t),e(this,"load",(function(){i.enabled&&(q(window.google)&&q(window.google.ima)?i.ready():lt(i.player.config.urls.googleIMA.sdk).then((function(){i.ready()})).catch((function(){i.trigger("error",new Error("Google IMA SDK failed to load"))})))})),e(this,"ready",(function(){var e;i.enabled||((e=i).manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()),i.startSafetyTimer(12e3,"ready()"),i.managerPromise.then((function(){i.clearSafetyTimer("onAdsManagerLoaded()")})),i.listeners(),i.setupIMA()})),e(this,"setupIMA",(function(){i.elements.container=ne("div",{class:i.player.config.classNames.ads}),i.player.elements.container.appendChild(i.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(i.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(i.player.config.playsinline),i.elements.displayContainer=new google.ima.AdDisplayContainer(i.elements.container,i.player.media),i.loader=new google.ima.AdsLoader(i.elements.displayContainer),i.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(e){return i.onAdsManagerLoaded(e)}),!1),i.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){return i.onAdError(e)}),!1),i.requestAds()})),e(this,"requestAds",(function(){var e=i.player.elements.container;try{var t=new google.ima.AdsRequest;t.adTagUrl=i.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!i.player.muted),i.loader.requestAds(t)}catch(e){i.onAdError(e)}})),e(this,"pollCountdown",(function(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0]))return clearInterval(i.countdownTimer),void i.elements.container.removeAttribute("data-badge-text");i.countdownTimer=setInterval((function(){var e=Ke(Math.max(i.manager.getRemainingTime(),0)),t="".concat(Ve.get("advertisement",i.player.config)," - ").concat(e);i.elements.container.setAttribute("data-badge-text",t)}),100)})),e(this,"onAdsManagerLoaded",(function(e){if(i.enabled){var t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,i.manager=e.getAdsManager(i.player,t),i.cuePoints=i.manager.getCuePoints(),i.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(function(e){return i.onAdError(e)})),Object.keys(google.ima.AdEvent.Type).forEach((function(e){i.manager.addEventListener(google.ima.AdEvent.Type[e],(function(e){return i.onAdEvent(e)}))})),i.trigger("loaded")}})),e(this,"addCuePoints",(function(){$(i.cuePoints)||i.cuePoints.forEach((function(e){if(0!==e&&-1!==e&&e<i.player.duration){var t=i.player.elements.progress;if(U(t)){var n=100/i.player.duration*e,a=ne("span",{class:i.player.config.classNames.cues});a.style.left="".concat(n.toString(),"%"),t.appendChild(a)}}}))})),e(this,"onAdEvent",(function(e){var t=i.player.elements.container,n=e.getAd(),a=e.getAdData();switch(function(e){Te.call(i.player,i.player.media,"ads".concat(e.replace(/_/g,"").toLowerCase()))}(e.type),e.type){case google.ima.AdEvent.Type.LOADED:i.trigger("loaded"),i.pollCountdown(!0),n.isLinear()||(n.width=t.offsetWidth,n.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:i.manager.setVolume(i.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:i.player.ended?i.loadAds():i.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:i.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:i.pollCountdown(),i.resumeContent();break;case google.ima.AdEvent.Type.LOG:a.adError&&i.player.debug.warn("Non-fatal ad error: ".concat(a.adError.getMessage()))}})),e(this,"onAdError",(function(e){i.cancel(),i.player.debug.warn("Ads error",e)})),e(this,"listeners",(function(){var e,t=i.player.elements.container;i.player.on("canplay",(function(){i.addCuePoints()})),i.player.on("ended",(function(){i.loader.contentComplete()})),i.player.on("timeupdate",(function(){e=i.player.currentTime})),i.player.on("seeked",(function(){var t=i.player.currentTime;$(i.cuePoints)||i.cuePoints.forEach((function(n,a){e<n&&n<t&&(i.manager.discardAdBreak(),i.cuePoints.splice(a,1))}))})),window.addEventListener("resize",(function(){i.manager&&i.manager.resize(t.offsetWidth,t.offsetHeight,google.ima.ViewMode.NORMAL)}))})),e(this,"play",(function(){var e=i.player.elements.container;i.managerPromise||i.resumeContent(),i.managerPromise.then((function(){i.manager.setVolume(i.player.volume),i.elements.displayContainer.initialize();try{i.initialized||(i.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),i.manager.start()),i.initialized=!0}catch(e){i.onAdError(e)}})).catch((function(){}))})),e(this,"resumeContent",(function(){i.elements.container.style.zIndex="",i.playing=!1,Ce(i.player.media.play())})),e(this,"pauseContent",(function(){i.elements.container.style.zIndex=3,i.playing=!0,i.player.media.pause()})),e(this,"cancel",(function(){i.initialized&&i.resumeContent(),i.trigger("error"),i.loadAds()})),e(this,"loadAds",(function(){i.managerPromise.then((function(){i.manager&&i.manager.destroy(),i.managerPromise=new Promise((function(e){i.on("loaded",e),i.player.debug.log(i.manager)})),i.initialized=!1,i.requestAds()})).catch((function(){}))})),e(this,"trigger",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var r=i.events[e];V(r)&&r.forEach((function(e){F(e)&&e.apply(i,n)}))})),e(this,"on",(function(e,t){return V(i.events[e])||(i.events[e]=[]),i.events[e].push(t),i})),e(this,"startSafetyTimer",(function(e,t){i.player.debug.log("Safety timer invoked from: ".concat(t)),i.safetyTimer=setTimeout((function(){i.cancel(),i.clearSafetyTimer("startSafetyTimer()")}),e)})),e(this,"clearSafetyTimer",(function(e){O(i.safetyTimer)||(i.player.debug.log("Safety timer cleared from: ".concat(e)),clearTimeout(i.safetyTimer),i.safetyTimer=null)})),this.player=n,this.config=n.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise((function(e,t){i.on("loaded",e),i.on("error",t)})),this.load()}return o(t,[{key:"enabled",get:function(){var e=this.config;return this.player.isHTML5&&this.player.isVideo&&e.enabled&&(!$(e.publisherId)||Y(e.tagUrl))}},{key:"tagUrl",get:function(){var e=this.config;return Y(e.tagUrl)?e.tagUrl:"https://go.aniview.com/api/adserver6/vast/?".concat(Qe({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId}))}}]),t}();function gt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255;return Math.min(Math.max(e,t),n)}var yt,vt=function(e){var t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach((function(e){var n={};e.split(/\r\n|\n|\r/).forEach((function(e){if(D(n.startTime)){if(!$(e.trim())&&$(n.text)){var t,i,a=e.trim().split("#xywh=");t=d(a,1),n.text=t[0],a[1]&&(i=d(a[1].split(","),4),n.x=i[0],n.y=i[1],n.w=i[2],n.h=i[3])}}else{var r=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);r&&(n.startTime=60*Number(r[1]||0)*60+60*Number(r[2])+Number(r[3])+Number("0.".concat(r[4])),n.endTime=60*Number(r[6]||0)*60+60*Number(r[7])+Number(r[8])+Number("0.".concat(r[9])))}})),n.text&&t.push(n)})),t},bt=function(e,t){var n={};return e>t.width/t.height?(n.width=t.width,n.height=1/e*t.width):(n.height=t.height,n.width=e*t.height),n},wt=function(){function t(n){var i=this;r(this,t),e(this,"load",(function(){i.player.elements.display.seekTooltip&&(i.player.elements.display.seekTooltip.hidden=i.enabled),i.enabled&&i.getThumbnails().then((function(){i.enabled&&(i.render(),i.determineContainerAutoSizing(),i.loaded=!0)}))})),e(this,"getThumbnails",(function(){return new Promise((function(e){var t=i.player.config.previewThumbnails.src;if($(t))throw new Error("Missing previewThumbnails.src config attribute");var n=function(){i.thumbnails.sort((function(e,t){return e.height-t.height})),i.player.debug.log("Preview thumbnails",i.thumbnails),e()};if(F(t))t((function(e){i.thumbnails=e,n()}));else{var a=(H(t)?[t]:t).map((function(e){return i.getThumbnail(e)}));Promise.all(a).then(n)}}))})),e(this,"getThumbnail",(function(e){return new Promise((function(t){Ue(e).then((function(n){var a={frames:vt(n),height:null,urlPrefix:""};a.frames[0].text.startsWith("/")||a.frames[0].text.startsWith("http://")||a.frames[0].text.startsWith("https://")||(a.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));var r=new Image;r.onload=function(){a.height=r.naturalHeight,a.width=r.naturalWidth,i.thumbnails.push(a),t()},r.src=a.urlPrefix+a.frames[0].text}))}))})),e(this,"startMove",(function(e){if(i.loaded&&W(e)&&["touchmove","mousemove"].includes(e.type)&&i.player.media.duration){if("touchmove"===e.type)i.seekTime=i.player.media.duration*(i.player.elements.inputs.seek.value/100);else{var t,n,a=i.player.elements.progress.getBoundingClientRect(),r=100/a.width*(e.pageX-a.left);i.seekTime=i.player.media.duration*(r/100),i.seekTime<0&&(i.seekTime=0),i.seekTime>i.player.media.duration-1&&(i.seekTime=i.player.media.duration-1),i.mousePosX=e.pageX,i.elements.thumb.time.innerText=Ke(i.seekTime);var s=null===(t=i.player.config.markers)||void 0===t||null===(n=t.points)||void 0===n?void 0:n.find((function(e){return e.time===Math.round(i.seekTime)}));s&&i.elements.thumb.time.insertAdjacentHTML("afterbegin","".concat(s.label,"<br>"))}i.showImageAtCurrentTime()}})),e(this,"endMove",(function(){i.toggleThumbContainer(!1,!0)})),e(this,"startScrubbing",(function(e){(O(e.button)||!1===e.button||0===e.button)&&(i.mouseDown=!0,i.player.media.duration&&(i.toggleScrubbingContainer(!0),i.toggleThumbContainer(!1,!0),i.showImageAtCurrentTime()))})),e(this,"endScrubbing",(function(){i.mouseDown=!1,Math.ceil(i.lastTime)===Math.ceil(i.player.media.currentTime)?i.toggleScrubbingContainer(!1):ke.call(i.player,i.player.media,"timeupdate",(function(){i.mouseDown||i.toggleScrubbingContainer(!1)}))})),e(this,"listeners",(function(){i.player.on("play",(function(){i.toggleThumbContainer(!1,!0)})),i.player.on("seeked",(function(){i.toggleThumbContainer(!1)})),i.player.on("timeupdate",(function(){i.lastTime=i.player.media.currentTime}))})),e(this,"render",(function(){i.elements.thumb.container=ne("div",{class:i.player.config.classNames.previewThumbnails.thumbContainer}),i.elements.thumb.imageContainer=ne("div",{class:i.player.config.classNames.previewThumbnails.imageContainer}),i.elements.thumb.container.appendChild(i.elements.thumb.imageContainer);var e=ne("div",{class:i.player.config.classNames.previewThumbnails.timeContainer});i.elements.thumb.time=ne("span",{},"00:00"),e.appendChild(i.elements.thumb.time),i.elements.thumb.imageContainer.appendChild(e),U(i.player.elements.progress)&&i.player.elements.progress.appendChild(i.elements.thumb.container),i.elements.scrubbing.container=ne("div",{class:i.player.config.classNames.previewThumbnails.scrubbingContainer}),i.player.elements.wrapper.appendChild(i.elements.scrubbing.container)})),e(this,"destroy",(function(){i.elements.thumb.container&&i.elements.thumb.container.remove(),i.elements.scrubbing.container&&i.elements.scrubbing.container.remove()})),e(this,"showImageAtCurrentTime",(function(){i.mouseDown?i.setScrubbingContainerSize():i.setThumbContainerSizeAndPos();var e=i.thumbnails[0].frames.findIndex((function(e){return i.seekTime>=e.startTime&&i.seekTime<=e.endTime})),t=e>=0,n=0;i.mouseDown||i.toggleThumbContainer(t),t&&(i.thumbnails.forEach((function(t,a){i.loadedImages.includes(t.frames[e].text)&&(n=a)})),e!==i.showingThumb&&(i.showingThumb=e,i.loadImage(n)))})),e(this,"loadImage",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=i.showingThumb,n=i.thumbnails[e],a=n.urlPrefix,r=n.frames[t],s=n.frames[t].text,o=a+s;if(i.currentImageElement&&i.currentImageElement.dataset.filename===s)i.showImage(i.currentImageElement,r,e,t,s,!1),i.currentImageElement.dataset.index=t,i.removeOldImages(i.currentImageElement);else{i.loadingImage&&i.usingSprites&&(i.loadingImage.onload=null);var l=new Image;l.src=o,l.dataset.index=t,l.dataset.filename=s,i.showingThumbFilename=s,i.player.debug.log("Loading image: ".concat(o)),l.onload=function(){return i.showImage(l,r,e,t,s,!0)},i.loadingImage=l,i.removeOldImages(l)}})),e(this,"showImage",(function(e,t,n,a,r){var s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];i.player.debug.log("Showing thumb: ".concat(r,". num: ").concat(a,". qual: ").concat(n,". newimg: ").concat(s)),i.setImageSizeAndOffset(e,t),s&&(i.currentImageContainer.appendChild(e),i.currentImageElement=e,i.loadedImages.includes(r)||i.loadedImages.push(r)),i.preloadNearby(a,!0).then(i.preloadNearby(a,!1)).then(i.getHigherQuality(n,e,t,r))})),e(this,"removeOldImages",(function(e){Array.from(i.currentImageContainer.children).forEach((function(t){if("img"===t.tagName.toLowerCase()){var n=i.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;var a=i.currentImageContainer;setTimeout((function(){a.removeChild(t),i.player.debug.log("Removing thumb: ".concat(t.dataset.filename))}),n)}}}))})),e(this,"preloadNearby",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(n){setTimeout((function(){var a=i.thumbnails[0].frames[e].text;if(i.showingThumbFilename===a){var r;r=t?i.thumbnails[0].frames.slice(e):i.thumbnails[0].frames.slice(0,e).reverse();var s=!1;r.forEach((function(e){var t=e.text;if(t!==a&&!i.loadedImages.includes(t)){s=!0,i.player.debug.log("Preloading thumb filename: ".concat(t));var r=i.thumbnails[0].urlPrefix+t,o=new Image;o.src=r,o.onload=function(){i.player.debug.log("Preloaded thumb filename: ".concat(t)),i.loadedImages.includes(t)||i.loadedImages.push(t),n()}}})),s||n()}}),300)}))})),e(this,"getHigherQuality",(function(e,t,n,a){if(e<i.thumbnails.length-1){var r=t.naturalHeight;i.usingSprites&&(r=n.h),r<i.thumbContainerHeight&&setTimeout((function(){i.showingThumbFilename===a&&(i.player.debug.log("Showing higher quality thumb for: ".concat(a)),i.loadImage(e+1))}),300)}})),e(this,"toggleThumbContainer",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i.player.config.classNames.previewThumbnails.thumbContainerShown;i.elements.thumb.container.classList.toggle(n,e),!e&&t&&(i.showingThumb=null,i.showingThumbFilename=null)})),e(this,"toggleScrubbingContainer",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=i.player.config.classNames.previewThumbnails.scrubbingContainerShown;i.elements.scrubbing.container.classList.toggle(t,e),e||(i.showingThumb=null,i.showingThumbFilename=null)})),e(this,"determineContainerAutoSizing",(function(){(i.elements.thumb.imageContainer.clientHeight>20||i.elements.thumb.imageContainer.clientWidth>20)&&(i.sizeSpecifiedInCSS=!0)})),e(this,"setThumbContainerSizeAndPos",(function(){var e=i.elements.thumb.imageContainer;if(i.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){var t=Math.floor(e.clientHeight*i.thumbAspectRatio);e.style.width="".concat(t,"px")}else if(e.clientHeight<20&&e.clientWidth>20){var n=Math.floor(e.clientWidth/i.thumbAspectRatio);e.style.height="".concat(n,"px")}}else{var a=Math.floor(i.thumbContainerHeight*i.thumbAspectRatio);e.style.height="".concat(i.thumbContainerHeight,"px"),e.style.width="".concat(a,"px")}i.setThumbContainerPos()})),e(this,"setThumbContainerPos",(function(){var e=i.player.elements.progress.getBoundingClientRect(),t=i.player.elements.container.getBoundingClientRect(),n=i.elements.thumb.container,a=t.left-e.left+10,r=t.right-e.left-n.clientWidth-10,s=i.mousePosX-e.left-n.clientWidth/2,o=gt(s,a,r);n.style.left="".concat(o,"px"),n.style.setProperty("--preview-arrow-offset",s-o+"px")})),e(this,"setScrubbingContainerSize",(function(){var e=bt(i.thumbAspectRatio,{width:i.player.media.clientWidth,height:i.player.media.clientHeight}),t=e.width,n=e.height;i.elements.scrubbing.container.style.width="".concat(t,"px"),i.elements.scrubbing.container.style.height="".concat(n,"px")})),e(this,"setImageSizeAndOffset",(function(e,t){if(i.usingSprites){var n=i.thumbContainerHeight/t.h;e.style.height=e.naturalHeight*n+"px",e.style.width=e.naturalWidth*n+"px",e.style.left="-".concat(t.x*n,"px"),e.style.top="-".concat(t.y*n,"px")}})),this.player=n,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}return o(t,[{key:"enabled",get:function(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}},{key:"currentImageContainer",get:function(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}},{key:"usingSprites",get:function(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}},{key:"thumbAspectRatio",get:function(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}},{key:"thumbContainerHeight",get:function(){return this.mouseDown?bt(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight}).height:this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}},{key:"currentImageElement",get:function(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement},set:function(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}]),t}(),kt={insertElements(e,t){var n=this;H(t)?ie(e,this.media,{src:t}):V(t)&&t.forEach((function(t){ie(e,n.media,t)}))},change(e){var t=this;G(e,"sources.length")?(Oe.cancelRequests.call(this),this.destroy.call(this,(function(){t.options.quality=[],ae(t.media),t.media=null,U(t.elements.container)&&t.elements.container.removeAttribute("class");var n=e.sources,i=e.type,a=d(n,1)[0],r=a.provider,s=void 0===r?Ze.html5:r,o=a.src,l="html5"===s?i:"div",c="html5"===s?{}:{src:o};Object.assign(t,{provider:s,type:i,supported:ge.check(i,s,t.config.playsinline),media:ne(l,c)}),t.elements.container.appendChild(t.media),R(e.autoplay)&&(t.config.autoplay=e.autoplay),t.isHTML5&&(t.config.crossorigin&&t.media.setAttribute("crossorigin",""),t.config.autoplay&&t.media.setAttribute("autoplay",""),$(e.poster)||(t.poster=e.poster),t.config.loop.active&&t.media.setAttribute("loop",""),t.config.muted&&t.media.setAttribute("muted",""),t.config.playsinline&&t.media.setAttribute("playsinline","")),rt.addStyleHook.call(t),t.isHTML5&&kt.insertElements.call(t,"source",n),t.config.title=e.title,mt.setup.call(t),t.isHTML5&&Object.keys(e).includes("tracks")&&kt.insertElements.call(t,"track",e.tracks),(t.isHTML5||t.isEmbed&&!t.supported.ui)&&rt.build.call(t),t.isHTML5&&t.media.load(),$(e.previewThumbnails)||(Object.assign(t.config.previewThumbnails,e.previewThumbnails),t.previewThumbnails&&t.previewThumbnails.loaded&&(t.previewThumbnails.destroy(),t.previewThumbnails=null),t.config.previewThumbnails.enabled&&(t.previewThumbnails=new wt(t))),t.fullscreen.update()}),!0)):this.debug.warn("Invalid source format")}},Tt=function(){function t(n,i){var a=this;if(r(this,t),e(this,"play",(function(){return F(a.media.play)?(a.ads&&a.ads.enabled&&a.ads.managerPromise.then((function(){return a.ads.play()})).catch((function(){return Ce(a.media.play())})),a.media.play()):null})),e(this,"pause",(function(){return a.playing&&F(a.media.pause)?a.media.pause():null})),e(this,"togglePlay",(function(e){return(R(e)?e:!a.playing)?a.play():a.pause()})),e(this,"stop",(function(){a.isHTML5?(a.pause(),a.restart()):F(a.media.stop)&&a.media.stop()})),e(this,"restart",(function(){a.currentTime=0})),e(this,"rewind",(function(e){a.currentTime-=D(e)?e:a.config.seekTime})),e(this,"forward",(function(e){a.currentTime+=D(e)?e:a.config.seekTime})),e(this,"increaseVolume",(function(e){var t=a.media.muted?0:a.volume;a.volume=t+(D(e)?e:0)})),e(this,"decreaseVolume",(function(e){a.increaseVolume(-e)})),e(this,"airplay",(function(){ge.airplay&&a.media.webkitShowPlaybackTargetPicker()})),e(this,"toggleControls",(function(e){if(a.supported.ui&&!a.isAudio){var t=ue(a.elements.container,a.config.classNames.hideControls),n=void 0===e?void 0:!e,i=ce(a.elements.container,a.config.classNames.hideControls,n);if(i&&V(a.config.controls)&&a.config.controls.includes("settings")&&!$(a.config.settings)&&Ye.toggleMenu.call(a,!1),i!==t){var r=i?"controlshidden":"controlsshown";Te.call(a,a.media,r)}return!i}return!1})),e(this,"on",(function(e,t){be.call(a,a.elements.container,e,t)})),e(this,"once",(function(e,t){ke.call(a,a.elements.container,e,t)})),e(this,"off",(function(e,t){we(a.elements.container,e,t)})),e(this,"destroy",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(a.ready){var n=function(){document.body.style.overflow="",a.embed=null,t?(Object.keys(a.elements).length&&(ae(a.elements.buttons.play),ae(a.elements.captions),ae(a.elements.controls),ae(a.elements.wrapper),a.elements.buttons.play=null,a.elements.captions=null,a.elements.controls=null,a.elements.wrapper=null),F(e)&&e()):(Se.call(a),Oe.cancelRequests.call(a),se(a.elements.original,a.elements.container),Te.call(a,a.elements.original,"destroyed",!0),F(e)&&e.call(a.elements.original),a.ready=!1,setTimeout((function(){a.elements=null,a.media=null}),200))};a.stop(),clearTimeout(a.timers.loading),clearTimeout(a.timers.controls),clearTimeout(a.timers.resized),a.isHTML5?(rt.toggleNativeControls.call(a,!0),n()):a.isYouTube?(clearInterval(a.timers.buffering),clearInterval(a.timers.playing),null!==a.embed&&F(a.embed.destroy)&&a.embed.destroy(),n()):a.isVimeo&&(null!==a.embed&&a.embed.unload().then(n),setTimeout(n,200))}})),e(this,"supports",(function(e){return ge.mime.call(a,e)})),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=ge.touch,this.media=n,H(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||B(this.media)||V(this.media))&&(this.media=this.media[0]),this.config=Z({},Je,t.defaults,i||{},function(){try{return JSON.parse(a.media.getAttribute("data-plyr-config"))}catch(e){return{}}}()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new nt(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",ge),!O(this.media)&&U(this.media))if(this.media.plyr)this.debug.warn("Target already setup");else if(this.config.enabled)if(ge.check().api){var s=this.media.cloneNode(!0);s.autoplay=!1,this.elements.original=s;var o=this.media.tagName.toLowerCase(),l=null,c=null;switch(o){case"div":if(l=this.media.querySelector("iframe"),U(l)){if(c=$e(l.getAttribute("src")),this.provider=function(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?Ze.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?Ze.vimeo:null}(c.toString()),this.elements.container=this.media,this.media=l,this.elements.container.className="",c.search.length){var u=["1","true"];u.includes(c.searchParams.get("autoplay"))&&(this.config.autoplay=!0),u.includes(c.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=u.includes(c.searchParams.get("playsinline")),this.config.youtube.hl=c.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if($(this.provider)||!Object.values(Ze).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=et;break;case"video":case"audio":this.type=o,this.provider=Ze.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=ge.check(this.type,this.provider,this.config.playsinline),this.supported.api?(this.eventListeners=[],this.listeners=new st(this),this.storage=new Be(this),this.media.plyr=this,U(this.elements.container)||(this.elements.container=ne("div",{tabindex:0}),ee(this.media,this.elements.container)),rt.migrateStyles.call(this),rt.addStyleHook.call(this),mt.setup.call(this),this.config.debug&&be.call(this,this.elements.container,this.config.events.join(" "),(function(e){a.debug.log("event: ".concat(e.type))})),this.fullscreen=new it(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&rt.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new ft(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",(function(){return Ce(a.play())})),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new wt(this))):this.debug.error("Setup failed: no support")}else this.debug.error("Setup failed: no support");else this.debug.error("Setup failed: disabled by config");else this.debug.error("Setup failed: no suitable element passed")}return o(t,[{key:"isHTML5",get:function(){return this.provider===Ze.html5}},{key:"isEmbed",get:function(){return this.isYouTube||this.isVimeo}},{key:"isYouTube",get:function(){return this.provider===Ze.youtube}},{key:"isVimeo",get:function(){return this.provider===Ze.vimeo}},{key:"isVideo",get:function(){return this.type===et}},{key:"isAudio",get:function(){return"audio"===this.type}},{key:"playing",get:function(){return Boolean(this.ready&&!this.paused&&!this.ended)}},{key:"paused",get:function(){return Boolean(this.media.paused)}},{key:"stopped",get:function(){return Boolean(this.paused&&0===this.currentTime)}},{key:"ended",get:function(){return Boolean(this.media.ended)}},{key:"currentTime",get:function(){return Number(this.media.currentTime)},set:function(e){if(this.duration){var t=D(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log("Seeking to ".concat(this.currentTime," seconds"))}}},{key:"buffered",get:function(){var e=this.media.buffered;return D(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}},{key:"seeking",get:function(){return Boolean(this.media.seeking)}},{key:"duration",get:function(){var e=parseFloat(this.config.duration),t=(this.media||{}).duration,n=D(t)&&t!==1/0?t:0;return e||n}},{key:"volume",get:function(){return Number(this.media.volume)},set:function(e){var t=e;H(t)&&(t=Number(t)),D(t)||(t=this.storage.get("volume")),D(t)||(t=this.config.volume),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!$(e)&&this.muted&&t>0&&(this.muted=!1)}},{key:"muted",get:function(){return Boolean(this.media.muted)},set:function(e){var t=e;R(t)||(t=this.storage.get("muted")),R(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}},{key:"hasAudio",get:function(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}},{key:"speed",get:function(){return Number(this.media.playbackRate)},set:function(e){var t=this,n=null;D(e)&&(n=e),D(n)||(n=this.storage.get("speed")),D(n)||(n=this.config.speed.selected);var i=this.minimumSpeed,a=this.maximumSpeed;n=gt(n,i,a),this.config.speed.selected=n,setTimeout((function(){t.media&&(t.media.playbackRate=n)}),0)}},{key:"minimumSpeed",get:function(){return this.isYouTube?Math.min.apply(Math,a(this.options.speed)):this.isVimeo?.5:.0625}},{key:"maximumSpeed",get:function(){return this.isYouTube?Math.max.apply(Math,a(this.options.speed)):this.isVimeo?2:16}},{key:"quality",get:function(){return this.media.quality},set:function(e){var t=this.config.quality,n=this.options.quality;if(n.length){var i=[!$(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(D),a=!0;if(!n.includes(i)){var r=Pe(n,i);this.debug.warn("Unsupported quality option: ".concat(i,", using ").concat(r," instead")),i=r,a=!1}t.selected=i,this.media.quality=i,a&&this.storage.set({quality:i})}}},{key:"loop",get:function(){return Boolean(this.media.loop)},set:function(e){var t=R(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}},{key:"source",get:function(){return this.media.currentSrc},set:function(e){kt.change.call(this,e)}},{key:"download",get:function(){var e=this.config.urls.download;return Y(e)?e:this.source},set:function(e){Y(e)&&(this.config.urls.download=e,Ye.setDownloadUrl.call(this))}},{key:"poster",get:function(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null},set:function(e){this.isVideo?rt.setPoster.call(this,e,!1).catch((function(){})):this.debug.warn("Poster can only be set for video")}},{key:"ratio",get:function(){if(!this.isVideo)return null;var e=Ne(je.call(this));return V(e)?e.join(":"):e},set:function(e){this.isVideo?H(e)&&Le(e)?(this.config.ratio=Ne(e),Ie.call(this)):this.debug.error("Invalid aspect ratio specified (".concat(e,")")):this.debug.warn("Aspect ratio can only be set for video")}},{key:"autoplay",get:function(){return Boolean(this.config.autoplay)},set:function(e){this.config.autoplay=R(e)?e:this.config.autoplay}},{key:"toggleCaptions",value:function(e){Xe.toggle.call(this,e,!1)}},{key:"currentTrack",get:function(){var e=this.captions,t=e.toggled,n=e.currentTrack;return t?n:-1},set:function(e){Xe.set.call(this,e,!1),Xe.setup.call(this)}},{key:"language",get:function(){return(Xe.getCurrentTrack.call(this)||{}).language},set:function(e){Xe.setLanguage.call(this,e,!1)}},{key:"pip",get:function(){return ge.pip?$(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===Ge:null},set:function(e){if(ge.pip){var t=R(e)?e:!this.pip;F(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?Ge:"inline"),F(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}}},{key:"setPreviewThumbnails",value:function(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new wt(this))}}],[{key:"supported",value:function(e,t,n){return ge.check(e,t,n)}},{key:"loadSprite",value:function(e,t){return We(e,t)}},{key:"setup",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null;return H(e)?i=Array.from(document.querySelectorAll(e)):B(e)?i=Array.from(e):V(e)&&(i=e.filter(U)),$(i)?null:i.map((function(e){return new t(e,n)}))}}]),t}();return Tt.defaults=(yt=Je,JSON.parse(JSON.stringify(yt))),Tt}())},"./src/assets/js/MySwiper.js":function(e,t,n){"use strict";n.r(t),n.d(t,{Swipers:function(){return i}});var i=function(){document.addEventListener("DOMContentLoaded",(function(){var e=new Swiper(".slider-js-2",{slidesPerView:4,direction:"vertical",freeMode:!0,watchSlidesProgress:!0});new Swiper(".slider-js-1",{spaceBetween:10,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},thumbs:{swiper:e},effect:"fade",fadeEffect:{crossFade:!0}}),new Swiper(".slider-full-js",{slidesPerView:4,loop:"true",speed:300,spaceBetween:14,grabCursor:!0,pagination:{el:".swiper-pagination-rew",clickable:!0},navigation:{prevEl:".js-rew-prev",nextEl:".js-rew-next"},breakpoints:{900:{spaceBetween:22}}})}))}},"./src/assets/js/animation.js":function(e,t,n){"use strict";n.r(t),n.d(t,{Anim:function(){return i}});var i=function(){document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll("._anim-top"),t=document.querySelectorAll("._anim-left"),n=document.querySelectorAll("._anim-right"),i=Array.prototype.slice.call(e),a=Array.prototype.slice.call(t),r=Array.prototype.slice.call(n);i.length>0&&i.forEach((function(e){var t=e.getBoundingClientRect();window.addEventListener("scroll",(function(){t.top<document.body.offsetHeight-200&&e.classList.add("_is-active")}))})),a.length>0&&a.forEach((function(e){var t=e.getBoundingClientRect();window.addEventListener("scroll",(function(){t.top<document.body.offsetHeight-200&&e.classList.add("_is-active")}))})),r.length>0&&r.forEach((function(e){var t=e.getBoundingClientRect();window.addEventListener("scroll",(function(){t.top<document.body.offsetHeight-200&&e.classList.add("_is-active")}))}))}))}},"./src/assets/js/button.js":function(e,t,n){"use strict";n.r(t),n.d(t,{Button:function(){return i}});var i=function(e){var t=e.target.closest(".but-wave");e.preventDefault();var n=Math.max(t.clientWidth,t.clientHeight),i=document.createElement("div"),a=t.getBoundingClientRect();i.classList.add("addDiv"),i.style.width=i.style.height=n+"px",i.style.left=e.clientX-a.left-n/2+"px",i.style.top=e.clientY-a.top-n/2+"px",t.closest(".but-wave").append(i),setTimeout((function(){i.remove()}),300)}},"./src/assets/js/constants.js":function(e,t,n){"use strict";n.r(t),n.d(t,{body:function(){return r},header:function(){return l},player1:function(){return u},playerRev1:function(){return d},playerRev2:function(){return h},playerRev3:function(){return p},playerRev4:function(){return m},popupsInit:function(){return o},toysPlyr:function(){return c},waves:function(){return s}});var i=n("./node_modules/plyr/dist/plyr.min.js"),a=n.n(i),r=document.querySelector("body"),s=document.querySelectorAll(".but-wave"),o=document.querySelectorAll(".popups-init-js"),l=document.querySelector("header"),c=document.querySelector(".toys__plyr"),u=new(a())(".player-1"),d=new(a())(".player-rew-1"),h=new(a())(".player-rew-2"),p=new(a())(".player-rew-3"),m=new(a())(".player-rew-4")},"./src/assets/js/galSwiper.js":function(e,t,n){"use strict";function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.r(t),n.d(t,{Gal:function(){return r}});var r=function(e){var t,n=new Swiper(".s2swiper",{speed:300,centeredSlides:!0,spaceBetween:11,effect:"coverflow",coverflowEffect:{rotate:0,stretch:0,depth:0},navigation:{prevEl:".s2-prev",nextEl:".s2-next"},loop:!0,slidesPerView:"auto",slideToClickedSlide:"true"});n&&n.on("slideChangeTransitionStart",(function(){for(var e=i(document.querySelectorAll(".s2  .swiper-slide")),n=i(document.querySelectorAll(".s1  .slide")),a=0;a<n.length;++a)n[a].classList.contains("_is-start")&&n[a].classList.remove("_is-start"),n[a].classList.contains("_is-active")&&(n[a].classList.remove("_is-active"),n[a].classList.add("_not-active"));setTimeout((function(){for(var i=0;i<e.length;++i)e[i].classList.contains("swiper-slide-active")&&(t=e[i].getAttribute("data-id"),n[t].classList.remove("_not-active"),n[t].classList.add("_is-active"))}),10)}))}},"./src/assets/js/header.js":function(e,t,n){"use strict";n.r(t),n.d(t,{Headers:function(){return i}});var i=function(){window.addEventListener("scroll",(function(e){window.pageYOffset>100?document.querySelector(".dop_header").classList.add("responciveHeader"):document.querySelector(".dop_header").classList.remove("responciveHeader")})),window.onresize=function(){window.innerWidth>=999&&(menu.querySelector(".header__info")&&menu.querySelector(".header__info").remove(),menu.classList.remove("menu-active"),document.querySelector(".info").classList.remove("info-active"),document.querySelector("body").classList.remove("lock"))}}},"./src/assets/js/popup.js":function(e,t,n){"use strict";n.r(t),n.d(t,{Popups:function(){return o}});var i=n("./node_modules/plyr/dist/plyr.min.js"),a=n.n(i),r=n("./src/assets/js/constants.js");function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var o=function(){var e,t=document.querySelector(".popup-js"),n=t.querySelectorAll(".popup__content"),i=[],o=function(e){if(Array.isArray(e))return s(e)}(e=document.querySelectorAll(".slider-video"))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();o.forEach((function(e){var t=e.getAttribute("id");if(t){var n="#".concat(t),r=new(a())(n);i.push({id:t,e:r})}})),document.addEventListener("click",(function(e){var a=e.target;a.closest(".popups-init-js")?function(){var e=t.querySelector(a.closest(".popups-init-js").getAttribute("rel"));setTimeout((function(){t.style.display="block",t.classList.remove("_not-active"),t.classList.add("_is-active"),n.forEach((function(t){t==e?e.style.display="grid":t.style.display="none"}))}),200);for(var s=e.querySelector("video").getAttribute("id"),l=0;l<o.length;++l)i[l].id===s&&i[l].e.play();r.body.style.cssText="overflow: hidden"}():(a.matches(".popup-overlay-js")||a.closest(".popup-close-js"))&&function(){t.classList.remove("_is-active"),t.classList.add("_not-active"),setTimeout((function(){t.style.display="none",n.forEach((function(e){e.style.display="none"}))}),300),r.body.style.cssText="overflow: visible";for(var e=0;e<i.length;++e)i[e].e.stop()}()}))}},"./src/assets/scss/app.scss":function(e,t,n){"use strict";n.r(t)}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};!function(){"use strict";n.r(i);var e=n("./src/assets/js/animation.js"),t=n("./src/assets/js/button.js"),a=n("./src/assets/js/header.js"),r=n("./src/assets/js/MySwiper.js"),s=n("./src/assets/js/popup.js"),o=n("./src/assets/js/galSwiper.js"),l=n("./src/assets/js/constants.js");n("./src/assets/scss/app.scss"),(0,e.Anim)(),(0,r.Swipers)(),(0,o.Gal)(),document.addEventListener("DOMContentLoaded",(function(){l.popupsInit.length>0&&(0,s.Popups)(),l.header&&(0,a.Headers)(),l.waves.forEach((function(e){e.addEventListener("click",t.Button)})),function(){var e=document.querySelector(".toys .plyr__controls");if(l.player1){var t=document.querySelector(".toys__video .plyr"),n=document.querySelector(".toys__video .toys__sheap");n.innerHTML="0:00",t.addEventListener("click",(function(t){e.classList.add("_is-active");var i=l.player1.currentTime.toFixed(2);i=i.replace(".",":"),n.innerHTML=i}))}}()}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjBzQyxFQUFHdmdDLFVBQVUrRyxJQUFJLGNBQ2xCLElBQUkyNUIsRUFBSzNDLEVBQUFBLFFBQUFBLFlBQUFBLFFBQTRCLEdBQ3BDMkMsRUFBS0EsRUFBR3BoQyxRQUFRLElBQUssS0FDcEJtaEMsRUFBTXYzQixVQUFZdzNCLENBQ3JCLEdBQ0YsQ0FDRixDQUVEQyxFQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzL3BseXIuanMiLCJ3ZWJwYWNrOi8vcmVzL25vZGVfbW9kdWxlcy9yYW5nZXRvdWNoL2Rpc3QvcmFuZ2V0b3VjaC5tanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9pcy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL2FuaW1hdGlvbi5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9vYmplY3RzLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvZWxlbWVudHMuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9zdXBwb3J0LmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvZXZlbnRzLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvcHJvbWlzZS5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL2FycmF5cy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL3N0eWxlLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvaHRtbDUuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9zdHJpbmdzLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvaTE4bi5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3N0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9mZXRjaC5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL2xvYWQtc3ByaXRlLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvdGltZS5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL2NvbnRyb2xzLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvdXJscy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL2NhcHRpb25zLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvY29uZmlnL2RlZmF1bHRzLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvY29uZmlnL3N0YXRlcy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL2NvbmZpZy90eXBlcy5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL2NvbnNvbGUuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9mdWxsc2NyZWVuLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvdXRpbHMvbG9hZC1pbWFnZS5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3VpLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvbGlzdGVuZXJzLmpzIiwid2VicGFjazovL3Jlcy9ub2RlX21vZHVsZXMvbG9hZGpzL2Rpc3QvbG9hZGpzLnVtZC5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3V0aWxzL2xvYWQtc2NyaXB0LmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvcGx1Z2lucy92aW1lby5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL3BsdWdpbnMveW91dHViZS5qcyIsIndlYnBhY2s6Ly9yZXMvc3JjL2pzL21lZGlhLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvcGx1Z2lucy9hZHMuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy91dGlscy9udW1iZXJzLmpzIiwid2VicGFjazovL3Jlcy9zcmMvanMvcGx1Z2lucy9wcmV2aWV3LXRodW1ibmFpbHMuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9zb3VyY2UuanMiLCJ3ZWJwYWNrOi8vcmVzL3NyYy9qcy9wbHlyLmpzIiwid2VicGFjazovL3Jlcy8uL3NyYy9hc3NldHMvanMvTXlTd2lwZXIuanMiLCJ3ZWJwYWNrOi8vcmVzLy4vc3JjL2Fzc2V0cy9qcy9hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vcmVzLy4vc3JjL2Fzc2V0cy9qcy9idXR0b24uanMiLCJ3ZWJwYWNrOi8vcmVzLy4vc3JjL2Fzc2V0cy9qcy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcmVzLy4vc3JjL2Fzc2V0cy9qcy9nYWxTd2lwZXIuanMiLCJ3ZWJwYWNrOi8vcmVzLy4vc3JjL2Fzc2V0cy9qcy9oZWFkZXIuanMiLCJ3ZWJwYWNrOi8vcmVzLy4vc3JjL2Fzc2V0cy9qcy9wb3B1cC5qcyIsIndlYnBhY2s6Ly9yZXMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcmVzL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL3Jlcy93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vcmVzL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vcmVzL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vcmVzL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vcmVzLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbInR5cGVvZiBuYXZpZ2F0b3IgPT09IFwib2JqZWN0XCIgJiYgKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOlxuICB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoJ1BseXInLCBmYWN0b3J5KSA6XG4gIChnbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWxUaGlzIDogZ2xvYmFsIHx8IHNlbGYsIGdsb2JhbC5QbHlyID0gZmFjdG9yeSgpKTtcbn0pKHRoaXMsIChmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuICBmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkkMShvYmosIGtleSwgdmFsdWUpIHtcbiAgICBpZiAoa2V5IGluIG9iaikge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9ialtrZXldID0gdmFsdWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iajtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhlLCB0KSB7XG4gICAgaWYgKCEoZSBpbnN0YW5jZW9mIHQpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICB9XG5cbiAgZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXMoZSwgdCkge1xuICAgIGZvciAodmFyIG4gPSAwOyBuIDwgdC5sZW5ndGg7IG4rKykge1xuICAgICAgdmFyIHIgPSB0W25dO1xuICAgICAgci5lbnVtZXJhYmxlID0gci5lbnVtZXJhYmxlIHx8ICExLCByLmNvbmZpZ3VyYWJsZSA9ICEwLCBcInZhbHVlXCIgaW4gciAmJiAoci53cml0YWJsZSA9ICEwKSwgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIua2V5LCByKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoZSwgdCwgbikge1xuICAgIHJldHVybiB0ICYmIF9kZWZpbmVQcm9wZXJ0aWVzKGUucHJvdG90eXBlLCB0KSwgbiAmJiBfZGVmaW5lUHJvcGVydGllcyhlLCBuKSwgZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShlLCB0LCBuKSB7XG4gICAgcmV0dXJuIHQgaW4gZSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCB0LCB7XG4gICAgICB2YWx1ZTogbixcbiAgICAgIGVudW1lcmFibGU6ICEwLFxuICAgICAgY29uZmlndXJhYmxlOiAhMCxcbiAgICAgIHdyaXRhYmxlOiAhMFxuICAgIH0pIDogZVt0XSA9IG4sIGU7XG4gIH1cblxuICBmdW5jdGlvbiBvd25LZXlzKGUsIHQpIHtcbiAgICB2YXIgbiA9IE9iamVjdC5rZXlzKGUpO1xuXG4gICAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHtcbiAgICAgIHZhciByID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtcbiAgICAgIHQgJiYgKHIgPSByLmZpbHRlcihmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCB0KS5lbnVtZXJhYmxlO1xuICAgICAgfSkpLCBuLnB1c2guYXBwbHkobiwgcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIG47XG4gIH1cblxuICBmdW5jdGlvbiBfb2JqZWN0U3ByZWFkMihlKSB7XG4gICAgZm9yICh2YXIgdCA9IDE7IHQgPCBhcmd1bWVudHMubGVuZ3RoOyB0KyspIHtcbiAgICAgIHZhciBuID0gbnVsbCAhPSBhcmd1bWVudHNbdF0gPyBhcmd1bWVudHNbdF0gOiB7fTtcbiAgICAgIHQgJSAyID8gb3duS2V5cyhPYmplY3QobiksICEwKS5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIF9kZWZpbmVQcm9wZXJ0eShlLCB0LCBuW3RdKTtcbiAgICAgIH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSkgOiBvd25LZXlzKE9iamVjdChuKSkuZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgdCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLCB0KSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gZTtcbiAgfVxuXG4gIHZhciBkZWZhdWx0cyQxID0ge1xuICAgIGFkZENTUzogITAsXG4gICAgdGh1bWJXaWR0aDogMTUsXG4gICAgd2F0Y2g6ICEwXG4gIH07XG5cbiAgZnVuY3Rpb24gbWF0Y2hlcyQxKGUsIHQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0KSkuaW5jbHVkZXModGhpcyk7XG4gICAgfS5jYWxsKGUsIHQpO1xuICB9XG5cbiAgZnVuY3Rpb24gdHJpZ2dlcihlLCB0KSB7XG4gICAgaWYgKGUgJiYgdCkge1xuICAgICAgdmFyIG4gPSBuZXcgRXZlbnQodCwge1xuICAgICAgICBidWJibGVzOiAhMFxuICAgICAgfSk7XG4gICAgICBlLmRpc3BhdGNoRXZlbnQobik7XG4gICAgfVxuICB9XG5cbiAgdmFyIGdldENvbnN0cnVjdG9yJDEgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBudWxsICE9IGUgPyBlLmNvbnN0cnVjdG9yIDogbnVsbDtcbiAgfSxcbiAgICAgIGluc3RhbmNlT2YkMSA9IGZ1bmN0aW9uIChlLCB0KSB7XG4gICAgcmV0dXJuICEhKGUgJiYgdCAmJiBlIGluc3RhbmNlb2YgdCk7XG4gIH0sXG4gICAgICBpc051bGxPclVuZGVmaW5lZCQxID0gZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gbnVsbCA9PSBlO1xuICB9LFxuICAgICAgaXNPYmplY3QkMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGdldENvbnN0cnVjdG9yJDEoZSkgPT09IE9iamVjdDtcbiAgfSxcbiAgICAgIGlzTnVtYmVyJDEgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBnZXRDb25zdHJ1Y3RvciQxKGUpID09PSBOdW1iZXIgJiYgIU51bWJlci5pc05hTihlKTtcbiAgfSxcbiAgICAgIGlzU3RyaW5nJDEgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBnZXRDb25zdHJ1Y3RvciQxKGUpID09PSBTdHJpbmc7XG4gIH0sXG4gICAgICBpc0Jvb2xlYW4kMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGdldENvbnN0cnVjdG9yJDEoZSkgPT09IEJvb2xlYW47XG4gIH0sXG4gICAgICBpc0Z1bmN0aW9uJDEgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBnZXRDb25zdHJ1Y3RvciQxKGUpID09PSBGdW5jdGlvbjtcbiAgfSxcbiAgICAgIGlzQXJyYXkkMSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoZSk7XG4gIH0sXG4gICAgICBpc05vZGVMaXN0JDEgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBpbnN0YW5jZU9mJDEoZSwgTm9kZUxpc3QpO1xuICB9LFxuICAgICAgaXNFbGVtZW50JDEgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBpbnN0YW5jZU9mJDEoZSwgRWxlbWVudCk7XG4gIH0sXG4gICAgICBpc0V2ZW50JDEgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBpbnN0YW5jZU9mJDEoZSwgRXZlbnQpO1xuICB9LFxuICAgICAgaXNFbXB0eSQxID0gZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gaXNOdWxsT3JVbmRlZmluZWQkMShlKSB8fCAoaXNTdHJpbmckMShlKSB8fCBpc0FycmF5JDEoZSkgfHwgaXNOb2RlTGlzdCQxKGUpKSAmJiAhZS5sZW5ndGggfHwgaXNPYmplY3QkMShlKSAmJiAhT2JqZWN0LmtleXMoZSkubGVuZ3RoO1xuICB9LFxuICAgICAgaXMkMSA9IHtcbiAgICBudWxsT3JVbmRlZmluZWQ6IGlzTnVsbE9yVW5kZWZpbmVkJDEsXG4gICAgb2JqZWN0OiBpc09iamVjdCQxLFxuICAgIG51bWJlcjogaXNOdW1iZXIkMSxcbiAgICBzdHJpbmc6IGlzU3RyaW5nJDEsXG4gICAgYm9vbGVhbjogaXNCb29sZWFuJDEsXG4gICAgZnVuY3Rpb246IGlzRnVuY3Rpb24kMSxcbiAgICBhcnJheTogaXNBcnJheSQxLFxuICAgIG5vZGVMaXN0OiBpc05vZGVMaXN0JDEsXG4gICAgZWxlbWVudDogaXNFbGVtZW50JDEsXG4gICAgZXZlbnQ6IGlzRXZlbnQkMSxcbiAgICBlbXB0eTogaXNFbXB0eSQxXG4gIH07XG5cbiAgZnVuY3Rpb24gZ2V0RGVjaW1hbFBsYWNlcyhlKSB7XG4gICAgdmFyIHQgPSBcIlwiLmNvbmNhdChlKS5tYXRjaCgvKD86XFwuKFxcZCspKT8oPzpbZUVdKFsrLV0/XFxkKykpPyQvKTtcbiAgICByZXR1cm4gdCA/IE1hdGgubWF4KDAsICh0WzFdID8gdFsxXS5sZW5ndGggOiAwKSAtICh0WzJdID8gK3RbMl0gOiAwKSkgOiAwO1xuICB9XG5cbiAgZnVuY3Rpb24gcm91bmQoZSwgdCkge1xuICAgIGlmICgxID4gdCkge1xuICAgICAgdmFyIG4gPSBnZXREZWNpbWFsUGxhY2VzKHQpO1xuICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoZS50b0ZpeGVkKG4pKTtcbiAgICB9XG5cbiAgICByZXR1cm4gTWF0aC5yb3VuZChlIC8gdCkgKiB0O1xuICB9XG5cbiAgdmFyIFJhbmdlVG91Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gZSh0LCBuKSB7XG4gICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgZSksIGlzJDEuZWxlbWVudCh0KSA/IHRoaXMuZWxlbWVudCA9IHQgOiBpcyQxLnN0cmluZyh0KSAmJiAodGhpcy5lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0KSksIGlzJDEuZWxlbWVudCh0aGlzLmVsZW1lbnQpICYmIGlzJDEuZW1wdHkodGhpcy5lbGVtZW50LnJhbmdlVG91Y2gpICYmICh0aGlzLmNvbmZpZyA9IF9vYmplY3RTcHJlYWQyKHt9LCBkZWZhdWx0cyQxLCB7fSwgbiksIHRoaXMuaW5pdCgpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gX2NyZWF0ZUNsYXNzKGUsIFt7XG4gICAgICBrZXk6IFwiaW5pdFwiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZS5lbmFibGVkICYmICh0aGlzLmNvbmZpZy5hZGRDU1MgJiYgKHRoaXMuZWxlbWVudC5zdHlsZS51c2VyU2VsZWN0ID0gXCJub25lXCIsIHRoaXMuZWxlbWVudC5zdHlsZS53ZWJLaXRVc2VyU2VsZWN0ID0gXCJub25lXCIsIHRoaXMuZWxlbWVudC5zdHlsZS50b3VjaEFjdGlvbiA9IFwibWFuaXB1bGF0aW9uXCIpLCB0aGlzLmxpc3RlbmVycyghMCksIHRoaXMuZWxlbWVudC5yYW5nZVRvdWNoID0gdGhpcyk7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImRlc3Ryb3lcIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGUuZW5hYmxlZCAmJiAodGhpcy5jb25maWcuYWRkQ1NTICYmICh0aGlzLmVsZW1lbnQuc3R5bGUudXNlclNlbGVjdCA9IFwiXCIsIHRoaXMuZWxlbWVudC5zdHlsZS53ZWJLaXRVc2VyU2VsZWN0ID0gXCJcIiwgdGhpcy5lbGVtZW50LnN0eWxlLnRvdWNoQWN0aW9uID0gXCJcIiksIHRoaXMubGlzdGVuZXJzKCExKSwgdGhpcy5lbGVtZW50LnJhbmdlVG91Y2ggPSBudWxsKTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwibGlzdGVuZXJzXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHQgPSB0aGlzLFxuICAgICAgICAgICAgbiA9IGUgPyBcImFkZEV2ZW50TGlzdGVuZXJcIiA6IFwicmVtb3ZlRXZlbnRMaXN0ZW5lclwiO1xuICAgICAgICBbXCJ0b3VjaHN0YXJ0XCIsIFwidG91Y2htb3ZlXCIsIFwidG91Y2hlbmRcIl0uZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIHQuZWxlbWVudFtuXShlLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIHQuc2V0KGUpO1xuICAgICAgICAgIH0sICExKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImdldFwiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGlmICghZS5lbmFibGVkIHx8ICFpcyQxLmV2ZW50KHQpKSByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIG4sXG4gICAgICAgICAgICByID0gdC50YXJnZXQsXG4gICAgICAgICAgICBpID0gdC5jaGFuZ2VkVG91Y2hlc1swXSxcbiAgICAgICAgICAgIG8gPSBwYXJzZUZsb2F0KHIuZ2V0QXR0cmlidXRlKFwibWluXCIpKSB8fCAwLFxuICAgICAgICAgICAgcyA9IHBhcnNlRmxvYXQoci5nZXRBdHRyaWJ1dGUoXCJtYXhcIikpIHx8IDEwMCxcbiAgICAgICAgICAgIHUgPSBwYXJzZUZsb2F0KHIuZ2V0QXR0cmlidXRlKFwic3RlcFwiKSkgfHwgMSxcbiAgICAgICAgICAgIGMgPSByLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuICAgICAgICAgICAgYSA9IDEwMCAvIGMud2lkdGggKiAodGhpcy5jb25maWcudGh1bWJXaWR0aCAvIDIpIC8gMTAwO1xuICAgICAgICByZXR1cm4gMCA+IChuID0gMTAwIC8gYy53aWR0aCAqIChpLmNsaWVudFggLSBjLmxlZnQpKSA/IG4gPSAwIDogMTAwIDwgbiAmJiAobiA9IDEwMCksIDUwID4gbiA/IG4gLT0gKDEwMCAtIDIgKiBuKSAqIGEgOiA1MCA8IG4gJiYgKG4gKz0gMiAqIChuIC0gNTApICogYSksIG8gKyByb3VuZChuIC8gMTAwICogKHMgLSBvKSwgdSk7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcInNldFwiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIGUuZW5hYmxlZCAmJiBpcyQxLmV2ZW50KHQpICYmICF0LnRhcmdldC5kaXNhYmxlZCAmJiAodC5wcmV2ZW50RGVmYXVsdCgpLCB0LnRhcmdldC52YWx1ZSA9IHRoaXMuZ2V0KHQpLCB0cmlnZ2VyKHQudGFyZ2V0LCBcInRvdWNoZW5kXCIgPT09IHQudHlwZSA/IFwiY2hhbmdlXCIgOiBcImlucHV0XCIpKTtcbiAgICAgIH1cbiAgICB9XSwgW3tcbiAgICAgIGtleTogXCJzZXR1cFwiLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9uICh0KSB7XG4gICAgICAgIHZhciBuID0gMSA8IGFyZ3VtZW50cy5sZW5ndGggJiYgdm9pZCAwICE9PSBhcmd1bWVudHNbMV0gPyBhcmd1bWVudHNbMV0gOiB7fSxcbiAgICAgICAgICAgIHIgPSBudWxsO1xuICAgICAgICBpZiAoaXMkMS5lbXB0eSh0KSB8fCBpcyQxLnN0cmluZyh0KSA/IHIgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoaXMkMS5zdHJpbmcodCkgPyB0IDogJ2lucHV0W3R5cGU9XCJyYW5nZVwiXScpKSA6IGlzJDEuZWxlbWVudCh0KSA/IHIgPSBbdF0gOiBpcyQxLm5vZGVMaXN0KHQpID8gciA9IEFycmF5LmZyb20odCkgOiBpcyQxLmFycmF5KHQpICYmIChyID0gdC5maWx0ZXIoaXMkMS5lbGVtZW50KSksIGlzJDEuZW1wdHkocikpIHJldHVybiBudWxsO1xuXG4gICAgICAgIHZhciBpID0gX29iamVjdFNwcmVhZDIoe30sIGRlZmF1bHRzJDEsIHt9LCBuKTtcblxuICAgICAgICBpZiAoaXMkMS5zdHJpbmcodCkgJiYgaS53YXRjaCkge1xuICAgICAgICAgIHZhciBvID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgIEFycmF5LmZyb20obikuZm9yRWFjaChmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICBBcnJheS5mcm9tKG4uYWRkZWROb2RlcykuZm9yRWFjaChmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgICAgIGlzJDEuZWxlbWVudChuKSAmJiBtYXRjaGVzJDEobiwgdCkgJiYgbmV3IGUobiwgaSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgby5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcbiAgICAgICAgICAgIGNoaWxkTGlzdDogITAsXG4gICAgICAgICAgICBzdWJ0cmVlOiAhMFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHIubWFwKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBlKHQsIG4pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LCB7XG4gICAgICBrZXk6IFwiZW5hYmxlZFwiLFxuICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcIm9udG91Y2hzdGFydFwiIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgICAgIH1cbiAgICB9XSksIGU7XG4gIH0oKTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBUeXBlIGNoZWNraW5nIHV0aWxzXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGdldENvbnN0cnVjdG9yID0gaW5wdXQgPT4gaW5wdXQgIT09IG51bGwgJiYgdHlwZW9mIGlucHV0ICE9PSAndW5kZWZpbmVkJyA/IGlucHV0LmNvbnN0cnVjdG9yIDogbnVsbDtcblxuICBjb25zdCBpbnN0YW5jZU9mID0gKGlucHV0LCBjb25zdHJ1Y3RvcikgPT4gQm9vbGVhbihpbnB1dCAmJiBjb25zdHJ1Y3RvciAmJiBpbnB1dCBpbnN0YW5jZW9mIGNvbnN0cnVjdG9yKTtcblxuICBjb25zdCBpc051bGxPclVuZGVmaW5lZCA9IGlucHV0ID0+IGlucHV0ID09PSBudWxsIHx8IHR5cGVvZiBpbnB1dCA9PT0gJ3VuZGVmaW5lZCc7XG5cbiAgY29uc3QgaXNPYmplY3QgPSBpbnB1dCA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IE9iamVjdDtcblxuICBjb25zdCBpc051bWJlciA9IGlucHV0ID0+IGdldENvbnN0cnVjdG9yKGlucHV0KSA9PT0gTnVtYmVyICYmICFOdW1iZXIuaXNOYU4oaW5wdXQpO1xuXG4gIGNvbnN0IGlzU3RyaW5nID0gaW5wdXQgPT4gZ2V0Q29uc3RydWN0b3IoaW5wdXQpID09PSBTdHJpbmc7XG5cbiAgY29uc3QgaXNCb29sZWFuID0gaW5wdXQgPT4gZ2V0Q29uc3RydWN0b3IoaW5wdXQpID09PSBCb29sZWFuO1xuXG4gIGNvbnN0IGlzRnVuY3Rpb24gPSBpbnB1dCA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IEZ1bmN0aW9uO1xuXG4gIGNvbnN0IGlzQXJyYXkgPSBpbnB1dCA9PiBBcnJheS5pc0FycmF5KGlucHV0KTtcblxuICBjb25zdCBpc1dlYWtNYXAgPSBpbnB1dCA9PiBpbnN0YW5jZU9mKGlucHV0LCBXZWFrTWFwKTtcblxuICBjb25zdCBpc05vZGVMaXN0ID0gaW5wdXQgPT4gaW5zdGFuY2VPZihpbnB1dCwgTm9kZUxpc3QpO1xuXG4gIGNvbnN0IGlzVGV4dE5vZGUgPSBpbnB1dCA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IFRleHQ7XG5cbiAgY29uc3QgaXNFdmVudCA9IGlucHV0ID0+IGluc3RhbmNlT2YoaW5wdXQsIEV2ZW50KTtcblxuICBjb25zdCBpc0tleWJvYXJkRXZlbnQgPSBpbnB1dCA9PiBpbnN0YW5jZU9mKGlucHV0LCBLZXlib2FyZEV2ZW50KTtcblxuICBjb25zdCBpc0N1ZSA9IGlucHV0ID0+IGluc3RhbmNlT2YoaW5wdXQsIHdpbmRvdy5UZXh0VHJhY2tDdWUpIHx8IGluc3RhbmNlT2YoaW5wdXQsIHdpbmRvdy5WVFRDdWUpO1xuXG4gIGNvbnN0IGlzVHJhY2sgPSBpbnB1dCA9PiBpbnN0YW5jZU9mKGlucHV0LCBUZXh0VHJhY2spIHx8ICFpc051bGxPclVuZGVmaW5lZChpbnB1dCkgJiYgaXNTdHJpbmcoaW5wdXQua2luZCk7XG5cbiAgY29uc3QgaXNQcm9taXNlID0gaW5wdXQgPT4gaW5zdGFuY2VPZihpbnB1dCwgUHJvbWlzZSkgJiYgaXNGdW5jdGlvbihpbnB1dC50aGVuKTtcblxuICBjb25zdCBpc0VsZW1lbnQgPSBpbnB1dCA9PiBpbnB1dCAhPT0gbnVsbCAmJiB0eXBlb2YgaW5wdXQgPT09ICdvYmplY3QnICYmIGlucHV0Lm5vZGVUeXBlID09PSAxICYmIHR5cGVvZiBpbnB1dC5zdHlsZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIGlucHV0Lm93bmVyRG9jdW1lbnQgPT09ICdvYmplY3QnO1xuXG4gIGNvbnN0IGlzRW1wdHkgPSBpbnB1dCA9PiBpc051bGxPclVuZGVmaW5lZChpbnB1dCkgfHwgKGlzU3RyaW5nKGlucHV0KSB8fCBpc0FycmF5KGlucHV0KSB8fCBpc05vZGVMaXN0KGlucHV0KSkgJiYgIWlucHV0Lmxlbmd0aCB8fCBpc09iamVjdChpbnB1dCkgJiYgIU9iamVjdC5rZXlzKGlucHV0KS5sZW5ndGg7XG5cbiAgY29uc3QgaXNVcmwgPSBpbnB1dCA9PiB7XG4gICAgLy8gQWNjZXB0IGEgVVJMIG9iamVjdFxuICAgIGlmIChpbnN0YW5jZU9mKGlucHV0LCB3aW5kb3cuVVJMKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSAvLyBNdXN0IGJlIHN0cmluZyBmcm9tIGhlcmVcblxuXG4gICAgaWYgKCFpc1N0cmluZyhpbnB1dCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IC8vIEFkZCB0aGUgcHJvdG9jb2wgaWYgcmVxdWlyZWRcblxuXG4gICAgbGV0IHN0cmluZyA9IGlucHV0O1xuXG4gICAgaWYgKCFpbnB1dC5zdGFydHNXaXRoKCdodHRwOi8vJykgfHwgIWlucHV0LnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJykpIHtcbiAgICAgIHN0cmluZyA9IGBodHRwOi8vJHtpbnB1dH1gO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gIWlzRW1wdHkobmV3IFVSTChzdHJpbmcpLmhvc3RuYW1lKTtcbiAgICB9IGNhdGNoIChfKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIHZhciBpcyA9IHtcbiAgICBudWxsT3JVbmRlZmluZWQ6IGlzTnVsbE9yVW5kZWZpbmVkLFxuICAgIG9iamVjdDogaXNPYmplY3QsXG4gICAgbnVtYmVyOiBpc051bWJlcixcbiAgICBzdHJpbmc6IGlzU3RyaW5nLFxuICAgIGJvb2xlYW46IGlzQm9vbGVhbixcbiAgICBmdW5jdGlvbjogaXNGdW5jdGlvbixcbiAgICBhcnJheTogaXNBcnJheSxcbiAgICB3ZWFrTWFwOiBpc1dlYWtNYXAsXG4gICAgbm9kZUxpc3Q6IGlzTm9kZUxpc3QsXG4gICAgZWxlbWVudDogaXNFbGVtZW50LFxuICAgIHRleHROb2RlOiBpc1RleHROb2RlLFxuICAgIGV2ZW50OiBpc0V2ZW50LFxuICAgIGtleWJvYXJkRXZlbnQ6IGlzS2V5Ym9hcmRFdmVudCxcbiAgICBjdWU6IGlzQ3VlLFxuICAgIHRyYWNrOiBpc1RyYWNrLFxuICAgIHByb21pc2U6IGlzUHJvbWlzZSxcbiAgICB1cmw6IGlzVXJsLFxuICAgIGVtcHR5OiBpc0VtcHR5XG4gIH07XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgdHJhbnNpdGlvbkVuZEV2ZW50ID0gKCgpID0+IHtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIGNvbnN0IGV2ZW50cyA9IHtcbiAgICAgIFdlYmtpdFRyYW5zaXRpb246ICd3ZWJraXRUcmFuc2l0aW9uRW5kJyxcbiAgICAgIE1velRyYW5zaXRpb246ICd0cmFuc2l0aW9uZW5kJyxcbiAgICAgIE9UcmFuc2l0aW9uOiAnb1RyYW5zaXRpb25FbmQgb3RyYW5zaXRpb25lbmQnLFxuICAgICAgdHJhbnNpdGlvbjogJ3RyYW5zaXRpb25lbmQnXG4gICAgfTtcbiAgICBjb25zdCB0eXBlID0gT2JqZWN0LmtleXMoZXZlbnRzKS5maW5kKGV2ZW50ID0+IGVsZW1lbnQuc3R5bGVbZXZlbnRdICE9PSB1bmRlZmluZWQpO1xuICAgIHJldHVybiBpcy5zdHJpbmcodHlwZSkgPyBldmVudHNbdHlwZV0gOiBmYWxzZTtcbiAgfSkoKTsgLy8gRm9yY2UgcmVwYWludCBvZiBlbGVtZW50XG5cbiAgZnVuY3Rpb24gcmVwYWludChlbGVtZW50LCBkZWxheSkge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICAgIGVsZW1lbnQuaGlkZGVuID0gdHJ1ZTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC1leHByZXNzaW9uc1xuXG4gICAgICAgIGVsZW1lbnQub2Zmc2V0SGVpZ2h0OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cblxuICAgICAgICBlbGVtZW50LmhpZGRlbiA9IGZhbHNlO1xuICAgICAgfSBjYXRjaCAoXykgey8vIERvIG5vdGhpbmdcbiAgICAgIH1cbiAgICB9LCBkZWxheSk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBCcm93c2VyIHNuaWZmaW5nXG4gIC8vIFVuZm9ydHVuYXRlbHksIGR1ZSB0byBtaXhlZCBzdXBwb3J0LCBVQSBzbmlmZmluZyBpcyByZXF1aXJlZFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBicm93c2VyID0ge1xuICAgIGlzSUU6IEJvb2xlYW4od2luZG93LmRvY3VtZW50LmRvY3VtZW50TW9kZSksXG4gICAgaXNFZGdlOiB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmNsdWRlcygnRWRnZScpLFxuICAgIGlzV2Via2l0OiAnV2Via2l0QXBwZWFyYW5jZScgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlICYmICEvRWRnZS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSxcbiAgICBpc0lQaG9uZTogLyhpUGhvbmV8aVBvZCkvZ2kudGVzdChuYXZpZ2F0b3IucGxhdGZvcm0pLFxuICAgIGlzSW9zOiBuYXZpZ2F0b3IucGxhdGZvcm0gPT09ICdNYWNJbnRlbCcgJiYgbmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzID4gMSB8fCAvKGlQYWR8aVBob25lfGlQb2QpL2dpLnRlc3QobmF2aWdhdG9yLnBsYXRmb3JtKVxuICB9O1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgZnVuY3Rpb24gY2xvbmVEZWVwKG9iamVjdCkge1xuICAgIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iamVjdCkpO1xuICB9IC8vIEdldCBhIG5lc3RlZCB2YWx1ZSBpbiBhbiBvYmplY3RcblxuICBmdW5jdGlvbiBnZXREZWVwKG9iamVjdCwgcGF0aCkge1xuICAgIHJldHVybiBwYXRoLnNwbGl0KCcuJykucmVkdWNlKChvYmosIGtleSkgPT4gb2JqICYmIG9ialtrZXldLCBvYmplY3QpO1xuICB9IC8vIERlZXAgZXh0ZW5kIGRlc3RpbmF0aW9uIG9iamVjdCB3aXRoIE4gbW9yZSBvYmplY3RzXG5cbiAgZnVuY3Rpb24gZXh0ZW5kKHRhcmdldCA9IHt9LCAuLi5zb3VyY2VzKSB7XG4gICAgaWYgKCFzb3VyY2VzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9XG5cbiAgICBjb25zdCBzb3VyY2UgPSBzb3VyY2VzLnNoaWZ0KCk7XG5cbiAgICBpZiAoIWlzLm9iamVjdChzb3VyY2UpKSB7XG4gICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH1cblxuICAgIE9iamVjdC5rZXlzKHNvdXJjZSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgaWYgKGlzLm9iamVjdChzb3VyY2Vba2V5XSkpIHtcbiAgICAgICAgaWYgKCFPYmplY3Qua2V5cyh0YXJnZXQpLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICBPYmplY3QuYXNzaWduKHRhcmdldCwge1xuICAgICAgICAgICAgW2tleV06IHt9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBleHRlbmQodGFyZ2V0W2tleV0sIHNvdXJjZVtrZXldKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7XG4gICAgICAgICAgW2tleV06IHNvdXJjZVtrZXldXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBleHRlbmQodGFyZ2V0LCAuLi5zb3VyY2VzKTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgZnVuY3Rpb24gd3JhcChlbGVtZW50cywgd3JhcHBlcikge1xuICAgIC8vIENvbnZlcnQgYGVsZW1lbnRzYCB0byBhbiBhcnJheSwgaWYgbmVjZXNzYXJ5LlxuICAgIGNvbnN0IHRhcmdldHMgPSBlbGVtZW50cy5sZW5ndGggPyBlbGVtZW50cyA6IFtlbGVtZW50c107IC8vIExvb3BzIGJhY2t3YXJkcyB0byBwcmV2ZW50IGhhdmluZyB0byBjbG9uZSB0aGUgd3JhcHBlciBvbiB0aGVcbiAgICAvLyBmaXJzdCBlbGVtZW50IChzZWUgYGNoaWxkYCBiZWxvdykuXG5cbiAgICBBcnJheS5mcm9tKHRhcmdldHMpLnJldmVyc2UoKS5mb3JFYWNoKChlbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgY2hpbGQgPSBpbmRleCA+IDAgPyB3cmFwcGVyLmNsb25lTm9kZSh0cnVlKSA6IHdyYXBwZXI7IC8vIENhY2hlIHRoZSBjdXJyZW50IHBhcmVudCBhbmQgc2libGluZy5cblxuICAgICAgY29uc3QgcGFyZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xuICAgICAgY29uc3Qgc2libGluZyA9IGVsZW1lbnQubmV4dFNpYmxpbmc7IC8vIFdyYXAgdGhlIGVsZW1lbnQgKGlzIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZCBmcm9tIGl0cyBjdXJyZW50XG4gICAgICAvLyBwYXJlbnQpLlxuXG4gICAgICBjaGlsZC5hcHBlbmRDaGlsZChlbGVtZW50KTsgLy8gSWYgdGhlIGVsZW1lbnQgaGFkIGEgc2libGluZywgaW5zZXJ0IHRoZSB3cmFwcGVyIGJlZm9yZVxuICAgICAgLy8gdGhlIHNpYmxpbmcgdG8gbWFpbnRhaW4gdGhlIEhUTUwgc3RydWN0dXJlOyBvdGhlcndpc2UsIGp1c3RcbiAgICAgIC8vIGFwcGVuZCBpdCB0byB0aGUgcGFyZW50LlxuXG4gICAgICBpZiAoc2libGluZykge1xuICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKGNoaWxkLCBzaWJsaW5nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gLy8gU2V0IGF0dHJpYnV0ZXNcblxuICBmdW5jdGlvbiBzZXRBdHRyaWJ1dGVzKGVsZW1lbnQsIGF0dHJpYnV0ZXMpIHtcbiAgICBpZiAoIWlzLmVsZW1lbnQoZWxlbWVudCkgfHwgaXMuZW1wdHkoYXR0cmlidXRlcykpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIEFzc3VtZSBudWxsIGFuZCB1bmRlZmluZWQgYXR0cmlidXRlcyBzaG91bGQgYmUgbGVmdCBvdXQsXG4gICAgLy8gU2V0dGluZyB0aGVtIHdvdWxkIG90aGVyd2lzZSBjb252ZXJ0IHRoZW0gdG8gXCJudWxsXCIgYW5kIFwidW5kZWZpbmVkXCJcblxuXG4gICAgT2JqZWN0LmVudHJpZXMoYXR0cmlidXRlcykuZmlsdGVyKChbLCB2YWx1ZV0pID0+ICFpcy5udWxsT3JVbmRlZmluZWQodmFsdWUpKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IGVsZW1lbnQuc2V0QXR0cmlidXRlKGtleSwgdmFsdWUpKTtcbiAgfSAvLyBDcmVhdGUgYSBEb2N1bWVudEZyYWdtZW50XG5cbiAgZnVuY3Rpb24gY3JlYXRlRWxlbWVudCh0eXBlLCBhdHRyaWJ1dGVzLCB0ZXh0KSB7XG4gICAgLy8gQ3JlYXRlIGEgbmV3IDxlbGVtZW50PlxuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHR5cGUpOyAvLyBTZXQgYWxsIHBhc3NlZCBhdHRyaWJ1dGVzXG5cbiAgICBpZiAoaXMub2JqZWN0KGF0dHJpYnV0ZXMpKSB7XG4gICAgICBzZXRBdHRyaWJ1dGVzKGVsZW1lbnQsIGF0dHJpYnV0ZXMpO1xuICAgIH0gLy8gQWRkIHRleHQgbm9kZVxuXG5cbiAgICBpZiAoaXMuc3RyaW5nKHRleHQpKSB7XG4gICAgICBlbGVtZW50LmlubmVyVGV4dCA9IHRleHQ7XG4gICAgfSAvLyBSZXR1cm4gYnVpbHQgZWxlbWVudFxuXG5cbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfSAvLyBJbmFlcnQgYW4gZWxlbWVudCBhZnRlciBhbm90aGVyXG5cbiAgZnVuY3Rpb24gaW5zZXJ0QWZ0ZXIoZWxlbWVudCwgdGFyZ2V0KSB7XG4gICAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpIHx8ICFpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0YXJnZXQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZWxlbWVudCwgdGFyZ2V0Lm5leHRTaWJsaW5nKTtcbiAgfSAvLyBJbnNlcnQgYSBEb2N1bWVudEZyYWdtZW50XG5cbiAgZnVuY3Rpb24gaW5zZXJ0RWxlbWVudCh0eXBlLCBwYXJlbnQsIGF0dHJpYnV0ZXMsIHRleHQpIHtcbiAgICBpZiAoIWlzLmVsZW1lbnQocGFyZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHBhcmVudC5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KHR5cGUsIGF0dHJpYnV0ZXMsIHRleHQpKTtcbiAgfSAvLyBSZW1vdmUgZWxlbWVudChzKVxuXG4gIGZ1bmN0aW9uIHJlbW92ZUVsZW1lbnQoZWxlbWVudCkge1xuICAgIGlmIChpcy5ub2RlTGlzdChlbGVtZW50KSB8fCBpcy5hcnJheShlbGVtZW50KSkge1xuICAgICAgQXJyYXkuZnJvbShlbGVtZW50KS5mb3JFYWNoKHJlbW92ZUVsZW1lbnQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghaXMuZWxlbWVudChlbGVtZW50KSB8fCAhaXMuZWxlbWVudChlbGVtZW50LnBhcmVudE5vZGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuICB9IC8vIFJlbW92ZSBhbGwgY2hpbGQgZWxlbWVudHNcblxuICBmdW5jdGlvbiBlbXB0eUVsZW1lbnQoZWxlbWVudCkge1xuICAgIGlmICghaXMuZWxlbWVudChlbGVtZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCB7XG4gICAgICBsZW5ndGhcbiAgICB9ID0gZWxlbWVudC5jaGlsZE5vZGVzO1xuXG4gICAgd2hpbGUgKGxlbmd0aCA+IDApIHtcbiAgICAgIGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5sYXN0Q2hpbGQpO1xuICAgICAgbGVuZ3RoIC09IDE7XG4gICAgfVxuICB9IC8vIFJlcGxhY2UgZWxlbWVudFxuXG4gIGZ1bmN0aW9uIHJlcGxhY2VFbGVtZW50KG5ld0NoaWxkLCBvbGRDaGlsZCkge1xuICAgIGlmICghaXMuZWxlbWVudChvbGRDaGlsZCkgfHwgIWlzLmVsZW1lbnQob2xkQ2hpbGQucGFyZW50Tm9kZSkgfHwgIWlzLmVsZW1lbnQobmV3Q2hpbGQpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBvbGRDaGlsZC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChuZXdDaGlsZCwgb2xkQ2hpbGQpO1xuICAgIHJldHVybiBuZXdDaGlsZDtcbiAgfSAvLyBHZXQgYW4gYXR0cmlidXRlIG9iamVjdCBmcm9tIGEgc3RyaW5nIHNlbGVjdG9yXG5cbiAgZnVuY3Rpb24gZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3RvcihzZWwsIGV4aXN0aW5nQXR0cmlidXRlcykge1xuICAgIC8vIEZvciBleGFtcGxlOlxuICAgIC8vICcudGVzdCcgdG8geyBjbGFzczogJ3Rlc3QnIH1cbiAgICAvLyAnI3Rlc3QnIHRvIHsgaWQ6ICd0ZXN0JyB9XG4gICAgLy8gJ1tkYXRhLXRlc3Q9XCJ0ZXN0XCJdJyB0byB7ICdkYXRhLXRlc3QnOiAndGVzdCcgfVxuICAgIGlmICghaXMuc3RyaW5nKHNlbCkgfHwgaXMuZW1wdHkoc2VsKSkge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cblxuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7fTtcbiAgICBjb25zdCBleGlzdGluZyA9IGV4dGVuZCh7fSwgZXhpc3RpbmdBdHRyaWJ1dGVzKTtcbiAgICBzZWwuc3BsaXQoJywnKS5mb3JFYWNoKHMgPT4ge1xuICAgICAgLy8gUmVtb3ZlIHdoaXRlc3BhY2VcbiAgICAgIGNvbnN0IHNlbGVjdG9yID0gcy50cmltKCk7XG4gICAgICBjb25zdCBjbGFzc05hbWUgPSBzZWxlY3Rvci5yZXBsYWNlKCcuJywgJycpO1xuICAgICAgY29uc3Qgc3RyaXBwZWQgPSBzZWxlY3Rvci5yZXBsYWNlKC9bW1xcXV0vZywgJycpOyAvLyBHZXQgdGhlIHBhcnRzIGFuZCB2YWx1ZVxuXG4gICAgICBjb25zdCBwYXJ0cyA9IHN0cmlwcGVkLnNwbGl0KCc9Jyk7XG4gICAgICBjb25zdCBba2V5XSA9IHBhcnRzO1xuICAgICAgY29uc3QgdmFsdWUgPSBwYXJ0cy5sZW5ndGggPiAxID8gcGFydHNbMV0ucmVwbGFjZSgvW1wiJ10vZywgJycpIDogJyc7IC8vIEdldCB0aGUgZmlyc3QgY2hhcmFjdGVyXG5cbiAgICAgIGNvbnN0IHN0YXJ0ID0gc2VsZWN0b3IuY2hhckF0KDApO1xuXG4gICAgICBzd2l0Y2ggKHN0YXJ0KSB7XG4gICAgICAgIGNhc2UgJy4nOlxuICAgICAgICAgIC8vIEFkZCB0byBleGlzdGluZyBjbGFzc25hbWVcbiAgICAgICAgICBpZiAoaXMuc3RyaW5nKGV4aXN0aW5nLmNsYXNzKSkge1xuICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyA9IGAke2V4aXN0aW5nLmNsYXNzfSAke2NsYXNzTmFtZX1gO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3NOYW1lO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJyMnOlxuICAgICAgICAgIC8vIElEIHNlbGVjdG9yXG4gICAgICAgICAgYXR0cmlidXRlcy5pZCA9IHNlbGVjdG9yLnJlcGxhY2UoJyMnLCAnJyk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnWyc6XG4gICAgICAgICAgLy8gQXR0cmlidXRlIHNlbGVjdG9yXG4gICAgICAgICAgYXR0cmlidXRlc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGV4dGVuZChleGlzdGluZywgYXR0cmlidXRlcyk7XG4gIH0gLy8gVG9nZ2xlIGhpZGRlblxuXG4gIGZ1bmN0aW9uIHRvZ2dsZUhpZGRlbihlbGVtZW50LCBoaWRkZW4pIHtcbiAgICBpZiAoIWlzLmVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgaGlkZSA9IGhpZGRlbjtcblxuICAgIGlmICghaXMuYm9vbGVhbihoaWRlKSkge1xuICAgICAgaGlkZSA9ICFlbGVtZW50LmhpZGRlbjtcbiAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuXG5cbiAgICBlbGVtZW50LmhpZGRlbiA9IGhpZGU7XG4gIH0gLy8gTWlycm9yIEVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSwgd2l0aCBJRSBjb21wYXRpYmlsaXR5IGZvciBcImZvcmNlXCIgYXJndW1lbnRcblxuICBmdW5jdGlvbiB0b2dnbGVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUsIGZvcmNlKSB7XG4gICAgaWYgKGlzLm5vZGVMaXN0KGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm4gQXJyYXkuZnJvbShlbGVtZW50KS5tYXAoZSA9PiB0b2dnbGVDbGFzcyhlLCBjbGFzc05hbWUsIGZvcmNlKSk7XG4gICAgfVxuXG4gICAgaWYgKGlzLmVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAgIGxldCBtZXRob2QgPSAndG9nZ2xlJztcblxuICAgICAgaWYgKHR5cGVvZiBmb3JjZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgbWV0aG9kID0gZm9yY2UgPyAnYWRkJyA6ICdyZW1vdmUnO1xuICAgICAgfVxuXG4gICAgICBlbGVtZW50LmNsYXNzTGlzdFttZXRob2RdKGNsYXNzTmFtZSk7XG4gICAgICByZXR1cm4gZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gLy8gSGFzIGNsYXNzIG5hbWVcblxuICBmdW5jdGlvbiBoYXNDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICByZXR1cm4gaXMuZWxlbWVudChlbGVtZW50KSAmJiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xuICB9IC8vIEVsZW1lbnQgbWF0Y2hlcyBzZWxlY3RvclxuXG4gIGZ1bmN0aW9uIG1hdGNoZXMoZWxlbWVudCwgc2VsZWN0b3IpIHtcbiAgICBjb25zdCB7XG4gICAgICBwcm90b3R5cGVcbiAgICB9ID0gRWxlbWVudDtcblxuICAgIGZ1bmN0aW9uIG1hdGNoKCkge1xuICAgICAgcmV0dXJuIEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpLmluY2x1ZGVzKHRoaXMpO1xuICAgIH1cblxuICAgIGNvbnN0IG1ldGhvZCA9IHByb3RvdHlwZS5tYXRjaGVzIHx8IHByb3RvdHlwZS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwgcHJvdG90eXBlLm1vek1hdGNoZXNTZWxlY3RvciB8fCBwcm90b3R5cGUubXNNYXRjaGVzU2VsZWN0b3IgfHwgbWF0Y2g7XG4gICAgcmV0dXJuIG1ldGhvZC5jYWxsKGVsZW1lbnQsIHNlbGVjdG9yKTtcbiAgfSAvLyBDbG9zZXN0IGFuY2VzdG9yIGVsZW1lbnQgbWF0Y2hpbmcgc2VsZWN0b3IgKGFsc28gdGVzdHMgZWxlbWVudCBpdHNlbGYpXG5cbiAgZnVuY3Rpb24gY2xvc2VzdCQxKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gICAgY29uc3Qge1xuICAgICAgcHJvdG90eXBlXG4gICAgfSA9IEVsZW1lbnQ7IC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9FbGVtZW50L2Nsb3Nlc3QjUG9seWZpbGxcblxuICAgIGZ1bmN0aW9uIGNsb3Nlc3RFbGVtZW50KCkge1xuICAgICAgbGV0IGVsID0gdGhpcztcblxuICAgICAgZG8ge1xuICAgICAgICBpZiAobWF0Y2hlcy5tYXRjaGVzKGVsLCBzZWxlY3RvcikpIHJldHVybiBlbDtcbiAgICAgICAgZWwgPSBlbC5wYXJlbnRFbGVtZW50IHx8IGVsLnBhcmVudE5vZGU7XG4gICAgICB9IHdoaWxlIChlbCAhPT0gbnVsbCAmJiBlbC5ub2RlVHlwZSA9PT0gMSk7XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IG1ldGhvZCA9IHByb3RvdHlwZS5jbG9zZXN0IHx8IGNsb3Nlc3RFbGVtZW50O1xuICAgIHJldHVybiBtZXRob2QuY2FsbChlbGVtZW50LCBzZWxlY3Rvcik7XG4gIH0gLy8gRmluZCBhbGwgZWxlbWVudHNcblxuICBmdW5jdGlvbiBnZXRFbGVtZW50cyhzZWxlY3Rvcikge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgfSAvLyBGaW5kIGEgc2luZ2xlIGVsZW1lbnRcblxuICBmdW5jdGlvbiBnZXRFbGVtZW50KHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICB9IC8vIFNldCBmb2N1cyBhbmQgdGFiIGZvY3VzIGNsYXNzXG5cbiAgZnVuY3Rpb24gc2V0Rm9jdXMoZWxlbWVudCA9IG51bGwsIHRhYkZvY3VzID0gZmFsc2UpIHtcbiAgICBpZiAoIWlzLmVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIFNldCByZWd1bGFyIGZvY3VzXG5cblxuICAgIGVsZW1lbnQuZm9jdXMoe1xuICAgICAgcHJldmVudFNjcm9sbDogdHJ1ZVxuICAgIH0pOyAvLyBJZiB3ZSB3YW50IHRvIG1pbWljIGtleWJvYXJkIGZvY3VzIHZpYSB0YWJcblxuICAgIGlmICh0YWJGb2N1cykge1xuICAgICAgdG9nZ2xlQ2xhc3MoZWxlbWVudCwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy50YWJGb2N1cyk7XG4gICAgfVxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCBkZWZhdWx0Q29kZWNzID0ge1xuICAgICdhdWRpby9vZ2cnOiAndm9yYmlzJyxcbiAgICAnYXVkaW8vd2F2JzogJzEnLFxuICAgICd2aWRlby93ZWJtJzogJ3ZwOCwgdm9yYmlzJyxcbiAgICAndmlkZW8vbXA0JzogJ2F2YzEuNDJFMDFFLCBtcDRhLjQwLjInLFxuICAgICd2aWRlby9vZ2cnOiAndGhlb3JhJ1xuICB9OyAvLyBDaGVjayBmb3IgZmVhdHVyZSBzdXBwb3J0XG5cbiAgY29uc3Qgc3VwcG9ydCA9IHtcbiAgICAvLyBCYXNpYyBzdXBwb3J0XG4gICAgYXVkaW86ICdjYW5QbGF5VHlwZScgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXVkaW8nKSxcbiAgICB2aWRlbzogJ2NhblBsYXlUeXBlJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpLFxuXG4gICAgLy8gQ2hlY2sgZm9yIHN1cHBvcnRcbiAgICAvLyBCYXNpYyBmdW5jdGlvbmFsaXR5IHZzIGZ1bGwgVUlcbiAgICBjaGVjayh0eXBlLCBwcm92aWRlciwgcGxheXNpbmxpbmUpIHtcbiAgICAgIGNvbnN0IGNhblBsYXlJbmxpbmUgPSBicm93c2VyLmlzSVBob25lICYmIHBsYXlzaW5saW5lICYmIHN1cHBvcnQucGxheXNpbmxpbmU7XG4gICAgICBjb25zdCBhcGkgPSBzdXBwb3J0W3R5cGVdIHx8IHByb3ZpZGVyICE9PSAnaHRtbDUnO1xuICAgICAgY29uc3QgdWkgPSBhcGkgJiYgc3VwcG9ydC5yYW5nZUlucHV0ICYmICh0eXBlICE9PSAndmlkZW8nIHx8ICFicm93c2VyLmlzSVBob25lIHx8IGNhblBsYXlJbmxpbmUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYXBpLFxuICAgICAgICB1aVxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgLy8gUGljdHVyZS1pbi1waWN0dXJlIHN1cHBvcnRcbiAgICAvLyBTYWZhcmkgJiBDaHJvbWUgb25seSBjdXJyZW50bHlcbiAgICBwaXA6ICgoKSA9PiB7XG4gICAgICBpZiAoYnJvd3Nlci5pc0lQaG9uZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9IC8vIFNhZmFyaVxuICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24vd2Via2l0anMvYWRkaW5nX3BpY3R1cmVfaW5fcGljdHVyZV90b195b3VyX3NhZmFyaV9tZWRpYV9jb250cm9sc1xuXG5cbiAgICAgIGlmIChpcy5mdW5jdGlvbihjcmVhdGVFbGVtZW50KCd2aWRlbycpLndlYmtpdFNldFByZXNlbnRhdGlvbk1vZGUpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSAvLyBDaHJvbWVcbiAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3dlYi91cGRhdGVzLzIwMTgvMTAvd2F0Y2gtdmlkZW8tdXNpbmctcGljdHVyZS1pbi1waWN0dXJlXG5cblxuICAgICAgaWYgKGRvY3VtZW50LnBpY3R1cmVJblBpY3R1cmVFbmFibGVkICYmICFjcmVhdGVFbGVtZW50KCd2aWRlbycpLmRpc2FibGVQaWN0dXJlSW5QaWN0dXJlKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSkoKSxcbiAgICAvLyBBaXJwbGF5IHN1cHBvcnRcbiAgICAvLyBTYWZhcmkgb25seSBjdXJyZW50bHlcbiAgICBhaXJwbGF5OiBpcy5mdW5jdGlvbih3aW5kb3cuV2ViS2l0UGxheWJhY2tUYXJnZXRBdmFpbGFiaWxpdHlFdmVudCksXG4gICAgLy8gSW5saW5lIHBsYXliYWNrIHN1cHBvcnRcbiAgICAvLyBodHRwczovL3dlYmtpdC5vcmcvYmxvZy82Nzg0L25ldy12aWRlby1wb2xpY2llcy1mb3ItaW9zL1xuICAgIHBsYXlzaW5saW5lOiAncGxheXNJbmxpbmUnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyksXG5cbiAgICAvLyBDaGVjayBmb3IgbWltZSB0eXBlIHN1cHBvcnQgYWdhaW5zdCBhIHBsYXllciBpbnN0YW5jZVxuICAgIC8vIENyZWRpdHM6IGh0dHA6Ly9kaXZlaW50b2h0bWw1LmluZm8vZXZlcnl0aGluZy5odG1sXG4gICAgLy8gUmVsYXRlZDogaHR0cDovL3d3dy5sZWFuYmFja3BsYXllci5jb20vdGVzdC9oNW10Lmh0bWxcbiAgICBtaW1lKGlucHV0KSB7XG4gICAgICBpZiAoaXMuZW1wdHkoaW5wdXQpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgW21lZGlhVHlwZV0gPSBpbnB1dC5zcGxpdCgnLycpO1xuICAgICAgbGV0IHR5cGUgPSBpbnB1dDsgLy8gVmVyaWZ5IHdlJ3JlIHVzaW5nIEhUTUw1IGFuZCB0aGVyZSdzIG5vIG1lZGlhIHR5cGUgbWlzbWF0Y2hcblxuICAgICAgaWYgKCF0aGlzLmlzSFRNTDUgfHwgbWVkaWFUeXBlICE9PSB0aGlzLnR5cGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSAvLyBBZGQgY29kZWMgaWYgcmVxdWlyZWRcblxuXG4gICAgICBpZiAoT2JqZWN0LmtleXMoZGVmYXVsdENvZGVjcykuaW5jbHVkZXModHlwZSkpIHtcbiAgICAgICAgdHlwZSArPSBgOyBjb2RlY3M9XCIke2RlZmF1bHRDb2RlY3NbaW5wdXRdfVwiYDtcbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4odHlwZSAmJiB0aGlzLm1lZGlhLmNhblBsYXlUeXBlKHR5cGUpLnJlcGxhY2UoL25vLywgJycpKTtcbiAgICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBDaGVjayBmb3IgdGV4dFRyYWNrcyBzdXBwb3J0XG4gICAgdGV4dFRyYWNrczogJ3RleHRUcmFja3MnIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyksXG4gICAgLy8gPGlucHV0IHR5cGU9XCJyYW5nZVwiPiBTbGlkZXJzXG4gICAgcmFuZ2VJbnB1dDogKCgpID0+IHtcbiAgICAgIGNvbnN0IHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgIHJhbmdlLnR5cGUgPSAncmFuZ2UnO1xuICAgICAgcmV0dXJuIHJhbmdlLnR5cGUgPT09ICdyYW5nZSc7XG4gICAgfSkoKSxcbiAgICAvLyBUb3VjaFxuICAgIC8vIE5PVEU6IFJlbWVtYmVyIGEgZGV2aWNlIGNhbiBiZSBtb3VzZSArIHRvdWNoIGVuYWJsZWQgc28gd2UgY2hlY2sgb24gZmlyc3QgdG91Y2ggZXZlbnRcbiAgICB0b3VjaDogJ29udG91Y2hzdGFydCcgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFxuICAgIC8vIERldGVjdCB0cmFuc2l0aW9ucyBzdXBwb3J0XG4gICAgdHJhbnNpdGlvbnM6IHRyYW5zaXRpb25FbmRFdmVudCAhPT0gZmFsc2UsXG4gICAgLy8gUmVkdWNlZCBtb3Rpb24gaU9TICYgTWFjT1Mgc2V0dGluZ1xuICAgIC8vIGh0dHBzOi8vd2Via2l0Lm9yZy9ibG9nLzc1NTEvcmVzcG9uc2l2ZS1kZXNpZ24tZm9yLW1vdGlvbi9cbiAgICByZWR1Y2VkTW90aW9uOiAnbWF0Y2hNZWRpYScgaW4gd2luZG93ICYmIHdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1yZWR1Y2VkLW1vdGlvbiknKS5tYXRjaGVzXG4gIH07XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL1dJQ0cvRXZlbnRMaXN0ZW5lck9wdGlvbnMvYmxvYi9naC1wYWdlcy9leHBsYWluZXIubWRcbiAgLy8gaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1OUE02MTcySjIyZ1xuXG4gIGNvbnN0IHN1cHBvcnRzUGFzc2l2ZUxpc3RlbmVycyA9ICgoKSA9PiB7XG4gICAgLy8gVGVzdCB2aWEgYSBnZXR0ZXIgaW4gdGhlIG9wdGlvbnMgb2JqZWN0IHRvIHNlZSBpZiB0aGUgcGFzc2l2ZSBwcm9wZXJ0eSBpcyBhY2Nlc3NlZFxuICAgIGxldCBzdXBwb3J0ZWQgPSBmYWxzZTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCAncGFzc2l2ZScsIHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIHN1cHBvcnRlZCA9IHRydWU7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgfSk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndGVzdCcsIG51bGwsIG9wdGlvbnMpO1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Rlc3QnLCBudWxsLCBvcHRpb25zKTtcbiAgICB9IGNhdGNoIChfKSB7Ly8gRG8gbm90aGluZ1xuICAgIH1cblxuICAgIHJldHVybiBzdXBwb3J0ZWQ7XG4gIH0pKCk7IC8vIFRvZ2dsZSBldmVudCBsaXN0ZW5lclxuXG5cbiAgZnVuY3Rpb24gdG9nZ2xlTGlzdGVuZXIoZWxlbWVudCwgZXZlbnQsIGNhbGxiYWNrLCB0b2dnbGUgPSBmYWxzZSwgcGFzc2l2ZSA9IHRydWUsIGNhcHR1cmUgPSBmYWxzZSkge1xuICAgIC8vIEJhaWwgaWYgbm8gZWxlbWVudCwgZXZlbnQsIG9yIGNhbGxiYWNrXG4gICAgaWYgKCFlbGVtZW50IHx8ICEoJ2FkZEV2ZW50TGlzdGVuZXInIGluIGVsZW1lbnQpIHx8IGlzLmVtcHR5KGV2ZW50KSB8fCAhaXMuZnVuY3Rpb24oY2FsbGJhY2spKSB7XG4gICAgICByZXR1cm47XG4gICAgfSAvLyBBbGxvdyBtdWx0aXBsZSBldmVudHNcblxuXG4gICAgY29uc3QgZXZlbnRzID0gZXZlbnQuc3BsaXQoJyAnKTsgLy8gQnVpbGQgb3B0aW9uc1xuICAgIC8vIERlZmF1bHQgdG8ganVzdCB0aGUgY2FwdHVyZSBib29sZWFuIGZvciBicm93c2VycyB3aXRoIG5vIHBhc3NpdmUgbGlzdGVuZXIgc3VwcG9ydFxuXG4gICAgbGV0IG9wdGlvbnMgPSBjYXB0dXJlOyAvLyBJZiBwYXNzaXZlIGV2ZW50cyBsaXN0ZW5lcnMgYXJlIHN1cHBvcnRlZFxuXG4gICAgaWYgKHN1cHBvcnRzUGFzc2l2ZUxpc3RlbmVycykge1xuICAgICAgb3B0aW9ucyA9IHtcbiAgICAgICAgLy8gV2hldGhlciB0aGUgbGlzdGVuZXIgY2FuIGJlIHBhc3NpdmUgKGkuZS4gZGVmYXVsdCBuZXZlciBwcmV2ZW50ZWQpXG4gICAgICAgIHBhc3NpdmUsXG4gICAgICAgIC8vIFdoZXRoZXIgdGhlIGxpc3RlbmVyIGlzIGEgY2FwdHVyaW5nIGxpc3RlbmVyIG9yIG5vdFxuICAgICAgICBjYXB0dXJlXG4gICAgICB9O1xuICAgIH0gLy8gSWYgYSBzaW5nbGUgbm9kZSBpcyBwYXNzZWQsIGJpbmQgdGhlIGV2ZW50IGxpc3RlbmVyXG5cblxuICAgIGV2ZW50cy5mb3JFYWNoKHR5cGUgPT4ge1xuICAgICAgaWYgKHRoaXMgJiYgdGhpcy5ldmVudExpc3RlbmVycyAmJiB0b2dnbGUpIHtcbiAgICAgICAgLy8gQ2FjaGUgZXZlbnQgbGlzdGVuZXJcbiAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5wdXNoKHtcbiAgICAgICAgICBlbGVtZW50LFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgY2FsbGJhY2ssXG4gICAgICAgICAgb3B0aW9uc1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgZWxlbWVudFt0b2dnbGUgPyAnYWRkRXZlbnRMaXN0ZW5lcicgOiAncmVtb3ZlRXZlbnRMaXN0ZW5lciddKHR5cGUsIGNhbGxiYWNrLCBvcHRpb25zKTtcbiAgICB9KTtcbiAgfSAvLyBCaW5kIGV2ZW50IGhhbmRsZXJcblxuICBmdW5jdGlvbiBvbihlbGVtZW50LCBldmVudHMgPSAnJywgY2FsbGJhY2ssIHBhc3NpdmUgPSB0cnVlLCBjYXB0dXJlID0gZmFsc2UpIHtcbiAgICB0b2dnbGVMaXN0ZW5lci5jYWxsKHRoaXMsIGVsZW1lbnQsIGV2ZW50cywgY2FsbGJhY2ssIHRydWUsIHBhc3NpdmUsIGNhcHR1cmUpO1xuICB9IC8vIFVuYmluZCBldmVudCBoYW5kbGVyXG5cbiAgZnVuY3Rpb24gb2ZmKGVsZW1lbnQsIGV2ZW50cyA9ICcnLCBjYWxsYmFjaywgcGFzc2l2ZSA9IHRydWUsIGNhcHR1cmUgPSBmYWxzZSkge1xuICAgIHRvZ2dsZUxpc3RlbmVyLmNhbGwodGhpcywgZWxlbWVudCwgZXZlbnRzLCBjYWxsYmFjaywgZmFsc2UsIHBhc3NpdmUsIGNhcHR1cmUpO1xuICB9IC8vIEJpbmQgb25jZS1vbmx5IGV2ZW50IGhhbmRsZXJcblxuICBmdW5jdGlvbiBvbmNlKGVsZW1lbnQsIGV2ZW50cyA9ICcnLCBjYWxsYmFjaywgcGFzc2l2ZSA9IHRydWUsIGNhcHR1cmUgPSBmYWxzZSkge1xuICAgIGNvbnN0IG9uY2VDYWxsYmFjayA9ICguLi5hcmdzKSA9PiB7XG4gICAgICBvZmYoZWxlbWVudCwgZXZlbnRzLCBvbmNlQ2FsbGJhY2ssIHBhc3NpdmUsIGNhcHR1cmUpO1xuICAgICAgY2FsbGJhY2suYXBwbHkodGhpcywgYXJncyk7XG4gICAgfTtcblxuICAgIHRvZ2dsZUxpc3RlbmVyLmNhbGwodGhpcywgZWxlbWVudCwgZXZlbnRzLCBvbmNlQ2FsbGJhY2ssIHRydWUsIHBhc3NpdmUsIGNhcHR1cmUpO1xuICB9IC8vIFRyaWdnZXIgZXZlbnRcblxuICBmdW5jdGlvbiB0cmlnZ2VyRXZlbnQoZWxlbWVudCwgdHlwZSA9ICcnLCBidWJibGVzID0gZmFsc2UsIGRldGFpbCA9IHt9KSB7XG4gICAgLy8gQmFpbCBpZiBubyBlbGVtZW50XG4gICAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpIHx8IGlzLmVtcHR5KHR5cGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfSAvLyBDcmVhdGUgYW5kIGRpc3BhdGNoIHRoZSBldmVudFxuXG5cbiAgICBjb25zdCBldmVudCA9IG5ldyBDdXN0b21FdmVudCh0eXBlLCB7XG4gICAgICBidWJibGVzLFxuICAgICAgZGV0YWlsOiB7IC4uLmRldGFpbCxcbiAgICAgICAgcGx5cjogdGhpc1xuICAgICAgfVxuICAgIH0pOyAvLyBEaXNwYXRjaCB0aGUgZXZlbnRcblxuICAgIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gIH0gLy8gVW5iaW5kIGFsbCBjYWNoZWQgZXZlbnQgbGlzdGVuZXJzXG5cbiAgZnVuY3Rpb24gdW5iaW5kTGlzdGVuZXJzKCkge1xuICAgIGlmICh0aGlzICYmIHRoaXMuZXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGVsZW1lbnQsXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgICBvcHRpb25zXG4gICAgICAgIH0gPSBpdGVtO1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgY2FsbGJhY2ssIG9wdGlvbnMpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzID0gW107XG4gICAgfVxuICB9IC8vIFJ1biBtZXRob2Qgd2hlbiAvIGlmIHBsYXllciBpcyByZWFkeVxuXG4gIGZ1bmN0aW9uIHJlYWR5KCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHRoaXMucmVhZHkgPyBzZXRUaW1lb3V0KHJlc29sdmUsIDApIDogb24uY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgJ3JlYWR5JywgcmVzb2x2ZSkpLnRoZW4oKCkgPT4ge30pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNpbGVuY2UgYSBQcm9taXNlLWxpa2Ugb2JqZWN0LlxuICAgKiBUaGlzIGlzIHVzZWZ1bCBmb3IgYXZvaWRpbmcgbm9uLWhhcm1mdWwsIGJ1dCBwb3RlbnRpYWxseSBjb25mdXNpbmcgXCJ1bmNhdWdodFxuICAgKiBwbGF5IHByb21pc2VcIiByZWplY3Rpb24gZXJyb3IgbWVzc2FnZXMuXG4gICAqIEBwYXJhbSAge09iamVjdH0gdmFsdWUgQW4gb2JqZWN0IHRoYXQgbWF5IG9yIG1heSBub3QgYmUgYFByb21pc2VgLWxpa2UuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIHNpbGVuY2VQcm9taXNlKHZhbHVlKSB7XG4gICAgaWYgKGlzLnByb21pc2UodmFsdWUpKSB7XG4gICAgICB2YWx1ZS50aGVuKG51bGwsICgpID0+IHt9KTtcbiAgICB9XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIGRlZHVwZShhcnJheSkge1xuICAgIGlmICghaXMuYXJyYXkoYXJyYXkpKSB7XG4gICAgICByZXR1cm4gYXJyYXk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFycmF5LmZpbHRlcigoaXRlbSwgaW5kZXgpID0+IGFycmF5LmluZGV4T2YoaXRlbSkgPT09IGluZGV4KTtcbiAgfSAvLyBHZXQgdGhlIGNsb3Nlc3QgdmFsdWUgaW4gYW4gYXJyYXlcblxuICBmdW5jdGlvbiBjbG9zZXN0KGFycmF5LCB2YWx1ZSkge1xuICAgIGlmICghaXMuYXJyYXkoYXJyYXkpIHx8ICFhcnJheS5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBhcnJheS5yZWR1Y2UoKHByZXYsIGN1cnIpID0+IE1hdGguYWJzKGN1cnIgLSB2YWx1ZSkgPCBNYXRoLmFicyhwcmV2IC0gdmFsdWUpID8gY3VyciA6IHByZXYpO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBzdXBwb3J0c0NTUyhkZWNsYXJhdGlvbikge1xuICAgIGlmICghd2luZG93IHx8ICF3aW5kb3cuQ1NTKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHdpbmRvdy5DU1Muc3VwcG9ydHMoZGVjbGFyYXRpb24pO1xuICB9IC8vIFN0YW5kYXJkL2NvbW1vbiBhc3BlY3QgcmF0aW9zXG5cbiAgY29uc3Qgc3RhbmRhcmRSYXRpb3MgPSBbWzEsIDFdLCBbNCwgM10sIFszLCA0XSwgWzUsIDRdLCBbNCwgNV0sIFszLCAyXSwgWzIsIDNdLCBbMTYsIDEwXSwgWzEwLCAxNl0sIFsxNiwgOV0sIFs5LCAxNl0sIFsyMSwgOV0sIFs5LCAyMV0sIFszMiwgOV0sIFs5LCAzMl1dLnJlZHVjZSgob3V0LCBbeCwgeV0pID0+ICh7IC4uLm91dCxcbiAgICBbeCAvIHldOiBbeCwgeV1cbiAgfSksIHt9KTsgLy8gVmFsaWRhdGUgYW4gYXNwZWN0IHJhdGlvXG5cbiAgZnVuY3Rpb24gdmFsaWRhdGVBc3BlY3RSYXRpbyhpbnB1dCkge1xuICAgIGlmICghaXMuYXJyYXkoaW5wdXQpICYmICghaXMuc3RyaW5nKGlucHV0KSB8fCAhaW5wdXQuaW5jbHVkZXMoJzonKSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCByYXRpbyA9IGlzLmFycmF5KGlucHV0KSA/IGlucHV0IDogaW5wdXQuc3BsaXQoJzonKTtcbiAgICByZXR1cm4gcmF0aW8ubWFwKE51bWJlcikuZXZlcnkoaXMubnVtYmVyKTtcbiAgfSAvLyBSZWR1Y2UgYW4gYXNwZWN0IHJhdGlvIHRvIGl0J3MgbG93ZXN0IGZvcm1cblxuICBmdW5jdGlvbiByZWR1Y2VBc3BlY3RSYXRpbyhyYXRpbykge1xuICAgIGlmICghaXMuYXJyYXkocmF0aW8pIHx8ICFyYXRpby5ldmVyeShpcy5udW1iZXIpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBbd2lkdGgsIGhlaWdodF0gPSByYXRpbztcblxuICAgIGNvbnN0IGdldERpdmlkZXIgPSAodywgaCkgPT4gaCA9PT0gMCA/IHcgOiBnZXREaXZpZGVyKGgsIHcgJSBoKTtcblxuICAgIGNvbnN0IGRpdmlkZXIgPSBnZXREaXZpZGVyKHdpZHRoLCBoZWlnaHQpO1xuICAgIHJldHVybiBbd2lkdGggLyBkaXZpZGVyLCBoZWlnaHQgLyBkaXZpZGVyXTtcbiAgfSAvLyBDYWxjdWxhdGUgYW4gYXNwZWN0IHJhdGlvXG5cbiAgZnVuY3Rpb24gZ2V0QXNwZWN0UmF0aW8oaW5wdXQpIHtcbiAgICBjb25zdCBwYXJzZSA9IHJhdGlvID0+IHZhbGlkYXRlQXNwZWN0UmF0aW8ocmF0aW8pID8gcmF0aW8uc3BsaXQoJzonKS5tYXAoTnVtYmVyKSA6IG51bGw7IC8vIFRyeSBwcm92aWRlZCByYXRpb1xuXG5cbiAgICBsZXQgcmF0aW8gPSBwYXJzZShpbnB1dCk7IC8vIEdldCBmcm9tIGNvbmZpZ1xuXG4gICAgaWYgKHJhdGlvID09PSBudWxsKSB7XG4gICAgICByYXRpbyA9IHBhcnNlKHRoaXMuY29uZmlnLnJhdGlvKTtcbiAgICB9IC8vIEdldCBmcm9tIGVtYmVkXG5cblxuICAgIGlmIChyYXRpbyA9PT0gbnVsbCAmJiAhaXMuZW1wdHkodGhpcy5lbWJlZCkgJiYgaXMuYXJyYXkodGhpcy5lbWJlZC5yYXRpbykpIHtcbiAgICAgICh7XG4gICAgICAgIHJhdGlvXG4gICAgICB9ID0gdGhpcy5lbWJlZCk7XG4gICAgfSAvLyBHZXQgZnJvbSBIVE1MNSB2aWRlb1xuXG5cbiAgICBpZiAocmF0aW8gPT09IG51bGwgJiYgdGhpcy5pc0hUTUw1KSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHZpZGVvV2lkdGgsXG4gICAgICAgIHZpZGVvSGVpZ2h0XG4gICAgICB9ID0gdGhpcy5tZWRpYTtcbiAgICAgIHJhdGlvID0gW3ZpZGVvV2lkdGgsIHZpZGVvSGVpZ2h0XTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVkdWNlQXNwZWN0UmF0aW8ocmF0aW8pO1xuICB9IC8vIFNldCBhc3BlY3QgcmF0aW8gZm9yIHJlc3BvbnNpdmUgY29udGFpbmVyXG5cbiAgZnVuY3Rpb24gc2V0QXNwZWN0UmF0aW8oaW5wdXQpIHtcbiAgICBpZiAoIXRoaXMuaXNWaWRlbykge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cblxuICAgIGNvbnN0IHtcbiAgICAgIHdyYXBwZXJcbiAgICB9ID0gdGhpcy5lbGVtZW50cztcbiAgICBjb25zdCByYXRpbyA9IGdldEFzcGVjdFJhdGlvLmNhbGwodGhpcywgaW5wdXQpO1xuXG4gICAgaWYgKCFpcy5hcnJheShyYXRpbykpIHtcbiAgICAgIHJldHVybiB7fTtcbiAgICB9XG5cbiAgICBjb25zdCBbeCwgeV0gPSByZWR1Y2VBc3BlY3RSYXRpbyhyYXRpbyk7XG4gICAgY29uc3QgdXNlTmF0aXZlID0gc3VwcG9ydHNDU1MoYGFzcGVjdC1yYXRpbzogJHt4fS8ke3l9YCk7XG4gICAgY29uc3QgcGFkZGluZyA9IDEwMCAvIHggKiB5O1xuXG4gICAgaWYgKHVzZU5hdGl2ZSkge1xuICAgICAgd3JhcHBlci5zdHlsZS5hc3BlY3RSYXRpbyA9IGAke3h9LyR7eX1gO1xuICAgIH0gZWxzZSB7XG4gICAgICB3cmFwcGVyLnN0eWxlLnBhZGRpbmdCb3R0b20gPSBgJHtwYWRkaW5nfSVgO1xuICAgIH0gLy8gRm9yIFZpbWVvIHdlIGhhdmUgYW4gZXh0cmEgPGRpdj4gdG8gaGlkZSB0aGUgc3RhbmRhcmQgY29udHJvbHMgYW5kIFVJXG5cblxuICAgIGlmICh0aGlzLmlzVmltZW8gJiYgIXRoaXMuY29uZmlnLnZpbWVvLnByZW1pdW0gJiYgdGhpcy5zdXBwb3J0ZWQudWkpIHtcbiAgICAgIGNvbnN0IGhlaWdodCA9IDEwMCAvIHRoaXMubWVkaWEub2Zmc2V0V2lkdGggKiBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLm1lZGlhKS5wYWRkaW5nQm90dG9tLCAxMCk7XG4gICAgICBjb25zdCBvZmZzZXQgPSAoaGVpZ2h0IC0gcGFkZGluZykgLyAoaGVpZ2h0IC8gNTApO1xuXG4gICAgICBpZiAodGhpcy5mdWxsc2NyZWVuLmFjdGl2ZSkge1xuICAgICAgICB3cmFwcGVyLnN0eWxlLnBhZGRpbmdCb3R0b20gPSBudWxsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5tZWRpYS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWSgtJHtvZmZzZXR9JSlgO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQodGhpcy5jb25maWcuY2xhc3NOYW1lcy52aWRlb0ZpeGVkUmF0aW8pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBwYWRkaW5nLFxuICAgICAgcmF0aW9cbiAgICB9O1xuICB9IC8vIFJvdW5kIGFuIGFzcGVjdCByYXRpbyB0byBjbG9zZXN0IHN0YW5kYXJkIHJhdGlvXG5cbiAgZnVuY3Rpb24gcm91bmRBc3BlY3RSYXRpbyh4LCB5LCB0b2xlcmFuY2UgPSAwLjA1KSB7XG4gICAgY29uc3QgcmF0aW8gPSB4IC8geTtcbiAgICBjb25zdCBjbG9zZXN0UmF0aW8gPSBjbG9zZXN0KE9iamVjdC5rZXlzKHN0YW5kYXJkUmF0aW9zKSwgcmF0aW8pOyAvLyBDaGVjayBtYXRjaCBpcyB3aXRoaW4gdG9sZXJhbmNlXG5cbiAgICBpZiAoTWF0aC5hYnMoY2xvc2VzdFJhdGlvIC0gcmF0aW8pIDw9IHRvbGVyYW5jZSkge1xuICAgICAgcmV0dXJuIHN0YW5kYXJkUmF0aW9zW2Nsb3Nlc3RSYXRpb107XG4gICAgfSAvLyBObyBtYXRjaFxuXG5cbiAgICByZXR1cm4gW3gsIHldO1xuICB9IC8vIEdldCB0aGUgc2l6ZSBvZiB0aGUgdmlld3BvcnRcbiAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTI0ODA4MS9ob3ctdG8tZ2V0LXRoZS1icm93c2VyLXZpZXdwb3J0LWRpbWVuc2lvbnNcblxuICBmdW5jdGlvbiBnZXRWaWV3cG9ydFNpemUoKSB7XG4gICAgY29uc3Qgd2lkdGggPSBNYXRoLm1heChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgMCwgd2luZG93LmlubmVyV2lkdGggfHwgMCk7XG4gICAgY29uc3QgaGVpZ2h0ID0gTWF0aC5tYXgoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCB8fCAwLCB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgMCk7XG4gICAgcmV0dXJuIFt3aWR0aCwgaGVpZ2h0XTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IGh0bWw1ID0ge1xuICAgIGdldFNvdXJjZXMoKSB7XG4gICAgICBpZiAoIXRoaXMuaXNIVE1MNSkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNvdXJjZXMgPSBBcnJheS5mcm9tKHRoaXMubWVkaWEucXVlcnlTZWxlY3RvckFsbCgnc291cmNlJykpOyAvLyBGaWx0ZXIgb3V0IHVuc3VwcG9ydGVkIHNvdXJjZXMgKGlmIHR5cGUgaXMgc3BlY2lmaWVkKVxuXG4gICAgICByZXR1cm4gc291cmNlcy5maWx0ZXIoc291cmNlID0+IHtcbiAgICAgICAgY29uc3QgdHlwZSA9IHNvdXJjZS5nZXRBdHRyaWJ1dGUoJ3R5cGUnKTtcblxuICAgICAgICBpZiAoaXMuZW1wdHkodHlwZSkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdXBwb3J0Lm1pbWUuY2FsbCh0aGlzLCB0eXBlKTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyBHZXQgcXVhbGl0eSBsZXZlbHNcbiAgICBnZXRRdWFsaXR5T3B0aW9ucygpIHtcbiAgICAgIC8vIFdoZXRoZXIgd2UncmUgZm9yY2luZyBhbGwgb3B0aW9ucyAoZS5nLiBmb3Igc3RyZWFtaW5nKVxuICAgICAgaWYgKHRoaXMuY29uZmlnLnF1YWxpdHkuZm9yY2VkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5xdWFsaXR5Lm9wdGlvbnM7XG4gICAgICB9IC8vIEdldCBzaXplcyBmcm9tIDxzb3VyY2U+IGVsZW1lbnRzXG5cblxuICAgICAgcmV0dXJuIGh0bWw1LmdldFNvdXJjZXMuY2FsbCh0aGlzKS5tYXAoc291cmNlID0+IE51bWJlcihzb3VyY2UuZ2V0QXR0cmlidXRlKCdzaXplJykpKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgfSxcblxuICAgIHNldHVwKCkge1xuICAgICAgaWYgKCF0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwbGF5ZXIgPSB0aGlzOyAvLyBTZXQgc3BlZWQgb3B0aW9ucyBmcm9tIGNvbmZpZ1xuXG4gICAgICBwbGF5ZXIub3B0aW9ucy5zcGVlZCA9IHBsYXllci5jb25maWcuc3BlZWQub3B0aW9uczsgLy8gU2V0IGFzcGVjdCByYXRpbyBpZiBmaXhlZFxuXG4gICAgICBpZiAoIWlzLmVtcHR5KHRoaXMuY29uZmlnLnJhdGlvKSkge1xuICAgICAgICBzZXRBc3BlY3RSYXRpby5jYWxsKHBsYXllcik7XG4gICAgICB9IC8vIFF1YWxpdHlcblxuXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAncXVhbGl0eScsIHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIC8vIEdldCBzb3VyY2VzXG4gICAgICAgICAgY29uc3Qgc291cmNlcyA9IGh0bWw1LmdldFNvdXJjZXMuY2FsbChwbGF5ZXIpO1xuICAgICAgICAgIGNvbnN0IHNvdXJjZSA9IHNvdXJjZXMuZmluZChzID0+IHMuZ2V0QXR0cmlidXRlKCdzcmMnKSA9PT0gcGxheWVyLnNvdXJjZSk7IC8vIFJldHVybiBzaXplLCBpZiBtYXRjaCBpcyBmb3VuZFxuXG4gICAgICAgICAgcmV0dXJuIHNvdXJjZSAmJiBOdW1iZXIoc291cmNlLmdldEF0dHJpYnV0ZSgnc2l6ZScpKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgICBpZiAocGxheWVyLnF1YWxpdHkgPT09IGlucHV0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBJZiB3ZSdyZSB1c2luZyBhbiBleHRlcm5hbCBoYW5kbGVyLi4uXG5cblxuICAgICAgICAgIGlmIChwbGF5ZXIuY29uZmlnLnF1YWxpdHkuZm9yY2VkICYmIGlzLmZ1bmN0aW9uKHBsYXllci5jb25maWcucXVhbGl0eS5vbkNoYW5nZSkpIHtcbiAgICAgICAgICAgIHBsYXllci5jb25maWcucXVhbGl0eS5vbkNoYW5nZShpbnB1dCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEdldCBzb3VyY2VzXG4gICAgICAgICAgICBjb25zdCBzb3VyY2VzID0gaHRtbDUuZ2V0U291cmNlcy5jYWxsKHBsYXllcik7IC8vIEdldCBmaXJzdCBtYXRjaCBmb3IgcmVxdWVzdGVkIHNpemVcblxuICAgICAgICAgICAgY29uc3Qgc291cmNlID0gc291cmNlcy5maW5kKHMgPT4gTnVtYmVyKHMuZ2V0QXR0cmlidXRlKCdzaXplJykpID09PSBpbnB1dCk7IC8vIE5vIG1hdGNoaW5nIHNvdXJjZSBmb3VuZFxuXG4gICAgICAgICAgICBpZiAoIXNvdXJjZSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IC8vIEdldCBjdXJyZW50IHN0YXRlXG5cblxuICAgICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgICBjdXJyZW50VGltZSxcbiAgICAgICAgICAgICAgcGF1c2VkLFxuICAgICAgICAgICAgICBwcmVsb2FkLFxuICAgICAgICAgICAgICByZWFkeVN0YXRlLFxuICAgICAgICAgICAgICBwbGF5YmFja1JhdGVcbiAgICAgICAgICAgIH0gPSBwbGF5ZXIubWVkaWE7IC8vIFNldCBuZXcgc291cmNlXG5cbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5zcmMgPSBzb3VyY2UuZ2V0QXR0cmlidXRlKCdzcmMnKTsgLy8gUHJldmVudCBsb2FkaW5nIGlmIHByZWxvYWQ9XCJub25lXCIgYW5kIHRoZSBjdXJyZW50IHNvdXJjZSBpc24ndCBsb2FkZWQgKCMxMDQ0KVxuXG4gICAgICAgICAgICBpZiAocHJlbG9hZCAhPT0gJ25vbmUnIHx8IHJlYWR5U3RhdGUpIHtcbiAgICAgICAgICAgICAgLy8gUmVzdG9yZSB0aW1lXG4gICAgICAgICAgICAgIHBsYXllci5vbmNlKCdsb2FkZWRtZXRhZGF0YScsICgpID0+IHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuc3BlZWQgPSBwbGF5YmFja1JhdGU7XG4gICAgICAgICAgICAgICAgcGxheWVyLmN1cnJlbnRUaW1lID0gY3VycmVudFRpbWU7IC8vIFJlc3VtZSBwbGF5aW5nXG5cbiAgICAgICAgICAgICAgICBpZiAoIXBhdXNlZCkge1xuICAgICAgICAgICAgICAgICAgc2lsZW5jZVByb21pc2UocGxheWVyLnBsYXkoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTsgLy8gTG9hZCBuZXcgc291cmNlXG5cbiAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLmxvYWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IC8vIFRyaWdnZXIgY2hhbmdlIGV2ZW50XG5cblxuICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncXVhbGl0eWNoYW5nZScsIGZhbHNlLCB7XG4gICAgICAgICAgICBxdWFsaXR5OiBpbnB1dFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyBDYW5jZWwgY3VycmVudCBuZXR3b3JrIHJlcXVlc3RzXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy8xNzRcbiAgICBjYW5jZWxSZXF1ZXN0cygpIHtcbiAgICAgIGlmICghdGhpcy5pc0hUTUw1KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gUmVtb3ZlIGNoaWxkIHNvdXJjZXNcblxuXG4gICAgICByZW1vdmVFbGVtZW50KGh0bWw1LmdldFNvdXJjZXMuY2FsbCh0aGlzKSk7IC8vIFNldCBibGFuayB2aWRlbyBzcmMgYXR0cmlidXRlXG4gICAgICAvLyBUaGlzIGlzIHRvIHByZXZlbnQgYSBNRURJQV9FUlJfU1JDX05PVF9TVVBQT1JURUQgZXJyb3JcbiAgICAgIC8vIEluZm86IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzIyMzE1NzkvaG93LXRvLXByb3Blcmx5LWRpc3Bvc2Utb2YtYW4taHRtbDUtdmlkZW8tYW5kLWNsb3NlLXNvY2tldC1vci1jb25uZWN0aW9uXG5cbiAgICAgIHRoaXMubWVkaWEuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLmNvbmZpZy5ibGFua1ZpZGVvKTsgLy8gTG9hZCB0aGUgbmV3IGVtcHR5IHNvdXJjZVxuICAgICAgLy8gVGhpcyB3aWxsIGNhbmNlbCBleGlzdGluZyByZXF1ZXN0c1xuICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy8xNzRcblxuICAgICAgdGhpcy5tZWRpYS5sb2FkKCk7IC8vIERlYnVnZ2luZ1xuXG4gICAgICB0aGlzLmRlYnVnLmxvZygnQ2FuY2VsbGVkIG5ldHdvcmsgcmVxdWVzdHMnKTtcbiAgICB9XG5cbiAgfTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGZ1bmN0aW9uIGdlbmVyYXRlSWQocHJlZml4KSB7XG4gICAgcmV0dXJuIGAke3ByZWZpeH0tJHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCl9YDtcbiAgfSAvLyBGb3JtYXQgc3RyaW5nXG5cbiAgZnVuY3Rpb24gZm9ybWF0KGlucHV0LCAuLi5hcmdzKSB7XG4gICAgaWYgKGlzLmVtcHR5KGlucHV0KSkgcmV0dXJuIGlucHV0O1xuICAgIHJldHVybiBpbnB1dC50b1N0cmluZygpLnJlcGxhY2UoL3soXFxkKyl9L2csIChtYXRjaCwgaSkgPT4gYXJnc1tpXS50b1N0cmluZygpKTtcbiAgfSAvLyBHZXQgcGVyY2VudGFnZVxuXG4gIGZ1bmN0aW9uIGdldFBlcmNlbnRhZ2UoY3VycmVudCwgbWF4KSB7XG4gICAgaWYgKGN1cnJlbnQgPT09IDAgfHwgbWF4ID09PSAwIHx8IE51bWJlci5pc05hTihjdXJyZW50KSB8fCBOdW1iZXIuaXNOYU4obWF4KSkge1xuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgcmV0dXJuIChjdXJyZW50IC8gbWF4ICogMTAwKS50b0ZpeGVkKDIpO1xuICB9IC8vIFJlcGxhY2UgYWxsIG9jY3VycmVuY2VzIG9mIGEgc3RyaW5nIGluIGEgc3RyaW5nXG5cbiAgY29uc3QgcmVwbGFjZUFsbCA9IChpbnB1dCA9ICcnLCBmaW5kID0gJycsIHJlcGxhY2UgPSAnJykgPT4gaW5wdXQucmVwbGFjZShuZXcgUmVnRXhwKGZpbmQudG9TdHJpbmcoKS5yZXBsYWNlKC8oWy4qKz9ePSE6JHt9KCl8W1xcXS9cXFxcXSkvZywgJ1xcXFwkMScpLCAnZycpLCByZXBsYWNlLnRvU3RyaW5nKCkpOyAvLyBDb252ZXJ0IHRvIHRpdGxlIGNhc2VcblxuICBjb25zdCB0b1RpdGxlQ2FzZSA9IChpbnB1dCA9ICcnKSA9PiBpbnB1dC50b1N0cmluZygpLnJlcGxhY2UoL1xcd1xcUyovZywgdGV4dCA9PiB0ZXh0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGV4dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpKTsgLy8gQ29udmVydCBzdHJpbmcgdG8gcGFzY2FsQ2FzZVxuXG4gIGZ1bmN0aW9uIHRvUGFzY2FsQ2FzZShpbnB1dCA9ICcnKSB7XG4gICAgbGV0IHN0cmluZyA9IGlucHV0LnRvU3RyaW5nKCk7IC8vIENvbnZlcnQga2ViYWIgY2FzZVxuXG4gICAgc3RyaW5nID0gcmVwbGFjZUFsbChzdHJpbmcsICctJywgJyAnKTsgLy8gQ29udmVydCBzbmFrZSBjYXNlXG5cbiAgICBzdHJpbmcgPSByZXBsYWNlQWxsKHN0cmluZywgJ18nLCAnICcpOyAvLyBDb252ZXJ0IHRvIHRpdGxlIGNhc2VcblxuICAgIHN0cmluZyA9IHRvVGl0bGVDYXNlKHN0cmluZyk7IC8vIENvbnZlcnQgdG8gcGFzY2FsIGNhc2VcblxuICAgIHJldHVybiByZXBsYWNlQWxsKHN0cmluZywgJyAnLCAnJyk7XG4gIH0gLy8gQ29udmVydCBzdHJpbmcgdG8gcGFzY2FsQ2FzZVxuXG4gIGZ1bmN0aW9uIHRvQ2FtZWxDYXNlKGlucHV0ID0gJycpIHtcbiAgICBsZXQgc3RyaW5nID0gaW5wdXQudG9TdHJpbmcoKTsgLy8gQ29udmVydCB0byBwYXNjYWwgY2FzZVxuXG4gICAgc3RyaW5nID0gdG9QYXNjYWxDYXNlKHN0cmluZyk7IC8vIENvbnZlcnQgZmlyc3QgY2hhcmFjdGVyIHRvIGxvd2VyY2FzZVxuXG4gICAgcmV0dXJuIHN0cmluZy5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIHN0cmluZy5zbGljZSgxKTtcbiAgfSAvLyBSZW1vdmUgSFRNTCBmcm9tIGEgc3RyaW5nXG5cbiAgZnVuY3Rpb24gc3RyaXBIVE1MKHNvdXJjZSkge1xuICAgIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChlbGVtZW50KTtcbiAgICBlbGVtZW50LmlubmVySFRNTCA9IHNvdXJjZTtcbiAgICByZXR1cm4gZnJhZ21lbnQuZmlyc3RDaGlsZC5pbm5lclRleHQ7XG4gIH0gLy8gTGlrZSBvdXRlckhUTUwsIGJ1dCBhbHNvIHdvcmtzIGZvciBEb2N1bWVudEZyYWdtZW50XG5cbiAgZnVuY3Rpb24gZ2V0SFRNTChlbGVtZW50KSB7XG4gICAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gICAgcmV0dXJuIHdyYXBwZXIuaW5uZXJIVE1MO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCByZXNvdXJjZXMgPSB7XG4gICAgcGlwOiAnUElQJyxcbiAgICBhaXJwbGF5OiAnQWlyUGxheScsXG4gICAgaHRtbDU6ICdIVE1MNScsXG4gICAgdmltZW86ICdWaW1lbycsXG4gICAgeW91dHViZTogJ1lvdVR1YmUnXG4gIH07XG4gIGNvbnN0IGkxOG4gPSB7XG4gICAgZ2V0KGtleSA9ICcnLCBjb25maWcgPSB7fSkge1xuICAgICAgaWYgKGlzLmVtcHR5KGtleSkgfHwgaXMuZW1wdHkoY29uZmlnKSkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9XG5cbiAgICAgIGxldCBzdHJpbmcgPSBnZXREZWVwKGNvbmZpZy5pMThuLCBrZXkpO1xuXG4gICAgICBpZiAoaXMuZW1wdHkoc3RyaW5nKSkge1xuICAgICAgICBpZiAoT2JqZWN0LmtleXMocmVzb3VyY2VzKS5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc291cmNlc1trZXldO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICcnO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXBsYWNlID0ge1xuICAgICAgICAne3NlZWt0aW1lfSc6IGNvbmZpZy5zZWVrVGltZSxcbiAgICAgICAgJ3t0aXRsZX0nOiBjb25maWcudGl0bGVcbiAgICAgIH07XG4gICAgICBPYmplY3QuZW50cmllcyhyZXBsYWNlKS5mb3JFYWNoKChbaywgdl0pID0+IHtcbiAgICAgICAgc3RyaW5nID0gcmVwbGFjZUFsbChzdHJpbmcsIGssIHYpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH1cblxuICB9O1xuXG4gIGNsYXNzIFN0b3JhZ2Uge1xuICAgIGNvbnN0cnVjdG9yKHBsYXllcikge1xuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJnZXRcIiwga2V5ID0+IHtcbiAgICAgICAgaWYgKCFTdG9yYWdlLnN1cHBvcnRlZCB8fCAhdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdG9yZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmtleSk7XG5cbiAgICAgICAgaWYgKGlzLmVtcHR5KHN0b3JlKSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QganNvbiA9IEpTT04ucGFyc2Uoc3RvcmUpO1xuICAgICAgICByZXR1cm4gaXMuc3RyaW5nKGtleSkgJiYga2V5Lmxlbmd0aCA/IGpzb25ba2V5XSA6IGpzb247XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJzZXRcIiwgb2JqZWN0ID0+IHtcbiAgICAgICAgLy8gQmFpbCBpZiB3ZSBkb24ndCBoYXZlIGxvY2FsU3RvcmFnZSBzdXBwb3J0IG9yIGl0J3MgZGlzYWJsZWRcbiAgICAgICAgaWYgKCFTdG9yYWdlLnN1cHBvcnRlZCB8fCAhdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIENhbiBvbmx5IHN0b3JlIG9iamVjdHN0XG5cblxuICAgICAgICBpZiAoIWlzLm9iamVjdChvYmplY3QpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIEdldCBjdXJyZW50IHN0b3JhZ2VcblxuXG4gICAgICAgIGxldCBzdG9yYWdlID0gdGhpcy5nZXQoKTsgLy8gRGVmYXVsdCB0byBlbXB0eSBvYmplY3RcblxuICAgICAgICBpZiAoaXMuZW1wdHkoc3RvcmFnZSkpIHtcbiAgICAgICAgICBzdG9yYWdlID0ge307XG4gICAgICAgIH0gLy8gVXBkYXRlIHRoZSB3b3JraW5nIGNvcHkgb2YgdGhlIHZhbHVlc1xuXG5cbiAgICAgICAgZXh0ZW5kKHN0b3JhZ2UsIG9iamVjdCk7IC8vIFVwZGF0ZSBzdG9yYWdlXG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5rZXksIEpTT04uc3RyaW5naWZ5KHN0b3JhZ2UpKTtcbiAgICAgICAgfSBjYXRjaCAoXykgey8vIERvIG5vdGhpbmdcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuZW5hYmxlZCA9IHBsYXllci5jb25maWcuc3RvcmFnZS5lbmFibGVkO1xuICAgICAgdGhpcy5rZXkgPSBwbGF5ZXIuY29uZmlnLnN0b3JhZ2Uua2V5O1xuICAgIH0gLy8gQ2hlY2sgZm9yIGFjdHVhbCBzdXBwb3J0IChzZWUgaWYgd2UgY2FuIHVzZSBpdClcblxuXG4gICAgc3RhdGljIGdldCBzdXBwb3J0ZWQoKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoISgnbG9jYWxTdG9yYWdlJyBpbiB3aW5kb3cpKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdGVzdCA9ICdfX190ZXN0JzsgLy8gVHJ5IHRvIHVzZSBpdCAoaXQgbWlnaHQgYmUgZGlzYWJsZWQsIGUuZy4gdXNlciBpcyBpbiBwcml2YXRlIG1vZGUpXG4gICAgICAgIC8vIHNlZTogaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzEzMVxuXG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0ZXN0LCB0ZXN0KTtcbiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRlc3QpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gRmV0Y2ggd3JhcHBlclxuICAvLyBVc2luZyBYSFIgdG8gYXZvaWQgaXNzdWVzIHdpdGggb2xkZXIgYnJvd3NlcnNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZnVuY3Rpb24gZmV0Y2godXJsLCByZXNwb25zZVR5cGUgPSAndGV4dCcpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOyAvLyBDaGVjayBmb3IgQ09SUyBzdXBwb3J0XG5cbiAgICAgICAgaWYgKCEoJ3dpdGhDcmVkZW50aWFscycgaW4gcmVxdWVzdCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlVHlwZSA9PT0gJ3RleHQnKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICByZXNvbHZlKEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgICAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc29sdmUocmVxdWVzdC5yZXNwb25zZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsICgpID0+IHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVxdWVzdC5zdGF0dXMpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdC5vcGVuKCdHRVQnLCB1cmwsIHRydWUpOyAvLyBTZXQgdGhlIHJlcXVpcmVkIHJlc3BvbnNlIHR5cGVcblxuICAgICAgICByZXF1ZXN0LnJlc3BvbnNlVHlwZSA9IHJlc3BvbnNlVHlwZTtcbiAgICAgICAgcmVxdWVzdC5zZW5kKCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBsb2FkU3ByaXRlKHVybCwgaWQpIHtcbiAgICBpZiAoIWlzLnN0cmluZyh1cmwpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcHJlZml4ID0gJ2NhY2hlJztcbiAgICBjb25zdCBoYXNJZCA9IGlzLnN0cmluZyhpZCk7XG4gICAgbGV0IGlzQ2FjaGVkID0gZmFsc2U7XG5cbiAgICBjb25zdCBleGlzdHMgPSAoKSA9PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkgIT09IG51bGw7XG5cbiAgICBjb25zdCB1cGRhdGUgPSAoY29udGFpbmVyLCBkYXRhKSA9PiB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBkYXRhOyAvLyBDaGVjayBhZ2FpbiBpbmNhc2Ugb2YgcmFjZSBjb25kaXRpb25cblxuICAgICAgaWYgKGhhc0lkICYmIGV4aXN0cygpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gSW5qZWN0IHRoZSBTVkcgdG8gdGhlIGJvZHlcblxuXG4gICAgICBkb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIGNvbnRhaW5lcik7XG4gICAgfTsgLy8gT25seSBsb2FkIG9uY2UgaWYgSUQgc2V0XG5cblxuICAgIGlmICghaGFzSWQgfHwgIWV4aXN0cygpKSB7XG4gICAgICBjb25zdCB1c2VTdG9yYWdlID0gU3RvcmFnZS5zdXBwb3J0ZWQ7IC8vIENyZWF0ZSBjb250YWluZXJcblxuICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdoaWRkZW4nLCAnJyk7XG5cbiAgICAgIGlmIChoYXNJZCkge1xuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKCdpZCcsIGlkKTtcbiAgICAgIH0gLy8gQ2hlY2sgaW4gY2FjaGVcblxuXG4gICAgICBpZiAodXNlU3RvcmFnZSkge1xuICAgICAgICBjb25zdCBjYWNoZWQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oYCR7cHJlZml4fS0ke2lkfWApO1xuICAgICAgICBpc0NhY2hlZCA9IGNhY2hlZCAhPT0gbnVsbDtcblxuICAgICAgICBpZiAoaXNDYWNoZWQpIHtcbiAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShjYWNoZWQpO1xuICAgICAgICAgIHVwZGF0ZShjb250YWluZXIsIGRhdGEuY29udGVudCk7XG4gICAgICAgIH1cbiAgICAgIH0gLy8gR2V0IHRoZSBzcHJpdGVcblxuXG4gICAgICBmZXRjaCh1cmwpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgaWYgKGlzLmVtcHR5KHJlc3VsdCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodXNlU3RvcmFnZSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oYCR7cHJlZml4fS0ke2lkfWAsIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgY29udGVudDogcmVzdWx0XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgfSBjYXRjaCAoXykgey8vIERvIG5vdGhpbmdcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGUoY29udGFpbmVyLCByZXN1bHQpO1xuICAgICAgfSkuY2F0Y2goKCkgPT4ge30pO1xuICAgIH1cbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgY29uc3QgZ2V0SG91cnMgPSB2YWx1ZSA9PiBNYXRoLnRydW5jKHZhbHVlIC8gNjAgLyA2MCAlIDYwLCAxMCk7XG4gIGNvbnN0IGdldE1pbnV0ZXMgPSB2YWx1ZSA9PiBNYXRoLnRydW5jKHZhbHVlIC8gNjAgJSA2MCwgMTApO1xuICBjb25zdCBnZXRTZWNvbmRzID0gdmFsdWUgPT4gTWF0aC50cnVuYyh2YWx1ZSAlIDYwLCAxMCk7IC8vIEZvcm1hdCB0aW1lIHRvIFVJIGZyaWVuZGx5IHN0cmluZ1xuXG4gIGZ1bmN0aW9uIGZvcm1hdFRpbWUodGltZSA9IDAsIGRpc3BsYXlIb3VycyA9IGZhbHNlLCBpbnZlcnRlZCA9IGZhbHNlKSB7XG4gICAgLy8gQmFpbCBpZiB0aGUgdmFsdWUgaXNuJ3QgYSBudW1iZXJcbiAgICBpZiAoIWlzLm51bWJlcih0aW1lKSkge1xuICAgICAgcmV0dXJuIGZvcm1hdFRpbWUodW5kZWZpbmVkLCBkaXNwbGF5SG91cnMsIGludmVydGVkKTtcbiAgICB9IC8vIEZvcm1hdCB0aW1lIGNvbXBvbmVudCB0byBhZGQgbGVhZGluZyB6ZXJvXG5cblxuICAgIGNvbnN0IGZvcm1hdCA9IHZhbHVlID0+IGAwJHt2YWx1ZX1gLnNsaWNlKC0yKTsgLy8gQnJlYWtkb3duIHRvIGhvdXJzLCBtaW5zLCBzZWNzXG5cblxuICAgIGxldCBob3VycyA9IGdldEhvdXJzKHRpbWUpO1xuICAgIGNvbnN0IG1pbnMgPSBnZXRNaW51dGVzKHRpbWUpO1xuICAgIGNvbnN0IHNlY3MgPSBnZXRTZWNvbmRzKHRpbWUpOyAvLyBEbyB3ZSBuZWVkIHRvIGRpc3BsYXkgaG91cnM/XG5cbiAgICBpZiAoZGlzcGxheUhvdXJzIHx8IGhvdXJzID4gMCkge1xuICAgICAgaG91cnMgPSBgJHtob3Vyc306YDtcbiAgICB9IGVsc2Uge1xuICAgICAgaG91cnMgPSAnJztcbiAgICB9IC8vIFJlbmRlclxuXG5cbiAgICByZXR1cm4gYCR7aW52ZXJ0ZWQgJiYgdGltZSA+IDAgPyAnLScgOiAnJ30ke2hvdXJzfSR7Zm9ybWF0KG1pbnMpfToke2Zvcm1hdChzZWNzKX1gO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBjb25zdCBjb250cm9scyA9IHtcbiAgICAvLyBHZXQgaWNvbiBVUkxcbiAgICBnZXRJY29uVXJsKCkge1xuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTCh0aGlzLmNvbmZpZy5pY29uVXJsLCB3aW5kb3cubG9jYXRpb24pO1xuICAgICAgY29uc3QgaG9zdCA9IHdpbmRvdy5sb2NhdGlvbi5ob3N0ID8gd2luZG93LmxvY2F0aW9uLmhvc3QgOiB3aW5kb3cudG9wLmxvY2F0aW9uLmhvc3Q7XG4gICAgICBjb25zdCBjb3JzID0gdXJsLmhvc3QgIT09IGhvc3QgfHwgYnJvd3Nlci5pc0lFICYmICF3aW5kb3cuc3ZnNGV2ZXJ5Ym9keTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVybDogdGhpcy5jb25maWcuaWNvblVybCxcbiAgICAgICAgY29yc1xuICAgICAgfTtcbiAgICB9LFxuXG4gICAgLy8gRmluZCB0aGUgVUkgY29udHJvbHNcbiAgICBmaW5kRWxlbWVudHMoKSB7XG4gICAgICB0cnkge1xuICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xzID0gZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jb250cm9scy53cmFwcGVyKTsgLy8gQnV0dG9uc1xuXG4gICAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9ucyA9IHtcbiAgICAgICAgICBwbGF5OiBnZXRFbGVtZW50cy5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnBsYXkpLFxuICAgICAgICAgIHBhdXNlOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMucGF1c2UpLFxuICAgICAgICAgIHJlc3RhcnQ6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5yZXN0YXJ0KSxcbiAgICAgICAgICByZXdpbmQ6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5yZXdpbmQpLFxuICAgICAgICAgIGZhc3RGb3J3YXJkOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuZmFzdEZvcndhcmQpLFxuICAgICAgICAgIG11dGU6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5tdXRlKSxcbiAgICAgICAgICBwaXA6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5waXApLFxuICAgICAgICAgIGFpcnBsYXk6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5haXJwbGF5KSxcbiAgICAgICAgICBzZXR0aW5nczogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnNldHRpbmdzKSxcbiAgICAgICAgICBjYXB0aW9uczogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLmNhcHRpb25zKSxcbiAgICAgICAgICBmdWxsc2NyZWVuOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuZnVsbHNjcmVlbilcbiAgICAgICAgfTsgLy8gUHJvZ3Jlc3NcblxuICAgICAgICB0aGlzLmVsZW1lbnRzLnByb2dyZXNzID0gZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5wcm9ncmVzcyk7IC8vIElucHV0c1xuXG4gICAgICAgIHRoaXMuZWxlbWVudHMuaW5wdXRzID0ge1xuICAgICAgICAgIHNlZWs6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuaW5wdXRzLnNlZWspLFxuICAgICAgICAgIHZvbHVtZTogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5pbnB1dHMudm9sdW1lKVxuICAgICAgICB9OyAvLyBEaXNwbGF5XG5cbiAgICAgICAgdGhpcy5lbGVtZW50cy5kaXNwbGF5ID0ge1xuICAgICAgICAgIGJ1ZmZlcjogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5kaXNwbGF5LmJ1ZmZlciksXG4gICAgICAgICAgY3VycmVudFRpbWU6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuZGlzcGxheS5jdXJyZW50VGltZSksXG4gICAgICAgICAgZHVyYXRpb246IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuZGlzcGxheS5kdXJhdGlvbilcbiAgICAgICAgfTsgLy8gU2VlayB0b29sdGlwXG5cbiAgICAgICAgaWYgKGlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5wcm9ncmVzcykpIHtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXAgPSB0aGlzLmVsZW1lbnRzLnByb2dyZXNzLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcH1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gTG9nIGl0XG4gICAgICAgIHRoaXMuZGVidWcud2FybignSXQgbG9va3MgbGlrZSB0aGVyZSBpcyBhIHByb2JsZW0gd2l0aCB5b3VyIGN1c3RvbSBjb250cm9scyBIVE1MJywgZXJyb3IpOyAvLyBSZXN0b3JlIG5hdGl2ZSB2aWRlbyBjb250cm9sc1xuXG4gICAgICAgIHRoaXMudG9nZ2xlTmF0aXZlQ29udHJvbHModHJ1ZSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gQ3JlYXRlIDxzdmc+IGljb25cbiAgICBjcmVhdGVJY29uKHR5cGUsIGF0dHJpYnV0ZXMpIHtcbiAgICAgIGNvbnN0IG5hbWVzcGFjZSA9ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc7XG4gICAgICBjb25zdCBpY29uVXJsID0gY29udHJvbHMuZ2V0SWNvblVybC5jYWxsKHRoaXMpO1xuICAgICAgY29uc3QgaWNvblBhdGggPSBgJHshaWNvblVybC5jb3JzID8gaWNvblVybC51cmwgOiAnJ30jJHt0aGlzLmNvbmZpZy5pY29uUHJlZml4fWA7IC8vIENyZWF0ZSA8c3ZnPlxuXG4gICAgICBjb25zdCBpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKG5hbWVzcGFjZSwgJ3N2ZycpO1xuICAgICAgc2V0QXR0cmlidXRlcyhpY29uLCBleHRlbmQoYXR0cmlidXRlcywge1xuICAgICAgICAnYXJpYS1oaWRkZW4nOiAndHJ1ZScsXG4gICAgICAgIGZvY3VzYWJsZTogJ2ZhbHNlJ1xuICAgICAgfSkpOyAvLyBDcmVhdGUgdGhlIDx1c2U+IHRvIHJlZmVyZW5jZSBzcHJpdGVcblxuICAgICAgY29uc3QgdXNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKG5hbWVzcGFjZSwgJ3VzZScpO1xuICAgICAgY29uc3QgcGF0aCA9IGAke2ljb25QYXRofS0ke3R5cGV9YDsgLy8gU2V0IGBocmVmYCBhdHRyaWJ1dGVzXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvNDYwXG4gICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9TVkcvQXR0cmlidXRlL3hsaW5rOmhyZWZcblxuICAgICAgaWYgKCdocmVmJyBpbiB1c2UpIHtcbiAgICAgICAgdXNlLnNldEF0dHJpYnV0ZU5TKCdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJywgJ2hyZWYnLCBwYXRoKTtcbiAgICAgIH0gLy8gQWx3YXlzIHNldCB0aGUgb2xkZXIgYXR0cmlidXRlIGV2ZW4gdGhvdWdoIGl0J3MgXCJkZXByZWNhdGVkXCIgKGl0J2xsIGJlIGFyb3VuZCBmb3IgYWdlcylcblxuXG4gICAgICB1c2Uuc2V0QXR0cmlidXRlTlMoJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnLCAneGxpbms6aHJlZicsIHBhdGgpOyAvLyBBZGQgPHVzZT4gdG8gPHN2Zz5cblxuICAgICAgaWNvbi5hcHBlbmRDaGlsZCh1c2UpO1xuICAgICAgcmV0dXJuIGljb247XG4gICAgfSxcblxuICAgIC8vIENyZWF0ZSBoaWRkZW4gdGV4dCBsYWJlbFxuICAgIGNyZWF0ZUxhYmVsKGtleSwgYXR0ciA9IHt9KSB7XG4gICAgICBjb25zdCB0ZXh0ID0gaTE4bi5nZXQoa2V5LCB0aGlzLmNvbmZpZyk7XG4gICAgICBjb25zdCBhdHRyaWJ1dGVzID0geyAuLi5hdHRyLFxuICAgICAgICBjbGFzczogW2F0dHIuY2xhc3MsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaGlkZGVuXS5maWx0ZXIoQm9vbGVhbikuam9pbignICcpXG4gICAgICB9O1xuICAgICAgcmV0dXJuIGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCBhdHRyaWJ1dGVzLCB0ZXh0KTtcbiAgICB9LFxuXG4gICAgLy8gQ3JlYXRlIGEgYmFkZ2VcbiAgICBjcmVhdGVCYWRnZSh0ZXh0KSB7XG4gICAgICBpZiAoaXMuZW1wdHkodGV4dCkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGJhZGdlID0gY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMubWVudS52YWx1ZVxuICAgICAgfSk7XG4gICAgICBiYWRnZS5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5tZW51LmJhZGdlXG4gICAgICB9LCB0ZXh0KSk7XG4gICAgICByZXR1cm4gYmFkZ2U7XG4gICAgfSxcblxuICAgIC8vIENyZWF0ZSBhIDxidXR0b24+XG4gICAgY3JlYXRlQnV0dG9uKGJ1dHRvblR5cGUsIGF0dHIpIHtcbiAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBleHRlbmQoe30sIGF0dHIpO1xuICAgICAgbGV0IHR5cGUgPSB0b0NhbWVsQ2FzZShidXR0b25UeXBlKTtcbiAgICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgICBlbGVtZW50OiAnYnV0dG9uJyxcbiAgICAgICAgdG9nZ2xlOiBmYWxzZSxcbiAgICAgICAgbGFiZWw6IG51bGwsXG4gICAgICAgIGljb246IG51bGwsXG4gICAgICAgIGxhYmVsUHJlc3NlZDogbnVsbCxcbiAgICAgICAgaWNvblByZXNzZWQ6IG51bGxcbiAgICAgIH07XG4gICAgICBbJ2VsZW1lbnQnLCAnaWNvbicsICdsYWJlbCddLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICBwcm9wc1trZXldID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICAgIGRlbGV0ZSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgIH0pOyAvLyBEZWZhdWx0IHRvICdidXR0b24nIHR5cGUgdG8gcHJldmVudCBmb3JtIHN1Ym1pc3Npb25cblxuICAgICAgaWYgKHByb3BzLmVsZW1lbnQgPT09ICdidXR0b24nICYmICFPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5pbmNsdWRlcygndHlwZScpKSB7XG4gICAgICAgIGF0dHJpYnV0ZXMudHlwZSA9ICdidXR0b24nO1xuICAgICAgfSAvLyBTZXQgY2xhc3MgbmFtZVxuXG5cbiAgICAgIGlmIChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5pbmNsdWRlcygnY2xhc3MnKSkge1xuICAgICAgICBpZiAoIWF0dHJpYnV0ZXMuY2xhc3Muc3BsaXQoJyAnKS5zb21lKGMgPT4gYyA9PT0gdGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sKSkge1xuICAgICAgICAgIGV4dGVuZChhdHRyaWJ1dGVzLCB7XG4gICAgICAgICAgICBjbGFzczogYCR7YXR0cmlidXRlcy5jbGFzc30gJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9YFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gdGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sO1xuICAgICAgfSAvLyBMYXJnZSBwbGF5IGJ1dHRvblxuXG5cbiAgICAgIHN3aXRjaCAoYnV0dG9uVHlwZSkge1xuICAgICAgICBjYXNlICdwbGF5JzpcbiAgICAgICAgICBwcm9wcy50b2dnbGUgPSB0cnVlO1xuICAgICAgICAgIHByb3BzLmxhYmVsID0gJ3BsYXknO1xuICAgICAgICAgIHByb3BzLmxhYmVsUHJlc3NlZCA9ICdwYXVzZSc7XG4gICAgICAgICAgcHJvcHMuaWNvbiA9ICdwbGF5JztcbiAgICAgICAgICBwcm9wcy5pY29uUHJlc3NlZCA9ICdwYXVzZSc7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnbXV0ZSc6XG4gICAgICAgICAgcHJvcHMudG9nZ2xlID0gdHJ1ZTtcbiAgICAgICAgICBwcm9wcy5sYWJlbCA9ICdtdXRlJztcbiAgICAgICAgICBwcm9wcy5sYWJlbFByZXNzZWQgPSAndW5tdXRlJztcbiAgICAgICAgICBwcm9wcy5pY29uID0gJ3ZvbHVtZSc7XG4gICAgICAgICAgcHJvcHMuaWNvblByZXNzZWQgPSAnbXV0ZWQnO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2NhcHRpb25zJzpcbiAgICAgICAgICBwcm9wcy50b2dnbGUgPSB0cnVlO1xuICAgICAgICAgIHByb3BzLmxhYmVsID0gJ2VuYWJsZUNhcHRpb25zJztcbiAgICAgICAgICBwcm9wcy5sYWJlbFByZXNzZWQgPSAnZGlzYWJsZUNhcHRpb25zJztcbiAgICAgICAgICBwcm9wcy5pY29uID0gJ2NhcHRpb25zLW9mZic7XG4gICAgICAgICAgcHJvcHMuaWNvblByZXNzZWQgPSAnY2FwdGlvbnMtb24nO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2Z1bGxzY3JlZW4nOlxuICAgICAgICAgIHByb3BzLnRvZ2dsZSA9IHRydWU7XG4gICAgICAgICAgcHJvcHMubGFiZWwgPSAnZW50ZXJGdWxsc2NyZWVuJztcbiAgICAgICAgICBwcm9wcy5sYWJlbFByZXNzZWQgPSAnZXhpdEZ1bGxzY3JlZW4nO1xuICAgICAgICAgIHByb3BzLmljb24gPSAnZW50ZXItZnVsbHNjcmVlbic7XG4gICAgICAgICAgcHJvcHMuaWNvblByZXNzZWQgPSAnZXhpdC1mdWxsc2NyZWVuJztcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdwbGF5LWxhcmdlJzpcbiAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzICs9IGAgJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9LS1vdmVybGFpZGA7XG4gICAgICAgICAgdHlwZSA9ICdwbGF5JztcbiAgICAgICAgICBwcm9wcy5sYWJlbCA9ICdwbGF5JztcbiAgICAgICAgICBwcm9wcy5pY29uID0gJ3BsYXknO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgaWYgKGlzLmVtcHR5KHByb3BzLmxhYmVsKSkge1xuICAgICAgICAgICAgcHJvcHMubGFiZWwgPSB0eXBlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChpcy5lbXB0eShwcm9wcy5pY29uKSkge1xuICAgICAgICAgICAgcHJvcHMuaWNvbiA9IGJ1dHRvblR5cGU7XG4gICAgICAgICAgfVxuXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGJ1dHRvbiA9IGNyZWF0ZUVsZW1lbnQocHJvcHMuZWxlbWVudCk7IC8vIFNldHVwIHRvZ2dsZSBpY29uIGFuZCBsYWJlbHNcblxuICAgICAgaWYgKHByb3BzLnRvZ2dsZSkge1xuICAgICAgICAvLyBJY29uXG4gICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChjb250cm9scy5jcmVhdGVJY29uLmNhbGwodGhpcywgcHJvcHMuaWNvblByZXNzZWQsIHtcbiAgICAgICAgICBjbGFzczogJ2ljb24tLXByZXNzZWQnXG4gICAgICAgIH0pKTtcbiAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGNvbnRyb2xzLmNyZWF0ZUljb24uY2FsbCh0aGlzLCBwcm9wcy5pY29uLCB7XG4gICAgICAgICAgY2xhc3M6ICdpY29uLS1ub3QtcHJlc3NlZCdcbiAgICAgICAgfSkpOyAvLyBMYWJlbC9Ub29sdGlwXG5cbiAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGNvbnRyb2xzLmNyZWF0ZUxhYmVsLmNhbGwodGhpcywgcHJvcHMubGFiZWxQcmVzc2VkLCB7XG4gICAgICAgICAgY2xhc3M6ICdsYWJlbC0tcHJlc3NlZCdcbiAgICAgICAgfSkpO1xuICAgICAgICBidXR0b24uYXBwZW5kQ2hpbGQoY29udHJvbHMuY3JlYXRlTGFiZWwuY2FsbCh0aGlzLCBwcm9wcy5sYWJlbCwge1xuICAgICAgICAgIGNsYXNzOiAnbGFiZWwtLW5vdC1wcmVzc2VkJ1xuICAgICAgICB9KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBidXR0b24uYXBwZW5kQ2hpbGQoY29udHJvbHMuY3JlYXRlSWNvbi5jYWxsKHRoaXMsIHByb3BzLmljb24pKTtcbiAgICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGNvbnRyb2xzLmNyZWF0ZUxhYmVsLmNhbGwodGhpcywgcHJvcHMubGFiZWwpKTtcbiAgICAgIH0gLy8gTWVyZ2UgYW5kIHNldCBhdHRyaWJ1dGVzXG5cblxuICAgICAgZXh0ZW5kKGF0dHJpYnV0ZXMsIGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnNbdHlwZV0sIGF0dHJpYnV0ZXMpKTtcbiAgICAgIHNldEF0dHJpYnV0ZXMoYnV0dG9uLCBhdHRyaWJ1dGVzKTsgLy8gV2UgaGF2ZSBtdWx0aXBsZSBwbGF5IGJ1dHRvbnNcblxuICAgICAgaWYgKHR5cGUgPT09ICdwbGF5Jykge1xuICAgICAgICBpZiAoIWlzLmFycmF5KHRoaXMuZWxlbWVudHMuYnV0dG9uc1t0eXBlXSkpIHtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnNbdHlwZV0gPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9uc1t0eXBlXS5wdXNoKGJ1dHRvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnNbdHlwZV0gPSBidXR0b247XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBidXR0b247XG4gICAgfSxcblxuICAgIC8vIENyZWF0ZSBhbiA8aW5wdXQgdHlwZT0ncmFuZ2UnPlxuICAgIGNyZWF0ZVJhbmdlKHR5cGUsIGF0dHJpYnV0ZXMpIHtcbiAgICAgIC8vIFNlZWsgaW5wdXRcbiAgICAgIGNvbnN0IGlucHV0ID0gY3JlYXRlRWxlbWVudCgnaW5wdXQnLCBleHRlbmQoZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuaW5wdXRzW3R5cGVdKSwge1xuICAgICAgICB0eXBlOiAncmFuZ2UnLFxuICAgICAgICBtaW46IDAsXG4gICAgICAgIG1heDogMTAwLFxuICAgICAgICBzdGVwOiAwLjAxLFxuICAgICAgICB2YWx1ZTogMCxcbiAgICAgICAgYXV0b2NvbXBsZXRlOiAnb2ZmJyxcbiAgICAgICAgLy8gQTExeSBmaXhlcyBmb3IgaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzkwNVxuICAgICAgICByb2xlOiAnc2xpZGVyJyxcbiAgICAgICAgJ2FyaWEtbGFiZWwnOiBpMThuLmdldCh0eXBlLCB0aGlzLmNvbmZpZyksXG4gICAgICAgICdhcmlhLXZhbHVlbWluJzogMCxcbiAgICAgICAgJ2FyaWEtdmFsdWVtYXgnOiAxMDAsXG4gICAgICAgICdhcmlhLXZhbHVlbm93JzogMFxuICAgICAgfSwgYXR0cmlidXRlcykpO1xuICAgICAgdGhpcy5lbGVtZW50cy5pbnB1dHNbdHlwZV0gPSBpbnB1dDsgLy8gU2V0IHRoZSBmaWxsIGZvciB3ZWJraXQgbm93XG5cbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVJhbmdlRmlsbC5jYWxsKHRoaXMsIGlucHV0KTsgLy8gSW1wcm92ZSBzdXBwb3J0IG9uIHRvdWNoIGRldmljZXNcblxuICAgICAgUmFuZ2VUb3VjaC5zZXR1cChpbnB1dCk7XG4gICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfSxcblxuICAgIC8vIENyZWF0ZSBhIDxwcm9ncmVzcz5cbiAgICBjcmVhdGVQcm9ncmVzcyh0eXBlLCBhdHRyaWJ1dGVzKSB7XG4gICAgICBjb25zdCBwcm9ncmVzcyA9IGNyZWF0ZUVsZW1lbnQoJ3Byb2dyZXNzJywgZXh0ZW5kKGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmRpc3BsYXlbdHlwZV0pLCB7XG4gICAgICAgIG1pbjogMCxcbiAgICAgICAgbWF4OiAxMDAsXG4gICAgICAgIHZhbHVlOiAwLFxuICAgICAgICByb2xlOiAncHJvZ3Jlc3NiYXInLFxuICAgICAgICAnYXJpYS1oaWRkZW4nOiB0cnVlXG4gICAgICB9LCBhdHRyaWJ1dGVzKSk7IC8vIENyZWF0ZSB0aGUgbGFiZWwgaW5zaWRlXG5cbiAgICAgIGlmICh0eXBlICE9PSAndm9sdW1lJykge1xuICAgICAgICBwcm9ncmVzcy5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KCdzcGFuJywgbnVsbCwgJzAnKSk7XG4gICAgICAgIGNvbnN0IHN1ZmZpeEtleSA9IHtcbiAgICAgICAgICBwbGF5ZWQ6ICdwbGF5ZWQnLFxuICAgICAgICAgIGJ1ZmZlcjogJ2J1ZmZlcmVkJ1xuICAgICAgICB9W3R5cGVdO1xuICAgICAgICBjb25zdCBzdWZmaXggPSBzdWZmaXhLZXkgPyBpMThuLmdldChzdWZmaXhLZXksIHRoaXMuY29uZmlnKSA6ICcnO1xuICAgICAgICBwcm9ncmVzcy5pbm5lclRleHQgPSBgJSAke3N1ZmZpeC50b0xvd2VyQ2FzZSgpfWA7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheVt0eXBlXSA9IHByb2dyZXNzO1xuICAgICAgcmV0dXJuIHByb2dyZXNzO1xuICAgIH0sXG5cbiAgICAvLyBDcmVhdGUgdGltZSBkaXNwbGF5XG4gICAgY3JlYXRlVGltZSh0eXBlLCBhdHRycykge1xuICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmRpc3BsYXlbdHlwZV0sIGF0dHJzKTtcbiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIGV4dGVuZChhdHRyaWJ1dGVzLCB7XG4gICAgICAgIGNsYXNzOiBgJHthdHRyaWJ1dGVzLmNsYXNzID8gYXR0cmlidXRlcy5jbGFzcyA6ICcnfSAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuZGlzcGxheS50aW1lfSBgLnRyaW0oKSxcbiAgICAgICAgJ2FyaWEtbGFiZWwnOiBpMThuLmdldCh0eXBlLCB0aGlzLmNvbmZpZylcbiAgICAgIH0pLCAnMDA6MDAnKTsgLy8gUmVmZXJlbmNlIGZvciB1cGRhdGVzXG5cbiAgICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheVt0eXBlXSA9IGNvbnRhaW5lcjtcbiAgICAgIHJldHVybiBjb250YWluZXI7XG4gICAgfSxcblxuICAgIC8vIEJpbmQga2V5Ym9hcmQgc2hvcnRjdXRzIGZvciBhIG1lbnUgaXRlbVxuICAgIC8vIFdlIGhhdmUgdG8gYmluZCB0byBrZXl1cCBvdGhlcndpc2UgRmlyZWZveCB0cmlnZ2VycyBhIGNsaWNrIHdoZW4gYSBrZXlkb3duIGV2ZW50IGhhbmRsZXIgc2hpZnRzIGZvY3VzXG4gICAgLy8gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTIyMDE0M1xuICAgIGJpbmRNZW51SXRlbVNob3J0Y3V0cyhtZW51SXRlbSwgdHlwZSkge1xuICAgICAgLy8gTmF2aWdhdGUgdGhyb3VnaCBtZW51cyB2aWEgYXJyb3cga2V5cyBhbmQgc3BhY2VcbiAgICAgIG9uLmNhbGwodGhpcywgbWVudUl0ZW0sICdrZXlkb3duIGtleXVwJywgZXZlbnQgPT4ge1xuICAgICAgICAvLyBXZSBvbmx5IGNhcmUgYWJvdXQgc3BhY2UgYW5kIOKshu+4jyDirIfvuI/vuI8g4p6h77iPXG4gICAgICAgIGlmICghWydTcGFjZScsICdBcnJvd1VwJywgJ0Fycm93RG93bicsICdBcnJvd1JpZ2h0J10uaW5jbHVkZXMoZXZlbnQua2V5KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBQcmV2ZW50IHBsYXkgLyBzZWVrXG5cblxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsgLy8gV2UncmUganVzdCBoZXJlIHRvIHByZXZlbnQgdGhlIGtleWRvd24gYnViYmxpbmdcblxuICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2tleWRvd24nKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaXNSYWRpb0J1dHRvbiA9IG1hdGNoZXMobWVudUl0ZW0sICdbcm9sZT1cIm1lbnVpdGVtcmFkaW9cIl0nKTsgLy8gU2hvdyB0aGUgcmVzcGVjdGl2ZSBtZW51XG5cbiAgICAgICAgaWYgKCFpc1JhZGlvQnV0dG9uICYmIFsnU3BhY2UnLCAnQXJyb3dSaWdodCddLmluY2x1ZGVzKGV2ZW50LmtleSkpIHtcbiAgICAgICAgICBjb250cm9scy5zaG93TWVudVBhbmVsLmNhbGwodGhpcywgdHlwZSwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbGV0IHRhcmdldDtcblxuICAgICAgICAgIGlmIChldmVudC5rZXkgIT09ICdTcGFjZScpIHtcbiAgICAgICAgICAgIGlmIChldmVudC5rZXkgPT09ICdBcnJvd0Rvd24nIHx8IGlzUmFkaW9CdXR0b24gJiYgZXZlbnQua2V5ID09PSAnQXJyb3dSaWdodCcpIHtcbiAgICAgICAgICAgICAgdGFyZ2V0ID0gbWVudUl0ZW0ubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gbWVudUl0ZW0ucGFyZW50Tm9kZS5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGFyZ2V0ID0gbWVudUl0ZW0ucHJldmlvdXNFbGVtZW50U2libGluZztcblxuICAgICAgICAgICAgICBpZiAoIWlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgIHRhcmdldCA9IG1lbnVJdGVtLnBhcmVudE5vZGUubGFzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZXRGb2N1cy5jYWxsKHRoaXMsIHRhcmdldCwgdHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBmYWxzZSk7IC8vIEVudGVyIHdpbGwgZmlyZSBhIGBjbGlja2AgZXZlbnQgYnV0IHdlIHN0aWxsIG5lZWQgdG8gbWFuYWdlIGZvY3VzXG4gICAgICAvLyBTbyB3ZSBiaW5kIHRvIGtleXVwIHdoaWNoIGZpcmVzIGFmdGVyIGFuZCBzZXQgZm9jdXMgaGVyZVxuXG4gICAgICBvbi5jYWxsKHRoaXMsIG1lbnVJdGVtLCAna2V5dXAnLCBldmVudCA9PiB7XG4gICAgICAgIGlmIChldmVudC5rZXkgIT09ICdSZXR1cm4nKSByZXR1cm47XG4gICAgICAgIGNvbnRyb2xzLmZvY3VzRmlyc3RNZW51SXRlbS5jYWxsKHRoaXMsIG51bGwsIHRydWUpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vIENyZWF0ZSBhIHNldHRpbmdzIG1lbnUgaXRlbVxuICAgIGNyZWF0ZU1lbnVJdGVtKHtcbiAgICAgIHZhbHVlLFxuICAgICAgbGlzdCxcbiAgICAgIHR5cGUsXG4gICAgICB0aXRsZSxcbiAgICAgIGJhZGdlID0gbnVsbCxcbiAgICAgIGNoZWNrZWQgPSBmYWxzZVxuICAgIH0pIHtcbiAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5pbnB1dHNbdHlwZV0pO1xuICAgICAgY29uc3QgbWVudUl0ZW0gPSBjcmVhdGVFbGVtZW50KCdidXR0b24nLCBleHRlbmQoYXR0cmlidXRlcywge1xuICAgICAgICB0eXBlOiAnYnV0dG9uJyxcbiAgICAgICAgcm9sZTogJ21lbnVpdGVtcmFkaW8nLFxuICAgICAgICBjbGFzczogYCR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sfSAke2F0dHJpYnV0ZXMuY2xhc3MgPyBhdHRyaWJ1dGVzLmNsYXNzIDogJyd9YC50cmltKCksXG4gICAgICAgICdhcmlhLWNoZWNrZWQnOiBjaGVja2VkLFxuICAgICAgICB2YWx1ZVxuICAgICAgfSkpO1xuICAgICAgY29uc3QgZmxleCA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsgLy8gV2UgaGF2ZSB0byBzZXQgYXMgSFRNTCBpbmNhc2Ugb2Ygc3BlY2lhbCBjaGFyYWN0ZXJzXG5cbiAgICAgIGZsZXguaW5uZXJIVE1MID0gdGl0bGU7XG5cbiAgICAgIGlmIChpcy5lbGVtZW50KGJhZGdlKSkge1xuICAgICAgICBmbGV4LmFwcGVuZENoaWxkKGJhZGdlKTtcbiAgICAgIH1cblxuICAgICAgbWVudUl0ZW0uYXBwZW5kQ2hpbGQoZmxleCk7IC8vIFJlcGxpY2F0ZSByYWRpbyBidXR0b24gYmVoYXZpb3JcblxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1lbnVJdGVtLCAnY2hlY2tlZCcsIHtcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcblxuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgcmV0dXJuIG1lbnVJdGVtLmdldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJykgPT09ICd0cnVlJztcbiAgICAgICAgfSxcblxuICAgICAgICBzZXQoY2hlY2spIHtcbiAgICAgICAgICAvLyBFbnN1cmUgZXhjbHVzaXZpdHlcbiAgICAgICAgICBpZiAoY2hlY2spIHtcbiAgICAgICAgICAgIEFycmF5LmZyb20obWVudUl0ZW0ucGFyZW50Tm9kZS5jaGlsZHJlbikuZmlsdGVyKG5vZGUgPT4gbWF0Y2hlcyhub2RlLCAnW3JvbGU9XCJtZW51aXRlbXJhZGlvXCJdJykpLmZvckVhY2gobm9kZSA9PiBub2RlLnNldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJywgJ2ZhbHNlJykpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIG1lbnVJdGVtLnNldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJywgY2hlY2sgPyAndHJ1ZScgOiAnZmFsc2UnKTtcbiAgICAgICAgfVxuXG4gICAgICB9KTtcbiAgICAgIHRoaXMubGlzdGVuZXJzLmJpbmQobWVudUl0ZW0sICdjbGljayBrZXl1cCcsIGV2ZW50ID0+IHtcbiAgICAgICAgaWYgKGlzLmtleWJvYXJkRXZlbnQoZXZlbnQpICYmIGV2ZW50LmtleSAhPT0gJ1NwYWNlJykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBtZW51SXRlbS5jaGVja2VkID0gdHJ1ZTtcblxuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICBjYXNlICdsYW5ndWFnZSc6XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUcmFjayA9IE51bWJlcih2YWx1ZSk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJ3F1YWxpdHknOlxuICAgICAgICAgICAgdGhpcy5xdWFsaXR5ID0gdmFsdWU7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJ3NwZWVkJzpcbiAgICAgICAgICAgIHRoaXMuc3BlZWQgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgY29udHJvbHMuc2hvd01lbnVQYW5lbC5jYWxsKHRoaXMsICdob21lJywgaXMua2V5Ym9hcmRFdmVudChldmVudCkpO1xuICAgICAgfSwgdHlwZSwgZmFsc2UpO1xuICAgICAgY29udHJvbHMuYmluZE1lbnVJdGVtU2hvcnRjdXRzLmNhbGwodGhpcywgbWVudUl0ZW0sIHR5cGUpO1xuICAgICAgbGlzdC5hcHBlbmRDaGlsZChtZW51SXRlbSk7XG4gICAgfSxcblxuICAgIC8vIEZvcm1hdCBhIHRpbWUgZm9yIGRpc3BsYXlcbiAgICBmb3JtYXRUaW1lKHRpbWUgPSAwLCBpbnZlcnRlZCA9IGZhbHNlKSB7XG4gICAgICAvLyBCYWlsIGlmIHRoZSB2YWx1ZSBpc24ndCBhIG51bWJlclxuICAgICAgaWYgKCFpcy5udW1iZXIodGltZSkpIHtcbiAgICAgICAgcmV0dXJuIHRpbWU7XG4gICAgICB9IC8vIEFsd2F5cyBkaXNwbGF5IGhvdXJzIGlmIGR1cmF0aW9uIGlzIG92ZXIgYW4gaG91clxuXG5cbiAgICAgIGNvbnN0IGZvcmNlSG91cnMgPSBnZXRIb3Vycyh0aGlzLmR1cmF0aW9uKSA+IDA7XG4gICAgICByZXR1cm4gZm9ybWF0VGltZSh0aW1lLCBmb3JjZUhvdXJzLCBpbnZlcnRlZCk7XG4gICAgfSxcblxuICAgIC8vIFVwZGF0ZSB0aGUgZGlzcGxheWVkIHRpbWVcbiAgICB1cGRhdGVUaW1lRGlzcGxheSh0YXJnZXQgPSBudWxsLCB0aW1lID0gMCwgaW52ZXJ0ZWQgPSBmYWxzZSkge1xuICAgICAgLy8gQmFpbCBpZiB0aGVyZSdzIG5vIGVsZW1lbnQgdG8gZGlzcGxheSBvciB0aGUgdmFsdWUgaXNuJ3QgYSBudW1iZXJcbiAgICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpIHx8ICFpcy5udW1iZXIodGltZSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cblxuXG4gICAgICB0YXJnZXQuaW5uZXJUZXh0ID0gY29udHJvbHMuZm9ybWF0VGltZSh0aW1lLCBpbnZlcnRlZCk7XG4gICAgfSxcblxuICAgIC8vIFVwZGF0ZSB2b2x1bWUgVUkgYW5kIHN0b3JhZ2VcbiAgICB1cGRhdGVWb2x1bWUoKSB7XG4gICAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gVXBkYXRlIHJhbmdlXG5cblxuICAgICAgaWYgKGlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5pbnB1dHMudm9sdW1lKSkge1xuICAgICAgICBjb250cm9scy5zZXRSYW5nZS5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuaW5wdXRzLnZvbHVtZSwgdGhpcy5tdXRlZCA/IDAgOiB0aGlzLnZvbHVtZSk7XG4gICAgICB9IC8vIFVwZGF0ZSBtdXRlIHN0YXRlXG5cblxuICAgICAgaWYgKGlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5idXR0b25zLm11dGUpKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9ucy5tdXRlLnByZXNzZWQgPSB0aGlzLm11dGVkIHx8IHRoaXMudm9sdW1lID09PSAwO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBVcGRhdGUgc2VlayB2YWx1ZSBhbmQgbG93ZXIgZmlsbFxuICAgIHNldFJhbmdlKHRhcmdldCwgdmFsdWUgPSAwKSB7XG4gICAgICBpZiAoIWlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuXG5cbiAgICAgIHRhcmdldC52YWx1ZSA9IHZhbHVlOyAvLyBXZWJraXQgcmFuZ2UgZmlsbFxuXG4gICAgICBjb250cm9scy51cGRhdGVSYW5nZUZpbGwuY2FsbCh0aGlzLCB0YXJnZXQpO1xuICAgIH0sXG5cbiAgICAvLyBVcGRhdGUgPHByb2dyZXNzPiBlbGVtZW50c1xuICAgIHVwZGF0ZVByb2dyZXNzKGV2ZW50KSB7XG4gICAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpIHx8ICFpcy5ldmVudChldmVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgdmFsdWUgPSAwO1xuXG4gICAgICBjb25zdCBzZXRQcm9ncmVzcyA9ICh0YXJnZXQsIGlucHV0KSA9PiB7XG4gICAgICAgIGNvbnN0IHZhbCA9IGlzLm51bWJlcihpbnB1dCkgPyBpbnB1dCA6IDA7XG4gICAgICAgIGNvbnN0IHByb2dyZXNzID0gaXMuZWxlbWVudCh0YXJnZXQpID8gdGFyZ2V0IDogdGhpcy5lbGVtZW50cy5kaXNwbGF5LmJ1ZmZlcjsgLy8gVXBkYXRlIHZhbHVlIGFuZCBsYWJlbFxuXG4gICAgICAgIGlmIChpcy5lbGVtZW50KHByb2dyZXNzKSkge1xuICAgICAgICAgIHByb2dyZXNzLnZhbHVlID0gdmFsOyAvLyBVcGRhdGUgdGV4dCBsYWJlbCBpbnNpZGVcblxuICAgICAgICAgIGNvbnN0IGxhYmVsID0gcHJvZ3Jlc3MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NwYW4nKVswXTtcblxuICAgICAgICAgIGlmIChpcy5lbGVtZW50KGxhYmVsKSkge1xuICAgICAgICAgICAgbGFiZWwuY2hpbGROb2Rlc1swXS5ub2RlVmFsdWUgPSB2YWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBpZiAoZXZlbnQpIHtcbiAgICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgICAgICAgLy8gVmlkZW8gcGxheWluZ1xuICAgICAgICAgIGNhc2UgJ3RpbWV1cGRhdGUnOlxuICAgICAgICAgIGNhc2UgJ3NlZWtpbmcnOlxuICAgICAgICAgIGNhc2UgJ3NlZWtlZCc6XG4gICAgICAgICAgICB2YWx1ZSA9IGdldFBlcmNlbnRhZ2UodGhpcy5jdXJyZW50VGltZSwgdGhpcy5kdXJhdGlvbik7IC8vIFNldCBzZWVrIHJhbmdlIHZhbHVlIG9ubHkgaWYgaXQncyBhICduYXR1cmFsJyB0aW1lIGV2ZW50XG5cbiAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAndGltZXVwZGF0ZScpIHtcbiAgICAgICAgICAgICAgY29udHJvbHMuc2V0UmFuZ2UuY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmlucHV0cy5zZWVrLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIC8vIENoZWNrIGJ1ZmZlciBzdGF0dXNcblxuICAgICAgICAgIGNhc2UgJ3BsYXlpbmcnOlxuICAgICAgICAgIGNhc2UgJ3Byb2dyZXNzJzpcbiAgICAgICAgICAgIHNldFByb2dyZXNzKHRoaXMuZWxlbWVudHMuZGlzcGxheS5idWZmZXIsIHRoaXMuYnVmZmVyZWQgKiAxMDApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gV2Via2l0IHBvbHlmaWxsIGZvciBsb3dlciBmaWxsIHJhbmdlXG4gICAgdXBkYXRlUmFuZ2VGaWxsKHRhcmdldCkge1xuICAgICAgLy8gR2V0IHJhbmdlIGZyb20gZXZlbnQgaWYgZXZlbnQgcGFzc2VkXG4gICAgICBjb25zdCByYW5nZSA9IGlzLmV2ZW50KHRhcmdldCkgPyB0YXJnZXQudGFyZ2V0IDogdGFyZ2V0OyAvLyBOZWVkcyB0byBiZSBhIHZhbGlkIDxpbnB1dCB0eXBlPSdyYW5nZSc+XG5cbiAgICAgIGlmICghaXMuZWxlbWVudChyYW5nZSkgfHwgcmFuZ2UuZ2V0QXR0cmlidXRlKCd0eXBlJykgIT09ICdyYW5nZScpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBTZXQgYXJpYSB2YWx1ZXMgZm9yIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy85MDVcblxuXG4gICAgICBpZiAobWF0Y2hlcyhyYW5nZSwgdGhpcy5jb25maWcuc2VsZWN0b3JzLmlucHV0cy5zZWVrKSkge1xuICAgICAgICByYW5nZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCB0aGlzLmN1cnJlbnRUaW1lKTtcbiAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBjb250cm9scy5mb3JtYXRUaW1lKHRoaXMuY3VycmVudFRpbWUpO1xuICAgICAgICBjb25zdCBkdXJhdGlvbiA9IGNvbnRyb2xzLmZvcm1hdFRpbWUodGhpcy5kdXJhdGlvbik7XG4gICAgICAgIGNvbnN0IGZvcm1hdCA9IGkxOG4uZ2V0KCdzZWVrTGFiZWwnLCB0aGlzLmNvbmZpZyk7XG4gICAgICAgIHJhbmdlLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZXRleHQnLCBmb3JtYXQucmVwbGFjZSgne2N1cnJlbnRUaW1lfScsIGN1cnJlbnRUaW1lKS5yZXBsYWNlKCd7ZHVyYXRpb259JywgZHVyYXRpb24pKTtcbiAgICAgIH0gZWxzZSBpZiAobWF0Y2hlcyhyYW5nZSwgdGhpcy5jb25maWcuc2VsZWN0b3JzLmlucHV0cy52b2x1bWUpKSB7XG4gICAgICAgIGNvbnN0IHBlcmNlbnQgPSByYW5nZS52YWx1ZSAqIDEwMDtcbiAgICAgICAgcmFuZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JywgcGVyY2VudCk7XG4gICAgICAgIHJhbmdlLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZXRleHQnLCBgJHtwZXJjZW50LnRvRml4ZWQoMSl9JWApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmFuZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JywgcmFuZ2UudmFsdWUpO1xuICAgICAgfSAvLyBXZWJLaXQgb25seVxuXG5cbiAgICAgIGlmICghYnJvd3Nlci5pc1dlYmtpdCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFNldCBDU1MgY3VzdG9tIHByb3BlcnR5XG5cblxuICAgICAgcmFuZ2Uuc3R5bGUuc2V0UHJvcGVydHkoJy0tdmFsdWUnLCBgJHtyYW5nZS52YWx1ZSAvIHJhbmdlLm1heCAqIDEwMH0lYCk7XG4gICAgfSxcblxuICAgIC8vIFVwZGF0ZSBob3ZlciB0b29sdGlwIGZvciBzZWVraW5nXG4gICAgdXBkYXRlU2Vla1Rvb2x0aXAoZXZlbnQpIHtcbiAgICAgIHZhciBfdGhpcyRjb25maWckbWFya2VycywgX3RoaXMkY29uZmlnJG1hcmtlcnMkO1xuXG4gICAgICAvLyBCYWlsIGlmIHNldHRpbmcgbm90IHRydWVcbiAgICAgIGlmICghdGhpcy5jb25maWcudG9vbHRpcHMuc2VlayB8fCAhaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmlucHV0cy5zZWVrKSB8fCAhaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXApIHx8IHRoaXMuZHVyYXRpb24gPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0aXBFbGVtZW50ID0gdGhpcy5lbGVtZW50cy5kaXNwbGF5LnNlZWtUb29sdGlwO1xuICAgICAgY29uc3QgdmlzaWJsZSA9IGAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcH0tLXZpc2libGVgO1xuXG4gICAgICBjb25zdCB0b2dnbGUgPSBzaG93ID0+IHRvZ2dsZUNsYXNzKHRpcEVsZW1lbnQsIHZpc2libGUsIHNob3cpOyAvLyBIaWRlIG9uIHRvdWNoXG5cblxuICAgICAgaWYgKHRoaXMudG91Y2gpIHtcbiAgICAgICAgdG9nZ2xlKGZhbHNlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBEZXRlcm1pbmUgcGVyY2VudGFnZSwgaWYgYWxyZWFkeSB2aXNpYmxlXG5cblxuICAgICAgbGV0IHBlcmNlbnQgPSAwO1xuICAgICAgY29uc3QgY2xpZW50UmVjdCA9IHRoaXMuZWxlbWVudHMucHJvZ3Jlc3MuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgIGlmIChpcy5ldmVudChldmVudCkpIHtcbiAgICAgICAgcGVyY2VudCA9IDEwMCAvIGNsaWVudFJlY3Qud2lkdGggKiAoZXZlbnQucGFnZVggLSBjbGllbnRSZWN0LmxlZnQpO1xuICAgICAgfSBlbHNlIGlmIChoYXNDbGFzcyh0aXBFbGVtZW50LCB2aXNpYmxlKSkge1xuICAgICAgICBwZXJjZW50ID0gcGFyc2VGbG9hdCh0aXBFbGVtZW50LnN0eWxlLmxlZnQsIDEwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gU2V0IGJvdW5kc1xuXG5cbiAgICAgIGlmIChwZXJjZW50IDwgMCkge1xuICAgICAgICBwZXJjZW50ID0gMDtcbiAgICAgIH0gZWxzZSBpZiAocGVyY2VudCA+IDEwMCkge1xuICAgICAgICBwZXJjZW50ID0gMTAwO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0aW1lID0gdGhpcy5kdXJhdGlvbiAvIDEwMCAqIHBlcmNlbnQ7IC8vIERpc3BsYXkgdGhlIHRpbWUgYSBjbGljayB3b3VsZCBzZWVrIHRvXG5cbiAgICAgIHRpcEVsZW1lbnQuaW5uZXJUZXh0ID0gY29udHJvbHMuZm9ybWF0VGltZSh0aW1lKTsgLy8gR2V0IG1hcmtlciBwb2ludCBmb3IgdGltZVxuXG4gICAgICBjb25zdCBwb2ludCA9IChfdGhpcyRjb25maWckbWFya2VycyA9IHRoaXMuY29uZmlnLm1hcmtlcnMpID09PSBudWxsIHx8IF90aGlzJGNvbmZpZyRtYXJrZXJzID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RoaXMkY29uZmlnJG1hcmtlcnMkID0gX3RoaXMkY29uZmlnJG1hcmtlcnMucG9pbnRzKSA9PT0gbnVsbCB8fCBfdGhpcyRjb25maWckbWFya2VycyQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGNvbmZpZyRtYXJrZXJzJC5maW5kKCh7XG4gICAgICAgIHRpbWU6IHRcbiAgICAgIH0pID0+IHQgPT09IE1hdGgucm91bmQodGltZSkpOyAvLyBBcHBlbmQgdGhlIHBvaW50IGxhYmVsIHRvIHRoZSB0b29sdGlwXG5cbiAgICAgIGlmIChwb2ludCkge1xuICAgICAgICB0aXBFbGVtZW50Lmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIGAke3BvaW50LmxhYmVsfTxicj5gKTtcbiAgICAgIH0gLy8gU2V0IHBvc2l0aW9uXG5cblxuICAgICAgdGlwRWxlbWVudC5zdHlsZS5sZWZ0ID0gYCR7cGVyY2VudH0lYDsgLy8gU2hvdy9oaWRlIHRoZSB0b29sdGlwXG4gICAgICAvLyBJZiB0aGUgZXZlbnQgaXMgYSBtb3VlcyBpbi9vdXQgYW5kIHBlcmNlbnRhZ2UgaXMgaW5zaWRlIGJvdW5kc1xuXG4gICAgICBpZiAoaXMuZXZlbnQoZXZlbnQpICYmIFsnbW91c2VlbnRlcicsICdtb3VzZWxlYXZlJ10uaW5jbHVkZXMoZXZlbnQudHlwZSkpIHtcbiAgICAgICAgdG9nZ2xlKGV2ZW50LnR5cGUgPT09ICdtb3VzZWVudGVyJyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIEhhbmRsZSB0aW1lIGNoYW5nZSBldmVudFxuICAgIHRpbWVVcGRhdGUoZXZlbnQpIHtcbiAgICAgIC8vIE9ubHkgaW52ZXJ0IGlmIG9ubHkgb25lIHRpbWUgZWxlbWVudCBpcyBkaXNwbGF5ZWQgYW5kIHVzZWQgZm9yIGJvdGggZHVyYXRpb24gYW5kIGN1cnJlbnRUaW1lXG4gICAgICBjb25zdCBpbnZlcnQgPSAhaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmRpc3BsYXkuZHVyYXRpb24pICYmIHRoaXMuY29uZmlnLmludmVydFRpbWU7IC8vIER1cmF0aW9uXG5cbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVRpbWVEaXNwbGF5LmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5kaXNwbGF5LmN1cnJlbnRUaW1lLCBpbnZlcnQgPyB0aGlzLmR1cmF0aW9uIC0gdGhpcy5jdXJyZW50VGltZSA6IHRoaXMuY3VycmVudFRpbWUsIGludmVydCk7IC8vIElnbm9yZSB1cGRhdGVzIHdoaWxlIHNlZWtpbmdcblxuICAgICAgaWYgKGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09ICd0aW1ldXBkYXRlJyAmJiB0aGlzLm1lZGlhLnNlZWtpbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBQbGF5aW5nIHByb2dyZXNzXG5cblxuICAgICAgY29udHJvbHMudXBkYXRlUHJvZ3Jlc3MuY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfSxcblxuICAgIC8vIFNob3cgdGhlIGR1cmF0aW9uIG9uIG1ldGFkYXRhbG9hZGVkIG9yIGR1cmF0aW9uY2hhbmdlIGV2ZW50c1xuICAgIGR1cmF0aW9uVXBkYXRlKCkge1xuICAgICAgLy8gQmFpbCBpZiBubyBVSSBvciBkdXJhdGlvbmNoYW5nZSBldmVudCB0cmlnZ2VyZWQgYWZ0ZXIgcGxheWluZy9zZWVrIHdoZW4gaW52ZXJ0VGltZSBpcyBmYWxzZVxuICAgICAgaWYgKCF0aGlzLnN1cHBvcnRlZC51aSB8fCAhdGhpcy5jb25maWcuaW52ZXJ0VGltZSAmJiB0aGlzLmN1cnJlbnRUaW1lKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gSWYgZHVyYXRpb24gaXMgdGhlIDIqKjMyIChzaGFrYSksIEluZmluaXR5IChITFMpLCBEQVNILUlGIChOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiB8fCBOdW1iZXIuTUFYX1ZBTFVFKSBpbmRpY2F0aW5nIGxpdmUgd2UgaGlkZSB0aGUgY3VycmVudFRpbWUgYW5kIHByb2dyZXNzYmFyLlxuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3ZpZGVvLWRldi9obHMuanMvYmxvYi81ODIwZDI5ZDNjNGM4YTQ2ZThiNzVmMWUzYWZhM2U2OGMxYTlhMmRiL3NyYy9jb250cm9sbGVyL2J1ZmZlci1jb250cm9sbGVyLmpzI0w0MTVcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvc2hha2EtcGxheWVyL2Jsb2IvNGQ4ODkwNTQ2MzFmNGUxY2YwZmJkODBkZGQyYjcxODg3YzAyZTIzMi9saWIvbWVkaWEvc3RyZWFtaW5nX2VuZ2luZS5qcyNMMTA2MlxuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0Rhc2gtSW5kdXN0cnktRm9ydW0vZGFzaC5qcy9ibG9iLzY5ODU5ZjUxYjk2OTY0NWIyMzQ2NjY4MDBkNGNiNTk2ZDg5YzYwMmQvc3JjL2Rhc2gvbW9kZWxzL0Rhc2hNYW5pZmVzdE1vZGVsLmpzI0wzMzhcblxuXG4gICAgICBpZiAodGhpcy5kdXJhdGlvbiA+PSAyICoqIDMyKSB7XG4gICAgICAgIHRvZ2dsZUhpZGRlbih0aGlzLmVsZW1lbnRzLmRpc3BsYXkuY3VycmVudFRpbWUsIHRydWUpO1xuICAgICAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5wcm9ncmVzcywgdHJ1ZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gVXBkYXRlIEFSSUEgdmFsdWVzXG5cblxuICAgICAgaWYgKGlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5pbnB1dHMuc2VlaykpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5pbnB1dHMuc2Vlay5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVtYXgnLCB0aGlzLmR1cmF0aW9uKTtcbiAgICAgIH0gLy8gSWYgdGhlcmUncyBhIHNwb3QgdG8gZGlzcGxheSBkdXJhdGlvblxuXG5cbiAgICAgIGNvbnN0IGhhc0R1cmF0aW9uID0gaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmRpc3BsYXkuZHVyYXRpb24pOyAvLyBJZiB0aGVyZSdzIG9ubHkgb25lIHRpbWUgZGlzcGxheSwgZGlzcGxheSBkdXJhdGlvbiB0aGVyZVxuXG4gICAgICBpZiAoIWhhc0R1cmF0aW9uICYmIHRoaXMuY29uZmlnLmRpc3BsYXlEdXJhdGlvbiAmJiB0aGlzLnBhdXNlZCkge1xuICAgICAgICBjb250cm9scy51cGRhdGVUaW1lRGlzcGxheS5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuZGlzcGxheS5jdXJyZW50VGltZSwgdGhpcy5kdXJhdGlvbik7XG4gICAgICB9IC8vIElmIHRoZXJlJ3MgYSBkdXJhdGlvbiBlbGVtZW50LCB1cGRhdGUgY29udGVudFxuXG5cbiAgICAgIGlmIChoYXNEdXJhdGlvbikge1xuICAgICAgICBjb250cm9scy51cGRhdGVUaW1lRGlzcGxheS5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuZGlzcGxheS5kdXJhdGlvbiwgdGhpcy5kdXJhdGlvbik7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5tYXJrZXJzLmVuYWJsZWQpIHtcbiAgICAgICAgY29udHJvbHMuc2V0TWFya2Vycy5jYWxsKHRoaXMpO1xuICAgICAgfSAvLyBVcGRhdGUgdGhlIHRvb2x0aXAgKGlmIHZpc2libGUpXG5cblxuICAgICAgY29udHJvbHMudXBkYXRlU2Vla1Rvb2x0aXAuY2FsbCh0aGlzKTtcbiAgICB9LFxuXG4gICAgLy8gSGlkZS9zaG93IGEgdGFiXG4gICAgdG9nZ2xlTWVudUJ1dHRvbihzZXR0aW5nLCB0b2dnbGUpIHtcbiAgICAgIHRvZ2dsZUhpZGRlbih0aGlzLmVsZW1lbnRzLnNldHRpbmdzLmJ1dHRvbnNbc2V0dGluZ10sICF0b2dnbGUpO1xuICAgIH0sXG5cbiAgICAvLyBVcGRhdGUgdGhlIHNlbGVjdGVkIHNldHRpbmdcbiAgICB1cGRhdGVTZXR0aW5nKHNldHRpbmcsIGNvbnRhaW5lciwgaW5wdXQpIHtcbiAgICAgIGNvbnN0IHBhbmUgPSB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVsc1tzZXR0aW5nXTtcbiAgICAgIGxldCB2YWx1ZSA9IG51bGw7XG4gICAgICBsZXQgbGlzdCA9IGNvbnRhaW5lcjtcblxuICAgICAgaWYgKHNldHRpbmcgPT09ICdjYXB0aW9ucycpIHtcbiAgICAgICAgdmFsdWUgPSB0aGlzLmN1cnJlbnRUcmFjaztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhbHVlID0gIWlzLmVtcHR5KGlucHV0KSA/IGlucHV0IDogdGhpc1tzZXR0aW5nXTsgLy8gR2V0IGRlZmF1bHRcblxuICAgICAgICBpZiAoaXMuZW1wdHkodmFsdWUpKSB7XG4gICAgICAgICAgdmFsdWUgPSB0aGlzLmNvbmZpZ1tzZXR0aW5nXS5kZWZhdWx0O1xuICAgICAgICB9IC8vIFVuc3VwcG9ydGVkIHZhbHVlXG5cblxuICAgICAgICBpZiAoIWlzLmVtcHR5KHRoaXMub3B0aW9uc1tzZXR0aW5nXSkgJiYgIXRoaXMub3B0aW9uc1tzZXR0aW5nXS5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgICAgICB0aGlzLmRlYnVnLndhcm4oYFVuc3VwcG9ydGVkIHZhbHVlIG9mICcke3ZhbHVlfScgZm9yICR7c2V0dGluZ31gKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gRGlzYWJsZWQgdmFsdWVcblxuXG4gICAgICAgIGlmICghdGhpcy5jb25maWdbc2V0dGluZ10ub3B0aW9ucy5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgICAgICB0aGlzLmRlYnVnLndhcm4oYERpc2FibGVkIHZhbHVlIG9mICcke3ZhbHVlfScgZm9yICR7c2V0dGluZ31gKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH0gLy8gR2V0IHRoZSBsaXN0IGlmIHdlIG5lZWQgdG9cblxuXG4gICAgICBpZiAoIWlzLmVsZW1lbnQobGlzdCkpIHtcbiAgICAgICAgbGlzdCA9IHBhbmUgJiYgcGFuZS5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cIm1lbnVcIl0nKTtcbiAgICAgIH0gLy8gSWYgdGhlcmUncyBubyBsaXN0IGl0IG1lYW5zIGl0J3Mgbm90IGJlZW4gcmVuZGVyZWQuLi5cblxuXG4gICAgICBpZiAoIWlzLmVsZW1lbnQobGlzdCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBVcGRhdGUgdGhlIGxhYmVsXG5cblxuICAgICAgY29uc3QgbGFiZWwgPSB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLmJ1dHRvbnNbc2V0dGluZ10ucXVlcnlTZWxlY3RvcihgLiR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5tZW51LnZhbHVlfWApO1xuICAgICAgbGFiZWwuaW5uZXJIVE1MID0gY29udHJvbHMuZ2V0TGFiZWwuY2FsbCh0aGlzLCBzZXR0aW5nLCB2YWx1ZSk7IC8vIEZpbmQgdGhlIHJhZGlvIG9wdGlvbiBhbmQgY2hlY2sgaXRcblxuICAgICAgY29uc3QgdGFyZ2V0ID0gbGlzdCAmJiBsaXN0LnF1ZXJ5U2VsZWN0b3IoYFt2YWx1ZT1cIiR7dmFsdWV9XCJdYCk7XG5cbiAgICAgIGlmIChpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICAgICAgdGFyZ2V0LmNoZWNrZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBUcmFuc2xhdGUgYSB2YWx1ZSBpbnRvIGEgbmljZSBsYWJlbFxuICAgIGdldExhYmVsKHNldHRpbmcsIHZhbHVlKSB7XG4gICAgICBzd2l0Y2ggKHNldHRpbmcpIHtcbiAgICAgICAgY2FzZSAnc3BlZWQnOlxuICAgICAgICAgIHJldHVybiB2YWx1ZSA9PT0gMSA/IGkxOG4uZ2V0KCdub3JtYWwnLCB0aGlzLmNvbmZpZykgOiBgJHt2YWx1ZX0mdGltZXM7YDtcblxuICAgICAgICBjYXNlICdxdWFsaXR5JzpcbiAgICAgICAgICBpZiAoaXMubnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBpMThuLmdldChgcXVhbGl0eUxhYmVsLiR7dmFsdWV9YCwgdGhpcy5jb25maWcpO1xuXG4gICAgICAgICAgICBpZiAoIWxhYmVsLmxlbmd0aCkge1xuICAgICAgICAgICAgICByZXR1cm4gYCR7dmFsdWV9cGA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBsYWJlbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gdG9UaXRsZUNhc2UodmFsdWUpO1xuXG4gICAgICAgIGNhc2UgJ2NhcHRpb25zJzpcbiAgICAgICAgICByZXR1cm4gY2FwdGlvbnMuZ2V0TGFiZWwuY2FsbCh0aGlzKTtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBTZXQgdGhlIHF1YWxpdHkgbWVudVxuICAgIHNldFF1YWxpdHlNZW51KG9wdGlvbnMpIHtcbiAgICAgIC8vIE1lbnUgcmVxdWlyZWRcbiAgICAgIGlmICghaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5xdWFsaXR5KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHR5cGUgPSAncXVhbGl0eSc7XG4gICAgICBjb25zdCBsaXN0ID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMucXVhbGl0eS5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cIm1lbnVcIl0nKTsgLy8gU2V0IG9wdGlvbnMgaWYgcGFzc2VkIGFuZCBmaWx0ZXIgYmFzZWQgb24gdW5pcXVlbmVzcyBhbmQgY29uZmlnXG5cbiAgICAgIGlmIChpcy5hcnJheShvcHRpb25zKSkge1xuICAgICAgICB0aGlzLm9wdGlvbnMucXVhbGl0eSA9IGRlZHVwZShvcHRpb25zKS5maWx0ZXIocXVhbGl0eSA9PiB0aGlzLmNvbmZpZy5xdWFsaXR5Lm9wdGlvbnMuaW5jbHVkZXMocXVhbGl0eSkpO1xuICAgICAgfSAvLyBUb2dnbGUgdGhlIHBhbmUgYW5kIHRhYlxuXG5cbiAgICAgIGNvbnN0IHRvZ2dsZSA9ICFpcy5lbXB0eSh0aGlzLm9wdGlvbnMucXVhbGl0eSkgJiYgdGhpcy5vcHRpb25zLnF1YWxpdHkubGVuZ3RoID4gMTtcbiAgICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnVCdXR0b24uY2FsbCh0aGlzLCB0eXBlLCB0b2dnbGUpOyAvLyBFbXB0eSB0aGUgbWVudVxuXG4gICAgICBlbXB0eUVsZW1lbnQobGlzdCk7IC8vIENoZWNrIGlmIHdlIG5lZWQgdG8gdG9nZ2xlIHRoZSBwYXJlbnRcblxuICAgICAgY29udHJvbHMuY2hlY2tNZW51LmNhbGwodGhpcyk7IC8vIElmIHdlJ3JlIGhpZGluZywgbm90aGluZyBtb3JlIHRvIGRvXG5cbiAgICAgIGlmICghdG9nZ2xlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gR2V0IHRoZSBiYWRnZSBIVE1MIGZvciBIRCwgNEsgZXRjXG5cblxuICAgICAgY29uc3QgZ2V0QmFkZ2UgPSBxdWFsaXR5ID0+IHtcbiAgICAgICAgY29uc3QgbGFiZWwgPSBpMThuLmdldChgcXVhbGl0eUJhZGdlLiR7cXVhbGl0eX1gLCB0aGlzLmNvbmZpZyk7XG5cbiAgICAgICAgaWYgKCFsYWJlbC5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb250cm9scy5jcmVhdGVCYWRnZS5jYWxsKHRoaXMsIGxhYmVsKTtcbiAgICAgIH07IC8vIFNvcnQgb3B0aW9ucyBieSB0aGUgY29uZmlnIGFuZCB0aGVuIHJlbmRlciBvcHRpb25zXG5cblxuICAgICAgdGhpcy5vcHRpb25zLnF1YWxpdHkuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICBjb25zdCBzb3J0aW5nID0gdGhpcy5jb25maWcucXVhbGl0eS5vcHRpb25zO1xuICAgICAgICByZXR1cm4gc29ydGluZy5pbmRleE9mKGEpID4gc29ydGluZy5pbmRleE9mKGIpID8gMSA6IC0xO1xuICAgICAgfSkuZm9yRWFjaChxdWFsaXR5ID0+IHtcbiAgICAgICAgY29udHJvbHMuY3JlYXRlTWVudUl0ZW0uY2FsbCh0aGlzLCB7XG4gICAgICAgICAgdmFsdWU6IHF1YWxpdHksXG4gICAgICAgICAgbGlzdCxcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIHRpdGxlOiBjb250cm9scy5nZXRMYWJlbC5jYWxsKHRoaXMsICdxdWFsaXR5JywgcXVhbGl0eSksXG4gICAgICAgICAgYmFkZ2U6IGdldEJhZGdlKHF1YWxpdHkpXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwodGhpcywgdHlwZSwgbGlzdCk7XG4gICAgfSxcblxuICAgIC8vIFNldCB0aGUgbG9vcGluZyBvcHRpb25zXG5cbiAgICAvKiBzZXRMb29wTWVudSgpIHtcbiAgICAgICAgICAvLyBNZW51IHJlcXVpcmVkXG4gICAgICAgICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLmxvb3ApKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSBbJ3N0YXJ0JywgJ2VuZCcsICdhbGwnLCAncmVzZXQnXTtcbiAgICAgICAgICBjb25zdCBsaXN0ID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMubG9vcC5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cIm1lbnVcIl0nKTtcbiAgICAgICAgICAgLy8gU2hvdyB0aGUgcGFuZSBhbmQgdGFiXG4gICAgICAgICAgdG9nZ2xlSGlkZGVuKHRoaXMuZWxlbWVudHMuc2V0dGluZ3MuYnV0dG9ucy5sb29wLCBmYWxzZSk7XG4gICAgICAgICAgdG9nZ2xlSGlkZGVuKHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLmxvb3AsIGZhbHNlKTtcbiAgICAgICAgICAgLy8gVG9nZ2xlIHRoZSBwYW5lIGFuZCB0YWJcbiAgICAgICAgICBjb25zdCB0b2dnbGUgPSAhaXMuZW1wdHkodGhpcy5sb29wLm9wdGlvbnMpO1xuICAgICAgICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnVCdXR0b24uY2FsbCh0aGlzLCAnbG9vcCcsIHRvZ2dsZSk7XG4gICAgICAgICAgIC8vIEVtcHR5IHRoZSBtZW51XG4gICAgICAgICAgZW1wdHlFbGVtZW50KGxpc3QpO1xuICAgICAgICAgICBvcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgICAgICAgICBjb25zdCBidXR0b24gPSBjcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICAgJ2J1dHRvbicsXG4gICAgICAgICAgICAgICAgICBleHRlbmQoZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5sb29wKSwge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2wsXG4gICAgICAgICAgICAgICAgICAgICAgJ2RhdGEtcGx5ci1sb29wLWFjdGlvbic6IG9wdGlvbixcbiAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgaTE4bi5nZXQob3B0aW9uLCB0aGlzLmNvbmZpZylcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgIGlmIChbJ3N0YXJ0JywgJ2VuZCddLmluY2x1ZGVzKG9wdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGJhZGdlID0gY29udHJvbHMuY3JlYXRlQmFkZ2UuY2FsbCh0aGlzLCAnMDA6MDAnKTtcbiAgICAgICAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChiYWRnZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICAgICAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChpdGVtKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0sICovXG4gICAgLy8gR2V0IGN1cnJlbnQgc2VsZWN0ZWQgY2FwdGlvbiBsYW5ndWFnZVxuICAgIC8vIFRPRE86IHJld29yayB0aGlzIHRvIHVzZXIgdGhlIGdldHRlciBpbiB0aGUgQVBJP1xuICAgIC8vIFNldCBhIGxpc3Qgb2YgYXZhaWxhYmxlIGNhcHRpb25zIGxhbmd1YWdlc1xuICAgIHNldENhcHRpb25zTWVudSgpIHtcbiAgICAgIC8vIE1lbnUgcmVxdWlyZWRcbiAgICAgIGlmICghaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5jYXB0aW9ucykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBUT0RPOiBDYXB0aW9ucyBvciBsYW5ndWFnZT8gQ3VycmVudGx5IGl0J3MgbWl4ZWRcblxuXG4gICAgICBjb25zdCB0eXBlID0gJ2NhcHRpb25zJztcbiAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5jYXB0aW9ucy5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cIm1lbnVcIl0nKTtcbiAgICAgIGNvbnN0IHRyYWNrcyA9IGNhcHRpb25zLmdldFRyYWNrcy5jYWxsKHRoaXMpO1xuICAgICAgY29uc3QgdG9nZ2xlID0gQm9vbGVhbih0cmFja3MubGVuZ3RoKTsgLy8gVG9nZ2xlIHRoZSBwYW5lIGFuZCB0YWJcblxuICAgICAgY29udHJvbHMudG9nZ2xlTWVudUJ1dHRvbi5jYWxsKHRoaXMsIHR5cGUsIHRvZ2dsZSk7IC8vIEVtcHR5IHRoZSBtZW51XG5cbiAgICAgIGVtcHR5RWxlbWVudChsaXN0KTsgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byB0b2dnbGUgdGhlIHBhcmVudFxuXG4gICAgICBjb250cm9scy5jaGVja01lbnUuY2FsbCh0aGlzKTsgLy8gSWYgdGhlcmUncyBubyBjYXB0aW9ucywgYmFpbFxuXG4gICAgICBpZiAoIXRvZ2dsZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIEdlbmVyYXRlIG9wdGlvbnMgZGF0YVxuXG5cbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB0cmFja3MubWFwKCh0cmFjaywgdmFsdWUpID0+ICh7XG4gICAgICAgIHZhbHVlLFxuICAgICAgICBjaGVja2VkOiB0aGlzLmNhcHRpb25zLnRvZ2dsZWQgJiYgdGhpcy5jdXJyZW50VHJhY2sgPT09IHZhbHVlLFxuICAgICAgICB0aXRsZTogY2FwdGlvbnMuZ2V0TGFiZWwuY2FsbCh0aGlzLCB0cmFjayksXG4gICAgICAgIGJhZGdlOiB0cmFjay5sYW5ndWFnZSAmJiBjb250cm9scy5jcmVhdGVCYWRnZS5jYWxsKHRoaXMsIHRyYWNrLmxhbmd1YWdlLnRvVXBwZXJDYXNlKCkpLFxuICAgICAgICBsaXN0LFxuICAgICAgICB0eXBlOiAnbGFuZ3VhZ2UnXG4gICAgICB9KSk7IC8vIEFkZCB0aGUgXCJEaXNhYmxlZFwiIG9wdGlvbiB0byB0dXJuIG9mZiBjYXB0aW9uc1xuXG4gICAgICBvcHRpb25zLnVuc2hpZnQoe1xuICAgICAgICB2YWx1ZTogLTEsXG4gICAgICAgIGNoZWNrZWQ6ICF0aGlzLmNhcHRpb25zLnRvZ2dsZWQsXG4gICAgICAgIHRpdGxlOiBpMThuLmdldCgnZGlzYWJsZWQnLCB0aGlzLmNvbmZpZyksXG4gICAgICAgIGxpc3QsXG4gICAgICAgIHR5cGU6ICdsYW5ndWFnZSdcbiAgICAgIH0pOyAvLyBHZW5lcmF0ZSBvcHRpb25zXG5cbiAgICAgIG9wdGlvbnMuZm9yRWFjaChjb250cm9scy5jcmVhdGVNZW51SXRlbS5iaW5kKHRoaXMpKTtcbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbCh0aGlzLCB0eXBlLCBsaXN0KTtcbiAgICB9LFxuXG4gICAgLy8gU2V0IGEgbGlzdCBvZiBhdmFpbGFibGUgY2FwdGlvbnMgbGFuZ3VhZ2VzXG4gICAgc2V0U3BlZWRNZW51KCkge1xuICAgICAgLy8gTWVudSByZXF1aXJlZFxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLnNwZWVkKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHR5cGUgPSAnc3BlZWQnO1xuICAgICAgY29uc3QgbGlzdCA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLnNwZWVkLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpOyAvLyBGaWx0ZXIgb3V0IGludmFsaWQgc3BlZWRzXG5cbiAgICAgIHRoaXMub3B0aW9ucy5zcGVlZCA9IHRoaXMub3B0aW9ucy5zcGVlZC5maWx0ZXIobyA9PiBvID49IHRoaXMubWluaW11bVNwZWVkICYmIG8gPD0gdGhpcy5tYXhpbXVtU3BlZWQpOyAvLyBUb2dnbGUgdGhlIHBhbmUgYW5kIHRhYlxuXG4gICAgICBjb25zdCB0b2dnbGUgPSAhaXMuZW1wdHkodGhpcy5vcHRpb25zLnNwZWVkKSAmJiB0aGlzLm9wdGlvbnMuc3BlZWQubGVuZ3RoID4gMTtcbiAgICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnVCdXR0b24uY2FsbCh0aGlzLCB0eXBlLCB0b2dnbGUpOyAvLyBFbXB0eSB0aGUgbWVudVxuXG4gICAgICBlbXB0eUVsZW1lbnQobGlzdCk7IC8vIENoZWNrIGlmIHdlIG5lZWQgdG8gdG9nZ2xlIHRoZSBwYXJlbnRcblxuICAgICAgY29udHJvbHMuY2hlY2tNZW51LmNhbGwodGhpcyk7IC8vIElmIHdlJ3JlIGhpZGluZywgbm90aGluZyBtb3JlIHRvIGRvXG5cbiAgICAgIGlmICghdG9nZ2xlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gQ3JlYXRlIGl0ZW1zXG5cblxuICAgICAgdGhpcy5vcHRpb25zLnNwZWVkLmZvckVhY2goc3BlZWQgPT4ge1xuICAgICAgICBjb250cm9scy5jcmVhdGVNZW51SXRlbS5jYWxsKHRoaXMsIHtcbiAgICAgICAgICB2YWx1ZTogc3BlZWQsXG4gICAgICAgICAgbGlzdCxcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIHRpdGxlOiBjb250cm9scy5nZXRMYWJlbC5jYWxsKHRoaXMsICdzcGVlZCcsIHNwZWVkKVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgY29udHJvbHMudXBkYXRlU2V0dGluZy5jYWxsKHRoaXMsIHR5cGUsIGxpc3QpO1xuICAgIH0sXG5cbiAgICAvLyBDaGVjayBpZiB3ZSBuZWVkIHRvIGhpZGUvc2hvdyB0aGUgc2V0dGluZ3MgbWVudVxuICAgIGNoZWNrTWVudSgpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgYnV0dG9uc1xuICAgICAgfSA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3M7XG4gICAgICBjb25zdCB2aXNpYmxlID0gIWlzLmVtcHR5KGJ1dHRvbnMpICYmIE9iamVjdC52YWx1ZXMoYnV0dG9ucykuc29tZShidXR0b24gPT4gIWJ1dHRvbi5oaWRkZW4pO1xuICAgICAgdG9nZ2xlSGlkZGVuKHRoaXMuZWxlbWVudHMuc2V0dGluZ3MubWVudSwgIXZpc2libGUpO1xuICAgIH0sXG5cbiAgICAvLyBGb2N1cyB0aGUgZmlyc3QgbWVudSBpdGVtIGluIGEgZ2l2ZW4gKG9yIHZpc2libGUpIG1lbnVcbiAgICBmb2N1c0ZpcnN0TWVudUl0ZW0ocGFuZSwgdGFiRm9jdXMgPSBmYWxzZSkge1xuICAgICAgaWYgKHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucG9wdXAuaGlkZGVuKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IHRhcmdldCA9IHBhbmU7XG5cbiAgICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICAgIHRhcmdldCA9IE9iamVjdC52YWx1ZXModGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMpLmZpbmQocCA9PiAhcC5oaWRkZW4pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBmaXJzdEl0ZW0gPSB0YXJnZXQucXVlcnlTZWxlY3RvcignW3JvbGVePVwibWVudWl0ZW1cIl0nKTtcbiAgICAgIHNldEZvY3VzLmNhbGwodGhpcywgZmlyc3RJdGVtLCB0YWJGb2N1cyk7XG4gICAgfSxcblxuICAgIC8vIFNob3cvaGlkZSBtZW51XG4gICAgdG9nZ2xlTWVudShpbnB1dCkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBwb3B1cFxuICAgICAgfSA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3M7XG4gICAgICBjb25zdCBidXR0b24gPSB0aGlzLmVsZW1lbnRzLmJ1dHRvbnMuc2V0dGluZ3M7IC8vIE1lbnUgYW5kIGJ1dHRvbiBhcmUgcmVxdWlyZWRcblxuICAgICAgaWYgKCFpcy5lbGVtZW50KHBvcHVwKSB8fCAhaXMuZWxlbWVudChidXR0b24pKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gVHJ1ZSB0b2dnbGUgYnkgZGVmYXVsdFxuXG5cbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaGlkZGVuXG4gICAgICB9ID0gcG9wdXA7XG4gICAgICBsZXQgc2hvdyA9IGhpZGRlbjtcblxuICAgICAgaWYgKGlzLmJvb2xlYW4oaW5wdXQpKSB7XG4gICAgICAgIHNob3cgPSBpbnB1dDtcbiAgICAgIH0gZWxzZSBpZiAoaXMua2V5Ym9hcmRFdmVudChpbnB1dCkgJiYgaW5wdXQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICBzaG93ID0gZmFsc2U7XG4gICAgICB9IGVsc2UgaWYgKGlzLmV2ZW50KGlucHV0KSkge1xuICAgICAgICAvLyBJZiBQbHlyIGlzIGluIGEgc2hhZG93RE9NLCB0aGUgZXZlbnQgdGFyZ2V0IGlzIHNldCB0byB0aGUgY29tcG9uZW50LCBpbnN0ZWFkIG9mIHRoZVxuICAgICAgICAvLyBFbGVtZW50IGluIHRoZSBzaGFkb3dET00uIFRoZSBwYXRoLCBpZiBhdmFpbGFibGUsIGlzIGNvbXBsZXRlLlxuICAgICAgICBjb25zdCB0YXJnZXQgPSBpcy5mdW5jdGlvbihpbnB1dC5jb21wb3NlZFBhdGgpID8gaW5wdXQuY29tcG9zZWRQYXRoKClbMF0gOiBpbnB1dC50YXJnZXQ7XG4gICAgICAgIGNvbnN0IGlzTWVudUl0ZW0gPSBwb3B1cC5jb250YWlucyh0YXJnZXQpOyAvLyBJZiB0aGUgY2xpY2sgd2FzIGluc2lkZSB0aGUgbWVudSBvciBpZiB0aGUgY2xpY2tcbiAgICAgICAgLy8gd2Fzbid0IHRoZSBidXR0b24gb3IgbWVudSBpdGVtIGFuZCB3ZSdyZSB0cnlpbmcgdG9cbiAgICAgICAgLy8gc2hvdyB0aGUgbWVudSAoYSBkb2MgY2xpY2sgc2hvdWxkbid0IHNob3cgdGhlIG1lbnUpXG5cbiAgICAgICAgaWYgKGlzTWVudUl0ZW0gfHwgIWlzTWVudUl0ZW0gJiYgaW5wdXQudGFyZ2V0ICE9PSBidXR0b24gJiYgc2hvdykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfSAvLyBTZXQgYnV0dG9uIGF0dHJpYnV0ZXNcblxuXG4gICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgc2hvdyk7IC8vIFNob3cgdGhlIGFjdHVhbCBwb3B1cFxuXG4gICAgICB0b2dnbGVIaWRkZW4ocG9wdXAsICFzaG93KTsgLy8gQWRkIGNsYXNzIGhvb2tcblxuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMubWVudS5vcGVuLCBzaG93KTsgLy8gRm9jdXMgdGhlIGZpcnN0IGl0ZW0gaWYga2V5IGludGVyYWN0aW9uXG5cbiAgICAgIGlmIChzaG93ICYmIGlzLmtleWJvYXJkRXZlbnQoaW5wdXQpKSB7XG4gICAgICAgIGNvbnRyb2xzLmZvY3VzRmlyc3RNZW51SXRlbS5jYWxsKHRoaXMsIG51bGwsIHRydWUpO1xuICAgICAgfSBlbHNlIGlmICghc2hvdyAmJiAhaGlkZGVuKSB7XG4gICAgICAgIC8vIElmIGNsb3NpbmcsIHJlLWZvY3VzIHRoZSBidXR0b25cbiAgICAgICAgc2V0Rm9jdXMuY2FsbCh0aGlzLCBidXR0b24sIGlzLmtleWJvYXJkRXZlbnQoaW5wdXQpKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gR2V0IHRoZSBuYXR1cmFsIHNpemUgb2YgYSBtZW51IHBhbmVsXG4gICAgZ2V0TWVudVNpemUodGFiKSB7XG4gICAgICBjb25zdCBjbG9uZSA9IHRhYi5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICBjbG9uZS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICBjbG9uZS5zdHlsZS5vcGFjaXR5ID0gMDtcbiAgICAgIGNsb25lLnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7IC8vIEFwcGVuZCB0byBwYXJlbnQgc28gd2UgZ2V0IHRoZSBcInJlYWxcIiBzaXplXG5cbiAgICAgIHRhYi5wYXJlbnROb2RlLmFwcGVuZENoaWxkKGNsb25lKTsgLy8gR2V0IHRoZSBzaXplcyBiZWZvcmUgd2UgcmVtb3ZlXG5cbiAgICAgIGNvbnN0IHdpZHRoID0gY2xvbmUuc2Nyb2xsV2lkdGg7XG4gICAgICBjb25zdCBoZWlnaHQgPSBjbG9uZS5zY3JvbGxIZWlnaHQ7IC8vIFJlbW92ZSBmcm9tIHRoZSBET01cblxuICAgICAgcmVtb3ZlRWxlbWVudChjbG9uZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aCxcbiAgICAgICAgaGVpZ2h0XG4gICAgICB9O1xuICAgIH0sXG5cbiAgICAvLyBTaG93IGEgcGFuZWwgaW4gdGhlIG1lbnVcbiAgICBzaG93TWVudVBhbmVsKHR5cGUgPSAnJywgdGFiRm9jdXMgPSBmYWxzZSkge1xuICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5lbGVtZW50cy5jb250YWluZXIucXVlcnlTZWxlY3RvcihgI3BseXItc2V0dGluZ3MtJHt0aGlzLmlkfS0ke3R5cGV9YCk7IC8vIE5vdGhpbmcgdG8gc2hvdywgYmFpbFxuXG4gICAgICBpZiAoIWlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIEhpZGUgYWxsIG90aGVyIHBhbmVsc1xuXG5cbiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRhcmdldC5wYXJlbnROb2RlO1xuICAgICAgY29uc3QgY3VycmVudCA9IEFycmF5LmZyb20oY29udGFpbmVyLmNoaWxkcmVuKS5maW5kKG5vZGUgPT4gIW5vZGUuaGlkZGVuKTsgLy8gSWYgd2UgY2FuIGRvIGZhbmN5IGFuaW1hdGlvbnMsIHdlJ2xsIGFuaW1hdGUgdGhlIGhlaWdodC93aWR0aFxuXG4gICAgICBpZiAoc3VwcG9ydC50cmFuc2l0aW9ucyAmJiAhc3VwcG9ydC5yZWR1Y2VkTW90aW9uKSB7XG4gICAgICAgIC8vIFNldCB0aGUgY3VycmVudCB3aWR0aCBhcyBhIGJhc2VcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gYCR7Y3VycmVudC5zY3JvbGxXaWR0aH1weGA7XG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHtjdXJyZW50LnNjcm9sbEhlaWdodH1weGA7IC8vIEdldCBwb3RlbnRpYWwgc2l6ZXNcblxuICAgICAgICBjb25zdCBzaXplID0gY29udHJvbHMuZ2V0TWVudVNpemUuY2FsbCh0aGlzLCB0YXJnZXQpOyAvLyBSZXN0b3JlIGF1dG8gaGVpZ2h0L3dpZHRoXG5cbiAgICAgICAgY29uc3QgcmVzdG9yZSA9IGV2ZW50ID0+IHtcbiAgICAgICAgICAvLyBXZSdyZSBvbmx5IGJvdGhlcmVkIGFib3V0IGhlaWdodCBhbmQgd2lkdGggb24gdGhlIGNvbnRhaW5lclxuICAgICAgICAgIGlmIChldmVudC50YXJnZXQgIT09IGNvbnRhaW5lciB8fCAhWyd3aWR0aCcsICdoZWlnaHQnXS5pbmNsdWRlcyhldmVudC5wcm9wZXJ0eU5hbWUpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBSZXZlcnQgYmFjayB0byBhdXRvXG5cblxuICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9ICcnO1xuICAgICAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSAnJzsgLy8gT25seSBsaXN0ZW4gb25jZVxuXG4gICAgICAgICAgb2ZmLmNhbGwodGhpcywgY29udGFpbmVyLCB0cmFuc2l0aW9uRW5kRXZlbnQsIHJlc3RvcmUpO1xuICAgICAgICB9OyAvLyBMaXN0ZW4gZm9yIHRoZSB0cmFuc2l0aW9uIGZpbmlzaGluZyBhbmQgcmVzdG9yZSBhdXRvIGhlaWdodC93aWR0aFxuXG5cbiAgICAgICAgb24uY2FsbCh0aGlzLCBjb250YWluZXIsIHRyYW5zaXRpb25FbmRFdmVudCwgcmVzdG9yZSk7IC8vIFNldCBkaW1lbnNpb25zIHRvIHRhcmdldFxuXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke3NpemUud2lkdGh9cHhgO1xuICAgICAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gYCR7c2l6ZS5oZWlnaHR9cHhgO1xuICAgICAgfSAvLyBTZXQgYXR0cmlidXRlcyBvbiBjdXJyZW50IHRhYlxuXG5cbiAgICAgIHRvZ2dsZUhpZGRlbihjdXJyZW50LCB0cnVlKTsgLy8gU2V0IGF0dHJpYnV0ZXMgb24gdGFyZ2V0XG5cbiAgICAgIHRvZ2dsZUhpZGRlbih0YXJnZXQsIGZhbHNlKTsgLy8gRm9jdXMgdGhlIGZpcnN0IGl0ZW1cblxuICAgICAgY29udHJvbHMuZm9jdXNGaXJzdE1lbnVJdGVtLmNhbGwodGhpcywgdGFyZ2V0LCB0YWJGb2N1cyk7XG4gICAgfSxcblxuICAgIC8vIFNldCB0aGUgZG93bmxvYWQgVVJMXG4gICAgc2V0RG93bmxvYWRVcmwoKSB7XG4gICAgICBjb25zdCBidXR0b24gPSB0aGlzLmVsZW1lbnRzLmJ1dHRvbnMuZG93bmxvYWQ7IC8vIEJhaWwgaWYgbm8gYnV0dG9uXG5cbiAgICAgIGlmICghaXMuZWxlbWVudChidXR0b24pKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gU2V0IGF0dHJpYnV0ZVxuXG5cbiAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCB0aGlzLmRvd25sb2FkKTtcbiAgICB9LFxuXG4gICAgLy8gQnVpbGQgdGhlIGRlZmF1bHQgSFRNTFxuICAgIGNyZWF0ZShkYXRhKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGJpbmRNZW51SXRlbVNob3J0Y3V0cyxcbiAgICAgICAgY3JlYXRlQnV0dG9uLFxuICAgICAgICBjcmVhdGVQcm9ncmVzcyxcbiAgICAgICAgY3JlYXRlUmFuZ2UsXG4gICAgICAgIGNyZWF0ZVRpbWUsXG4gICAgICAgIHNldFF1YWxpdHlNZW51LFxuICAgICAgICBzZXRTcGVlZE1lbnUsXG4gICAgICAgIHNob3dNZW51UGFuZWxcbiAgICAgIH0gPSBjb250cm9scztcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udHJvbHMgPSBudWxsOyAvLyBMYXJnZXIgb3ZlcmxhaWQgcGxheSBidXR0b25cblxuICAgICAgaWYgKGlzLmFycmF5KHRoaXMuY29uZmlnLmNvbnRyb2xzKSAmJiB0aGlzLmNvbmZpZy5jb250cm9scy5pbmNsdWRlcygncGxheS1sYXJnZScpKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdwbGF5LWxhcmdlJykpO1xuICAgICAgfSAvLyBDcmVhdGUgdGhlIGNvbnRhaW5lclxuXG5cbiAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmNvbnRyb2xzLndyYXBwZXIpKTtcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udHJvbHMgPSBjb250YWluZXI7IC8vIERlZmF1bHQgaXRlbSBhdHRyaWJ1dGVzXG5cbiAgICAgIGNvbnN0IGRlZmF1bHRBdHRyaWJ1dGVzID0ge1xuICAgICAgICBjbGFzczogJ3BseXJfX2NvbnRyb2xzX19pdGVtJ1xuICAgICAgfTsgLy8gTG9vcCB0aHJvdWdoIGNvbnRyb2xzIGluIG9yZGVyXG5cbiAgICAgIGRlZHVwZShpcy5hcnJheSh0aGlzLmNvbmZpZy5jb250cm9scykgPyB0aGlzLmNvbmZpZy5jb250cm9scyA6IFtdKS5mb3JFYWNoKGNvbnRyb2wgPT4ge1xuICAgICAgICAvLyBSZXN0YXJ0IGJ1dHRvblxuICAgICAgICBpZiAoY29udHJvbCA9PT0gJ3Jlc3RhcnQnKSB7XG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdyZXN0YXJ0JywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgICAgfSAvLyBSZXdpbmQgYnV0dG9uXG5cblxuICAgICAgICBpZiAoY29udHJvbCA9PT0gJ3Jld2luZCcpIHtcbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ3Jld2luZCcsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICAgIH0gLy8gUGxheS9QYXVzZSBidXR0b25cblxuXG4gICAgICAgIGlmIChjb250cm9sID09PSAncGxheScpIHtcbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ3BsYXknLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgICB9IC8vIEZhc3QgZm9yd2FyZCBidXR0b25cblxuXG4gICAgICAgIGlmIChjb250cm9sID09PSAnZmFzdC1mb3J3YXJkJykge1xuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAnZmFzdC1mb3J3YXJkJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgICAgfSAvLyBQcm9ncmVzc1xuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdwcm9ncmVzcycpIHtcbiAgICAgICAgICBjb25zdCBwcm9ncmVzc0NvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIGNsYXNzOiBgJHtkZWZhdWx0QXR0cmlidXRlcy5jbGFzc30gcGx5cl9fcHJvZ3Jlc3NfX2NvbnRhaW5lcmBcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCBwcm9ncmVzcyA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLnByb2dyZXNzKSk7IC8vIFNlZWsgcmFuZ2Ugc2xpZGVyXG5cbiAgICAgICAgICBwcm9ncmVzcy5hcHBlbmRDaGlsZChjcmVhdGVSYW5nZS5jYWxsKHRoaXMsICdzZWVrJywge1xuICAgICAgICAgICAgaWQ6IGBwbHlyLXNlZWstJHtkYXRhLmlkfWBcbiAgICAgICAgICB9KSk7IC8vIEJ1ZmZlciBwcm9ncmVzc1xuXG4gICAgICAgICAgcHJvZ3Jlc3MuYXBwZW5kQ2hpbGQoY3JlYXRlUHJvZ3Jlc3MuY2FsbCh0aGlzLCAnYnVmZmVyJykpOyAvLyBUT0RPOiBBZGQgbG9vcCBkaXNwbGF5IGluZGljYXRvclxuICAgICAgICAgIC8vIFNlZWsgdG9vbHRpcFxuXG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLnRvb2x0aXBzLnNlZWspIHtcbiAgICAgICAgICAgIGNvbnN0IHRvb2x0aXAgPSBjcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy50b29sdGlwXG4gICAgICAgICAgICB9LCAnMDA6MDAnKTtcbiAgICAgICAgICAgIHByb2dyZXNzLmFwcGVuZENoaWxkKHRvb2x0aXApO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5kaXNwbGF5LnNlZWtUb29sdGlwID0gdG9vbHRpcDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLnByb2dyZXNzID0gcHJvZ3Jlc3M7XG4gICAgICAgICAgcHJvZ3Jlc3NDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50cy5wcm9ncmVzcyk7XG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHByb2dyZXNzQ29udGFpbmVyKTtcbiAgICAgICAgfSAvLyBNZWRpYSBjdXJyZW50IHRpbWUgZGlzcGxheVxuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdjdXJyZW50LXRpbWUnKSB7XG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZVRpbWUuY2FsbCh0aGlzLCAnY3VycmVudFRpbWUnLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgICB9IC8vIE1lZGlhIGR1cmF0aW9uIGRpc3BsYXlcblxuXG4gICAgICAgIGlmIChjb250cm9sID09PSAnZHVyYXRpb24nKSB7XG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZVRpbWUuY2FsbCh0aGlzLCAnZHVyYXRpb24nLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgICB9IC8vIFZvbHVtZSBjb250cm9sc1xuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdtdXRlJyB8fCBjb250cm9sID09PSAndm9sdW1lJykge1xuICAgICAgICAgIGxldCB7XG4gICAgICAgICAgICB2b2x1bWVcbiAgICAgICAgICB9ID0gdGhpcy5lbGVtZW50czsgLy8gQ3JlYXRlIHRoZSB2b2x1bWUgY29udGFpbmVyIGlmIG5lZWRlZFxuXG4gICAgICAgICAgaWYgKCFpcy5lbGVtZW50KHZvbHVtZSkgfHwgIWNvbnRhaW5lci5jb250YWlucyh2b2x1bWUpKSB7XG4gICAgICAgICAgICB2b2x1bWUgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCBleHRlbmQoe30sIGRlZmF1bHRBdHRyaWJ1dGVzLCB7XG4gICAgICAgICAgICAgIGNsYXNzOiBgJHtkZWZhdWx0QXR0cmlidXRlcy5jbGFzc30gcGx5cl9fdm9sdW1lYC50cmltKClcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMudm9sdW1lID0gdm9sdW1lO1xuICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHZvbHVtZSk7XG4gICAgICAgICAgfSAvLyBUb2dnbGUgbXV0ZSBidXR0b25cblxuXG4gICAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdtdXRlJykge1xuICAgICAgICAgICAgdm9sdW1lLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdtdXRlJykpO1xuICAgICAgICAgIH0gLy8gVm9sdW1lIHJhbmdlIGNvbnRyb2xcbiAgICAgICAgICAvLyBJZ25vcmVkIG9uIGlPUyBhcyBpdCdzIGhhbmRsZWQgZ2xvYmFsbHlcbiAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5hcHBsZS5jb20vbGlicmFyeS9zYWZhcmkvZG9jdW1lbnRhdGlvbi9BdWRpb1ZpZGVvL0NvbmNlcHR1YWwvVXNpbmdfSFRNTDVfQXVkaW9fVmlkZW8vRGV2aWNlLVNwZWNpZmljQ29uc2lkZXJhdGlvbnMvRGV2aWNlLVNwZWNpZmljQ29uc2lkZXJhdGlvbnMuaHRtbFxuXG5cbiAgICAgICAgICBpZiAoY29udHJvbCA9PT0gJ3ZvbHVtZScgJiYgIWJyb3dzZXIuaXNJb3MpIHtcbiAgICAgICAgICAgIC8vIFNldCB0aGUgYXR0cmlidXRlc1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHtcbiAgICAgICAgICAgICAgbWF4OiAxLFxuICAgICAgICAgICAgICBzdGVwOiAwLjA1LFxuICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5jb25maWcudm9sdW1lXG4gICAgICAgICAgICB9OyAvLyBDcmVhdGUgdGhlIHZvbHVtZSByYW5nZSBzbGlkZXJcblxuICAgICAgICAgICAgdm9sdW1lLmFwcGVuZENoaWxkKGNyZWF0ZVJhbmdlLmNhbGwodGhpcywgJ3ZvbHVtZScsIGV4dGVuZChhdHRyaWJ1dGVzLCB7XG4gICAgICAgICAgICAgIGlkOiBgcGx5ci12b2x1bWUtJHtkYXRhLmlkfWBcbiAgICAgICAgICAgIH0pKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IC8vIFRvZ2dsZSBjYXB0aW9ucyBidXR0b25cblxuXG4gICAgICAgIGlmIChjb250cm9sID09PSAnY2FwdGlvbnMnKSB7XG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdjYXB0aW9ucycsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICAgIH0gLy8gU2V0dGluZ3MgYnV0dG9uIC8gbWVudVxuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdzZXR0aW5ncycgJiYgIWlzLmVtcHR5KHRoaXMuY29uZmlnLnNldHRpbmdzKSkge1xuICAgICAgICAgIGNvbnN0IHdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCBleHRlbmQoe30sIGRlZmF1bHRBdHRyaWJ1dGVzLCB7XG4gICAgICAgICAgICBjbGFzczogYCR7ZGVmYXVsdEF0dHJpYnV0ZXMuY2xhc3N9IHBseXJfX21lbnVgLnRyaW0oKSxcbiAgICAgICAgICAgIGhpZGRlbjogJydcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAnc2V0dGluZ3MnLCB7XG4gICAgICAgICAgICAnYXJpYS1oYXNwb3B1cCc6IHRydWUsXG4gICAgICAgICAgICAnYXJpYS1jb250cm9scyc6IGBwbHlyLXNldHRpbmdzLSR7ZGF0YS5pZH1gLFxuICAgICAgICAgICAgJ2FyaWEtZXhwYW5kZWQnOiBmYWxzZVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgICBjb25zdCBwb3B1cCA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIGNsYXNzOiAncGx5cl9fbWVudV9fY29udGFpbmVyJyxcbiAgICAgICAgICAgIGlkOiBgcGx5ci1zZXR0aW5ncy0ke2RhdGEuaWR9YCxcbiAgICAgICAgICAgIGhpZGRlbjogJydcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBjb25zdCBpbm5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgIGNvbnN0IGhvbWUgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICBpZDogYHBseXItc2V0dGluZ3MtJHtkYXRhLmlkfS1ob21lYFxuICAgICAgICAgIH0pOyAvLyBDcmVhdGUgdGhlIG1lbnVcblxuICAgICAgICAgIGNvbnN0IG1lbnUgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICByb2xlOiAnbWVudSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBob21lLmFwcGVuZENoaWxkKG1lbnUpO1xuICAgICAgICAgIGlubmVyLmFwcGVuZENoaWxkKGhvbWUpO1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLmhvbWUgPSBob21lOyAvLyBCdWlsZCB0aGUgbWVudSBpdGVtc1xuXG4gICAgICAgICAgdGhpcy5jb25maWcuc2V0dGluZ3MuZm9yRWFjaCh0eXBlID0+IHtcbiAgICAgICAgICAgIC8vIFRPRE86IGJ1bmRsZSB0aGlzIHdpdGggdGhlIGNyZWF0ZU1lbnVJdGVtIGhlbHBlciBhbmQgYmluZGluZ3NcbiAgICAgICAgICAgIGNvbnN0IG1lbnVJdGVtID0gY3JlYXRlRWxlbWVudCgnYnV0dG9uJywgZXh0ZW5kKGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuc2V0dGluZ3MpLCB7XG4gICAgICAgICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICAgICAgICBjbGFzczogYCR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sfSAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbH0tLWZvcndhcmRgLFxuICAgICAgICAgICAgICByb2xlOiAnbWVudWl0ZW0nLFxuICAgICAgICAgICAgICAnYXJpYS1oYXNwb3B1cCc6IHRydWUsXG4gICAgICAgICAgICAgIGhpZGRlbjogJydcbiAgICAgICAgICAgIH0pKTsgLy8gQmluZCBtZW51IHNob3J0Y3V0cyBmb3Iga2V5Ym9hcmQgdXNlcnNcblxuICAgICAgICAgICAgYmluZE1lbnVJdGVtU2hvcnRjdXRzLmNhbGwodGhpcywgbWVudUl0ZW0sIHR5cGUpOyAvLyBTaG93IG1lbnUgb24gY2xpY2tcblxuICAgICAgICAgICAgb24uY2FsbCh0aGlzLCBtZW51SXRlbSwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICBzaG93TWVudVBhbmVsLmNhbGwodGhpcywgdHlwZSwgZmFsc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBmbGV4ID0gY3JlYXRlRWxlbWVudCgnc3BhbicsIG51bGwsIGkxOG4uZ2V0KHR5cGUsIHRoaXMuY29uZmlnKSk7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLm1lbnUudmFsdWVcbiAgICAgICAgICAgIH0pOyAvLyBTcGVlZCBjb250YWlucyBIVE1MIGVudGl0aWVzXG5cbiAgICAgICAgICAgIHZhbHVlLmlubmVySFRNTCA9IGRhdGFbdHlwZV07XG4gICAgICAgICAgICBmbGV4LmFwcGVuZENoaWxkKHZhbHVlKTtcbiAgICAgICAgICAgIG1lbnVJdGVtLmFwcGVuZENoaWxkKGZsZXgpO1xuICAgICAgICAgICAgbWVudS5hcHBlbmRDaGlsZChtZW51SXRlbSk7IC8vIEJ1aWxkIHRoZSBwYW5lc1xuXG4gICAgICAgICAgICBjb25zdCBwYW5lID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgICBpZDogYHBseXItc2V0dGluZ3MtJHtkYXRhLmlkfS0ke3R5cGV9YCxcbiAgICAgICAgICAgICAgaGlkZGVuOiAnJ1xuICAgICAgICAgICAgfSk7IC8vIEJhY2sgYnV0dG9uXG5cbiAgICAgICAgICAgIGNvbnN0IGJhY2tCdXR0b24gPSBjcmVhdGVFbGVtZW50KCdidXR0b24nLCB7XG4gICAgICAgICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICAgICAgICBjbGFzczogYCR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sfSAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbH0tLWJhY2tgXG4gICAgICAgICAgICB9KTsgLy8gVmlzaWJsZSBsYWJlbFxuXG4gICAgICAgICAgICBiYWNrQnV0dG9uLmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgICAgICAgICdhcmlhLWhpZGRlbic6IHRydWVcbiAgICAgICAgICAgIH0sIGkxOG4uZ2V0KHR5cGUsIHRoaXMuY29uZmlnKSkpOyAvLyBTY3JlZW4gcmVhZGVyIGxhYmVsXG5cbiAgICAgICAgICAgIGJhY2tCdXR0b24uYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaGlkZGVuXG4gICAgICAgICAgICB9LCBpMThuLmdldCgnbWVudUJhY2snLCB0aGlzLmNvbmZpZykpKTsgLy8gR28gYmFjayB2aWEga2V5Ym9hcmRcblxuICAgICAgICAgICAgb24uY2FsbCh0aGlzLCBwYW5lLCAna2V5ZG93bicsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleSAhPT0gJ0Fycm93TGVmdCcpIHJldHVybjsgLy8gUHJldmVudCBzZWVrXG5cbiAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7IC8vIFNob3cgdGhlIHJlc3BlY3RpdmUgbWVudVxuXG4gICAgICAgICAgICAgIHNob3dNZW51UGFuZWwuY2FsbCh0aGlzLCAnaG9tZScsIHRydWUpO1xuICAgICAgICAgICAgfSwgZmFsc2UpOyAvLyBHbyBiYWNrIHZpYSBidXR0b24gY2xpY2tcblxuICAgICAgICAgICAgb24uY2FsbCh0aGlzLCBiYWNrQnV0dG9uLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgIHNob3dNZW51UGFuZWwuY2FsbCh0aGlzLCAnaG9tZScsIGZhbHNlKTtcbiAgICAgICAgICAgIH0pOyAvLyBBZGQgdG8gcGFuZVxuXG4gICAgICAgICAgICBwYW5lLmFwcGVuZENoaWxkKGJhY2tCdXR0b24pOyAvLyBNZW51XG5cbiAgICAgICAgICAgIHBhbmUuYXBwZW5kQ2hpbGQoY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgICAgICByb2xlOiAnbWVudSdcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIGlubmVyLmFwcGVuZENoaWxkKHBhbmUpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5idXR0b25zW3R5cGVdID0gbWVudUl0ZW07XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVsc1t0eXBlXSA9IHBhbmU7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcG9wdXAuYXBwZW5kQ2hpbGQoaW5uZXIpO1xuICAgICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQocG9wdXApO1xuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh3cmFwcGVyKTtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBvcHVwID0gcG9wdXA7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5tZW51ID0gd3JhcHBlcjtcbiAgICAgICAgfSAvLyBQaWN0dXJlIGluIHBpY3R1cmUgYnV0dG9uXG5cblxuICAgICAgICBpZiAoY29udHJvbCA9PT0gJ3BpcCcgJiYgc3VwcG9ydC5waXApIHtcbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ3BpcCcsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICAgIH0gLy8gQWlycGxheSBidXR0b25cblxuXG4gICAgICAgIGlmIChjb250cm9sID09PSAnYWlycGxheScgJiYgc3VwcG9ydC5haXJwbGF5KSB7XG4gICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdhaXJwbGF5JywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgICAgfSAvLyBEb3dubG9hZCBidXR0b25cblxuXG4gICAgICAgIGlmIChjb250cm9sID09PSAnZG93bmxvYWQnKSB7XG4gICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGV4dGVuZCh7fSwgZGVmYXVsdEF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgIGVsZW1lbnQ6ICdhJyxcbiAgICAgICAgICAgIGhyZWY6IHRoaXMuZG93bmxvYWQsXG4gICAgICAgICAgICB0YXJnZXQ6ICdfYmxhbmsnXG4gICAgICAgICAgfSk7IC8vIFNldCBkb3dubG9hZCBhdHRyaWJ1dGUgZm9yIEhUTUw1IG9ubHlcblxuICAgICAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMuZG93bmxvYWQgPSAnJztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBkb3dubG9hZFxuICAgICAgICAgIH0gPSB0aGlzLmNvbmZpZy51cmxzO1xuXG4gICAgICAgICAgaWYgKCFpcy51cmwoZG93bmxvYWQpICYmIHRoaXMuaXNFbWJlZCkge1xuICAgICAgICAgICAgZXh0ZW5kKGF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgICAgaWNvbjogYGxvZ28tJHt0aGlzLnByb3ZpZGVyfWAsXG4gICAgICAgICAgICAgIGxhYmVsOiB0aGlzLnByb3ZpZGVyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ2Rvd25sb2FkJywgYXR0cmlidXRlcykpO1xuICAgICAgICB9IC8vIFRvZ2dsZSBmdWxsc2NyZWVuIGJ1dHRvblxuXG5cbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICdmdWxsc2NyZWVuJykge1xuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAnZnVsbHNjcmVlbicsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICAgIH1cbiAgICAgIH0pOyAvLyBTZXQgYXZhaWxhYmxlIHF1YWxpdHkgbGV2ZWxzXG5cbiAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgc2V0UXVhbGl0eU1lbnUuY2FsbCh0aGlzLCBodG1sNS5nZXRRdWFsaXR5T3B0aW9ucy5jYWxsKHRoaXMpKTtcbiAgICAgIH1cblxuICAgICAgc2V0U3BlZWRNZW51LmNhbGwodGhpcyk7XG4gICAgICByZXR1cm4gY29udGFpbmVyO1xuICAgIH0sXG5cbiAgICAvLyBJbnNlcnQgY29udHJvbHNcbiAgICBpbmplY3QoKSB7XG4gICAgICAvLyBTcHJpdGVcbiAgICAgIGlmICh0aGlzLmNvbmZpZy5sb2FkU3ByaXRlKSB7XG4gICAgICAgIGNvbnN0IGljb24gPSBjb250cm9scy5nZXRJY29uVXJsLmNhbGwodGhpcyk7IC8vIE9ubHkgbG9hZCBleHRlcm5hbCBzcHJpdGUgdXNpbmcgQUpBWFxuXG4gICAgICAgIGlmIChpY29uLmNvcnMpIHtcbiAgICAgICAgICBsb2FkU3ByaXRlKGljb24udXJsLCAnc3ByaXRlLXBseXInKTtcbiAgICAgICAgfVxuICAgICAgfSAvLyBDcmVhdGUgYSB1bmlxdWUgSURcblxuXG4gICAgICB0aGlzLmlkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDApOyAvLyBOdWxsIGJ5IGRlZmF1bHRcblxuICAgICAgbGV0IGNvbnRhaW5lciA9IG51bGw7XG4gICAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xzID0gbnVsbDsgLy8gU2V0IHRlbXBsYXRlIHByb3BlcnRpZXNcblxuICAgICAgY29uc3QgcHJvcHMgPSB7XG4gICAgICAgIGlkOiB0aGlzLmlkLFxuICAgICAgICBzZWVrdGltZTogdGhpcy5jb25maWcuc2Vla1RpbWUsXG4gICAgICAgIHRpdGxlOiB0aGlzLmNvbmZpZy50aXRsZVxuICAgICAgfTtcbiAgICAgIGxldCB1cGRhdGUgPSB0cnVlOyAvLyBJZiBmdW5jdGlvbiwgcnVuIGl0IGFuZCB1c2Ugb3V0cHV0XG5cbiAgICAgIGlmIChpcy5mdW5jdGlvbih0aGlzLmNvbmZpZy5jb250cm9scykpIHtcbiAgICAgICAgdGhpcy5jb25maWcuY29udHJvbHMgPSB0aGlzLmNvbmZpZy5jb250cm9scy5jYWxsKHRoaXMsIHByb3BzKTtcbiAgICAgIH0gLy8gQ29udmVydCBmYWxzeSBjb250cm9scyB0byBlbXB0eSBhcnJheSAocHJpbWFyaWx5IGZvciBlbXB0eSBzdHJpbmdzKVxuXG5cbiAgICAgIGlmICghdGhpcy5jb25maWcuY29udHJvbHMpIHtcbiAgICAgICAgdGhpcy5jb25maWcuY29udHJvbHMgPSBbXTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzLmVsZW1lbnQodGhpcy5jb25maWcuY29udHJvbHMpIHx8IGlzLnN0cmluZyh0aGlzLmNvbmZpZy5jb250cm9scykpIHtcbiAgICAgICAgLy8gSFRNTEVsZW1lbnQgb3IgTm9uLWVtcHR5IHN0cmluZyBwYXNzZWQgYXMgdGhlIG9wdGlvblxuICAgICAgICBjb250YWluZXIgPSB0aGlzLmNvbmZpZy5jb250cm9scztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIENyZWF0ZSBjb250cm9sc1xuICAgICAgICBjb250YWluZXIgPSBjb250cm9scy5jcmVhdGUuY2FsbCh0aGlzLCB7XG4gICAgICAgICAgaWQ6IHRoaXMuaWQsXG4gICAgICAgICAgc2Vla3RpbWU6IHRoaXMuY29uZmlnLnNlZWtUaW1lLFxuICAgICAgICAgIHNwZWVkOiB0aGlzLnNwZWVkLFxuICAgICAgICAgIHF1YWxpdHk6IHRoaXMucXVhbGl0eSxcbiAgICAgICAgICBjYXB0aW9uczogY2FwdGlvbnMuZ2V0TGFiZWwuY2FsbCh0aGlzKSAvLyBUT0RPOiBMb29waW5nXG4gICAgICAgICAgLy8gbG9vcDogJ05vbmUnLFxuXG4gICAgICAgIH0pO1xuICAgICAgICB1cGRhdGUgPSBmYWxzZTtcbiAgICAgIH0gLy8gUmVwbGFjZSBwcm9wcyB3aXRoIHRoZWlyIHZhbHVlXG5cblxuICAgICAgY29uc3QgcmVwbGFjZSA9IGlucHV0ID0+IHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGlucHV0O1xuICAgICAgICBPYmplY3QuZW50cmllcyhwcm9wcykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgcmVzdWx0ID0gcmVwbGFjZUFsbChyZXN1bHQsIGB7JHtrZXl9fWAsIHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9OyAvLyBVcGRhdGUgbWFya3VwXG5cblxuICAgICAgaWYgKHVwZGF0ZSkge1xuICAgICAgICBpZiAoaXMuc3RyaW5nKHRoaXMuY29uZmlnLmNvbnRyb2xzKSkge1xuICAgICAgICAgIGNvbnRhaW5lciA9IHJlcGxhY2UoY29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgICAgfSAvLyBDb250cm9scyBjb250YWluZXJcblxuXG4gICAgICBsZXQgdGFyZ2V0OyAvLyBJbmplY3QgdG8gY3VzdG9tIGxvY2F0aW9uXG5cbiAgICAgIGlmIChpcy5zdHJpbmcodGhpcy5jb25maWcuc2VsZWN0b3JzLmNvbnRyb2xzLmNvbnRhaW5lcikpIHtcbiAgICAgICAgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY29udHJvbHMuY29udGFpbmVyKTtcbiAgICAgIH0gLy8gSW5qZWN0IGludG8gdGhlIGNvbnRhaW5lciBieSBkZWZhdWx0XG5cblxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICAgICAgdGFyZ2V0ID0gdGhpcy5lbGVtZW50cy5jb250YWluZXI7XG4gICAgICB9IC8vIEluamVjdCBjb250cm9scyBIVE1MIChuZWVkcyB0byBiZSBiZWZvcmUgY2FwdGlvbnMsIGhlbmNlIFwiYWZ0ZXJiZWdpblwiKVxuXG5cbiAgICAgIGNvbnN0IGluc2VydE1ldGhvZCA9IGlzLmVsZW1lbnQoY29udGFpbmVyKSA/ICdpbnNlcnRBZGphY2VudEVsZW1lbnQnIDogJ2luc2VydEFkamFjZW50SFRNTCc7XG4gICAgICB0YXJnZXRbaW5zZXJ0TWV0aG9kXSgnYWZ0ZXJiZWdpbicsIGNvbnRhaW5lcik7IC8vIEZpbmQgdGhlIGVsZW1lbnRzIGlmIG5lZWQgYmVcblxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY29udHJvbHMpKSB7XG4gICAgICAgIGNvbnRyb2xzLmZpbmRFbGVtZW50cy5jYWxsKHRoaXMpO1xuICAgICAgfSAvLyBBZGQgcHJlc3NlZCBwcm9wZXJ0eSB0byBidXR0b25zXG5cblxuICAgICAgaWYgKCFpcy5lbXB0eSh0aGlzLmVsZW1lbnRzLmJ1dHRvbnMpKSB7XG4gICAgICAgIGNvbnN0IGFkZFByb3BlcnR5ID0gYnV0dG9uID0+IHtcbiAgICAgICAgICBjb25zdCBjbGFzc05hbWUgPSB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2xQcmVzc2VkO1xuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShidXR0b24sICdwcmVzc2VkJywge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcblxuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gaGFzQ2xhc3MoYnV0dG9uLCBjbGFzc05hbWUpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgc2V0KHByZXNzZWQgPSBmYWxzZSkge1xuICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhidXR0b24sIGNsYXNzTmFtZSwgcHJlc3NlZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICB9KTtcbiAgICAgICAgfTsgLy8gVG9nZ2xlIGNsYXNzbmFtZSB3aGVuIHByZXNzZWQgcHJvcGVydHkgaXMgc2V0XG5cblxuICAgICAgICBPYmplY3QudmFsdWVzKHRoaXMuZWxlbWVudHMuYnV0dG9ucykuZmlsdGVyKEJvb2xlYW4pLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgICBpZiAoaXMuYXJyYXkoYnV0dG9uKSB8fCBpcy5ub2RlTGlzdChidXR0b24pKSB7XG4gICAgICAgICAgICBBcnJheS5mcm9tKGJ1dHRvbikuZmlsdGVyKEJvb2xlYW4pLmZvckVhY2goYWRkUHJvcGVydHkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhZGRQcm9wZXJ0eShidXR0b24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IC8vIEVkZ2Ugc29tZXRpbWVzIGRvZXNuJ3QgZmluaXNoIHRoZSBwYWludCBzbyBmb3JjZSBhIHJlcGFpbnRcblxuXG4gICAgICBpZiAoYnJvd3Nlci5pc0VkZ2UpIHtcbiAgICAgICAgcmVwYWludCh0YXJnZXQpO1xuICAgICAgfSAvLyBTZXR1cCB0b29sdGlwc1xuXG5cbiAgICAgIGlmICh0aGlzLmNvbmZpZy50b29sdGlwcy5jb250cm9scykge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgY2xhc3NOYW1lcyxcbiAgICAgICAgICBzZWxlY3RvcnNcbiAgICAgICAgfSA9IHRoaXMuY29uZmlnO1xuICAgICAgICBjb25zdCBzZWxlY3RvciA9IGAke3NlbGVjdG9ycy5jb250cm9scy53cmFwcGVyfSAke3NlbGVjdG9ycy5sYWJlbHN9IC4ke2NsYXNzTmFtZXMuaGlkZGVufWA7XG4gICAgICAgIGNvbnN0IGxhYmVscyA9IGdldEVsZW1lbnRzLmNhbGwodGhpcywgc2VsZWN0b3IpO1xuICAgICAgICBBcnJheS5mcm9tKGxhYmVscykuZm9yRWFjaChsYWJlbCA9PiB7XG4gICAgICAgICAgdG9nZ2xlQ2xhc3MobGFiZWwsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaGlkZGVuLCBmYWxzZSk7XG4gICAgICAgICAgdG9nZ2xlQ2xhc3MobGFiZWwsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcCwgdHJ1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBTZXQgbWVkaWEgbWV0YWRhdGFcbiAgICBzZXRNZWRpYU1ldGFkYXRhKCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCdtZWRpYVNlc3Npb24nIGluIG5hdmlnYXRvcikge1xuICAgICAgICAgIG5hdmlnYXRvci5tZWRpYVNlc3Npb24ubWV0YWRhdGEgPSBuZXcgd2luZG93Lk1lZGlhTWV0YWRhdGEoe1xuICAgICAgICAgICAgdGl0bGU6IHRoaXMuY29uZmlnLm1lZGlhTWV0YWRhdGEudGl0bGUsXG4gICAgICAgICAgICBhcnRpc3Q6IHRoaXMuY29uZmlnLm1lZGlhTWV0YWRhdGEuYXJ0aXN0LFxuICAgICAgICAgICAgYWxidW06IHRoaXMuY29uZmlnLm1lZGlhTWV0YWRhdGEuYWxidW0sXG4gICAgICAgICAgICBhcnR3b3JrOiB0aGlzLmNvbmZpZy5tZWRpYU1ldGFkYXRhLmFydHdvcmtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoXykgey8vIERvIG5vdGhpbmdcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gQWRkIG1hcmtlcnNcbiAgICBzZXRNYXJrZXJzKCkge1xuICAgICAgdmFyIF90aGlzJGNvbmZpZyRtYXJrZXJzMiwgX3RoaXMkY29uZmlnJG1hcmtlcnMzO1xuXG4gICAgICBpZiAoIXRoaXMuZHVyYXRpb24gfHwgdGhpcy5lbGVtZW50cy5tYXJrZXJzKSByZXR1cm47IC8vIEdldCB2YWxpZCBwb2ludHNcblxuICAgICAgY29uc3QgcG9pbnRzID0gKF90aGlzJGNvbmZpZyRtYXJrZXJzMiA9IHRoaXMuY29uZmlnLm1hcmtlcnMpID09PSBudWxsIHx8IF90aGlzJGNvbmZpZyRtYXJrZXJzMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogKF90aGlzJGNvbmZpZyRtYXJrZXJzMyA9IF90aGlzJGNvbmZpZyRtYXJrZXJzMi5wb2ludHMpID09PSBudWxsIHx8IF90aGlzJGNvbmZpZyRtYXJrZXJzMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkY29uZmlnJG1hcmtlcnMzLmZpbHRlcigoe1xuICAgICAgICB0aW1lXG4gICAgICB9KSA9PiB0aW1lID4gMCAmJiB0aW1lIDwgdGhpcy5kdXJhdGlvbik7XG4gICAgICBpZiAoIShwb2ludHMgIT09IG51bGwgJiYgcG9pbnRzICE9PSB2b2lkIDAgJiYgcG9pbnRzLmxlbmd0aCkpIHJldHVybjtcbiAgICAgIGNvbnN0IGNvbnRhaW5lckZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgY29uc3QgcG9pbnRzRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICBsZXQgdGlwRWxlbWVudCA9IG51bGw7XG4gICAgICBjb25zdCB0aXBWaXNpYmxlID0gYCR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy50b29sdGlwfS0tdmlzaWJsZWA7XG5cbiAgICAgIGNvbnN0IHRvZ2dsZVRpcCA9IHNob3cgPT4gdG9nZ2xlQ2xhc3ModGlwRWxlbWVudCwgdGlwVmlzaWJsZSwgc2hvdyk7IC8vIEluamVjdCBtYXJrZXJzIHRvIHByb2dyZXNzIGNvbnRhaW5lclxuXG5cbiAgICAgIHBvaW50cy5mb3JFYWNoKHBvaW50ID0+IHtcbiAgICAgICAgY29uc3QgbWFya2VyRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMubWFya2VyXG4gICAgICAgIH0sICcnKTtcbiAgICAgICAgY29uc3QgbGVmdCA9IGAke3BvaW50LnRpbWUgLyB0aGlzLmR1cmF0aW9uICogMTAwfSVgO1xuXG4gICAgICAgIGlmICh0aXBFbGVtZW50KSB7XG4gICAgICAgICAgLy8gU2hvdyBvbiBob3ZlclxuICAgICAgICAgIG1hcmtlckVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcbiAgICAgICAgICAgIGlmIChwb2ludC5sYWJlbCkgcmV0dXJuO1xuICAgICAgICAgICAgdGlwRWxlbWVudC5zdHlsZS5sZWZ0ID0gbGVmdDtcbiAgICAgICAgICAgIHRpcEVsZW1lbnQuaW5uZXJIVE1MID0gcG9pbnQubGFiZWw7XG4gICAgICAgICAgICB0b2dnbGVUaXAodHJ1ZSk7XG4gICAgICAgICAgfSk7IC8vIEhpZGUgb24gbGVhdmVcblxuICAgICAgICAgIG1hcmtlckVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcbiAgICAgICAgICAgIHRvZ2dsZVRpcChmYWxzZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBtYXJrZXJFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY3VycmVudFRpbWUgPSBwb2ludC50aW1lO1xuICAgICAgICB9KTtcbiAgICAgICAgbWFya2VyRWxlbWVudC5zdHlsZS5sZWZ0ID0gbGVmdDtcbiAgICAgICAgcG9pbnRzRnJhZ21lbnQuYXBwZW5kQ2hpbGQobWFya2VyRWxlbWVudCk7XG4gICAgICB9KTtcbiAgICAgIGNvbnRhaW5lckZyYWdtZW50LmFwcGVuZENoaWxkKHBvaW50c0ZyYWdtZW50KTsgLy8gSW5qZWN0IGEgdG9vbHRpcCBpZiBuZWVkZWRcblxuICAgICAgaWYgKCF0aGlzLmNvbmZpZy50b29sdGlwcy5zZWVrKSB7XG4gICAgICAgIHRpcEVsZW1lbnQgPSBjcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnRvb2x0aXBcbiAgICAgICAgfSwgJycpO1xuICAgICAgICBjb250YWluZXJGcmFnbWVudC5hcHBlbmRDaGlsZCh0aXBFbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5lbGVtZW50cy5tYXJrZXJzID0ge1xuICAgICAgICBwb2ludHM6IHBvaW50c0ZyYWdtZW50LFxuICAgICAgICB0aXA6IHRpcEVsZW1lbnRcbiAgICAgIH07XG4gICAgICB0aGlzLmVsZW1lbnRzLnByb2dyZXNzLmFwcGVuZENoaWxkKGNvbnRhaW5lckZyYWdtZW50KTtcbiAgICB9XG5cbiAgfTtcblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvKipcbiAgICogUGFyc2UgYSBzdHJpbmcgdG8gYSBVUkwgb2JqZWN0XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCAtIHRoZSBVUkwgdG8gYmUgcGFyc2VkXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gc2FmZSAtIGZhaWxzYWZlIHBhcnNpbmdcbiAgICovXG5cbiAgZnVuY3Rpb24gcGFyc2VVcmwoaW5wdXQsIHNhZmUgPSB0cnVlKSB7XG4gICAgbGV0IHVybCA9IGlucHV0O1xuXG4gICAgaWYgKHNhZmUpIHtcbiAgICAgIGNvbnN0IHBhcnNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgIHBhcnNlci5ocmVmID0gdXJsO1xuICAgICAgdXJsID0gcGFyc2VyLmhyZWY7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBuZXcgVVJMKHVybCk7XG4gICAgfSBjYXRjaCAoXykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9IC8vIENvbnZlcnQgb2JqZWN0IHRvIFVSTFNlYXJjaFBhcmFtc1xuXG4gIGZ1bmN0aW9uIGJ1aWxkVXJsUGFyYW1zKGlucHV0KSB7XG4gICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuXG4gICAgaWYgKGlzLm9iamVjdChpbnB1dCkpIHtcbiAgICAgIE9iamVjdC5lbnRyaWVzKGlucHV0KS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgcGFyYW1zLnNldChrZXksIHZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBwYXJhbXM7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBjYXB0aW9ucyA9IHtcbiAgICAvLyBTZXR1cCBjYXB0aW9uc1xuICAgIHNldHVwKCkge1xuICAgICAgLy8gUmVxdWlyZXMgVUkgc3VwcG9ydFxuICAgICAgaWYgKCF0aGlzLnN1cHBvcnRlZC51aSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIE9ubHkgVmltZW8gYW5kIEhUTUw1IHZpZGVvIHN1cHBvcnRlZCBhdCB0aGlzIHBvaW50XG5cblxuICAgICAgaWYgKCF0aGlzLmlzVmlkZW8gfHwgdGhpcy5pc1lvdVR1YmUgfHwgdGhpcy5pc0hUTUw1ICYmICFzdXBwb3J0LnRleHRUcmFja3MpIHtcbiAgICAgICAgLy8gQ2xlYXIgbWVudSBhbmQgaGlkZVxuICAgICAgICBpZiAoaXMuYXJyYXkodGhpcy5jb25maWcuY29udHJvbHMpICYmIHRoaXMuY29uZmlnLmNvbnRyb2xzLmluY2x1ZGVzKCdzZXR0aW5ncycpICYmIHRoaXMuY29uZmlnLnNldHRpbmdzLmluY2x1ZGVzKCdjYXB0aW9ucycpKSB7XG4gICAgICAgICAgY29udHJvbHMuc2V0Q2FwdGlvbnNNZW51LmNhbGwodGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIEluamVjdCB0aGUgY29udGFpbmVyXG5cblxuICAgICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY2FwdGlvbnMpKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuY2FwdGlvbnMgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jYXB0aW9ucykpO1xuICAgICAgICBpbnNlcnRBZnRlcih0aGlzLmVsZW1lbnRzLmNhcHRpb25zLCB0aGlzLmVsZW1lbnRzLndyYXBwZXIpO1xuICAgICAgfSAvLyBGaXggSUUgY2FwdGlvbnMgaWYgQ09SUyBpcyB1c2VkXG4gICAgICAvLyBGZXRjaCBjYXB0aW9ucyBhbmQgaW5qZWN0IGFzIGJsb2JzIGluc3RlYWQgKGRhdGEgVVJJcyBub3Qgc3VwcG9ydGVkISlcblxuXG4gICAgICBpZiAoYnJvd3Nlci5pc0lFICYmIHdpbmRvdy5VUkwpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudHMgPSB0aGlzLm1lZGlhLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyYWNrJyk7XG4gICAgICAgIEFycmF5LmZyb20oZWxlbWVudHMpLmZvckVhY2godHJhY2sgPT4ge1xuICAgICAgICAgIGNvbnN0IHNyYyA9IHRyYWNrLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgICAgICAgY29uc3QgdXJsID0gcGFyc2VVcmwoc3JjKTtcblxuICAgICAgICAgIGlmICh1cmwgIT09IG51bGwgJiYgdXJsLmhvc3RuYW1lICE9PSB3aW5kb3cubG9jYXRpb24uaHJlZi5ob3N0bmFtZSAmJiBbJ2h0dHA6JywgJ2h0dHBzOiddLmluY2x1ZGVzKHVybC5wcm90b2NvbCkpIHtcbiAgICAgICAgICAgIGZldGNoKHNyYywgJ2Jsb2InKS50aGVuKGJsb2IgPT4ge1xuICAgICAgICAgICAgICB0cmFjay5zZXRBdHRyaWJ1dGUoJ3NyYycsIHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgICAgcmVtb3ZlRWxlbWVudCh0cmFjayk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSAvLyBHZXQgYW5kIHNldCBpbml0aWFsIGRhdGFcbiAgICAgIC8vIFRoZSBcInByZWZlcnJlZFwiIG9wdGlvbnMgYXJlIG5vdCByZWFsaXplZCB1bmxlc3MgLyB1bnRpbCB0aGUgd2FudGVkIGxhbmd1YWdlIGhhcyBhIG1hdGNoXG4gICAgICAvLyAqIGxhbmd1YWdlczogQXJyYXkgb2YgdXNlcidzIGJyb3dzZXIgbGFuZ3VhZ2VzLlxuICAgICAgLy8gKiBsYW5ndWFnZTogIFRoZSBsYW5ndWFnZSBwcmVmZXJyZWQgYnkgdXNlciBzZXR0aW5ncyBvciBjb25maWdcbiAgICAgIC8vICogYWN0aXZlOiAgICBUaGUgc3RhdGUgcHJlZmVycmVkIGJ5IHVzZXIgc2V0dGluZ3Mgb3IgY29uZmlnXG4gICAgICAvLyAqIHRvZ2dsZWQ6ICAgVGhlIHJlYWwgY2FwdGlvbnMgc3RhdGVcblxuXG4gICAgICBjb25zdCBicm93c2VyTGFuZ3VhZ2VzID0gbmF2aWdhdG9yLmxhbmd1YWdlcyB8fCBbbmF2aWdhdG9yLmxhbmd1YWdlIHx8IG5hdmlnYXRvci51c2VyTGFuZ3VhZ2UgfHwgJ2VuJ107XG4gICAgICBjb25zdCBsYW5ndWFnZXMgPSBkZWR1cGUoYnJvd3Nlckxhbmd1YWdlcy5tYXAobGFuZ3VhZ2UgPT4gbGFuZ3VhZ2Uuc3BsaXQoJy0nKVswXSkpO1xuICAgICAgbGV0IGxhbmd1YWdlID0gKHRoaXMuc3RvcmFnZS5nZXQoJ2xhbmd1YWdlJykgfHwgdGhpcy5jb25maWcuY2FwdGlvbnMubGFuZ3VhZ2UgfHwgJ2F1dG8nKS50b0xvd2VyQ2FzZSgpOyAvLyBVc2UgZmlyc3QgYnJvd3NlciBsYW5ndWFnZSB3aGVuIGxhbmd1YWdlIGlzICdhdXRvJ1xuXG4gICAgICBpZiAobGFuZ3VhZ2UgPT09ICdhdXRvJykge1xuICAgICAgICBbbGFuZ3VhZ2VdID0gbGFuZ3VhZ2VzO1xuICAgICAgfVxuXG4gICAgICBsZXQgYWN0aXZlID0gdGhpcy5zdG9yYWdlLmdldCgnY2FwdGlvbnMnKTtcblxuICAgICAgaWYgKCFpcy5ib29sZWFuKGFjdGl2ZSkpIHtcbiAgICAgICAgKHtcbiAgICAgICAgICBhY3RpdmVcbiAgICAgICAgfSA9IHRoaXMuY29uZmlnLmNhcHRpb25zKTtcbiAgICAgIH1cblxuICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmNhcHRpb25zLCB7XG4gICAgICAgIHRvZ2dsZWQ6IGZhbHNlLFxuICAgICAgICBhY3RpdmUsXG4gICAgICAgIGxhbmd1YWdlLFxuICAgICAgICBsYW5ndWFnZXNcbiAgICAgIH0pOyAvLyBXYXRjaCBjaGFuZ2VzIHRvIHRleHRUcmFja3MgYW5kIHVwZGF0ZSBjYXB0aW9ucyBtZW51XG5cbiAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgY29uc3QgdHJhY2tFdmVudHMgPSB0aGlzLmNvbmZpZy5jYXB0aW9ucy51cGRhdGUgPyAnYWRkdHJhY2sgcmVtb3ZldHJhY2snIDogJ3JlbW92ZXRyYWNrJztcbiAgICAgICAgb24uY2FsbCh0aGlzLCB0aGlzLm1lZGlhLnRleHRUcmFja3MsIHRyYWNrRXZlbnRzLCBjYXB0aW9ucy51cGRhdGUuYmluZCh0aGlzKSk7XG4gICAgICB9IC8vIFVwZGF0ZSBhdmFpbGFibGUgbGFuZ3VhZ2VzIGluIGxpc3QgbmV4dCB0aWNrICh0aGUgZXZlbnQgbXVzdCBub3QgYmUgdHJpZ2dlcmVkIGJlZm9yZSB0aGUgbGlzdGVuZXJzKVxuXG5cbiAgICAgIHNldFRpbWVvdXQoY2FwdGlvbnMudXBkYXRlLmJpbmQodGhpcyksIDApO1xuICAgIH0sXG5cbiAgICAvLyBVcGRhdGUgYXZhaWxhYmxlIGxhbmd1YWdlIG9wdGlvbnMgaW4gc2V0dGluZ3MgYmFzZWQgb24gdHJhY2tzXG4gICAgdXBkYXRlKCkge1xuICAgICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcywgdHJ1ZSk7IC8vIEdldCB0aGUgd2FudGVkIGxhbmd1YWdlXG5cbiAgICAgIGNvbnN0IHtcbiAgICAgICAgYWN0aXZlLFxuICAgICAgICBsYW5ndWFnZSxcbiAgICAgICAgbWV0YSxcbiAgICAgICAgY3VycmVudFRyYWNrTm9kZVxuICAgICAgfSA9IHRoaXMuY2FwdGlvbnM7XG4gICAgICBjb25zdCBsYW5ndWFnZUV4aXN0cyA9IEJvb2xlYW4odHJhY2tzLmZpbmQodHJhY2sgPT4gdHJhY2subGFuZ3VhZ2UgPT09IGxhbmd1YWdlKSk7IC8vIEhhbmRsZSB0cmFja3MgKGFkZCBldmVudCBsaXN0ZW5lciBhbmQgXCJwc2V1ZG9cIi1kZWZhdWx0KVxuXG4gICAgICBpZiAodGhpcy5pc0hUTUw1ICYmIHRoaXMuaXNWaWRlbykge1xuICAgICAgICB0cmFja3MuZmlsdGVyKHRyYWNrID0+ICFtZXRhLmdldCh0cmFjaykpLmZvckVhY2godHJhY2sgPT4ge1xuICAgICAgICAgIHRoaXMuZGVidWcubG9nKCdUcmFjayBhZGRlZCcsIHRyYWNrKTsgLy8gQXR0ZW1wdCB0byBzdG9yZSBpZiB0aGUgb3JpZ2luYWwgZG9tIGVsZW1lbnQgd2FzIFwiZGVmYXVsdFwiXG5cbiAgICAgICAgICBtZXRhLnNldCh0cmFjaywge1xuICAgICAgICAgICAgZGVmYXVsdDogdHJhY2subW9kZSA9PT0gJ3Nob3dpbmcnXG4gICAgICAgICAgfSk7IC8vIFR1cm4gb2ZmIG5hdGl2ZSBjYXB0aW9uIHJlbmRlcmluZyB0byBhdm9pZCBkb3VibGUgY2FwdGlvbnNcbiAgICAgICAgICAvLyBOb3RlOiBtb2RlPSdoaWRkZW4nIGZvcmNlcyBhIHRyYWNrIHRvIGRvd25sb2FkLiBUbyBlbnN1cmUgZXZlcnkgdHJhY2tcbiAgICAgICAgICAvLyBpc24ndCBkb3dubG9hZGVkIGF0IG9uY2UsIG9ubHkgJ3Nob3dpbmcnIHRyYWNrcyBzaG91bGQgYmUgcmVhc3NpZ25lZFxuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuXG4gICAgICAgICAgaWYgKHRyYWNrLm1vZGUgPT09ICdzaG93aW5nJykge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICAgICAgICB0cmFjay5tb2RlID0gJ2hpZGRlbic7XG4gICAgICAgICAgfSAvLyBBZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGN1ZSBjaGFuZ2VzXG5cblxuICAgICAgICAgIG9uLmNhbGwodGhpcywgdHJhY2ssICdjdWVjaGFuZ2UnLCAoKSA9PiBjYXB0aW9ucy51cGRhdGVDdWVzLmNhbGwodGhpcykpO1xuICAgICAgICB9KTtcbiAgICAgIH0gLy8gVXBkYXRlIGxhbmd1YWdlIGZpcnN0IHRpbWUgaXQgbWF0Y2hlcywgb3IgaWYgdGhlIHByZXZpb3VzIG1hdGNoaW5nIHRyYWNrIHdhcyByZW1vdmVkXG5cblxuICAgICAgaWYgKGxhbmd1YWdlRXhpc3RzICYmIHRoaXMubGFuZ3VhZ2UgIT09IGxhbmd1YWdlIHx8ICF0cmFja3MuaW5jbHVkZXMoY3VycmVudFRyYWNrTm9kZSkpIHtcbiAgICAgICAgY2FwdGlvbnMuc2V0TGFuZ3VhZ2UuY2FsbCh0aGlzLCBsYW5ndWFnZSk7XG4gICAgICAgIGNhcHRpb25zLnRvZ2dsZS5jYWxsKHRoaXMsIGFjdGl2ZSAmJiBsYW5ndWFnZUV4aXN0cyk7XG4gICAgICB9IC8vIEVuYWJsZSBvciBkaXNhYmxlIGNhcHRpb25zIGJhc2VkIG9uIHRyYWNrIGxlbmd0aFxuXG5cbiAgICAgIGlmICh0aGlzLmVsZW1lbnRzKSB7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNhcHRpb25zLmVuYWJsZWQsICFpcy5lbXB0eSh0cmFja3MpKTtcbiAgICAgIH0gLy8gVXBkYXRlIGF2YWlsYWJsZSBsYW5ndWFnZXMgaW4gbGlzdFxuXG5cbiAgICAgIGlmIChpcy5hcnJheSh0aGlzLmNvbmZpZy5jb250cm9scykgJiYgdGhpcy5jb25maWcuY29udHJvbHMuaW5jbHVkZXMoJ3NldHRpbmdzJykgJiYgdGhpcy5jb25maWcuc2V0dGluZ3MuaW5jbHVkZXMoJ2NhcHRpb25zJykpIHtcbiAgICAgICAgY29udHJvbHMuc2V0Q2FwdGlvbnNNZW51LmNhbGwodGhpcyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIFRvZ2dsZSBjYXB0aW9ucyBkaXNwbGF5XG4gICAgLy8gVXNlZCBpbnRlcm5hbGx5IGZvciB0aGUgdG9nZ2xlQ2FwdGlvbnMgbWV0aG9kLCB3aXRoIHRoZSBwYXNzaXZlIG9wdGlvbiBmb3JjZWQgdG8gZmFsc2VcbiAgICB0b2dnbGUoaW5wdXQsIHBhc3NpdmUgPSB0cnVlKSB7XG4gICAgICAvLyBJZiB0aGVyZSdzIG5vIGZ1bGwgc3VwcG9ydFxuICAgICAgaWYgKCF0aGlzLnN1cHBvcnRlZC51aSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdG9nZ2xlZFxuICAgICAgfSA9IHRoaXMuY2FwdGlvbnM7IC8vIEN1cnJlbnQgc3RhdGVcblxuICAgICAgY29uc3QgYWN0aXZlQ2xhc3MgPSB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNhcHRpb25zLmFjdGl2ZTsgLy8gR2V0IHRoZSBuZXh0IHN0YXRlXG4gICAgICAvLyBJZiB0aGUgbWV0aG9kIGlzIGNhbGxlZCB3aXRob3V0IHBhcmFtZXRlciwgdG9nZ2xlIGJhc2VkIG9uIGN1cnJlbnQgdmFsdWVcblxuICAgICAgY29uc3QgYWN0aXZlID0gaXMubnVsbE9yVW5kZWZpbmVkKGlucHV0KSA/ICF0b2dnbGVkIDogaW5wdXQ7IC8vIFVwZGF0ZSBzdGF0ZSBhbmQgdHJpZ2dlciBldmVudFxuXG4gICAgICBpZiAoYWN0aXZlICE9PSB0b2dnbGVkKSB7XG4gICAgICAgIC8vIFdoZW4gcGFzc2l2ZSwgZG9uJ3Qgb3ZlcnJpZGUgdXNlciBwcmVmZXJlbmNlc1xuICAgICAgICBpZiAoIXBhc3NpdmUpIHtcbiAgICAgICAgICB0aGlzLmNhcHRpb25zLmFjdGl2ZSA9IGFjdGl2ZTtcbiAgICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0KHtcbiAgICAgICAgICAgIGNhcHRpb25zOiBhY3RpdmVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSAvLyBGb3JjZSBsYW5ndWFnZSBpZiB0aGUgY2FsbCBpc24ndCBwYXNzaXZlIGFuZCB0aGVyZSBpcyBubyBtYXRjaGluZyBsYW5ndWFnZSB0byB0b2dnbGUgdG9cblxuXG4gICAgICAgIGlmICghdGhpcy5sYW5ndWFnZSAmJiBhY3RpdmUgJiYgIXBhc3NpdmUpIHtcbiAgICAgICAgICBjb25zdCB0cmFja3MgPSBjYXB0aW9ucy5nZXRUcmFja3MuY2FsbCh0aGlzKTtcbiAgICAgICAgICBjb25zdCB0cmFjayA9IGNhcHRpb25zLmZpbmRUcmFjay5jYWxsKHRoaXMsIFt0aGlzLmNhcHRpb25zLmxhbmd1YWdlLCAuLi50aGlzLmNhcHRpb25zLmxhbmd1YWdlc10sIHRydWUpOyAvLyBPdmVycmlkZSB1c2VyIHByZWZlcmVuY2VzIHRvIGF2b2lkIHN3aXRjaGluZyBsYW5ndWFnZXMgaWYgYSBtYXRjaGluZyB0cmFjayBpcyBhZGRlZFxuXG4gICAgICAgICAgdGhpcy5jYXB0aW9ucy5sYW5ndWFnZSA9IHRyYWNrLmxhbmd1YWdlOyAvLyBTZXQgY2FwdGlvbiwgYnV0IGRvbid0IHN0b3JlIGluIGxvY2FsU3RvcmFnZSBhcyB1c2VyIHByZWZlcmVuY2VcblxuICAgICAgICAgIGNhcHRpb25zLnNldC5jYWxsKHRoaXMsIHRyYWNrcy5pbmRleE9mKHRyYWNrKSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIFRvZ2dsZSBidXR0b24gaWYgaXQncyBlbmFibGVkXG5cblxuICAgICAgICBpZiAodGhpcy5lbGVtZW50cy5idXR0b25zLmNhcHRpb25zKSB7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5idXR0b25zLmNhcHRpb25zLnByZXNzZWQgPSBhY3RpdmU7XG4gICAgICAgIH0gLy8gQWRkIGNsYXNzIGhvb2tcblxuXG4gICAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCBhY3RpdmVDbGFzcywgYWN0aXZlKTtcbiAgICAgICAgdGhpcy5jYXB0aW9ucy50b2dnbGVkID0gYWN0aXZlOyAvLyBVcGRhdGUgc2V0dGluZ3MgbWVudVxuXG4gICAgICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbCh0aGlzLCAnY2FwdGlvbnMnKTsgLy8gVHJpZ2dlciBldmVudCAobm90IHVzZWQgaW50ZXJuYWxseSlcblxuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCBhY3RpdmUgPyAnY2FwdGlvbnNlbmFibGVkJyA6ICdjYXB0aW9uc2Rpc2FibGVkJyk7XG4gICAgICB9IC8vIFdhaXQgZm9yIHRoZSBjYWxsIHN0YWNrIHRvIGNsZWFyIGJlZm9yZSBzZXR0aW5nIG1vZGU9J2hpZGRlbidcbiAgICAgIC8vIG9uIHRoZSBhY3RpdmUgdHJhY2sgLSBmb3JjaW5nIHRoZSBicm93c2VyIHRvIGRvd25sb2FkIGl0XG5cblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlmIChhY3RpdmUgJiYgdGhpcy5jYXB0aW9ucy50b2dnbGVkKSB7XG4gICAgICAgICAgdGhpcy5jYXB0aW9ucy5jdXJyZW50VHJhY2tOb2RlLm1vZGUgPSAnaGlkZGVuJztcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8vIFNldCBjYXB0aW9ucyBieSB0cmFjayBpbmRleFxuICAgIC8vIFVzZWQgaW50ZXJuYWxseSBmb3IgdGhlIGN1cnJlbnRUcmFjayBzZXR0ZXIgd2l0aCB0aGUgcGFzc2l2ZSBvcHRpb24gZm9yY2VkIHRvIGZhbHNlXG4gICAgc2V0KGluZGV4LCBwYXNzaXZlID0gdHJ1ZSkge1xuICAgICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcyk7IC8vIERpc2FibGUgY2FwdGlvbnMgaWYgc2V0dGluZyB0byAtMVxuXG4gICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgIGNhcHRpb25zLnRvZ2dsZS5jYWxsKHRoaXMsIGZhbHNlLCBwYXNzaXZlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWlzLm51bWJlcihpbmRleCkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdJbnZhbGlkIGNhcHRpb24gYXJndW1lbnQnLCBpbmRleCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCEoaW5kZXggaW4gdHJhY2tzKSkge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oJ1RyYWNrIG5vdCBmb3VuZCcsIGluZGV4KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5jYXB0aW9ucy5jdXJyZW50VHJhY2sgIT09IGluZGV4KSB7XG4gICAgICAgIHRoaXMuY2FwdGlvbnMuY3VycmVudFRyYWNrID0gaW5kZXg7XG4gICAgICAgIGNvbnN0IHRyYWNrID0gdHJhY2tzW2luZGV4XTtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGxhbmd1YWdlXG4gICAgICAgIH0gPSB0cmFjayB8fCB7fTsgLy8gU3RvcmUgcmVmZXJlbmNlIHRvIG5vZGUgZm9yIGludmFsaWRhdGlvbiBvbiByZW1vdmVcblxuICAgICAgICB0aGlzLmNhcHRpb25zLmN1cnJlbnRUcmFja05vZGUgPSB0cmFjazsgLy8gVXBkYXRlIHNldHRpbmdzIG1lbnVcblxuICAgICAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwodGhpcywgJ2NhcHRpb25zJyk7IC8vIFdoZW4gcGFzc2l2ZSwgZG9uJ3Qgb3ZlcnJpZGUgdXNlciBwcmVmZXJlbmNlc1xuXG4gICAgICAgIGlmICghcGFzc2l2ZSkge1xuICAgICAgICAgIHRoaXMuY2FwdGlvbnMubGFuZ3VhZ2UgPSBsYW5ndWFnZTtcbiAgICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0KHtcbiAgICAgICAgICAgIGxhbmd1YWdlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gLy8gSGFuZGxlIFZpbWVvIGNhcHRpb25zXG5cblxuICAgICAgICBpZiAodGhpcy5pc1ZpbWVvKSB7XG4gICAgICAgICAgdGhpcy5lbWJlZC5lbmFibGVUZXh0VHJhY2sobGFuZ3VhZ2UpO1xuICAgICAgICB9IC8vIFRyaWdnZXIgZXZlbnRcblxuXG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsICdsYW5ndWFnZWNoYW5nZScpO1xuICAgICAgfSAvLyBTaG93IGNhcHRpb25zXG5cblxuICAgICAgY2FwdGlvbnMudG9nZ2xlLmNhbGwodGhpcywgdHJ1ZSwgcGFzc2l2ZSk7XG5cbiAgICAgIGlmICh0aGlzLmlzSFRNTDUgJiYgdGhpcy5pc1ZpZGVvKSB7XG4gICAgICAgIC8vIElmIHdlIGNoYW5nZSB0aGUgYWN0aXZlIHRyYWNrIHdoaWxlIGEgY3VlIGlzIGFscmVhZHkgZGlzcGxheWVkIHdlIG5lZWQgdG8gdXBkYXRlIGl0XG4gICAgICAgIGNhcHRpb25zLnVwZGF0ZUN1ZXMuY2FsbCh0aGlzKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gU2V0IGNhcHRpb25zIGJ5IGxhbmd1YWdlXG4gICAgLy8gVXNlZCBpbnRlcm5hbGx5IGZvciB0aGUgbGFuZ3VhZ2Ugc2V0dGVyIHdpdGggdGhlIHBhc3NpdmUgb3B0aW9uIGZvcmNlZCB0byBmYWxzZVxuICAgIHNldExhbmd1YWdlKGlucHV0LCBwYXNzaXZlID0gdHJ1ZSkge1xuICAgICAgaWYgKCFpcy5zdHJpbmcoaW5wdXQpKSB7XG4gICAgICAgIHRoaXMuZGVidWcud2FybignSW52YWxpZCBsYW5ndWFnZSBhcmd1bWVudCcsIGlucHV0KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBOb3JtYWxpemVcblxuXG4gICAgICBjb25zdCBsYW5ndWFnZSA9IGlucHV0LnRvTG93ZXJDYXNlKCk7XG4gICAgICB0aGlzLmNhcHRpb25zLmxhbmd1YWdlID0gbGFuZ3VhZ2U7IC8vIFNldCBjdXJyZW50VHJhY2tcblxuICAgICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcyk7XG4gICAgICBjb25zdCB0cmFjayA9IGNhcHRpb25zLmZpbmRUcmFjay5jYWxsKHRoaXMsIFtsYW5ndWFnZV0pO1xuICAgICAgY2FwdGlvbnMuc2V0LmNhbGwodGhpcywgdHJhY2tzLmluZGV4T2YodHJhY2spLCBwYXNzaXZlKTtcbiAgICB9LFxuXG4gICAgLy8gR2V0IGN1cnJlbnQgdmFsaWQgY2FwdGlvbiB0cmFja3NcbiAgICAvLyBJZiB1cGRhdGUgaXMgZmFsc2UgaXQgd2lsbCBhbHNvIGlnbm9yZSB0cmFja3Mgd2l0aG91dCBtZXRhZGF0YVxuICAgIC8vIFRoaXMgaXMgdXNlZCB0byBcImZyZWV6ZVwiIHRoZSBsYW5ndWFnZSBvcHRpb25zIHdoZW4gY2FwdGlvbnMudXBkYXRlIGlzIGZhbHNlXG4gICAgZ2V0VHJhY2tzKHVwZGF0ZSA9IGZhbHNlKSB7XG4gICAgICAvLyBIYW5kbGUgbWVkaWEgb3IgdGV4dFRyYWNrcyBtaXNzaW5nIG9yIG51bGxcbiAgICAgIGNvbnN0IHRyYWNrcyA9IEFycmF5LmZyb20oKHRoaXMubWVkaWEgfHwge30pLnRleHRUcmFja3MgfHwgW10pOyAvLyBGb3IgSFRNTDUsIHVzZSBjYWNoZSBpbnN0ZWFkIG9mIGN1cnJlbnQgdHJhY2tzIHdoZW4gaXQgZXhpc3RzIChpZiBjYXB0aW9ucy51cGRhdGUgaXMgZmFsc2UpXG4gICAgICAvLyBGaWx0ZXIgb3V0IHJlbW92ZWQgdHJhY2tzIGFuZCB0cmFja3MgdGhhdCBhcmVuJ3QgY2FwdGlvbnMvc3VidGl0bGVzIChmb3IgZXhhbXBsZSBtZXRhZGF0YSlcblxuICAgICAgcmV0dXJuIHRyYWNrcy5maWx0ZXIodHJhY2sgPT4gIXRoaXMuaXNIVE1MNSB8fCB1cGRhdGUgfHwgdGhpcy5jYXB0aW9ucy5tZXRhLmhhcyh0cmFjaykpLmZpbHRlcih0cmFjayA9PiBbJ2NhcHRpb25zJywgJ3N1YnRpdGxlcyddLmluY2x1ZGVzKHRyYWNrLmtpbmQpKTtcbiAgICB9LFxuXG4gICAgLy8gTWF0Y2ggdHJhY2tzIGJhc2VkIG9uIGxhbmd1YWdlcyBhbmQgZ2V0IHRoZSBmaXJzdFxuICAgIGZpbmRUcmFjayhsYW5ndWFnZXMsIGZvcmNlID0gZmFsc2UpIHtcbiAgICAgIGNvbnN0IHRyYWNrcyA9IGNhcHRpb25zLmdldFRyYWNrcy5jYWxsKHRoaXMpO1xuXG4gICAgICBjb25zdCBzb3J0SXNEZWZhdWx0ID0gdHJhY2sgPT4gTnVtYmVyKCh0aGlzLmNhcHRpb25zLm1ldGEuZ2V0KHRyYWNrKSB8fCB7fSkuZGVmYXVsdCk7XG5cbiAgICAgIGNvbnN0IHNvcnRlZCA9IEFycmF5LmZyb20odHJhY2tzKS5zb3J0KChhLCBiKSA9PiBzb3J0SXNEZWZhdWx0KGIpIC0gc29ydElzRGVmYXVsdChhKSk7XG4gICAgICBsZXQgdHJhY2s7XG4gICAgICBsYW5ndWFnZXMuZXZlcnkobGFuZ3VhZ2UgPT4ge1xuICAgICAgICB0cmFjayA9IHNvcnRlZC5maW5kKHQgPT4gdC5sYW5ndWFnZSA9PT0gbGFuZ3VhZ2UpO1xuICAgICAgICByZXR1cm4gIXRyYWNrOyAvLyBCcmVhayBpdGVyYXRpb24gaWYgdGhlcmUgaXMgYSBtYXRjaFxuICAgICAgfSk7IC8vIElmIG5vIG1hdGNoIGlzIGZvdW5kIGJ1dCBpcyByZXF1aXJlZCwgZ2V0IGZpcnN0XG5cbiAgICAgIHJldHVybiB0cmFjayB8fCAoZm9yY2UgPyBzb3J0ZWRbMF0gOiB1bmRlZmluZWQpO1xuICAgIH0sXG5cbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgdHJhY2tcbiAgICBnZXRDdXJyZW50VHJhY2soKSB7XG4gICAgICByZXR1cm4gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcylbdGhpcy5jdXJyZW50VHJhY2tdO1xuICAgIH0sXG5cbiAgICAvLyBHZXQgVUkgbGFiZWwgZm9yIHRyYWNrXG4gICAgZ2V0TGFiZWwodHJhY2spIHtcbiAgICAgIGxldCBjdXJyZW50VHJhY2sgPSB0cmFjaztcblxuICAgICAgaWYgKCFpcy50cmFjayhjdXJyZW50VHJhY2spICYmIHN1cHBvcnQudGV4dFRyYWNrcyAmJiB0aGlzLmNhcHRpb25zLnRvZ2dsZWQpIHtcbiAgICAgICAgY3VycmVudFRyYWNrID0gY2FwdGlvbnMuZ2V0Q3VycmVudFRyYWNrLmNhbGwodGhpcyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpcy50cmFjayhjdXJyZW50VHJhY2spKSB7XG4gICAgICAgIGlmICghaXMuZW1wdHkoY3VycmVudFRyYWNrLmxhYmVsKSkge1xuICAgICAgICAgIHJldHVybiBjdXJyZW50VHJhY2subGFiZWw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlzLmVtcHR5KGN1cnJlbnRUcmFjay5sYW5ndWFnZSkpIHtcbiAgICAgICAgICByZXR1cm4gdHJhY2subGFuZ3VhZ2UudG9VcHBlckNhc2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpMThuLmdldCgnZW5hYmxlZCcsIHRoaXMuY29uZmlnKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGkxOG4uZ2V0KCdkaXNhYmxlZCcsIHRoaXMuY29uZmlnKTtcbiAgICB9LFxuXG4gICAgLy8gVXBkYXRlIGNhcHRpb25zIHVzaW5nIGN1cnJlbnQgdHJhY2sncyBhY3RpdmUgY3Vlc1xuICAgIC8vIEFsc28gb3B0aW9uYWwgYXJyYXkgYXJndW1lbnQgaW4gY2FzZSB0aGVyZSBpc24ndCBhbnkgdHJhY2sgKGV4OiB2aW1lbylcbiAgICB1cGRhdGVDdWVzKGlucHV0KSB7XG4gICAgICAvLyBSZXF1aXJlcyBVSVxuICAgICAgaWYgKCF0aGlzLnN1cHBvcnRlZC51aSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICghaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmNhcHRpb25zKSkge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oJ05vIGNhcHRpb25zIGVsZW1lbnQgdG8gcmVuZGVyIHRvJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gT25seSBhY2NlcHQgYXJyYXkgb3IgZW1wdHkgaW5wdXRcblxuXG4gICAgICBpZiAoIWlzLm51bGxPclVuZGVmaW5lZChpbnB1dCkgJiYgIUFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XG4gICAgICAgIHRoaXMuZGVidWcud2FybigndXBkYXRlQ3VlczogSW52YWxpZCBpbnB1dCcsIGlucHV0KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBsZXQgY3VlcyA9IGlucHV0OyAvLyBHZXQgY3VlcyBmcm9tIHRyYWNrXG5cbiAgICAgIGlmICghY3Vlcykge1xuICAgICAgICBjb25zdCB0cmFjayA9IGNhcHRpb25zLmdldEN1cnJlbnRUcmFjay5jYWxsKHRoaXMpO1xuICAgICAgICBjdWVzID0gQXJyYXkuZnJvbSgodHJhY2sgfHwge30pLmFjdGl2ZUN1ZXMgfHwgW10pLm1hcChjdWUgPT4gY3VlLmdldEN1ZUFzSFRNTCgpKS5tYXAoZ2V0SFRNTCk7XG4gICAgICB9IC8vIFNldCBuZXcgY2FwdGlvbiB0ZXh0XG5cblxuICAgICAgY29uc3QgY29udGVudCA9IGN1ZXMubWFwKGN1ZVRleHQgPT4gY3VlVGV4dC50cmltKCkpLmpvaW4oJ1xcbicpO1xuICAgICAgY29uc3QgY2hhbmdlZCA9IGNvbnRlbnQgIT09IHRoaXMuZWxlbWVudHMuY2FwdGlvbnMuaW5uZXJIVE1MO1xuXG4gICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAvLyBFbXB0eSB0aGUgY29udGFpbmVyIGFuZCBjcmVhdGUgYSBuZXcgY2hpbGQgZWxlbWVudFxuICAgICAgICBlbXB0eUVsZW1lbnQodGhpcy5lbGVtZW50cy5jYXB0aW9ucyk7XG4gICAgICAgIGNvbnN0IGNhcHRpb24gPSBjcmVhdGVFbGVtZW50KCdzcGFuJywgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY2FwdGlvbikpO1xuICAgICAgICBjYXB0aW9uLmlubmVySFRNTCA9IGNvbnRlbnQ7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuY2FwdGlvbnMuYXBwZW5kQ2hpbGQoY2FwdGlvbik7IC8vIFRyaWdnZXIgZXZlbnRcblxuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCAnY3VlY2hhbmdlJyk7XG4gICAgICB9XG4gICAgfVxuXG4gIH07XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gUGx5ciBkZWZhdWx0IGNvbmZpZ1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBkZWZhdWx0cyA9IHtcbiAgICAvLyBEaXNhYmxlXG4gICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAvLyBDdXN0b20gbWVkaWEgdGl0bGVcbiAgICB0aXRsZTogJycsXG4gICAgLy8gTG9nZ2luZyB0byBjb25zb2xlXG4gICAgZGVidWc6IGZhbHNlLFxuICAgIC8vIEF1dG8gcGxheSAoaWYgc3VwcG9ydGVkKVxuICAgIGF1dG9wbGF5OiBmYWxzZSxcbiAgICAvLyBPbmx5IGFsbG93IG9uZSBtZWRpYSBwbGF5aW5nIGF0IG9uY2UgKHZpbWVvIG9ubHkpXG4gICAgYXV0b3BhdXNlOiB0cnVlLFxuICAgIC8vIEFsbG93IGlubGluZSBwbGF5YmFjayBvbiBpT1MgKHRoaXMgZWZmZWN0cyBZb3VUdWJlL1ZpbWVvIC0gSFRNTDUgcmVxdWlyZXMgdGhlIGF0dHJpYnV0ZSBwcmVzZW50KVxuICAgIC8vIFRPRE86IFJlbW92ZSBpb3NOYXRpdmUgZnVsbHNjcmVlbiBvcHRpb24gaW4gZmF2b3VyIG9mIHRoaXMgKGxvZ2ljIG5lZWRzIHdvcmspXG4gICAgcGxheXNpbmxpbmU6IHRydWUsXG4gICAgLy8gRGVmYXVsdCB0aW1lIHRvIHNraXAgd2hlbiByZXdpbmQvZmFzdCBmb3J3YXJkXG4gICAgc2Vla1RpbWU6IDEwLFxuICAgIC8vIERlZmF1bHQgdm9sdW1lXG4gICAgdm9sdW1lOiAxLFxuICAgIG11dGVkOiBmYWxzZSxcbiAgICAvLyBQYXNzIGEgY3VzdG9tIGR1cmF0aW9uXG4gICAgZHVyYXRpb246IG51bGwsXG4gICAgLy8gRGlzcGxheSB0aGUgbWVkaWEgZHVyYXRpb24gb24gbG9hZCBpbiB0aGUgY3VycmVudCB0aW1lIHBvc2l0aW9uXG4gICAgLy8gSWYgeW91IGhhdmUgb3B0ZWQgdG8gZGlzcGxheSBib3RoIGR1cmF0aW9uIGFuZCBjdXJyZW50VGltZSwgdGhpcyBpcyBpZ25vcmVkXG4gICAgZGlzcGxheUR1cmF0aW9uOiB0cnVlLFxuICAgIC8vIEludmVydCB0aGUgY3VycmVudCB0aW1lIHRvIGJlIGEgY291bnRkb3duXG4gICAgaW52ZXJ0VGltZTogdHJ1ZSxcbiAgICAvLyBDbGlja2luZyB0aGUgY3VycmVudFRpbWUgaW52ZXJ0cyBpdCdzIHZhbHVlIHRvIHNob3cgdGltZSBsZWZ0IHJhdGhlciB0aGFuIGVsYXBzZWRcbiAgICB0b2dnbGVJbnZlcnQ6IHRydWUsXG4gICAgLy8gRm9yY2UgYW4gYXNwZWN0IHJhdGlvXG4gICAgLy8gVGhlIGZvcm1hdCBtdXN0IGJlIGAndzpoJ2AgKGUuZy4gYCcxNjo5J2ApXG4gICAgcmF0aW86IG51bGwsXG4gICAgLy8gQ2xpY2sgdmlkZW8gY29udGFpbmVyIHRvIHBsYXkvcGF1c2VcbiAgICBjbGlja1RvUGxheTogdHJ1ZSxcbiAgICAvLyBBdXRvIGhpZGUgdGhlIGNvbnRyb2xzXG4gICAgaGlkZUNvbnRyb2xzOiB0cnVlLFxuICAgIC8vIFJlc2V0IHRvIHN0YXJ0IHdoZW4gcGxheWJhY2sgZW5kZWRcbiAgICByZXNldE9uRW5kOiBmYWxzZSxcbiAgICAvLyBEaXNhYmxlIHRoZSBzdGFuZGFyZCBjb250ZXh0IG1lbnVcbiAgICBkaXNhYmxlQ29udGV4dE1lbnU6IHRydWUsXG4gICAgLy8gU3ByaXRlIChmb3IgaWNvbnMpXG4gICAgbG9hZFNwcml0ZTogdHJ1ZSxcbiAgICBpY29uUHJlZml4OiAncGx5cicsXG4gICAgaWNvblVybDogJ2h0dHBzOi8vY2RuLnBseXIuaW8vMy43LjIvcGx5ci5zdmcnLFxuICAgIC8vIEJsYW5rIHZpZGVvICh1c2VkIHRvIHByZXZlbnQgZXJyb3JzIG9uIHNvdXJjZSBjaGFuZ2UpXG4gICAgYmxhbmtWaWRlbzogJ2h0dHBzOi8vY2RuLnBseXIuaW8vc3RhdGljL2JsYW5rLm1wNCcsXG4gICAgLy8gUXVhbGl0eSBkZWZhdWx0XG4gICAgcXVhbGl0eToge1xuICAgICAgZGVmYXVsdDogNTc2LFxuICAgICAgLy8gVGhlIG9wdGlvbnMgdG8gZGlzcGxheSBpbiB0aGUgVUksIGlmIGF2YWlsYWJsZSBmb3IgdGhlIHNvdXJjZSBtZWRpYVxuICAgICAgb3B0aW9uczogWzQzMjAsIDI4ODAsIDIxNjAsIDE0NDAsIDEwODAsIDcyMCwgNTc2LCA0ODAsIDM2MCwgMjQwXSxcbiAgICAgIGZvcmNlZDogZmFsc2UsXG4gICAgICBvbkNoYW5nZTogbnVsbFxuICAgIH0sXG4gICAgLy8gU2V0IGxvb3BzXG4gICAgbG9vcDoge1xuICAgICAgYWN0aXZlOiBmYWxzZSAvLyBzdGFydDogbnVsbCxcbiAgICAgIC8vIGVuZDogbnVsbCxcblxuICAgIH0sXG4gICAgLy8gU3BlZWQgZGVmYXVsdCBhbmQgb3B0aW9ucyB0byBkaXNwbGF5XG4gICAgc3BlZWQ6IHtcbiAgICAgIHNlbGVjdGVkOiAxLFxuICAgICAgLy8gVGhlIG9wdGlvbnMgdG8gZGlzcGxheSBpbiB0aGUgVUksIGlmIGF2YWlsYWJsZSBmb3IgdGhlIHNvdXJjZSBtZWRpYSAoZS5nLiBWaW1lbyBhbmQgWW91VHViZSBvbmx5IHN1cHBvcnQgMC41eC00eClcbiAgICAgIG9wdGlvbnM6IFswLjUsIDAuNzUsIDEsIDEuMjUsIDEuNSwgMS43NSwgMiwgNF1cbiAgICB9LFxuICAgIC8vIEtleWJvYXJkIHNob3J0Y3V0IHNldHRpbmdzXG4gICAga2V5Ym9hcmQ6IHtcbiAgICAgIGZvY3VzZWQ6IHRydWUsXG4gICAgICBnbG9iYWw6IGZhbHNlXG4gICAgfSxcbiAgICAvLyBEaXNwbGF5IHRvb2x0aXBzXG4gICAgdG9vbHRpcHM6IHtcbiAgICAgIGNvbnRyb2xzOiBmYWxzZSxcbiAgICAgIHNlZWs6IHRydWVcbiAgICB9LFxuICAgIC8vIENhcHRpb25zIHNldHRpbmdzXG4gICAgY2FwdGlvbnM6IHtcbiAgICAgIGFjdGl2ZTogZmFsc2UsXG4gICAgICBsYW5ndWFnZTogJ2F1dG8nLFxuICAgICAgLy8gTGlzdGVuIHRvIG5ldyB0cmFja3MgYWRkZWQgYWZ0ZXIgUGx5ciBpcyBpbml0aWFsaXplZC5cbiAgICAgIC8vIFRoaXMgaXMgbmVlZGVkIGZvciBzdHJlYW1pbmcgY2FwdGlvbnMsIGJ1dCBtYXkgcmVzdWx0IGluIHVuc2VsZWN0YWJsZSBvcHRpb25zXG4gICAgICB1cGRhdGU6IGZhbHNlXG4gICAgfSxcbiAgICAvLyBGdWxsc2NyZWVuIHNldHRpbmdzXG4gICAgZnVsbHNjcmVlbjoge1xuICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIC8vIEFsbG93IGZ1bGxzY3JlZW4/XG4gICAgICBmYWxsYmFjazogdHJ1ZSxcbiAgICAgIC8vIEZhbGxiYWNrIHVzaW5nIGZ1bGwgdmlld3BvcnQvd2luZG93XG4gICAgICBpb3NOYXRpdmU6IGZhbHNlIC8vIFVzZSB0aGUgbmF0aXZlIGZ1bGxzY3JlZW4gaW4gaU9TIChkaXNhYmxlcyBjdXN0b20gY29udHJvbHMpXG4gICAgICAvLyBTZWxlY3RvciBmb3IgdGhlIGZ1bGxzY3JlZW4gY29udGFpbmVyIHNvIGNvbnRleHR1YWwgLyBub24tcGxheWVyIGNvbnRlbnQgY2FuIHJlbWFpbiB2aXNpYmxlIGluIGZ1bGxzY3JlZW4gbW9kZVxuICAgICAgLy8gTm9uLWFuY2VzdG9ycyBvZiB0aGUgcGxheWVyIGVsZW1lbnQgd2lsbCBiZSBpZ25vcmVkXG4gICAgICAvLyBjb250YWluZXI6IG51bGwsIC8vIGRlZmF1bHRzIHRvIHRoZSBwbGF5ZXIgZWxlbWVudFxuXG4gICAgfSxcbiAgICAvLyBMb2NhbCBzdG9yYWdlXG4gICAgc3RvcmFnZToge1xuICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIGtleTogJ3BseXInXG4gICAgfSxcbiAgICAvLyBEZWZhdWx0IGNvbnRyb2xzXG4gICAgY29udHJvbHM6IFsncGxheS1sYXJnZScsIC8vICdyZXN0YXJ0JyxcbiAgICAvLyAncmV3aW5kJyxcbiAgICAncGxheScsIC8vICdmYXN0LWZvcndhcmQnLFxuICAgICdwcm9ncmVzcycsICdjdXJyZW50LXRpbWUnLCAvLyAnZHVyYXRpb24nLFxuICAgICdtdXRlJywgJ3ZvbHVtZScsICdjYXB0aW9ucycsICdzZXR0aW5ncycsICdwaXAnLCAnYWlycGxheScsIC8vICdkb3dubG9hZCcsXG4gICAgJ2Z1bGxzY3JlZW4nXSxcbiAgICBzZXR0aW5nczogWydjYXB0aW9ucycsICdxdWFsaXR5JywgJ3NwZWVkJ10sXG4gICAgLy8gTG9jYWxpc2F0aW9uXG4gICAgaTE4bjoge1xuICAgICAgcmVzdGFydDogJ1Jlc3RhcnQnLFxuICAgICAgcmV3aW5kOiAnUmV3aW5kIHtzZWVrdGltZX1zJyxcbiAgICAgIHBsYXk6ICdQbGF5JyxcbiAgICAgIHBhdXNlOiAnUGF1c2UnLFxuICAgICAgZmFzdEZvcndhcmQ6ICdGb3J3YXJkIHtzZWVrdGltZX1zJyxcbiAgICAgIHNlZWs6ICdTZWVrJyxcbiAgICAgIHNlZWtMYWJlbDogJ3tjdXJyZW50VGltZX0gb2Yge2R1cmF0aW9ufScsXG4gICAgICBwbGF5ZWQ6ICdQbGF5ZWQnLFxuICAgICAgYnVmZmVyZWQ6ICdCdWZmZXJlZCcsXG4gICAgICBjdXJyZW50VGltZTogJ0N1cnJlbnQgdGltZScsXG4gICAgICBkdXJhdGlvbjogJ0R1cmF0aW9uJyxcbiAgICAgIHZvbHVtZTogJ1ZvbHVtZScsXG4gICAgICBtdXRlOiAnTXV0ZScsXG4gICAgICB1bm11dGU6ICdVbm11dGUnLFxuICAgICAgZW5hYmxlQ2FwdGlvbnM6ICdFbmFibGUgY2FwdGlvbnMnLFxuICAgICAgZGlzYWJsZUNhcHRpb25zOiAnRGlzYWJsZSBjYXB0aW9ucycsXG4gICAgICBkb3dubG9hZDogJ0Rvd25sb2FkJyxcbiAgICAgIGVudGVyRnVsbHNjcmVlbjogJ0VudGVyIGZ1bGxzY3JlZW4nLFxuICAgICAgZXhpdEZ1bGxzY3JlZW46ICdFeGl0IGZ1bGxzY3JlZW4nLFxuICAgICAgZnJhbWVUaXRsZTogJ1BsYXllciBmb3Ige3RpdGxlfScsXG4gICAgICBjYXB0aW9uczogJ0NhcHRpb25zJyxcbiAgICAgIHNldHRpbmdzOiAnU2V0dGluZ3MnLFxuICAgICAgcGlwOiAnUElQJyxcbiAgICAgIG1lbnVCYWNrOiAnR28gYmFjayB0byBwcmV2aW91cyBtZW51JyxcbiAgICAgIHNwZWVkOiAnU3BlZWQnLFxuICAgICAgbm9ybWFsOiAnTm9ybWFsJyxcbiAgICAgIHF1YWxpdHk6ICdRdWFsaXR5JyxcbiAgICAgIGxvb3A6ICdMb29wJyxcbiAgICAgIHN0YXJ0OiAnU3RhcnQnLFxuICAgICAgZW5kOiAnRW5kJyxcbiAgICAgIGFsbDogJ0FsbCcsXG4gICAgICByZXNldDogJ1Jlc2V0JyxcbiAgICAgIGRpc2FibGVkOiAnRGlzYWJsZWQnLFxuICAgICAgZW5hYmxlZDogJ0VuYWJsZWQnLFxuICAgICAgYWR2ZXJ0aXNlbWVudDogJ0FkJyxcbiAgICAgIHF1YWxpdHlCYWRnZToge1xuICAgICAgICAyMTYwOiAnNEsnLFxuICAgICAgICAxNDQwOiAnSEQnLFxuICAgICAgICAxMDgwOiAnSEQnLFxuICAgICAgICA3MjA6ICdIRCcsXG4gICAgICAgIDU3NjogJ1NEJyxcbiAgICAgICAgNDgwOiAnU0QnXG4gICAgICB9XG4gICAgfSxcbiAgICAvLyBVUkxzXG4gICAgdXJsczoge1xuICAgICAgZG93bmxvYWQ6IG51bGwsXG4gICAgICB2aW1lbzoge1xuICAgICAgICBzZGs6ICdodHRwczovL3BsYXllci52aW1lby5jb20vYXBpL3BsYXllci5qcycsXG4gICAgICAgIGlmcmFtZTogJ2h0dHBzOi8vcGxheWVyLnZpbWVvLmNvbS92aWRlby97MH0/ezF9JyxcbiAgICAgICAgYXBpOiAnaHR0cHM6Ly92aW1lby5jb20vYXBpL29lbWJlZC5qc29uP3VybD17MH0nXG4gICAgICB9LFxuICAgICAgeW91dHViZToge1xuICAgICAgICBzZGs6ICdodHRwczovL3d3dy55b3V0dWJlLmNvbS9pZnJhbWVfYXBpJyxcbiAgICAgICAgYXBpOiAnaHR0cHM6Ly9ub2VtYmVkLmNvbS9lbWJlZD91cmw9aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj17MH0nXG4gICAgICB9LFxuICAgICAgZ29vZ2xlSU1BOiB7XG4gICAgICAgIHNkazogJ2h0dHBzOi8vaW1hc2RrLmdvb2dsZWFwaXMuY29tL2pzL3Nka2xvYWRlci9pbWEzLmpzJ1xuICAgICAgfVxuICAgIH0sXG4gICAgLy8gQ3VzdG9tIGNvbnRyb2wgbGlzdGVuZXJzXG4gICAgbGlzdGVuZXJzOiB7XG4gICAgICBzZWVrOiBudWxsLFxuICAgICAgcGxheTogbnVsbCxcbiAgICAgIHBhdXNlOiBudWxsLFxuICAgICAgcmVzdGFydDogbnVsbCxcbiAgICAgIHJld2luZDogbnVsbCxcbiAgICAgIGZhc3RGb3J3YXJkOiBudWxsLFxuICAgICAgbXV0ZTogbnVsbCxcbiAgICAgIHZvbHVtZTogbnVsbCxcbiAgICAgIGNhcHRpb25zOiBudWxsLFxuICAgICAgZG93bmxvYWQ6IG51bGwsXG4gICAgICBmdWxsc2NyZWVuOiBudWxsLFxuICAgICAgcGlwOiBudWxsLFxuICAgICAgYWlycGxheTogbnVsbCxcbiAgICAgIHNwZWVkOiBudWxsLFxuICAgICAgcXVhbGl0eTogbnVsbCxcbiAgICAgIGxvb3A6IG51bGwsXG4gICAgICBsYW5ndWFnZTogbnVsbFxuICAgIH0sXG4gICAgLy8gRXZlbnRzIHRvIHdhdGNoIGFuZCBidWJibGVcbiAgICBldmVudHM6IFsvLyBFdmVudHMgdG8gd2F0Y2ggb24gSFRNTDUgbWVkaWEgZWxlbWVudHMgYW5kIGJ1YmJsZVxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL2RvY3MvV2ViL0d1aWRlL0V2ZW50cy9NZWRpYV9ldmVudHNcbiAgICAnZW5kZWQnLCAncHJvZ3Jlc3MnLCAnc3RhbGxlZCcsICdwbGF5aW5nJywgJ3dhaXRpbmcnLCAnY2FucGxheScsICdjYW5wbGF5dGhyb3VnaCcsICdsb2Fkc3RhcnQnLCAnbG9hZGVkZGF0YScsICdsb2FkZWRtZXRhZGF0YScsICd0aW1ldXBkYXRlJywgJ3ZvbHVtZWNoYW5nZScsICdwbGF5JywgJ3BhdXNlJywgJ2Vycm9yJywgJ3NlZWtpbmcnLCAnc2Vla2VkJywgJ2VtcHRpZWQnLCAncmF0ZWNoYW5nZScsICdjdWVjaGFuZ2UnLCAvLyBDdXN0b20gZXZlbnRzXG4gICAgJ2Rvd25sb2FkJywgJ2VudGVyZnVsbHNjcmVlbicsICdleGl0ZnVsbHNjcmVlbicsICdjYXB0aW9uc2VuYWJsZWQnLCAnY2FwdGlvbnNkaXNhYmxlZCcsICdsYW5ndWFnZWNoYW5nZScsICdjb250cm9sc2hpZGRlbicsICdjb250cm9sc3Nob3duJywgJ3JlYWR5JywgLy8gWW91VHViZVxuICAgICdzdGF0ZWNoYW5nZScsIC8vIFF1YWxpdHlcbiAgICAncXVhbGl0eWNoYW5nZScsIC8vIEFkc1xuICAgICdhZHNsb2FkZWQnLCAnYWRzY29udGVudHBhdXNlJywgJ2Fkc2NvbnRlbnRyZXN1bWUnLCAnYWRzdGFydGVkJywgJ2Fkc21pZHBvaW50JywgJ2Fkc2NvbXBsZXRlJywgJ2Fkc2FsbGNvbXBsZXRlJywgJ2Fkc2ltcHJlc3Npb24nLCAnYWRzY2xpY2snXSxcbiAgICAvLyBTZWxlY3RvcnNcbiAgICAvLyBDaGFuZ2UgdGhlc2UgdG8gbWF0Y2ggeW91ciB0ZW1wbGF0ZSBpZiB1c2luZyBjdXN0b20gSFRNTFxuICAgIHNlbGVjdG9yczoge1xuICAgICAgZWRpdGFibGU6ICdpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCwgW2NvbnRlbnRlZGl0YWJsZV0nLFxuICAgICAgY29udGFpbmVyOiAnLnBseXInLFxuICAgICAgY29udHJvbHM6IHtcbiAgICAgICAgY29udGFpbmVyOiBudWxsLFxuICAgICAgICB3cmFwcGVyOiAnLnBseXJfX2NvbnRyb2xzJ1xuICAgICAgfSxcbiAgICAgIGxhYmVsczogJ1tkYXRhLXBseXJdJyxcbiAgICAgIGJ1dHRvbnM6IHtcbiAgICAgICAgcGxheTogJ1tkYXRhLXBseXI9XCJwbGF5XCJdJyxcbiAgICAgICAgcGF1c2U6ICdbZGF0YS1wbHlyPVwicGF1c2VcIl0nLFxuICAgICAgICByZXN0YXJ0OiAnW2RhdGEtcGx5cj1cInJlc3RhcnRcIl0nLFxuICAgICAgICByZXdpbmQ6ICdbZGF0YS1wbHlyPVwicmV3aW5kXCJdJyxcbiAgICAgICAgZmFzdEZvcndhcmQ6ICdbZGF0YS1wbHlyPVwiZmFzdC1mb3J3YXJkXCJdJyxcbiAgICAgICAgbXV0ZTogJ1tkYXRhLXBseXI9XCJtdXRlXCJdJyxcbiAgICAgICAgY2FwdGlvbnM6ICdbZGF0YS1wbHlyPVwiY2FwdGlvbnNcIl0nLFxuICAgICAgICBkb3dubG9hZDogJ1tkYXRhLXBseXI9XCJkb3dubG9hZFwiXScsXG4gICAgICAgIGZ1bGxzY3JlZW46ICdbZGF0YS1wbHlyPVwiZnVsbHNjcmVlblwiXScsXG4gICAgICAgIHBpcDogJ1tkYXRhLXBseXI9XCJwaXBcIl0nLFxuICAgICAgICBhaXJwbGF5OiAnW2RhdGEtcGx5cj1cImFpcnBsYXlcIl0nLFxuICAgICAgICBzZXR0aW5nczogJ1tkYXRhLXBseXI9XCJzZXR0aW5nc1wiXScsXG4gICAgICAgIGxvb3A6ICdbZGF0YS1wbHlyPVwibG9vcFwiXSdcbiAgICAgIH0sXG4gICAgICBpbnB1dHM6IHtcbiAgICAgICAgc2VlazogJ1tkYXRhLXBseXI9XCJzZWVrXCJdJyxcbiAgICAgICAgdm9sdW1lOiAnW2RhdGEtcGx5cj1cInZvbHVtZVwiXScsXG4gICAgICAgIHNwZWVkOiAnW2RhdGEtcGx5cj1cInNwZWVkXCJdJyxcbiAgICAgICAgbGFuZ3VhZ2U6ICdbZGF0YS1wbHlyPVwibGFuZ3VhZ2VcIl0nLFxuICAgICAgICBxdWFsaXR5OiAnW2RhdGEtcGx5cj1cInF1YWxpdHlcIl0nXG4gICAgICB9LFxuICAgICAgZGlzcGxheToge1xuICAgICAgICBjdXJyZW50VGltZTogJy5wbHlyX190aW1lLS1jdXJyZW50JyxcbiAgICAgICAgZHVyYXRpb246ICcucGx5cl9fdGltZS0tZHVyYXRpb24nLFxuICAgICAgICBidWZmZXI6ICcucGx5cl9fcHJvZ3Jlc3NfX2J1ZmZlcicsXG4gICAgICAgIGxvb3A6ICcucGx5cl9fcHJvZ3Jlc3NfX2xvb3AnLFxuICAgICAgICAvLyBVc2VkIGxhdGVyXG4gICAgICAgIHZvbHVtZTogJy5wbHlyX192b2x1bWUtLWRpc3BsYXknXG4gICAgICB9LFxuICAgICAgcHJvZ3Jlc3M6ICcucGx5cl9fcHJvZ3Jlc3MnLFxuICAgICAgY2FwdGlvbnM6ICcucGx5cl9fY2FwdGlvbnMnLFxuICAgICAgY2FwdGlvbjogJy5wbHlyX19jYXB0aW9uJ1xuICAgIH0sXG4gICAgLy8gQ2xhc3MgaG9va3MgYWRkZWQgdG8gdGhlIHBsYXllciBpbiBkaWZmZXJlbnQgc3RhdGVzXG4gICAgY2xhc3NOYW1lczoge1xuICAgICAgdHlwZTogJ3BseXItLXswfScsXG4gICAgICBwcm92aWRlcjogJ3BseXItLXswfScsXG4gICAgICB2aWRlbzogJ3BseXJfX3ZpZGVvLXdyYXBwZXInLFxuICAgICAgZW1iZWQ6ICdwbHlyX192aWRlby1lbWJlZCcsXG4gICAgICB2aWRlb0ZpeGVkUmF0aW86ICdwbHlyX192aWRlby13cmFwcGVyLS1maXhlZC1yYXRpbycsXG4gICAgICBlbWJlZENvbnRhaW5lcjogJ3BseXJfX3ZpZGVvLWVtYmVkX19jb250YWluZXInLFxuICAgICAgcG9zdGVyOiAncGx5cl9fcG9zdGVyJyxcbiAgICAgIHBvc3RlckVuYWJsZWQ6ICdwbHlyX19wb3N0ZXItZW5hYmxlZCcsXG4gICAgICBhZHM6ICdwbHlyX19hZHMnLFxuICAgICAgY29udHJvbDogJ3BseXJfX2NvbnRyb2wnLFxuICAgICAgY29udHJvbFByZXNzZWQ6ICdwbHlyX19jb250cm9sLS1wcmVzc2VkJyxcbiAgICAgIHBsYXlpbmc6ICdwbHlyLS1wbGF5aW5nJyxcbiAgICAgIHBhdXNlZDogJ3BseXItLXBhdXNlZCcsXG4gICAgICBzdG9wcGVkOiAncGx5ci0tc3RvcHBlZCcsXG4gICAgICBsb2FkaW5nOiAncGx5ci0tbG9hZGluZycsXG4gICAgICBob3ZlcjogJ3BseXItLWhvdmVyJyxcbiAgICAgIHRvb2x0aXA6ICdwbHlyX190b29sdGlwJyxcbiAgICAgIGN1ZXM6ICdwbHlyX19jdWVzJyxcbiAgICAgIG1hcmtlcjogJ3BseXJfX3Byb2dyZXNzX19tYXJrZXInLFxuICAgICAgaGlkZGVuOiAncGx5cl9fc3Itb25seScsXG4gICAgICBoaWRlQ29udHJvbHM6ICdwbHlyLS1oaWRlLWNvbnRyb2xzJyxcbiAgICAgIGlzSW9zOiAncGx5ci0taXMtaW9zJyxcbiAgICAgIGlzVG91Y2g6ICdwbHlyLS1pcy10b3VjaCcsXG4gICAgICB1aVN1cHBvcnRlZDogJ3BseXItLWZ1bGwtdWknLFxuICAgICAgbm9UcmFuc2l0aW9uOiAncGx5ci0tbm8tdHJhbnNpdGlvbicsXG4gICAgICBkaXNwbGF5OiB7XG4gICAgICAgIHRpbWU6ICdwbHlyX190aW1lJ1xuICAgICAgfSxcbiAgICAgIG1lbnU6IHtcbiAgICAgICAgdmFsdWU6ICdwbHlyX19tZW51X192YWx1ZScsXG4gICAgICAgIGJhZGdlOiAncGx5cl9fYmFkZ2UnLFxuICAgICAgICBvcGVuOiAncGx5ci0tbWVudS1vcGVuJ1xuICAgICAgfSxcbiAgICAgIGNhcHRpb25zOiB7XG4gICAgICAgIGVuYWJsZWQ6ICdwbHlyLS1jYXB0aW9ucy1lbmFibGVkJyxcbiAgICAgICAgYWN0aXZlOiAncGx5ci0tY2FwdGlvbnMtYWN0aXZlJ1xuICAgICAgfSxcbiAgICAgIGZ1bGxzY3JlZW46IHtcbiAgICAgICAgZW5hYmxlZDogJ3BseXItLWZ1bGxzY3JlZW4tZW5hYmxlZCcsXG4gICAgICAgIGZhbGxiYWNrOiAncGx5ci0tZnVsbHNjcmVlbi1mYWxsYmFjaydcbiAgICAgIH0sXG4gICAgICBwaXA6IHtcbiAgICAgICAgc3VwcG9ydGVkOiAncGx5ci0tcGlwLXN1cHBvcnRlZCcsXG4gICAgICAgIGFjdGl2ZTogJ3BseXItLXBpcC1hY3RpdmUnXG4gICAgICB9LFxuICAgICAgYWlycGxheToge1xuICAgICAgICBzdXBwb3J0ZWQ6ICdwbHlyLS1haXJwbGF5LXN1cHBvcnRlZCcsXG4gICAgICAgIGFjdGl2ZTogJ3BseXItLWFpcnBsYXktYWN0aXZlJ1xuICAgICAgfSxcbiAgICAgIHRhYkZvY3VzOiAncGx5cl9fdGFiLWZvY3VzJyxcbiAgICAgIHByZXZpZXdUaHVtYm5haWxzOiB7XG4gICAgICAgIC8vIFRvb2x0aXAgdGh1bWJzXG4gICAgICAgIHRodW1iQ29udGFpbmVyOiAncGx5cl9fcHJldmlldy10aHVtYicsXG4gICAgICAgIHRodW1iQ29udGFpbmVyU2hvd246ICdwbHlyX19wcmV2aWV3LXRodW1iLS1pcy1zaG93bicsXG4gICAgICAgIGltYWdlQ29udGFpbmVyOiAncGx5cl9fcHJldmlldy10aHVtYl9faW1hZ2UtY29udGFpbmVyJyxcbiAgICAgICAgdGltZUNvbnRhaW5lcjogJ3BseXJfX3ByZXZpZXctdGh1bWJfX3RpbWUtY29udGFpbmVyJyxcbiAgICAgICAgLy8gU2NydWJiaW5nXG4gICAgICAgIHNjcnViYmluZ0NvbnRhaW5lcjogJ3BseXJfX3ByZXZpZXctc2NydWJiaW5nJyxcbiAgICAgICAgc2NydWJiaW5nQ29udGFpbmVyU2hvd246ICdwbHlyX19wcmV2aWV3LXNjcnViYmluZy0taXMtc2hvd24nXG4gICAgICB9XG4gICAgfSxcbiAgICAvLyBFbWJlZCBhdHRyaWJ1dGVzXG4gICAgYXR0cmlidXRlczoge1xuICAgICAgZW1iZWQ6IHtcbiAgICAgICAgcHJvdmlkZXI6ICdkYXRhLXBseXItcHJvdmlkZXInLFxuICAgICAgICBpZDogJ2RhdGEtcGx5ci1lbWJlZC1pZCcsXG4gICAgICAgIGhhc2g6ICdkYXRhLXBseXItZW1iZWQtaGFzaCdcbiAgICAgIH1cbiAgICB9LFxuICAgIC8vIEFkdmVydGlzZW1lbnRzIHBsdWdpblxuICAgIC8vIFJlZ2lzdGVyIGZvciBhbiBhY2NvdW50IGhlcmU6IGh0dHA6Ly92aS5haS9wdWJsaXNoZXItdmlkZW8tbW9uZXRpemF0aW9uLz9haWQ9cGx5cmlvXG4gICAgYWRzOiB7XG4gICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgIHB1Ymxpc2hlcklkOiAnJyxcbiAgICAgIHRhZ1VybDogJydcbiAgICB9LFxuICAgIC8vIFByZXZpZXcgVGh1bWJuYWlscyBwbHVnaW5cbiAgICBwcmV2aWV3VGh1bWJuYWlsczoge1xuICAgICAgZW5hYmxlZDogZmFsc2UsXG4gICAgICBzcmM6ICcnXG4gICAgfSxcbiAgICAvLyBWaW1lbyBwbHVnaW5cbiAgICB2aW1lbzoge1xuICAgICAgYnlsaW5lOiBmYWxzZSxcbiAgICAgIHBvcnRyYWl0OiBmYWxzZSxcbiAgICAgIHRpdGxlOiBmYWxzZSxcbiAgICAgIHNwZWVkOiB0cnVlLFxuICAgICAgdHJhbnNwYXJlbnQ6IGZhbHNlLFxuICAgICAgLy8gQ3VzdG9tIHNldHRpbmdzIGZyb20gUGx5clxuICAgICAgY3VzdG9tQ29udHJvbHM6IHRydWUsXG4gICAgICByZWZlcnJlclBvbGljeTogbnVsbCxcbiAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9IVE1MSUZyYW1lRWxlbWVudC9yZWZlcnJlclBvbGljeVxuICAgICAgLy8gV2hldGhlciB0aGUgb3duZXIgb2YgdGhlIHZpZGVvIGhhcyBhIFBybyBvciBCdXNpbmVzcyBhY2NvdW50XG4gICAgICAvLyAod2hpY2ggYWxsb3dzIHVzIHRvIHByb3Blcmx5IGhpZGUgY29udHJvbHMgd2l0aG91dCBDU1MgaGFja3MsIGV0YylcbiAgICAgIHByZW1pdW06IGZhbHNlXG4gICAgfSxcbiAgICAvLyBZb3VUdWJlIHBsdWdpblxuICAgIHlvdXR1YmU6IHtcbiAgICAgIHJlbDogMCxcbiAgICAgIC8vIE5vIHJlbGF0ZWQgdmlkc1xuICAgICAgc2hvd2luZm86IDAsXG4gICAgICAvLyBIaWRlIGluZm9cbiAgICAgIGl2X2xvYWRfcG9saWN5OiAzLFxuICAgICAgLy8gSGlkZSBhbm5vdGF0aW9uc1xuICAgICAgbW9kZXN0YnJhbmRpbmc6IDEsXG4gICAgICAvLyBIaWRlIGxvZ29zIGFzIG11Y2ggYXMgcG9zc2libGUgKHRoZXkgc3RpbGwgc2hvdyBvbmUgaW4gdGhlIGNvcm5lciB3aGVuIHBhdXNlZClcbiAgICAgIC8vIEN1c3RvbSBzZXR0aW5ncyBmcm9tIFBseXJcbiAgICAgIGN1c3RvbUNvbnRyb2xzOiB0cnVlLFxuICAgICAgbm9Db29raWU6IGZhbHNlIC8vIFdoZXRoZXIgdG8gdXNlIGFuIGFsdGVybmF0aXZlIHZlcnNpb24gb2YgWW91VHViZSB3aXRob3V0IGNvb2tpZXNcblxuICAgIH0sXG4gICAgLy8gTWVkaWEgTWV0YWRhdGFcbiAgICBtZWRpYU1ldGFkYXRhOiB7XG4gICAgICB0aXRsZTogJycsXG4gICAgICBhcnRpc3Q6ICcnLFxuICAgICAgYWxidW06ICcnLFxuICAgICAgYXJ0d29yazogW11cbiAgICB9LFxuICAgIC8vIE1hcmtlcnNcbiAgICBtYXJrZXJzOiB7XG4gICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgIHBvaW50czogW11cbiAgICB9XG4gIH07XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gUGx5ciBzdGF0ZXNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgY29uc3QgcGlwID0ge1xuICAgIGFjdGl2ZTogJ3BpY3R1cmUtaW4tcGljdHVyZScsXG4gICAgaW5hY3RpdmU6ICdpbmxpbmUnXG4gIH07XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gUGx5ciBzdXBwb3J0ZWQgdHlwZXMgYW5kIHByb3ZpZGVyc1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBwcm92aWRlcnMgPSB7XG4gICAgaHRtbDU6ICdodG1sNScsXG4gICAgeW91dHViZTogJ3lvdXR1YmUnLFxuICAgIHZpbWVvOiAndmltZW8nXG4gIH07XG4gIGNvbnN0IHR5cGVzID0ge1xuICAgIGF1ZGlvOiAnYXVkaW8nLFxuICAgIHZpZGVvOiAndmlkZW8nXG4gIH07XG4gIC8qKlxuICAgKiBHZXQgcHJvdmlkZXIgYnkgVVJMXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB1cmxcbiAgICovXG5cbiAgZnVuY3Rpb24gZ2V0UHJvdmlkZXJCeVVybCh1cmwpIHtcbiAgICAvLyBZb3VUdWJlXG4gICAgaWYgKC9eKGh0dHBzPzpcXC9cXC8pPyh3d3dcXC4pPyh5b3V0dWJlXFwuY29tfHlvdXR1YmUtbm9jb29raWVcXC5jb218eW91dHVcXC4/YmUpXFwvLiskLy50ZXN0KHVybCkpIHtcbiAgICAgIHJldHVybiBwcm92aWRlcnMueW91dHViZTtcbiAgICB9IC8vIFZpbWVvXG5cblxuICAgIGlmICgvXmh0dHBzPzpcXC9cXC9wbGF5ZXIudmltZW8uY29tXFwvdmlkZW9cXC9cXGR7MCw5fSg/PVxcYnxcXC8pLy50ZXN0KHVybCkpIHtcbiAgICAgIHJldHVybiBwcm92aWRlcnMudmltZW87XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBDb25zb2xlIHdyYXBwZXJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgY29uc3Qgbm9vcCA9ICgpID0+IHt9O1xuXG4gIGNsYXNzIENvbnNvbGUge1xuICAgIGNvbnN0cnVjdG9yKGVuYWJsZWQgPSBmYWxzZSkge1xuICAgICAgdGhpcy5lbmFibGVkID0gd2luZG93LmNvbnNvbGUgJiYgZW5hYmxlZDtcblxuICAgICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgICB0aGlzLmxvZygnRGVidWdnaW5nIGVuYWJsZWQnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgbG9nKCkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIHJldHVybiB0aGlzLmVuYWJsZWQgPyBGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5jYWxsKGNvbnNvbGUubG9nLCBjb25zb2xlKSA6IG5vb3A7XG4gICAgfVxuXG4gICAgZ2V0IHdhcm4oKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgcmV0dXJuIHRoaXMuZW5hYmxlZCA/IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS53YXJuLCBjb25zb2xlKSA6IG5vb3A7XG4gICAgfVxuXG4gICAgZ2V0IGVycm9yKCkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIHJldHVybiB0aGlzLmVuYWJsZWQgPyBGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5jYWxsKGNvbnNvbGUuZXJyb3IsIGNvbnNvbGUpIDogbm9vcDtcbiAgICB9XG5cbiAgfVxuXG4gIGNsYXNzIEZ1bGxzY3JlZW4ge1xuICAgIGNvbnN0cnVjdG9yKHBsYXllcikge1xuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJvbkNoYW5nZVwiLCAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIFVwZGF0ZSB0b2dnbGUgYnV0dG9uXG5cblxuICAgICAgICBjb25zdCBidXR0b24gPSB0aGlzLnBsYXllci5lbGVtZW50cy5idXR0b25zLmZ1bGxzY3JlZW47XG5cbiAgICAgICAgaWYgKGlzLmVsZW1lbnQoYnV0dG9uKSkge1xuICAgICAgICAgIGJ1dHRvbi5wcmVzc2VkID0gdGhpcy5hY3RpdmU7XG4gICAgICAgIH0gLy8gQWx3YXlzIHRyaWdnZXIgZXZlbnRzIG9uIHRoZSBwbHlyIC8gbWVkaWEgZWxlbWVudCAobm90IGEgZnVsbHNjcmVlbiBjb250YWluZXIpIGFuZCBsZXQgdGhlbSBidWJibGUgdXBcblxuXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMudGFyZ2V0ID09PSB0aGlzLnBsYXllci5tZWRpYSA/IHRoaXMudGFyZ2V0IDogdGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyOyAvLyBUcmlnZ2VyIGFuIGV2ZW50XG5cbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcy5wbGF5ZXIsIHRhcmdldCwgdGhpcy5hY3RpdmUgPyAnZW50ZXJmdWxsc2NyZWVuJyA6ICdleGl0ZnVsbHNjcmVlbicsIHRydWUpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwidG9nZ2xlRmFsbGJhY2tcIiwgKHRvZ2dsZSA9IGZhbHNlKSA9PiB7XG4gICAgICAgIC8vIFN0b3JlIG9yIHJlc3RvcmUgc2Nyb2xsIHBvc2l0aW9uXG4gICAgICAgIGlmICh0b2dnbGUpIHtcbiAgICAgICAgICB0aGlzLnNjcm9sbFBvc2l0aW9uID0ge1xuICAgICAgICAgICAgeDogd2luZG93LnNjcm9sbFggfHwgMCxcbiAgICAgICAgICAgIHk6IHdpbmRvdy5zY3JvbGxZIHx8IDBcbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbyh0aGlzLnNjcm9sbFBvc2l0aW9uLngsIHRoaXMuc2Nyb2xsUG9zaXRpb24ueSk7XG4gICAgICAgIH0gLy8gVG9nZ2xlIHNjcm9sbFxuXG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IHRvZ2dsZSA/ICdoaWRkZW4nIDogJyc7IC8vIFRvZ2dsZSBjbGFzcyBob29rXG5cbiAgICAgICAgdG9nZ2xlQ2xhc3ModGhpcy50YXJnZXQsIHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmZ1bGxzY3JlZW4uZmFsbGJhY2ssIHRvZ2dsZSk7IC8vIEZvcmNlIGZ1bGwgdmlld3BvcnQgb24gaVBob25lIFgrXG5cbiAgICAgICAgaWYgKGJyb3dzZXIuaXNJb3MpIHtcbiAgICAgICAgICBsZXQgdmlld3BvcnQgPSBkb2N1bWVudC5oZWFkLnF1ZXJ5U2VsZWN0b3IoJ21ldGFbbmFtZT1cInZpZXdwb3J0XCJdJyk7XG4gICAgICAgICAgY29uc3QgcHJvcGVydHkgPSAndmlld3BvcnQtZml0PWNvdmVyJzsgLy8gSW5qZWN0IHRoZSB2aWV3cG9ydCBtZXRhIGlmIHJlcXVpcmVkXG5cbiAgICAgICAgICBpZiAoIXZpZXdwb3J0KSB7XG4gICAgICAgICAgICB2aWV3cG9ydCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ21ldGEnKTtcbiAgICAgICAgICAgIHZpZXdwb3J0LnNldEF0dHJpYnV0ZSgnbmFtZScsICd2aWV3cG9ydCcpO1xuICAgICAgICAgIH0gLy8gQ2hlY2sgaWYgdGhlIHByb3BlcnR5IGFscmVhZHkgZXhpc3RzXG5cblxuICAgICAgICAgIGNvbnN0IGhhc1Byb3BlcnR5ID0gaXMuc3RyaW5nKHZpZXdwb3J0LmNvbnRlbnQpICYmIHZpZXdwb3J0LmNvbnRlbnQuaW5jbHVkZXMocHJvcGVydHkpO1xuXG4gICAgICAgICAgaWYgKHRvZ2dsZSkge1xuICAgICAgICAgICAgdGhpcy5jbGVhbnVwVmlld3BvcnQgPSAhaGFzUHJvcGVydHk7XG5cbiAgICAgICAgICAgIGlmICghaGFzUHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgdmlld3BvcnQuY29udGVudCArPSBgLCR7cHJvcGVydHl9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY2xlYW51cFZpZXdwb3J0KSB7XG4gICAgICAgICAgICB2aWV3cG9ydC5jb250ZW50ID0gdmlld3BvcnQuY29udGVudC5zcGxpdCgnLCcpLmZpbHRlcihwYXJ0ID0+IHBhcnQudHJpbSgpICE9PSBwcm9wZXJ0eSkuam9pbignLCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSAvLyBUb2dnbGUgYnV0dG9uIGFuZCBmaXJlIGV2ZW50c1xuXG5cbiAgICAgICAgdGhpcy5vbkNoYW5nZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwidHJhcEZvY3VzXCIsIGV2ZW50ID0+IHtcbiAgICAgICAgLy8gQmFpbCBpZiBpT1MsIG5vdCBhY3RpdmUsIG5vdCB0aGUgdGFiIGtleVxuICAgICAgICBpZiAoYnJvd3Nlci5pc0lvcyB8fCAhdGhpcy5hY3RpdmUgfHwgZXZlbnQua2V5ICE9PSAnVGFiJykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBHZXQgdGhlIGN1cnJlbnQgZm9jdXNlZCBlbGVtZW50XG5cblxuICAgICAgICBjb25zdCBmb2N1c2VkID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICAgICAgY29uc3QgZm9jdXNhYmxlID0gZ2V0RWxlbWVudHMuY2FsbCh0aGlzLnBsYXllciwgJ2FbaHJlZl0sIGJ1dHRvbjpub3QoOmRpc2FibGVkKSwgaW5wdXQ6bm90KDpkaXNhYmxlZCksIFt0YWJpbmRleF0nKTtcbiAgICAgICAgY29uc3QgW2ZpcnN0XSA9IGZvY3VzYWJsZTtcbiAgICAgICAgY29uc3QgbGFzdCA9IGZvY3VzYWJsZVtmb2N1c2FibGUubGVuZ3RoIC0gMV07XG5cbiAgICAgICAgaWYgKGZvY3VzZWQgPT09IGxhc3QgJiYgIWV2ZW50LnNoaWZ0S2V5KSB7XG4gICAgICAgICAgLy8gTW92ZSBmb2N1cyB0byBmaXJzdCBlbGVtZW50IHRoYXQgY2FuIGJlIHRhYmJlZCBpZiBTaGlmdCBpc24ndCB1c2VkXG4gICAgICAgICAgZmlyc3QuZm9jdXMoKTtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9IGVsc2UgaWYgKGZvY3VzZWQgPT09IGZpcnN0ICYmIGV2ZW50LnNoaWZ0S2V5KSB7XG4gICAgICAgICAgLy8gTW92ZSBmb2N1cyB0byBsYXN0IGVsZW1lbnQgdGhhdCBjYW4gYmUgdGFiYmVkIGlmIFNoaWZ0IGlzIHVzZWRcbiAgICAgICAgICBsYXN0LmZvY3VzKCk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwidXBkYXRlXCIsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgICAgIGxldCBtb2RlO1xuXG4gICAgICAgICAgaWYgKHRoaXMuZm9yY2VGYWxsYmFjaykge1xuICAgICAgICAgICAgbW9kZSA9ICdGYWxsYmFjayAoZm9yY2VkKSc7XG4gICAgICAgICAgfSBlbHNlIGlmIChGdWxsc2NyZWVuLm5hdGl2ZSkge1xuICAgICAgICAgICAgbW9kZSA9ICdOYXRpdmUnO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtb2RlID0gJ0ZhbGxiYWNrJztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYCR7bW9kZX0gZnVsbHNjcmVlbiBlbmFibGVkYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKCdGdWxsc2NyZWVuIG5vdCBzdXBwb3J0ZWQgYW5kIGZhbGxiYWNrIGRpc2FibGVkJyk7XG4gICAgICAgIH0gLy8gQWRkIHN0eWxpbmcgaG9vayB0byBzaG93IGJ1dHRvblxuXG5cbiAgICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5mdWxsc2NyZWVuLmVuYWJsZWQsIHRoaXMuZW5hYmxlZCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJlbnRlclwiLCAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIGlPUyBuYXRpdmUgZnVsbHNjcmVlbiBkb2Vzbid0IG5lZWQgdGhlIHJlcXVlc3Qgc3RlcFxuXG5cbiAgICAgICAgaWYgKGJyb3dzZXIuaXNJb3MgJiYgdGhpcy5wbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uaW9zTmF0aXZlKSB7XG4gICAgICAgICAgaWYgKHRoaXMucGxheWVyLmlzVmltZW8pIHtcbiAgICAgICAgICAgIHRoaXMucGxheWVyLmVtYmVkLnJlcXVlc3RGdWxsc2NyZWVuKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0LndlYmtpdEVudGVyRnVsbHNjcmVlbigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghRnVsbHNjcmVlbi5uYXRpdmUgfHwgdGhpcy5mb3JjZUZhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy50b2dnbGVGYWxsYmFjayh0cnVlKTtcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5wcmVmaXgpIHtcbiAgICAgICAgICB0aGlzLnRhcmdldC5yZXF1ZXN0RnVsbHNjcmVlbih7XG4gICAgICAgICAgICBuYXZpZ2F0aW9uVUk6ICdoaWRlJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKCFpcy5lbXB0eSh0aGlzLnByZWZpeCkpIHtcbiAgICAgICAgICB0aGlzLnRhcmdldFtgJHt0aGlzLnByZWZpeH1SZXF1ZXN0JHt0aGlzLnByb3BlcnR5fWBdKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImV4aXRcIiwgKCkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBpT1MgbmF0aXZlIGZ1bGxzY3JlZW5cblxuXG4gICAgICAgIGlmIChicm93c2VyLmlzSW9zICYmIHRoaXMucGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmlvc05hdGl2ZSkge1xuICAgICAgICAgIHRoaXMudGFyZ2V0LndlYmtpdEV4aXRGdWxsc2NyZWVuKCk7XG4gICAgICAgICAgc2lsZW5jZVByb21pc2UodGhpcy5wbGF5ZXIucGxheSgpKTtcbiAgICAgICAgfSBlbHNlIGlmICghRnVsbHNjcmVlbi5uYXRpdmUgfHwgdGhpcy5mb3JjZUZhbGxiYWNrKSB7XG4gICAgICAgICAgdGhpcy50b2dnbGVGYWxsYmFjayhmYWxzZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoIXRoaXMucHJlZml4KSB7XG4gICAgICAgICAgKGRvY3VtZW50LmNhbmNlbEZ1bGxTY3JlZW4gfHwgZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4pLmNhbGwoZG9jdW1lbnQpO1xuICAgICAgICB9IGVsc2UgaWYgKCFpcy5lbXB0eSh0aGlzLnByZWZpeCkpIHtcbiAgICAgICAgICBjb25zdCBhY3Rpb24gPSB0aGlzLnByZWZpeCA9PT0gJ21veicgPyAnQ2FuY2VsJyA6ICdFeGl0JztcbiAgICAgICAgICBkb2N1bWVudFtgJHt0aGlzLnByZWZpeH0ke2FjdGlvbn0ke3RoaXMucHJvcGVydHl9YF0oKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwidG9nZ2xlXCIsICgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmFjdGl2ZSkge1xuICAgICAgICAgIHRoaXMuZW50ZXIoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmV4aXQoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIEtlZXAgcmVmZXJlbmNlIHRvIHBhcmVudFxuICAgICAgdGhpcy5wbGF5ZXIgPSBwbGF5ZXI7IC8vIEdldCBwcmVmaXhcblxuICAgICAgdGhpcy5wcmVmaXggPSBGdWxsc2NyZWVuLnByZWZpeDtcbiAgICAgIHRoaXMucHJvcGVydHkgPSBGdWxsc2NyZWVuLnByb3BlcnR5OyAvLyBTY3JvbGwgcG9zaXRpb25cblxuICAgICAgdGhpcy5zY3JvbGxQb3NpdGlvbiA9IHtcbiAgICAgICAgeDogMCxcbiAgICAgICAgeTogMFxuICAgICAgfTsgLy8gRm9yY2UgdGhlIHVzZSBvZiAnZnVsbCB3aW5kb3cvYnJvd3NlcicgcmF0aGVyIHRoYW4gZnVsbHNjcmVlblxuXG4gICAgICB0aGlzLmZvcmNlRmFsbGJhY2sgPSBwbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uZmFsbGJhY2sgPT09ICdmb3JjZSc7IC8vIEdldCB0aGUgZnVsbHNjcmVlbiBlbGVtZW50XG4gICAgICAvLyBDaGVja3MgY29udGFpbmVyIGlzIGFuIGFuY2VzdG9yLCBkZWZhdWx0cyB0byBudWxsXG5cbiAgICAgIHRoaXMucGxheWVyLmVsZW1lbnRzLmZ1bGxzY3JlZW4gPSBwbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uY29udGFpbmVyICYmIGNsb3Nlc3QkMSh0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXIsIHBsYXllci5jb25maWcuZnVsbHNjcmVlbi5jb250YWluZXIpOyAvLyBSZWdpc3RlciBldmVudCBsaXN0ZW5lcnNcbiAgICAgIC8vIEhhbmRsZSBldmVudCAoaW5jYXNlIHVzZXIgcHJlc3NlcyBlc2NhcGUgZXRjKVxuXG4gICAgICBvbi5jYWxsKHRoaXMucGxheWVyLCBkb2N1bWVudCwgdGhpcy5wcmVmaXggPT09ICdtcycgPyAnTVNGdWxsc2NyZWVuQ2hhbmdlJyA6IGAke3RoaXMucHJlZml4fWZ1bGxzY3JlZW5jaGFuZ2VgLCAoKSA9PiB7XG4gICAgICAgIC8vIFRPRE86IEZpbHRlciBmb3IgdGFyZ2V0Pz9cbiAgICAgICAgdGhpcy5vbkNoYW5nZSgpO1xuICAgICAgfSk7IC8vIEZ1bGxzY3JlZW4gdG9nZ2xlIG9uIGRvdWJsZSBjbGlja1xuXG4gICAgICBvbi5jYWxsKHRoaXMucGxheWVyLCB0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXIsICdkYmxjbGljaycsIGV2ZW50ID0+IHtcbiAgICAgICAgLy8gSWdub3JlIGRvdWJsZSBjbGljayBpbiBjb250cm9sc1xuICAgICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLnBsYXllci5lbGVtZW50cy5jb250cm9scykgJiYgdGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udHJvbHMuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucGxheWVyLmxpc3RlbmVycy5wcm94eShldmVudCwgdGhpcy50b2dnbGUsICdmdWxsc2NyZWVuJyk7XG4gICAgICB9KTsgLy8gVGFwIGZvY3VzIHdoZW4gaW4gZnVsbHNjcmVlblxuXG4gICAgICBvbi5jYWxsKHRoaXMsIHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lciwgJ2tleWRvd24nLCBldmVudCA9PiB0aGlzLnRyYXBGb2N1cyhldmVudCkpOyAvLyBVcGRhdGUgdGhlIFVJXG5cbiAgICAgIHRoaXMudXBkYXRlKCk7IC8vIHRoaXMudG9nZ2xlID0gdGhpcy50b2dnbGUuYmluZCh0aGlzKTtcbiAgICB9IC8vIERldGVybWluZSBpZiBuYXRpdmUgc3VwcG9ydGVkXG5cblxuICAgIHN0YXRpYyBnZXQgbmF0aXZlKCkge1xuICAgICAgcmV0dXJuICEhKGRvY3VtZW50LmZ1bGxzY3JlZW5FbmFibGVkIHx8IGRvY3VtZW50LndlYmtpdEZ1bGxzY3JlZW5FbmFibGVkIHx8IGRvY3VtZW50Lm1vekZ1bGxTY3JlZW5FbmFibGVkIHx8IGRvY3VtZW50Lm1zRnVsbHNjcmVlbkVuYWJsZWQpO1xuICAgIH0gLy8gSWYgd2UncmUgYWN0dWFsbHkgdXNpbmcgbmF0aXZlXG5cblxuICAgIGdldCB1c2luZ05hdGl2ZSgpIHtcbiAgICAgIHJldHVybiBGdWxsc2NyZWVuLm5hdGl2ZSAmJiAhdGhpcy5mb3JjZUZhbGxiYWNrO1xuICAgIH0gLy8gR2V0IHRoZSBwcmVmaXggZm9yIGhhbmRsZXJzXG5cblxuICAgIHN0YXRpYyBnZXQgcHJlZml4KCkge1xuICAgICAgLy8gTm8gcHJlZml4XG4gICAgICBpZiAoaXMuZnVuY3Rpb24oZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4pKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICAgIH0gLy8gQ2hlY2sgZm9yIGZ1bGxzY3JlZW4gc3VwcG9ydCBieSB2ZW5kb3IgcHJlZml4XG5cblxuICAgICAgbGV0IHZhbHVlID0gJyc7XG4gICAgICBjb25zdCBwcmVmaXhlcyA9IFsnd2Via2l0JywgJ21veicsICdtcyddO1xuICAgICAgcHJlZml4ZXMuc29tZShwcmUgPT4ge1xuICAgICAgICBpZiAoaXMuZnVuY3Rpb24oZG9jdW1lbnRbYCR7cHJlfUV4aXRGdWxsc2NyZWVuYF0pIHx8IGlzLmZ1bmN0aW9uKGRvY3VtZW50W2Ake3ByZX1DYW5jZWxGdWxsU2NyZWVuYF0pKSB7XG4gICAgICAgICAgdmFsdWUgPSBwcmU7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZ2V0IHByb3BlcnR5KCkge1xuICAgICAgcmV0dXJuIHRoaXMucHJlZml4ID09PSAnbW96JyA/ICdGdWxsU2NyZWVuJyA6ICdGdWxsc2NyZWVuJztcbiAgICB9IC8vIERldGVybWluZSBpZiBmdWxsc2NyZWVuIGlzIGVuYWJsZWRcblxuXG4gICAgZ2V0IGVuYWJsZWQoKSB7XG4gICAgICByZXR1cm4gKEZ1bGxzY3JlZW4ubmF0aXZlIHx8IHRoaXMucGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmZhbGxiYWNrKSAmJiB0aGlzLnBsYXllci5jb25maWcuZnVsbHNjcmVlbi5lbmFibGVkICYmIHRoaXMucGxheWVyLnN1cHBvcnRlZC51aSAmJiB0aGlzLnBsYXllci5pc1ZpZGVvO1xuICAgIH0gLy8gR2V0IGFjdGl2ZSBzdGF0ZVxuXG5cbiAgICBnZXQgYWN0aXZlKCkge1xuICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfSAvLyBGYWxsYmFjayB1c2luZyBjbGFzc25hbWVcblxuXG4gICAgICBpZiAoIUZ1bGxzY3JlZW4ubmF0aXZlIHx8IHRoaXMuZm9yY2VGYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gaGFzQ2xhc3ModGhpcy50YXJnZXQsIHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmZ1bGxzY3JlZW4uZmFsbGJhY2spO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBlbGVtZW50ID0gIXRoaXMucHJlZml4ID8gdGhpcy50YXJnZXQuZ2V0Um9vdE5vZGUoKS5mdWxsc2NyZWVuRWxlbWVudCA6IHRoaXMudGFyZ2V0LmdldFJvb3ROb2RlKClbYCR7dGhpcy5wcmVmaXh9JHt0aGlzLnByb3BlcnR5fUVsZW1lbnRgXTtcbiAgICAgIHJldHVybiBlbGVtZW50ICYmIGVsZW1lbnQuc2hhZG93Um9vdCA/IGVsZW1lbnQgPT09IHRoaXMudGFyZ2V0LmdldFJvb3ROb2RlKCkuaG9zdCA6IGVsZW1lbnQgPT09IHRoaXMudGFyZ2V0O1xuICAgIH0gLy8gR2V0IHRhcmdldCBlbGVtZW50XG5cblxuICAgIGdldCB0YXJnZXQoKSB7XG4gICAgICByZXR1cm4gYnJvd3Nlci5pc0lvcyAmJiB0aGlzLnBsYXllci5jb25maWcuZnVsbHNjcmVlbi5pb3NOYXRpdmUgPyB0aGlzLnBsYXllci5tZWRpYSA6IHRoaXMucGxheWVyLmVsZW1lbnRzLmZ1bGxzY3JlZW4gfHwgdGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyO1xuICAgIH1cblxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gTG9hZCBpbWFnZSBhdm9pZGluZyB4aHIvZmV0Y2ggQ09SUyBpc3N1ZXNcbiAgLy8gU2VydmVyIHN0YXR1cyBjYW4ndCBiZSBvYnRhaW5lZCB0aGlzIHdheSB1bmZvcnR1bmF0ZWx5LCBzbyB0aGlzIHVzZXMgXCJuYXR1cmFsV2lkdGhcIiB0byBkZXRlcm1pbmUgaWYgdGhlIGltYWdlIGhhcyBsb2FkZWRcbiAgLy8gQnkgZGVmYXVsdCBpdCBjaGVja3MgaWYgaXQgaXMgYXQgbGVhc3QgMXB4LCBidXQgeW91IGNhbiBhZGQgYSBzZWNvbmQgYXJndW1lbnQgdG8gY2hhbmdlIHRoaXNcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgZnVuY3Rpb24gbG9hZEltYWdlKHNyYywgbWluV2lkdGggPSAxKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGNvbnN0IGltYWdlID0gbmV3IEltYWdlKCk7XG5cbiAgICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICAgIGRlbGV0ZSBpbWFnZS5vbmxvYWQ7XG4gICAgICAgIGRlbGV0ZSBpbWFnZS5vbmVycm9yO1xuICAgICAgICAoaW1hZ2UubmF0dXJhbFdpZHRoID49IG1pbldpZHRoID8gcmVzb2x2ZSA6IHJlamVjdCkoaW1hZ2UpO1xuICAgICAgfTtcblxuICAgICAgT2JqZWN0LmFzc2lnbihpbWFnZSwge1xuICAgICAgICBvbmxvYWQ6IGhhbmRsZXIsXG4gICAgICAgIG9uZXJyb3I6IGhhbmRsZXIsXG4gICAgICAgIHNyY1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCB1aSA9IHtcbiAgICBhZGRTdHlsZUhvb2soKSB7XG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuc2VsZWN0b3JzLmNvbnRhaW5lci5yZXBsYWNlKCcuJywgJycpLCB0cnVlKTtcbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnVpU3VwcG9ydGVkLCB0aGlzLnN1cHBvcnRlZC51aSk7XG4gICAgfSxcblxuICAgIC8vIFRvZ2dsZSBuYXRpdmUgSFRNTDUgbWVkaWEgY29udHJvbHNcbiAgICB0b2dnbGVOYXRpdmVDb250cm9scyh0b2dnbGUgPSBmYWxzZSkge1xuICAgICAgaWYgKHRvZ2dsZSAmJiB0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xzJywgJycpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5tZWRpYS5yZW1vdmVBdHRyaWJ1dGUoJ2NvbnRyb2xzJyk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIFNldHVwIHRoZSBVSVxuICAgIGJ1aWxkKCkge1xuICAgICAgLy8gUmUtYXR0YWNoIG1lZGlhIGVsZW1lbnQgbGlzdGVuZXJzXG4gICAgICAvLyBUT0RPOiBVc2UgZXZlbnQgYnViYmxpbmc/XG4gICAgICB0aGlzLmxpc3RlbmVycy5tZWRpYSgpOyAvLyBEb24ndCBzZXR1cCBpbnRlcmZhY2UgaWYgbm8gc3VwcG9ydFxuXG4gICAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICAgIHRoaXMuZGVidWcud2FybihgQmFzaWMgc3VwcG9ydCBvbmx5IGZvciAke3RoaXMucHJvdmlkZXJ9ICR7dGhpcy50eXBlfWApOyAvLyBSZXN0b3JlIG5hdGl2ZSBjb250cm9sc1xuXG4gICAgICAgIHVpLnRvZ2dsZU5hdGl2ZUNvbnRyb2xzLmNhbGwodGhpcywgdHJ1ZSk7IC8vIEJhaWxcblxuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIEluamVjdCBjdXN0b20gY29udHJvbHMgaWYgbm90IHByZXNlbnRcblxuXG4gICAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5jb250cm9scykpIHtcbiAgICAgICAgLy8gSW5qZWN0IGN1c3RvbSBjb250cm9sc1xuICAgICAgICBjb250cm9scy5pbmplY3QuY2FsbCh0aGlzKTsgLy8gUmUtYXR0YWNoIGNvbnRyb2wgbGlzdGVuZXJzXG5cbiAgICAgICAgdGhpcy5saXN0ZW5lcnMuY29udHJvbHMoKTtcbiAgICAgIH0gLy8gUmVtb3ZlIG5hdGl2ZSBjb250cm9sc1xuXG5cbiAgICAgIHVpLnRvZ2dsZU5hdGl2ZUNvbnRyb2xzLmNhbGwodGhpcyk7IC8vIFNldHVwIGNhcHRpb25zIGZvciBIVE1MNVxuXG4gICAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICAgIGNhcHRpb25zLnNldHVwLmNhbGwodGhpcyk7XG4gICAgICB9IC8vIFJlc2V0IHZvbHVtZVxuXG5cbiAgICAgIHRoaXMudm9sdW1lID0gbnVsbDsgLy8gUmVzZXQgbXV0ZSBzdGF0ZVxuXG4gICAgICB0aGlzLm11dGVkID0gbnVsbDsgLy8gUmVzZXQgbG9vcCBzdGF0ZVxuXG4gICAgICB0aGlzLmxvb3AgPSBudWxsOyAvLyBSZXNldCBxdWFsaXR5IHNldHRpbmdcblxuICAgICAgdGhpcy5xdWFsaXR5ID0gbnVsbDsgLy8gUmVzZXQgc3BlZWRcblxuICAgICAgdGhpcy5zcGVlZCA9IG51bGw7IC8vIFJlc2V0IHZvbHVtZSBkaXNwbGF5XG5cbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVZvbHVtZS5jYWxsKHRoaXMpOyAvLyBSZXNldCB0aW1lIGRpc3BsYXlcblxuICAgICAgY29udHJvbHMudGltZVVwZGF0ZS5jYWxsKHRoaXMpOyAvLyBSZXNldCBkdXJhdGlvbiBkaXNwbGF5XG5cbiAgICAgIGNvbnRyb2xzLmR1cmF0aW9uVXBkYXRlLmNhbGwodGhpcyk7IC8vIFVwZGF0ZSB0aGUgVUlcblxuICAgICAgdWkuY2hlY2tQbGF5aW5nLmNhbGwodGhpcyk7IC8vIENoZWNrIGZvciBwaWN0dXJlLWluLXBpY3R1cmUgc3VwcG9ydFxuXG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5waXAuc3VwcG9ydGVkLCBzdXBwb3J0LnBpcCAmJiB0aGlzLmlzSFRNTDUgJiYgdGhpcy5pc1ZpZGVvKTsgLy8gQ2hlY2sgZm9yIGFpcnBsYXkgc3VwcG9ydFxuXG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5haXJwbGF5LnN1cHBvcnRlZCwgc3VwcG9ydC5haXJwbGF5ICYmIHRoaXMuaXNIVE1MNSk7IC8vIEFkZCBpT1MgY2xhc3NcblxuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaXNJb3MsIGJyb3dzZXIuaXNJb3MpOyAvLyBBZGQgdG91Y2ggY2xhc3NcblxuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaXNUb3VjaCwgdGhpcy50b3VjaCk7IC8vIFJlYWR5IGZvciBBUEkgY2FsbHNcblxuICAgICAgdGhpcy5yZWFkeSA9IHRydWU7IC8vIFJlYWR5IGV2ZW50IGF0IGVuZCBvZiBleGVjdXRpb24gc3RhY2tcblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsICdyZWFkeScpO1xuICAgICAgfSwgMCk7IC8vIFNldCB0aGUgdGl0bGVcblxuICAgICAgdWkuc2V0VGl0bGUuY2FsbCh0aGlzKTsgLy8gQXNzdXJlIHRoZSBwb3N0ZXIgaW1hZ2UgaXMgc2V0LCBpZiB0aGUgcHJvcGVydHkgd2FzIGFkZGVkIGJlZm9yZSB0aGUgZWxlbWVudCB3YXMgY3JlYXRlZFxuXG4gICAgICBpZiAodGhpcy5wb3N0ZXIpIHtcbiAgICAgICAgdWkuc2V0UG9zdGVyLmNhbGwodGhpcywgdGhpcy5wb3N0ZXIsIGZhbHNlKS5jYXRjaCgoKSA9PiB7fSk7XG4gICAgICB9IC8vIE1hbnVhbGx5IHNldCB0aGUgZHVyYXRpb24gaWYgdXNlciBoYXMgb3ZlcnJpZGRlbiBpdC5cbiAgICAgIC8vIFRoZSBldmVudCBsaXN0ZW5lcnMgZm9yIGl0IGRvZXNuJ3QgZ2V0IGNhbGxlZCBpZiBwcmVsb2FkIGlzIGRpc2FibGVkICgjNzAxKVxuXG5cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5kdXJhdGlvbikge1xuICAgICAgICBjb250cm9scy5kdXJhdGlvblVwZGF0ZS5jYWxsKHRoaXMpO1xuICAgICAgfSAvLyBNZWRpYSBtZXRhZGF0YVxuXG5cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5tZWRpYU1ldGFkYXRhKSB7XG4gICAgICAgIGNvbnRyb2xzLnNldE1lZGlhTWV0YWRhdGEuY2FsbCh0aGlzKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gU2V0dXAgYXJpYSBhdHRyaWJ1dGUgZm9yIHBsYXkgYW5kIGlmcmFtZSB0aXRsZVxuICAgIHNldFRpdGxlKCkge1xuICAgICAgLy8gRmluZCB0aGUgY3VycmVudCB0ZXh0XG4gICAgICBsZXQgbGFiZWwgPSBpMThuLmdldCgncGxheScsIHRoaXMuY29uZmlnKTsgLy8gSWYgdGhlcmUncyBhIG1lZGlhIHRpdGxlIHNldCwgdXNlIHRoYXQgZm9yIHRoZSBsYWJlbFxuXG4gICAgICBpZiAoaXMuc3RyaW5nKHRoaXMuY29uZmlnLnRpdGxlKSAmJiAhaXMuZW1wdHkodGhpcy5jb25maWcudGl0bGUpKSB7XG4gICAgICAgIGxhYmVsICs9IGAsICR7dGhpcy5jb25maWcudGl0bGV9YDtcbiAgICAgIH0gLy8gSWYgdGhlcmUncyBhIHBsYXkgYnV0dG9uLCBzZXQgbGFiZWxcblxuXG4gICAgICBBcnJheS5mcm9tKHRoaXMuZWxlbWVudHMuYnV0dG9ucy5wbGF5IHx8IFtdKS5mb3JFYWNoKGJ1dHRvbiA9PiB7XG4gICAgICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBsYWJlbCk7XG4gICAgICB9KTsgLy8gU2V0IGlmcmFtZSB0aXRsZVxuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzEyNFxuXG4gICAgICBpZiAodGhpcy5pc0VtYmVkKSB7XG4gICAgICAgIGNvbnN0IGlmcmFtZSA9IGdldEVsZW1lbnQuY2FsbCh0aGlzLCAnaWZyYW1lJyk7XG5cbiAgICAgICAgaWYgKCFpcy5lbGVtZW50KGlmcmFtZSkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gRGVmYXVsdCB0byBtZWRpYSB0eXBlXG5cblxuICAgICAgICBjb25zdCB0aXRsZSA9ICFpcy5lbXB0eSh0aGlzLmNvbmZpZy50aXRsZSkgPyB0aGlzLmNvbmZpZy50aXRsZSA6ICd2aWRlbyc7XG4gICAgICAgIGNvbnN0IGZvcm1hdCA9IGkxOG4uZ2V0KCdmcmFtZVRpdGxlJywgdGhpcy5jb25maWcpO1xuICAgICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCd0aXRsZScsIGZvcm1hdC5yZXBsYWNlKCd7dGl0bGV9JywgdGl0bGUpKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gVG9nZ2xlIHBvc3RlclxuICAgIHRvZ2dsZVBvc3RlcihlbmFibGUpIHtcbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnBvc3RlckVuYWJsZWQsIGVuYWJsZSk7XG4gICAgfSxcblxuICAgIC8vIFNldCB0aGUgcG9zdGVyIGltYWdlIChhc3luYylcbiAgICAvLyBVc2VkIGludGVybmFsbHkgZm9yIHRoZSBwb3N0ZXIgc2V0dGVyLCB3aXRoIHRoZSBwYXNzaXZlIG9wdGlvbiBmb3JjZWQgdG8gZmFsc2VcbiAgICBzZXRQb3N0ZXIocG9zdGVyLCBwYXNzaXZlID0gdHJ1ZSkge1xuICAgICAgLy8gRG9uJ3Qgb3ZlcnJpZGUgaWYgY2FsbCBpcyBwYXNzaXZlXG4gICAgICBpZiAocGFzc2l2ZSAmJiB0aGlzLnBvc3Rlcikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdQb3N0ZXIgYWxyZWFkeSBzZXQnKSk7XG4gICAgICB9IC8vIFNldCBwcm9wZXJ0eSBzeW5jaHJvbm91c2x5IHRvIHJlc3BlY3QgdGhlIGNhbGwgb3JkZXJcblxuXG4gICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnZGF0YS1wb3N0ZXInLCBwb3N0ZXIpOyAvLyBTaG93IHRoZSBwb3N0ZXJcblxuICAgICAgdGhpcy5lbGVtZW50cy5wb3N0ZXIucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTsgLy8gV2FpdCB1bnRpbCB1aSBpcyByZWFkeVxuXG4gICAgICByZXR1cm4gcmVhZHkuY2FsbCh0aGlzKSAvLyBMb2FkIGltYWdlXG4gICAgICAudGhlbigoKSA9PiBsb2FkSW1hZ2UocG9zdGVyKSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAvLyBIaWRlIHBvc3RlciBvbiBlcnJvciB1bmxlc3MgaXQncyBiZWVuIHNldCBieSBhbm90aGVyIGNhbGxcbiAgICAgICAgaWYgKHBvc3RlciA9PT0gdGhpcy5wb3N0ZXIpIHtcbiAgICAgICAgICB1aS50b2dnbGVQb3N0ZXIuY2FsbCh0aGlzLCBmYWxzZSk7XG4gICAgICAgIH0gLy8gUmV0aHJvd1xuXG5cbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gUHJldmVudCByYWNlIGNvbmRpdGlvbnNcbiAgICAgICAgaWYgKHBvc3RlciAhPT0gdGhpcy5wb3N0ZXIpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFBvc3RlciBjYW5jZWxsZWQgYnkgbGF0ZXIgY2FsbCB0byBzZXRQb3N0ZXInKTtcbiAgICAgICAgfVxuICAgICAgfSkudGhlbigoKSA9PiB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5lbGVtZW50cy5wb3N0ZXIuc3R5bGUsIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6IGB1cmwoJyR7cG9zdGVyfScpYCxcbiAgICAgICAgICAvLyBSZXNldCBiYWNrZ3JvdW5kU2l6ZSBhcyB3ZWxsIChzaW5jZSBpdCBjYW4gYmUgc2V0IHRvIFwiY292ZXJcIiBmb3IgcGFkZGVkIHRodW1ibmFpbHMgZm9yIHlvdXR1YmUpXG4gICAgICAgICAgYmFja2dyb3VuZFNpemU6ICcnXG4gICAgICAgIH0pO1xuICAgICAgICB1aS50b2dnbGVQb3N0ZXIuY2FsbCh0aGlzLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIHBvc3RlcjtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyBDaGVjayBwbGF5aW5nIHN0YXRlXG4gICAgY2hlY2tQbGF5aW5nKGV2ZW50KSB7XG4gICAgICAvLyBDbGFzcyBob29rc1xuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMucGxheWluZywgdGhpcy5wbGF5aW5nKTtcbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnBhdXNlZCwgdGhpcy5wYXVzZWQpO1xuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuc3RvcHBlZCwgdGhpcy5zdG9wcGVkKTsgLy8gU2V0IHN0YXRlXG5cbiAgICAgIEFycmF5LmZyb20odGhpcy5lbGVtZW50cy5idXR0b25zLnBsYXkgfHwgW10pLmZvckVhY2godGFyZ2V0ID0+IHtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0YXJnZXQsIHtcbiAgICAgICAgICBwcmVzc2VkOiB0aGlzLnBsYXlpbmdcbiAgICAgICAgfSk7XG4gICAgICAgIHRhcmdldC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBpMThuLmdldCh0aGlzLnBsYXlpbmcgPyAncGF1c2UnIDogJ3BsYXknLCB0aGlzLmNvbmZpZykpO1xuICAgICAgfSk7IC8vIE9ubHkgdXBkYXRlIGNvbnRyb2xzIG9uIG5vbiB0aW1ldXBkYXRlIGV2ZW50c1xuXG4gICAgICBpZiAoaXMuZXZlbnQoZXZlbnQpICYmIGV2ZW50LnR5cGUgPT09ICd0aW1ldXBkYXRlJykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFRvZ2dsZSBjb250cm9sc1xuXG5cbiAgICAgIHVpLnRvZ2dsZUNvbnRyb2xzLmNhbGwodGhpcyk7XG4gICAgfSxcblxuICAgIC8vIENoZWNrIGlmIG1lZGlhIGlzIGxvYWRpbmdcbiAgICBjaGVja0xvYWRpbmcoZXZlbnQpIHtcbiAgICAgIHRoaXMubG9hZGluZyA9IFsnc3RhbGxlZCcsICd3YWl0aW5nJ10uaW5jbHVkZXMoZXZlbnQudHlwZSk7IC8vIENsZWFyIHRpbWVyXG5cbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5sb2FkaW5nKTsgLy8gVGltZXIgdG8gcHJldmVudCBmbGlja2VyIHdoZW4gc2Vla2luZ1xuXG4gICAgICB0aGlzLnRpbWVycy5sb2FkaW5nID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIC8vIFVwZGF0ZSBwcm9ncmVzcyBiYXIgbG9hZGluZyBjbGFzcyBzdGF0ZVxuICAgICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5sb2FkaW5nLCB0aGlzLmxvYWRpbmcpOyAvLyBVcGRhdGUgY29udHJvbHMgdmlzaWJpbGl0eVxuXG4gICAgICAgIHVpLnRvZ2dsZUNvbnRyb2xzLmNhbGwodGhpcyk7XG4gICAgICB9LCB0aGlzLmxvYWRpbmcgPyAyNTAgOiAwKTtcbiAgICB9LFxuXG4gICAgLy8gVG9nZ2xlIGNvbnRyb2xzIGJhc2VkIG9uIHN0YXRlIGFuZCBgZm9yY2VgIGFyZ3VtZW50XG4gICAgdG9nZ2xlQ29udHJvbHMoZm9yY2UpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgY29udHJvbHM6IGNvbnRyb2xzRWxlbWVudFxuICAgICAgfSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICAgIGlmIChjb250cm9sc0VsZW1lbnQgJiYgdGhpcy5jb25maWcuaGlkZUNvbnRyb2xzKSB7XG4gICAgICAgIC8vIERvbid0IGhpZGUgY29udHJvbHMgaWYgYSB0b3VjaC1kZXZpY2UgdXNlciByZWNlbnRseSBzZWVrZWQuIChNdXN0IGJlIGxpbWl0ZWQgdG8gdG91Y2ggZGV2aWNlcywgb3IgaXQgb2NjYXNpb25hbGx5IHByZXZlbnRzIGRlc2t0b3AgY29udHJvbHMgZnJvbSBoaWRpbmcuKVxuICAgICAgICBjb25zdCByZWNlbnRUb3VjaFNlZWsgPSB0aGlzLnRvdWNoICYmIHRoaXMubGFzdFNlZWtUaW1lICsgMjAwMCA+IERhdGUubm93KCk7IC8vIFNob3cgY29udHJvbHMgaWYgZm9yY2UsIGxvYWRpbmcsIHBhdXNlZCwgYnV0dG9uIGludGVyYWN0aW9uLCBvciByZWNlbnQgc2Vlaywgb3RoZXJ3aXNlIGhpZGVcblxuICAgICAgICB0aGlzLnRvZ2dsZUNvbnRyb2xzKEJvb2xlYW4oZm9yY2UgfHwgdGhpcy5sb2FkaW5nIHx8IHRoaXMucGF1c2VkIHx8IGNvbnRyb2xzRWxlbWVudC5wcmVzc2VkIHx8IGNvbnRyb2xzRWxlbWVudC5ob3ZlciB8fCByZWNlbnRUb3VjaFNlZWspKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gTWlncmF0ZSBhbnkgY3VzdG9tIHByb3BlcnRpZXMgZnJvbSB0aGUgbWVkaWEgdG8gdGhlIHBhcmVudFxuICAgIG1pZ3JhdGVTdHlsZXMoKSB7XG4gICAgICAvLyBMb29wIHRocm91Z2ggdmFsdWVzIChhcyB0aGV5IGFyZSB0aGUga2V5cyB3aGVuIHRoZSBvYmplY3QgaXMgc3ByZWFkIPCfpJQpXG4gICAgICBPYmplY3QudmFsdWVzKHsgLi4udGhpcy5tZWRpYS5zdHlsZVxuICAgICAgfSkgLy8gV2UncmUgb25seSBmdXNzZWQgYWJvdXQgUGx5ciBzcGVjaWZpYyBwcm9wZXJ0aWVzXG4gICAgICAuZmlsdGVyKGtleSA9PiAhaXMuZW1wdHkoa2V5KSAmJiBpcy5zdHJpbmcoa2V5KSAmJiBrZXkuc3RhcnRzV2l0aCgnLS1wbHlyJykpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgLy8gU2V0IG9uIHRoZSBjb250YWluZXJcbiAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuc3R5bGUuc2V0UHJvcGVydHkoa2V5LCB0aGlzLm1lZGlhLnN0eWxlLmdldFByb3BlcnR5VmFsdWUoa2V5KSk7IC8vIENsZWFuIHVwIGZyb20gbWVkaWEgZWxlbWVudFxuXG4gICAgICAgIHRoaXMubWVkaWEuc3R5bGUucmVtb3ZlUHJvcGVydHkoa2V5KTtcbiAgICAgIH0pOyAvLyBSZW1vdmUgYXR0cmlidXRlIGlmIGVtcHR5XG5cbiAgICAgIGlmIChpcy5lbXB0eSh0aGlzLm1lZGlhLnN0eWxlKSkge1xuICAgICAgICB0aGlzLm1lZGlhLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfTtcblxuICBjbGFzcyBMaXN0ZW5lcnMge1xuICAgIGNvbnN0cnVjdG9yKF9wbGF5ZXIpIHtcbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiZmlyc3RUb3VjaFwiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBwbGF5ZXJcbiAgICAgICAgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBlbGVtZW50c1xuICAgICAgICB9ID0gcGxheWVyO1xuICAgICAgICBwbGF5ZXIudG91Y2ggPSB0cnVlOyAvLyBBZGQgdG91Y2ggY2xhc3NcblxuICAgICAgICB0b2dnbGVDbGFzcyhlbGVtZW50cy5jb250YWluZXIsIHBsYXllci5jb25maWcuY2xhc3NOYW1lcy5pc1RvdWNoLCB0cnVlKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInNldFRhYkZvY3VzXCIsIGV2ZW50ID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHBsYXllclxuICAgICAgICB9ID0gdGhpcztcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGVsZW1lbnRzXG4gICAgICAgIH0gPSBwbGF5ZXI7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBrZXksXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICB0aW1lU3RhbXBcbiAgICAgICAgfSA9IGV2ZW50O1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5mb2N1c1RpbWVyKTsgLy8gSWdub3JlIGFueSBrZXkgb3RoZXIgdGhhbiB0YWJcblxuICAgICAgICBpZiAodHlwZSA9PT0gJ2tleWRvd24nICYmIGtleSAhPT0gJ1RhYicpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gLy8gU3RvcmUgcmVmZXJlbmNlIHRvIGV2ZW50IHRpbWVTdGFtcFxuXG5cbiAgICAgICAgaWYgKHR5cGUgPT09ICdrZXlkb3duJykge1xuICAgICAgICAgIHRoaXMubGFzdEtleURvd24gPSB0aW1lU3RhbXA7XG4gICAgICAgIH0gLy8gUmVtb3ZlIGN1cnJlbnQgY2xhc3Nlc1xuXG5cbiAgICAgICAgY29uc3QgcmVtb3ZlQ3VycmVudCA9ICgpID0+IHtcbiAgICAgICAgICBjb25zdCBjbGFzc05hbWUgPSBwbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMudGFiRm9jdXM7XG4gICAgICAgICAgY29uc3QgY3VycmVudCA9IGdldEVsZW1lbnRzLmNhbGwocGxheWVyLCBgLiR7Y2xhc3NOYW1lfWApO1xuICAgICAgICAgIHRvZ2dsZUNsYXNzKGN1cnJlbnQsIGNsYXNzTmFtZSwgZmFsc2UpO1xuICAgICAgICB9OyAvLyBEZXRlcm1pbmUgaWYgYSBrZXkgd2FzIHByZXNzZWQgdG8gdHJpZ2dlciB0aGlzIGV2ZW50XG5cblxuICAgICAgICBjb25zdCB3YXNLZXlEb3duID0gdGltZVN0YW1wIC0gdGhpcy5sYXN0S2V5RG93biA8PSAyMDsgLy8gSWdub3JlIGZvY3VzIGV2ZW50cyBpZiBhIGtleSB3YXMgcHJlc3NlZCBwcmlvclxuXG4gICAgICAgIGlmICh0eXBlID09PSAnZm9jdXMnICYmICF3YXNLZXlEb3duKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIFJlbW92ZSBhbGwgY3VycmVudFxuXG5cbiAgICAgICAgcmVtb3ZlQ3VycmVudCgpOyAvLyBEZWxheSB0aGUgYWRkaW5nIG9mIGNsYXNzbmFtZSB1bnRpbCB0aGUgZm9jdXMgaGFzIGNoYW5nZWRcbiAgICAgICAgLy8gVGhpcyBldmVudCBmaXJlcyBiZWZvcmUgdGhlIGZvY3VzaW4gZXZlbnRcblxuICAgICAgICBpZiAodHlwZSAhPT0gJ2ZvY3Vzb3V0Jykge1xuICAgICAgICAgIHRoaXMuZm9jdXNUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZm9jdXNlZCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7IC8vIElnbm9yZSBpZiBjdXJyZW50IGZvY3VzIGVsZW1lbnQgaXNuJ3QgaW5zaWRlIHRoZSBwbGF5ZXJcblxuICAgICAgICAgICAgaWYgKCFlbGVtZW50cy5jb250YWluZXIuY29udGFpbnMoZm9jdXNlZCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0b2dnbGVDbGFzcyhkb2N1bWVudC5hY3RpdmVFbGVtZW50LCBwbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMudGFiRm9jdXMsIHRydWUpO1xuICAgICAgICAgIH0sIDEwKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiZ2xvYmFsXCIsICh0b2dnbGUgPSB0cnVlKSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBwbGF5ZXJcbiAgICAgICAgfSA9IHRoaXM7IC8vIEtleWJvYXJkIHNob3J0Y3V0c1xuXG4gICAgICAgIGlmIChwbGF5ZXIuY29uZmlnLmtleWJvYXJkLmdsb2JhbCkge1xuICAgICAgICAgIHRvZ2dsZUxpc3RlbmVyLmNhbGwocGxheWVyLCB3aW5kb3csICdrZXlkb3duIGtleXVwJywgdGhpcy5oYW5kbGVLZXksIHRvZ2dsZSwgZmFsc2UpO1xuICAgICAgICB9IC8vIENsaWNrIGFueXdoZXJlIGNsb3NlcyBtZW51XG5cblxuICAgICAgICB0b2dnbGVMaXN0ZW5lci5jYWxsKHBsYXllciwgZG9jdW1lbnQuYm9keSwgJ2NsaWNrJywgdGhpcy50b2dnbGVNZW51LCB0b2dnbGUpOyAvLyBEZXRlY3QgdG91Y2ggYnkgZXZlbnRzXG5cbiAgICAgICAgb25jZS5jYWxsKHBsYXllciwgZG9jdW1lbnQuYm9keSwgJ3RvdWNoc3RhcnQnLCB0aGlzLmZpcnN0VG91Y2gpOyAvLyBUYWIgZm9jdXMgZGV0ZWN0aW9uXG5cbiAgICAgICAgdG9nZ2xlTGlzdGVuZXIuY2FsbChwbGF5ZXIsIGRvY3VtZW50LmJvZHksICdrZXlkb3duIGZvY3VzIGJsdXIgZm9jdXNvdXQnLCB0aGlzLnNldFRhYkZvY3VzLCB0b2dnbGUsIGZhbHNlLCB0cnVlKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImNvbnRhaW5lclwiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBwbGF5ZXJcbiAgICAgICAgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBjb25maWcsXG4gICAgICAgICAgZWxlbWVudHMsXG4gICAgICAgICAgdGltZXJzXG4gICAgICAgIH0gPSBwbGF5ZXI7IC8vIEtleWJvYXJkIHNob3J0Y3V0c1xuXG4gICAgICAgIGlmICghY29uZmlnLmtleWJvYXJkLmdsb2JhbCAmJiBjb25maWcua2V5Ym9hcmQuZm9jdXNlZCkge1xuICAgICAgICAgIG9uLmNhbGwocGxheWVyLCBlbGVtZW50cy5jb250YWluZXIsICdrZXlkb3duIGtleXVwJywgdGhpcy5oYW5kbGVLZXksIGZhbHNlKTtcbiAgICAgICAgfSAvLyBUb2dnbGUgY29udHJvbHMgb24gbW91c2UgZXZlbnRzIGFuZCBlbnRlcmluZyBmdWxsc2NyZWVuXG5cblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgZWxlbWVudHMuY29udGFpbmVyLCAnbW91c2Vtb3ZlIG1vdXNlbGVhdmUgdG91Y2hzdGFydCB0b3VjaG1vdmUgZW50ZXJmdWxsc2NyZWVuIGV4aXRmdWxsc2NyZWVuJywgZXZlbnQgPT4ge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNvbnRyb2xzOiBjb250cm9sc0VsZW1lbnRcbiAgICAgICAgICB9ID0gZWxlbWVudHM7IC8vIFJlbW92ZSBidXR0b24gc3RhdGVzIGZvciBmdWxsc2NyZWVuXG5cbiAgICAgICAgICBpZiAoY29udHJvbHNFbGVtZW50ICYmIGV2ZW50LnR5cGUgPT09ICdlbnRlcmZ1bGxzY3JlZW4nKSB7XG4gICAgICAgICAgICBjb250cm9sc0VsZW1lbnQucHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgICAgY29udHJvbHNFbGVtZW50LmhvdmVyID0gZmFsc2U7XG4gICAgICAgICAgfSAvLyBTaG93LCB0aGVuIGhpZGUgYWZ0ZXIgYSB0aW1lb3V0IHVubGVzcyBhbm90aGVyIGNvbnRyb2wgZXZlbnQgb2NjdXJzXG5cblxuICAgICAgICAgIGNvbnN0IHNob3cgPSBbJ3RvdWNoc3RhcnQnLCAndG91Y2htb3ZlJywgJ21vdXNlbW92ZSddLmluY2x1ZGVzKGV2ZW50LnR5cGUpO1xuICAgICAgICAgIGxldCBkZWxheSA9IDA7XG5cbiAgICAgICAgICBpZiAoc2hvdykge1xuICAgICAgICAgICAgdWkudG9nZ2xlQ29udHJvbHMuY2FsbChwbGF5ZXIsIHRydWUpOyAvLyBVc2UgbG9uZ2VyIHRpbWVvdXQgZm9yIHRvdWNoIGRldmljZXNcblxuICAgICAgICAgICAgZGVsYXkgPSBwbGF5ZXIudG91Y2ggPyAzMDAwIDogMjAwMDtcbiAgICAgICAgICB9IC8vIENsZWFyIHRpbWVyXG5cblxuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcnMuY29udHJvbHMpOyAvLyBTZXQgbmV3IHRpbWVyIHRvIHByZXZlbnQgZmxpY2tlciB3aGVuIHNlZWtpbmdcblxuICAgICAgICAgIHRpbWVycy5jb250cm9scyA9IHNldFRpbWVvdXQoKCkgPT4gdWkudG9nZ2xlQ29udHJvbHMuY2FsbChwbGF5ZXIsIGZhbHNlKSwgZGVsYXkpO1xuICAgICAgICB9KTsgLy8gU2V0IGEgZ3V0dGVyIGZvciBWaW1lb1xuXG4gICAgICAgIGNvbnN0IHNldEd1dHRlciA9ICgpID0+IHtcbiAgICAgICAgICBpZiAoIXBsYXllci5pc1ZpbWVvIHx8IHBsYXllci5jb25maWcudmltZW8ucHJlbWl1bSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGVsZW1lbnRzLndyYXBwZXI7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgYWN0aXZlXG4gICAgICAgICAgfSA9IHBsYXllci5mdWxsc2NyZWVuO1xuICAgICAgICAgIGNvbnN0IFt2aWRlb1dpZHRoLCB2aWRlb0hlaWdodF0gPSBnZXRBc3BlY3RSYXRpby5jYWxsKHBsYXllcik7XG4gICAgICAgICAgY29uc3QgdXNlTmF0aXZlQXNwZWN0UmF0aW8gPSBzdXBwb3J0c0NTUyhgYXNwZWN0LXJhdGlvOiAke3ZpZGVvV2lkdGh9IC8gJHt2aWRlb0hlaWdodH1gKTsgLy8gSWYgbm90IGFjdGl2ZSwgcmVtb3ZlIHN0eWxlc1xuXG4gICAgICAgICAgaWYgKCFhY3RpdmUpIHtcbiAgICAgICAgICAgIGlmICh1c2VOYXRpdmVBc3BlY3RSYXRpbykge1xuICAgICAgICAgICAgICB0YXJnZXQuc3R5bGUud2lkdGggPSBudWxsO1xuICAgICAgICAgICAgICB0YXJnZXQuc3R5bGUuaGVpZ2h0ID0gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRhcmdldC5zdHlsZS5tYXhXaWR0aCA9IG51bGw7XG4gICAgICAgICAgICAgIHRhcmdldC5zdHlsZS5tYXJnaW4gPSBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBEZXRlcm1pbmUgd2hpY2ggZGltZW5zaW9uIHdpbGwgb3ZlcmZsb3cgYW5kIGNvbnN0cmFpbiB2aWV3XG5cblxuICAgICAgICAgIGNvbnN0IFt2aWV3cG9ydFdpZHRoLCB2aWV3cG9ydEhlaWdodF0gPSBnZXRWaWV3cG9ydFNpemUoKTtcbiAgICAgICAgICBjb25zdCBvdmVyZmxvdyA9IHZpZXdwb3J0V2lkdGggLyB2aWV3cG9ydEhlaWdodCA+IHZpZGVvV2lkdGggLyB2aWRlb0hlaWdodDtcblxuICAgICAgICAgIGlmICh1c2VOYXRpdmVBc3BlY3RSYXRpbykge1xuICAgICAgICAgICAgdGFyZ2V0LnN0eWxlLndpZHRoID0gb3ZlcmZsb3cgPyAnYXV0bycgOiAnMTAwJSc7XG4gICAgICAgICAgICB0YXJnZXQuc3R5bGUuaGVpZ2h0ID0gb3ZlcmZsb3cgPyAnMTAwJScgOiAnYXV0byc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRhcmdldC5zdHlsZS5tYXhXaWR0aCA9IG92ZXJmbG93ID8gYCR7dmlld3BvcnRIZWlnaHQgLyB2aWRlb0hlaWdodCAqIHZpZGVvV2lkdGh9cHhgIDogbnVsbDtcbiAgICAgICAgICAgIHRhcmdldC5zdHlsZS5tYXJnaW4gPSBvdmVyZmxvdyA/ICcwIGF1dG8nIDogbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH07IC8vIEhhbmRsZSByZXNpemluZ1xuXG5cbiAgICAgICAgY29uc3QgcmVzaXplZCA9ICgpID0+IHtcbiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXJzLnJlc2l6ZWQpO1xuICAgICAgICAgIHRpbWVycy5yZXNpemVkID0gc2V0VGltZW91dChzZXRHdXR0ZXIsIDUwKTtcbiAgICAgICAgfTtcblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgZWxlbWVudHMuY29udGFpbmVyLCAnZW50ZXJmdWxsc2NyZWVuIGV4aXRmdWxsc2NyZWVuJywgZXZlbnQgPT4ge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIHRhcmdldFxuICAgICAgICAgIH0gPSBwbGF5ZXIuZnVsbHNjcmVlbjsgLy8gSWdub3JlIGV2ZW50cyBub3QgZnJvbSB0YXJnZXRcblxuICAgICAgICAgIGlmICh0YXJnZXQgIT09IGVsZW1lbnRzLmNvbnRhaW5lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gLy8gSWYgaXQncyBub3QgYW4gZW1iZWQgYW5kIG5vIHJhdGlvIHNwZWNpZmllZFxuXG5cbiAgICAgICAgICBpZiAoIXBsYXllci5pc0VtYmVkICYmIGlzLmVtcHR5KHBsYXllci5jb25maWcucmF0aW8pKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBTZXQgVmltZW8gZ3V0dGVyXG5cblxuICAgICAgICAgIHNldEd1dHRlcigpOyAvLyBXYXRjaCBmb3IgcmVzaXplc1xuXG4gICAgICAgICAgY29uc3QgbWV0aG9kID0gZXZlbnQudHlwZSA9PT0gJ2VudGVyZnVsbHNjcmVlbicgPyBvbiA6IG9mZjtcbiAgICAgICAgICBtZXRob2QuY2FsbChwbGF5ZXIsIHdpbmRvdywgJ3Jlc2l6ZScsIHJlc2l6ZWQpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcIm1lZGlhXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHBsYXllclxuICAgICAgICB9ID0gdGhpcztcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGVsZW1lbnRzXG4gICAgICAgIH0gPSBwbGF5ZXI7IC8vIFRpbWUgY2hhbmdlIG9uIG1lZGlhXG5cbiAgICAgICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3RpbWV1cGRhdGUgc2Vla2luZyBzZWVrZWQnLCBldmVudCA9PiBjb250cm9scy50aW1lVXBkYXRlLmNhbGwocGxheWVyLCBldmVudCkpOyAvLyBEaXNwbGF5IGR1cmF0aW9uXG5cbiAgICAgICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2R1cmF0aW9uY2hhbmdlIGxvYWRlZGRhdGEgbG9hZGVkbWV0YWRhdGEnLCBldmVudCA9PiBjb250cm9scy5kdXJhdGlvblVwZGF0ZS5jYWxsKHBsYXllciwgZXZlbnQpKTsgLy8gSGFuZGxlIHRoZSBtZWRpYSBmaW5pc2hpbmdcblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZW5kZWQnLCAoKSA9PiB7XG4gICAgICAgICAgLy8gU2hvdyBwb3N0ZXIgb24gZW5kXG4gICAgICAgICAgaWYgKHBsYXllci5pc0hUTUw1ICYmIHBsYXllci5pc1ZpZGVvICYmIHBsYXllci5jb25maWcucmVzZXRPbkVuZCkge1xuICAgICAgICAgICAgLy8gUmVzdGFydFxuICAgICAgICAgICAgcGxheWVyLnJlc3RhcnQoKTsgLy8gQ2FsbCBwYXVzZSBvdGhlcndpc2UgSUUxMSB3aWxsIHN0YXJ0IHBsYXlpbmcgdGhlIHZpZGVvIGFnYWluXG5cbiAgICAgICAgICAgIHBsYXllci5wYXVzZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7IC8vIENoZWNrIGZvciBidWZmZXIgcHJvZ3Jlc3NcblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncHJvZ3Jlc3MgcGxheWluZyBzZWVraW5nIHNlZWtlZCcsIGV2ZW50ID0+IGNvbnRyb2xzLnVwZGF0ZVByb2dyZXNzLmNhbGwocGxheWVyLCBldmVudCkpOyAvLyBIYW5kbGUgdm9sdW1lIGNoYW5nZXNcblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndm9sdW1lY2hhbmdlJywgZXZlbnQgPT4gY29udHJvbHMudXBkYXRlVm9sdW1lLmNhbGwocGxheWVyLCBldmVudCkpOyAvLyBIYW5kbGUgcGxheS9wYXVzZVxuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwbGF5aW5nIHBsYXkgcGF1c2UgZW5kZWQgZW1wdGllZCB0aW1ldXBkYXRlJywgZXZlbnQgPT4gdWkuY2hlY2tQbGF5aW5nLmNhbGwocGxheWVyLCBldmVudCkpOyAvLyBMb2FkaW5nIHN0YXRlXG5cbiAgICAgICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3dhaXRpbmcgY2FucGxheSBzZWVrZWQgcGxheWluZycsIGV2ZW50ID0+IHVpLmNoZWNrTG9hZGluZy5jYWxsKHBsYXllciwgZXZlbnQpKTsgLy8gQ2xpY2sgdmlkZW9cblxuICAgICAgICBpZiAocGxheWVyLnN1cHBvcnRlZC51aSAmJiBwbGF5ZXIuY29uZmlnLmNsaWNrVG9QbGF5ICYmICFwbGF5ZXIuaXNBdWRpbykge1xuICAgICAgICAgIC8vIFJlLWZldGNoIHRoZSB3cmFwcGVyXG4gICAgICAgICAgY29uc3Qgd3JhcHBlciA9IGdldEVsZW1lbnQuY2FsbChwbGF5ZXIsIGAuJHtwbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMudmlkZW99YCk7IC8vIEJhaWwgaWYgdGhlcmUncyBubyB3cmFwcGVyICh0aGlzIHNob3VsZCBuZXZlciBoYXBwZW4pXG5cbiAgICAgICAgICBpZiAoIWlzLmVsZW1lbnQod3JhcHBlcikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IC8vIE9uIGNsaWNrIHBsYXksIHBhdXNlIG9yIHJlc3RhcnRcblxuXG4gICAgICAgICAgb24uY2FsbChwbGF5ZXIsIGVsZW1lbnRzLmNvbnRhaW5lciwgJ2NsaWNrJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0cyA9IFtlbGVtZW50cy5jb250YWluZXIsIHdyYXBwZXJdOyAvLyBJZ25vcmUgaWYgY2xpY2sgaWYgbm90IGNvbnRhaW5lciBvciBpbiB2aWRlbyB3cmFwcGVyXG5cbiAgICAgICAgICAgIGlmICghdGFyZ2V0cy5pbmNsdWRlcyhldmVudC50YXJnZXQpICYmICF3cmFwcGVyLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSAvLyBUb3VjaCBkZXZpY2VzIHdpbGwganVzdCBzaG93IGNvbnRyb2xzIChpZiBoaWRkZW4pXG5cblxuICAgICAgICAgICAgaWYgKHBsYXllci50b3VjaCAmJiBwbGF5ZXIuY29uZmlnLmhpZGVDb250cm9scykge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChwbGF5ZXIuZW5kZWQpIHtcbiAgICAgICAgICAgICAgdGhpcy5wcm94eShldmVudCwgcGxheWVyLnJlc3RhcnQsICdyZXN0YXJ0Jyk7XG4gICAgICAgICAgICAgIHRoaXMucHJveHkoZXZlbnQsICgpID0+IHtcbiAgICAgICAgICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIucGxheSgpKTtcbiAgICAgICAgICAgICAgfSwgJ3BsYXknKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMucHJveHkoZXZlbnQsICgpID0+IHtcbiAgICAgICAgICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIudG9nZ2xlUGxheSgpKTtcbiAgICAgICAgICAgICAgfSwgJ3BsYXknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSAvLyBEaXNhYmxlIHJpZ2h0IGNsaWNrXG5cblxuICAgICAgICBpZiAocGxheWVyLnN1cHBvcnRlZC51aSAmJiBwbGF5ZXIuY29uZmlnLmRpc2FibGVDb250ZXh0TWVudSkge1xuICAgICAgICAgIG9uLmNhbGwocGxheWVyLCBlbGVtZW50cy53cmFwcGVyLCAnY29udGV4dG1lbnUnLCBldmVudCA9PiB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIH0sIGZhbHNlKTtcbiAgICAgICAgfSAvLyBWb2x1bWUgY2hhbmdlXG5cblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndm9sdW1lY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgIC8vIFNhdmUgdG8gc3RvcmFnZVxuICAgICAgICAgIHBsYXllci5zdG9yYWdlLnNldCh7XG4gICAgICAgICAgICB2b2x1bWU6IHBsYXllci52b2x1bWUsXG4gICAgICAgICAgICBtdXRlZDogcGxheWVyLm11dGVkXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pOyAvLyBTcGVlZCBjaGFuZ2VcblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncmF0ZWNoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAvLyBVcGRhdGUgVUlcbiAgICAgICAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwocGxheWVyLCAnc3BlZWQnKTsgLy8gU2F2ZSB0byBzdG9yYWdlXG5cbiAgICAgICAgICBwbGF5ZXIuc3RvcmFnZS5zZXQoe1xuICAgICAgICAgICAgc3BlZWQ6IHBsYXllci5zcGVlZFxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTsgLy8gUXVhbGl0eSBjaGFuZ2VcblxuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncXVhbGl0eWNoYW5nZScsIGV2ZW50ID0+IHtcbiAgICAgICAgICAvLyBVcGRhdGUgVUlcbiAgICAgICAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwocGxheWVyLCAncXVhbGl0eScsIG51bGwsIGV2ZW50LmRldGFpbC5xdWFsaXR5KTtcbiAgICAgICAgfSk7IC8vIFVwZGF0ZSBkb3dubG9hZCBsaW5rIHdoZW4gcmVhZHkgYW5kIGlmIHF1YWxpdHkgY2hhbmdlc1xuXG4gICAgICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdyZWFkeSBxdWFsaXR5Y2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgIGNvbnRyb2xzLnNldERvd25sb2FkVXJsLmNhbGwocGxheWVyKTtcbiAgICAgICAgfSk7IC8vIFByb3h5IGV2ZW50cyB0byBjb250YWluZXJcbiAgICAgICAgLy8gQnViYmxlIHVwIGtleSBldmVudHMgZm9yIEVkZ2VcblxuICAgICAgICBjb25zdCBwcm94eUV2ZW50cyA9IHBsYXllci5jb25maWcuZXZlbnRzLmNvbmNhdChbJ2tleXVwJywgJ2tleWRvd24nXSkuam9pbignICcpO1xuICAgICAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCBwcm94eUV2ZW50cywgZXZlbnQgPT4ge1xuICAgICAgICAgIGxldCB7XG4gICAgICAgICAgICBkZXRhaWwgPSB7fVxuICAgICAgICAgIH0gPSBldmVudDsgLy8gR2V0IGVycm9yIGRldGFpbHMgZnJvbSBtZWRpYVxuXG4gICAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdlcnJvcicpIHtcbiAgICAgICAgICAgIGRldGFpbCA9IHBsYXllci5tZWRpYS5lcnJvcjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIGVsZW1lbnRzLmNvbnRhaW5lciwgZXZlbnQudHlwZSwgdHJ1ZSwgZGV0YWlsKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJwcm94eVwiLCAoZXZlbnQsIGRlZmF1bHRIYW5kbGVyLCBjdXN0b21IYW5kbGVyS2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBwbGF5ZXJcbiAgICAgICAgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGN1c3RvbUhhbmRsZXIgPSBwbGF5ZXIuY29uZmlnLmxpc3RlbmVyc1tjdXN0b21IYW5kbGVyS2V5XTtcbiAgICAgICAgY29uc3QgaGFzQ3VzdG9tSGFuZGxlciA9IGlzLmZ1bmN0aW9uKGN1c3RvbUhhbmRsZXIpO1xuICAgICAgICBsZXQgcmV0dXJuZWQgPSB0cnVlOyAvLyBFeGVjdXRlIGN1c3RvbSBoYW5kbGVyXG5cbiAgICAgICAgaWYgKGhhc0N1c3RvbUhhbmRsZXIpIHtcbiAgICAgICAgICByZXR1cm5lZCA9IGN1c3RvbUhhbmRsZXIuY2FsbChwbGF5ZXIsIGV2ZW50KTtcbiAgICAgICAgfSAvLyBPbmx5IGNhbGwgZGVmYXVsdCBoYW5kbGVyIGlmIG5vdCBwcmV2ZW50ZWQgaW4gY3VzdG9tIGhhbmRsZXJcblxuXG4gICAgICAgIGlmIChyZXR1cm5lZCAhPT0gZmFsc2UgJiYgaXMuZnVuY3Rpb24oZGVmYXVsdEhhbmRsZXIpKSB7XG4gICAgICAgICAgZGVmYXVsdEhhbmRsZXIuY2FsbChwbGF5ZXIsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiYmluZFwiLCAoZWxlbWVudCwgdHlwZSwgZGVmYXVsdEhhbmRsZXIsIGN1c3RvbUhhbmRsZXJLZXksIHBhc3NpdmUgPSB0cnVlKSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBwbGF5ZXJcbiAgICAgICAgfSA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGN1c3RvbUhhbmRsZXIgPSBwbGF5ZXIuY29uZmlnLmxpc3RlbmVyc1tjdXN0b21IYW5kbGVyS2V5XTtcbiAgICAgICAgY29uc3QgaGFzQ3VzdG9tSGFuZGxlciA9IGlzLmZ1bmN0aW9uKGN1c3RvbUhhbmRsZXIpO1xuICAgICAgICBvbi5jYWxsKHBsYXllciwgZWxlbWVudCwgdHlwZSwgZXZlbnQgPT4gdGhpcy5wcm94eShldmVudCwgZGVmYXVsdEhhbmRsZXIsIGN1c3RvbUhhbmRsZXJLZXkpLCBwYXNzaXZlICYmICFoYXNDdXN0b21IYW5kbGVyKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImNvbnRyb2xzXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHBsYXllclxuICAgICAgICB9ID0gdGhpcztcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGVsZW1lbnRzXG4gICAgICAgIH0gPSBwbGF5ZXI7IC8vIElFIGRvZXNuJ3Qgc3VwcG9ydCBpbnB1dCBldmVudCwgc28gd2UgZmFsbGJhY2sgdG8gY2hhbmdlXG5cbiAgICAgICAgY29uc3QgaW5wdXRFdmVudCA9IGJyb3dzZXIuaXNJRSA/ICdjaGFuZ2UnIDogJ2lucHV0JzsgLy8gUGxheS9wYXVzZSB0b2dnbGVcblxuICAgICAgICBpZiAoZWxlbWVudHMuYnV0dG9ucy5wbGF5KSB7XG4gICAgICAgICAgQXJyYXkuZnJvbShlbGVtZW50cy5idXR0b25zLnBsYXkpLmZvckVhY2goYnV0dG9uID0+IHtcbiAgICAgICAgICAgIHRoaXMuYmluZChidXR0b24sICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgc2lsZW5jZVByb21pc2UocGxheWVyLnRvZ2dsZVBsYXkoKSk7XG4gICAgICAgICAgICB9LCAncGxheScpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IC8vIFBhdXNlXG5cblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuYnV0dG9ucy5yZXN0YXJ0LCAnY2xpY2snLCBwbGF5ZXIucmVzdGFydCwgJ3Jlc3RhcnQnKTsgLy8gUmV3aW5kXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMucmV3aW5kLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgLy8gUmVjb3JkIHNlZWsgdGltZSBzbyB3ZSBjYW4gcHJldmVudCBoaWRpbmcgY29udHJvbHMgZm9yIGEgZmV3IHNlY29uZHMgYWZ0ZXIgcmV3aW5kXG4gICAgICAgICAgcGxheWVyLmxhc3RTZWVrVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgcGxheWVyLnJld2luZCgpO1xuICAgICAgICB9LCAncmV3aW5kJyk7IC8vIFJld2luZFxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5idXR0b25zLmZhc3RGb3J3YXJkLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgLy8gUmVjb3JkIHNlZWsgdGltZSBzbyB3ZSBjYW4gcHJldmVudCBoaWRpbmcgY29udHJvbHMgZm9yIGEgZmV3IHNlY29uZHMgYWZ0ZXIgZmFzdCBmb3J3YXJkXG4gICAgICAgICAgcGxheWVyLmxhc3RTZWVrVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgICAgcGxheWVyLmZvcndhcmQoKTtcbiAgICAgICAgfSwgJ2Zhc3RGb3J3YXJkJyk7IC8vIE11dGUgdG9nZ2xlXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMubXV0ZSwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgIHBsYXllci5tdXRlZCA9ICFwbGF5ZXIubXV0ZWQ7XG4gICAgICAgIH0sICdtdXRlJyk7IC8vIENhcHRpb25zIHRvZ2dsZVxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5idXR0b25zLmNhcHRpb25zLCAnY2xpY2snLCAoKSA9PiBwbGF5ZXIudG9nZ2xlQ2FwdGlvbnMoKSk7IC8vIERvd25sb2FkXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMuZG93bmxvYWQsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2Rvd25sb2FkJyk7XG4gICAgICAgIH0sICdkb3dubG9hZCcpOyAvLyBGdWxsc2NyZWVuIHRvZ2dsZVxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5idXR0b25zLmZ1bGxzY3JlZW4sICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICBwbGF5ZXIuZnVsbHNjcmVlbi50b2dnbGUoKTtcbiAgICAgICAgfSwgJ2Z1bGxzY3JlZW4nKTsgLy8gUGljdHVyZS1pbi1QaWN0dXJlXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMucGlwLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgcGxheWVyLnBpcCA9ICd0b2dnbGUnO1xuICAgICAgICB9LCAncGlwJyk7IC8vIEFpcnBsYXlcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuYnV0dG9ucy5haXJwbGF5LCAnY2xpY2snLCBwbGF5ZXIuYWlycGxheSwgJ2FpcnBsYXknKTsgLy8gU2V0dGluZ3MgbWVudSAtIGNsaWNrIHRvZ2dsZVxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5idXR0b25zLnNldHRpbmdzLCAnY2xpY2snLCBldmVudCA9PiB7XG4gICAgICAgICAgLy8gUHJldmVudCB0aGUgZG9jdW1lbnQgY2xpY2sgbGlzdGVuZXIgY2xvc2luZyB0aGUgbWVudVxuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgY29udHJvbHMudG9nZ2xlTWVudS5jYWxsKHBsYXllciwgZXZlbnQpO1xuICAgICAgICB9LCBudWxsLCBmYWxzZSk7IC8vIENhbid0IGJlIHBhc3NpdmUgYXMgd2UncmUgcHJldmVudGluZyBkZWZhdWx0XG4gICAgICAgIC8vIFNldHRpbmdzIG1lbnUgLSBrZXlib2FyZCB0b2dnbGVcbiAgICAgICAgLy8gV2UgaGF2ZSB0byBiaW5kIHRvIGtleXVwIG90aGVyd2lzZSBGaXJlZm94IHRyaWdnZXJzIGEgY2xpY2sgd2hlbiBhIGtleWRvd24gZXZlbnQgaGFuZGxlciBzaGlmdHMgZm9jdXNcbiAgICAgICAgLy8gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTIyMDE0M1xuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5idXR0b25zLnNldHRpbmdzLCAna2V5dXAnLCBldmVudCA9PiB7XG4gICAgICAgICAgaWYgKCFbJ1NwYWNlJywgJ0VudGVyJ10uaW5jbHVkZXMoZXZlbnQua2V5KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gLy8gQmVjYXVzZSByZXR1cm4gdHJpZ2dlcnMgYSBjbGljayBhbnl3YXksIGFsbCB3ZSBuZWVkIHRvIGRvIGlzIHNldCBmb2N1c1xuXG5cbiAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgICAgICBjb250cm9scy5mb2N1c0ZpcnN0TWVudUl0ZW0uY2FsbChwbGF5ZXIsIG51bGwsIHRydWUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gLy8gUHJldmVudCBzY3JvbGxcblxuXG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy8gUHJldmVudCBwbGF5aW5nIHZpZGVvIChGaXJlZm94KVxuXG4gICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7IC8vIFRvZ2dsZSBtZW51XG5cbiAgICAgICAgICBjb250cm9scy50b2dnbGVNZW51LmNhbGwocGxheWVyLCBldmVudCk7XG4gICAgICAgIH0sIG51bGwsIGZhbHNlIC8vIENhbid0IGJlIHBhc3NpdmUgYXMgd2UncmUgcHJldmVudGluZyBkZWZhdWx0XG4gICAgICAgICk7IC8vIEVzY2FwZSBjbG9zZXMgbWVudVxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5zZXR0aW5ncy5tZW51LCAna2V5ZG93bicsIGV2ZW50ID0+IHtcbiAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgY29udHJvbHMudG9nZ2xlTWVudS5jYWxsKHBsYXllciwgZXZlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7IC8vIFNldCByYW5nZSBpbnB1dCBhbHRlcm5hdGl2ZSBcInZhbHVlXCIsIHdoaWNoIG1hdGNoZXMgdGhlIHRvb2x0aXAgdGltZSAoIzk1NClcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuaW5wdXRzLnNlZWssICdtb3VzZWRvd24gbW91c2Vtb3ZlJywgZXZlbnQgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlY3QgPSBlbGVtZW50cy5wcm9ncmVzcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICBjb25zdCBwZXJjZW50ID0gMTAwIC8gcmVjdC53aWR0aCAqIChldmVudC5wYWdlWCAtIHJlY3QubGVmdCk7XG4gICAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldC5zZXRBdHRyaWJ1dGUoJ3NlZWstdmFsdWUnLCBwZXJjZW50KTtcbiAgICAgICAgfSk7IC8vIFBhdXNlIHdoaWxlIHNlZWtpbmdcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuaW5wdXRzLnNlZWssICdtb3VzZWRvd24gbW91c2V1cCBrZXlkb3duIGtleXVwIHRvdWNoc3RhcnQgdG91Y2hlbmQnLCBldmVudCA9PiB7XG4gICAgICAgICAgY29uc3Qgc2VlayA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gJ3BsYXktb24tc2Vla2VkJztcblxuICAgICAgICAgIGlmIChpcy5rZXlib2FyZEV2ZW50KGV2ZW50KSAmJiAhWydBcnJvd0xlZnQnLCAnQXJyb3dSaWdodCddLmluY2x1ZGVzKGV2ZW50LmtleSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IC8vIFJlY29yZCBzZWVrIHRpbWUgc28gd2UgY2FuIHByZXZlbnQgaGlkaW5nIGNvbnRyb2xzIGZvciBhIGZldyBzZWNvbmRzIGFmdGVyIHNlZWtcblxuXG4gICAgICAgICAgcGxheWVyLmxhc3RTZWVrVGltZSA9IERhdGUubm93KCk7IC8vIFdhcyBwbGF5aW5nIGJlZm9yZT9cblxuICAgICAgICAgIGNvbnN0IHBsYXkgPSBzZWVrLmhhc0F0dHJpYnV0ZShhdHRyaWJ1dGUpOyAvLyBEb25lIHNlZWtpbmdcblxuICAgICAgICAgIGNvbnN0IGRvbmUgPSBbJ21vdXNldXAnLCAndG91Y2hlbmQnLCAna2V5dXAnXS5pbmNsdWRlcyhldmVudC50eXBlKTsgLy8gSWYgd2UncmUgZG9uZSBzZWVraW5nIGFuZCBpdCB3YXMgcGxheWluZywgcmVzdW1lIHBsYXliYWNrXG5cbiAgICAgICAgICBpZiAocGxheSAmJiBkb25lKSB7XG4gICAgICAgICAgICBzZWVrLnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgICAgICAgICAgc2lsZW5jZVByb21pc2UocGxheWVyLnBsYXkoKSk7XG4gICAgICAgICAgfSBlbHNlIGlmICghZG9uZSAmJiBwbGF5ZXIucGxheWluZykge1xuICAgICAgICAgICAgc2Vlay5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlLCAnJyk7XG4gICAgICAgICAgICBwbGF5ZXIucGF1c2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pOyAvLyBGaXggcmFuZ2UgaW5wdXRzIG9uIGlPU1xuICAgICAgICAvLyBTdXBlciB3ZWlyZCBpT1MgYnVnIHdoZXJlIGFmdGVyIHlvdSBpbnRlcmFjdCB3aXRoIGFuIDxpbnB1dCB0eXBlPVwicmFuZ2VcIj4sXG4gICAgICAgIC8vIGl0IHRha2VzIG92ZXIgZnVydGhlciBpbnRlcmFjdGlvbnMgb24gdGhlIHBhZ2UuIFRoaXMgaXMgYSBoYWNrXG5cbiAgICAgICAgaWYgKGJyb3dzZXIuaXNJb3MpIHtcbiAgICAgICAgICBjb25zdCBpbnB1dHMgPSBnZXRFbGVtZW50cy5jYWxsKHBsYXllciwgJ2lucHV0W3R5cGU9XCJyYW5nZVwiXScpO1xuICAgICAgICAgIEFycmF5LmZyb20oaW5wdXRzKS5mb3JFYWNoKGlucHV0ID0+IHRoaXMuYmluZChpbnB1dCwgaW5wdXRFdmVudCwgZXZlbnQgPT4gcmVwYWludChldmVudC50YXJnZXQpKSk7XG4gICAgICAgIH0gLy8gU2Vla1xuXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmlucHV0cy5zZWVrLCBpbnB1dEV2ZW50LCBldmVudCA9PiB7XG4gICAgICAgICAgY29uc3Qgc2VlayA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7IC8vIElmIGl0IGV4aXN0cywgdXNlIHNlZWstdmFsdWUgaW5zdGVhZCBvZiBcInZhbHVlXCIgZm9yIGNvbnNpc3RlbmN5IHdpdGggdG9vbHRpcCB0aW1lICgjOTU0KVxuXG4gICAgICAgICAgbGV0IHNlZWtUbyA9IHNlZWsuZ2V0QXR0cmlidXRlKCdzZWVrLXZhbHVlJyk7XG5cbiAgICAgICAgICBpZiAoaXMuZW1wdHkoc2Vla1RvKSkge1xuICAgICAgICAgICAgc2Vla1RvID0gc2Vlay52YWx1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzZWVrLnJlbW92ZUF0dHJpYnV0ZSgnc2Vlay12YWx1ZScpO1xuICAgICAgICAgIHBsYXllci5jdXJyZW50VGltZSA9IHNlZWtUbyAvIHNlZWsubWF4ICogcGxheWVyLmR1cmF0aW9uO1xuICAgICAgICB9LCAnc2VlaycpOyAvLyBTZWVrIHRvb2x0aXBcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMucHJvZ3Jlc3MsICdtb3VzZWVudGVyIG1vdXNlbGVhdmUgbW91c2Vtb3ZlJywgZXZlbnQgPT4gY29udHJvbHMudXBkYXRlU2Vla1Rvb2x0aXAuY2FsbChwbGF5ZXIsIGV2ZW50KSk7IC8vIFByZXZpZXcgdGh1bWJuYWlscyBwbHVnaW5cbiAgICAgICAgLy8gVE9ETzogUmVhbGx5IG5lZWQgdG8gd29yayBvbiBzb21lIHNvcnQgb2YgcGx1Zy1pbiB3aWRlIGV2ZW50IGJ1cyBvciBwdWItc3ViIGZvciB0aGlzXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLnByb2dyZXNzLCAnbW91c2Vtb3ZlIHRvdWNobW92ZScsIGV2ZW50ID0+IHtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBwcmV2aWV3VGh1bWJuYWlsc1xuICAgICAgICAgIH0gPSBwbGF5ZXI7XG5cbiAgICAgICAgICBpZiAocHJldmlld1RodW1ibmFpbHMgJiYgcHJldmlld1RodW1ibmFpbHMubG9hZGVkKSB7XG4gICAgICAgICAgICBwcmV2aWV3VGh1bWJuYWlscy5zdGFydE1vdmUoZXZlbnQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7IC8vIEhpZGUgdGh1bWJuYWlsIHByZXZpZXcgLSBvbiBtb3VzZSBjbGljaywgbW91c2UgbGVhdmUsIGFuZCB2aWRlbyBwbGF5L3NlZWsuIEFsbCBmb3VyIGFyZSByZXF1aXJlZCwgZS5nLiwgZm9yIGJ1ZmZlcmluZ1xuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5wcm9ncmVzcywgJ21vdXNlbGVhdmUgdG91Y2hlbmQgY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgcHJldmlld1RodW1ibmFpbHNcbiAgICAgICAgICB9ID0gcGxheWVyO1xuXG4gICAgICAgICAgaWYgKHByZXZpZXdUaHVtYm5haWxzICYmIHByZXZpZXdUaHVtYm5haWxzLmxvYWRlZCkge1xuICAgICAgICAgICAgcHJldmlld1RodW1ibmFpbHMuZW5kTW92ZShmYWxzZSwgdHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTsgLy8gU2hvdyBzY3J1YmJpbmcgcHJldmlld1xuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5wcm9ncmVzcywgJ21vdXNlZG93biB0b3VjaHN0YXJ0JywgZXZlbnQgPT4ge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIHByZXZpZXdUaHVtYm5haWxzXG4gICAgICAgICAgfSA9IHBsYXllcjtcblxuICAgICAgICAgIGlmIChwcmV2aWV3VGh1bWJuYWlscyAmJiBwcmV2aWV3VGh1bWJuYWlscy5sb2FkZWQpIHtcbiAgICAgICAgICAgIHByZXZpZXdUaHVtYm5haWxzLnN0YXJ0U2NydWJiaW5nKGV2ZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMucHJvZ3Jlc3MsICdtb3VzZXVwIHRvdWNoZW5kJywgZXZlbnQgPT4ge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIHByZXZpZXdUaHVtYm5haWxzXG4gICAgICAgICAgfSA9IHBsYXllcjtcblxuICAgICAgICAgIGlmIChwcmV2aWV3VGh1bWJuYWlscyAmJiBwcmV2aWV3VGh1bWJuYWlscy5sb2FkZWQpIHtcbiAgICAgICAgICAgIHByZXZpZXdUaHVtYm5haWxzLmVuZFNjcnViYmluZyhldmVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTsgLy8gUG9seWZpbGwgZm9yIGxvd2VyIGZpbGwgaW4gPGlucHV0IHR5cGU9XCJyYW5nZVwiPiBmb3Igd2Via2l0XG5cbiAgICAgICAgaWYgKGJyb3dzZXIuaXNXZWJraXQpIHtcbiAgICAgICAgICBBcnJheS5mcm9tKGdldEVsZW1lbnRzLmNhbGwocGxheWVyLCAnaW5wdXRbdHlwZT1cInJhbmdlXCJdJykpLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICB0aGlzLmJpbmQoZWxlbWVudCwgJ2lucHV0JywgZXZlbnQgPT4gY29udHJvbHMudXBkYXRlUmFuZ2VGaWxsLmNhbGwocGxheWVyLCBldmVudC50YXJnZXQpKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSAvLyBDdXJyZW50IHRpbWUgaW52ZXJ0XG4gICAgICAgIC8vIE9ubHkgaWYgb25lIHRpbWUgZWxlbWVudCBpcyB1c2VkIGZvciBib3RoIGN1cnJlbnRUaW1lIGFuZCBkdXJhdGlvblxuXG5cbiAgICAgICAgaWYgKHBsYXllci5jb25maWcudG9nZ2xlSW52ZXJ0ICYmICFpcy5lbGVtZW50KGVsZW1lbnRzLmRpc3BsYXkuZHVyYXRpb24pKSB7XG4gICAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmRpc3BsYXkuY3VycmVudFRpbWUsICdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIC8vIERvIG5vdGhpbmcgaWYgd2UncmUgYXQgdGhlIHN0YXJ0XG4gICAgICAgICAgICBpZiAocGxheWVyLmN1cnJlbnRUaW1lID09PSAwKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcGxheWVyLmNvbmZpZy5pbnZlcnRUaW1lID0gIXBsYXllci5jb25maWcuaW52ZXJ0VGltZTtcbiAgICAgICAgICAgIGNvbnRyb2xzLnRpbWVVcGRhdGUuY2FsbChwbGF5ZXIpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IC8vIFZvbHVtZVxuXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmlucHV0cy52b2x1bWUsIGlucHV0RXZlbnQsIGV2ZW50ID0+IHtcbiAgICAgICAgICBwbGF5ZXIudm9sdW1lID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgICAgICB9LCAndm9sdW1lJyk7IC8vIFVwZGF0ZSBjb250cm9scy5ob3ZlciBzdGF0ZSAodXNlZCBmb3IgdWkudG9nZ2xlQ29udHJvbHMgdG8gYXZvaWQgaGlkaW5nIHdoZW4gaW50ZXJhY3RpbmcpXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmNvbnRyb2xzLCAnbW91c2VlbnRlciBtb3VzZWxlYXZlJywgZXZlbnQgPT4ge1xuICAgICAgICAgIGVsZW1lbnRzLmNvbnRyb2xzLmhvdmVyID0gIXBsYXllci50b3VjaCAmJiBldmVudC50eXBlID09PSAnbW91c2VlbnRlcic7XG4gICAgICAgIH0pOyAvLyBBbHNvIHVwZGF0ZSBjb250cm9scy5ob3ZlciBzdGF0ZSBmb3IgYW55IG5vbi1wbGF5ZXIgY2hpbGRyZW4gb2YgZnVsbHNjcmVlbiBlbGVtZW50IChhcyBhYm92ZSlcblxuICAgICAgICBpZiAoZWxlbWVudHMuZnVsbHNjcmVlbikge1xuICAgICAgICAgIEFycmF5LmZyb20oZWxlbWVudHMuZnVsbHNjcmVlbi5jaGlsZHJlbikuZmlsdGVyKGMgPT4gIWMuY29udGFpbnMoZWxlbWVudHMuY29udGFpbmVyKSkuZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICB0aGlzLmJpbmQoY2hpbGQsICdtb3VzZWVudGVyIG1vdXNlbGVhdmUnLCBldmVudCA9PiB7XG4gICAgICAgICAgICAgIGlmIChlbGVtZW50cy5jb250cm9scykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnRzLmNvbnRyb2xzLmhvdmVyID0gIXBsYXllci50b3VjaCAmJiBldmVudC50eXBlID09PSAnbW91c2VlbnRlcic7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IC8vIFVwZGF0ZSBjb250cm9scy5wcmVzc2VkIHN0YXRlICh1c2VkIGZvciB1aS50b2dnbGVDb250cm9scyB0byBhdm9pZCBoaWRpbmcgd2hlbiBpbnRlcmFjdGluZylcblxuXG4gICAgICAgIHRoaXMuYmluZChlbGVtZW50cy5jb250cm9scywgJ21vdXNlZG93biBtb3VzZXVwIHRvdWNoc3RhcnQgdG91Y2hlbmQgdG91Y2hjYW5jZWwnLCBldmVudCA9PiB7XG4gICAgICAgICAgZWxlbWVudHMuY29udHJvbHMucHJlc3NlZCA9IFsnbW91c2Vkb3duJywgJ3RvdWNoc3RhcnQnXS5pbmNsdWRlcyhldmVudC50eXBlKTtcbiAgICAgICAgfSk7IC8vIFNob3cgY29udHJvbHMgd2hlbiB0aGV5IHJlY2VpdmUgZm9jdXMgKGUuZy4sIHdoZW4gdXNpbmcga2V5Ym9hcmQgdGFiIGtleSlcblxuICAgICAgICB0aGlzLmJpbmQoZWxlbWVudHMuY29udHJvbHMsICdmb2N1c2luJywgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGNvbmZpZyxcbiAgICAgICAgICAgIHRpbWVyc1xuICAgICAgICAgIH0gPSBwbGF5ZXI7IC8vIFNraXAgdHJhbnNpdGlvbiB0byBwcmV2ZW50IGZvY3VzIGZyb20gc2Nyb2xsaW5nIHRoZSBwYXJlbnQgZWxlbWVudFxuXG4gICAgICAgICAgdG9nZ2xlQ2xhc3MoZWxlbWVudHMuY29udHJvbHMsIGNvbmZpZy5jbGFzc05hbWVzLm5vVHJhbnNpdGlvbiwgdHJ1ZSk7IC8vIFRvZ2dsZVxuXG4gICAgICAgICAgdWkudG9nZ2xlQ29udHJvbHMuY2FsbChwbGF5ZXIsIHRydWUpOyAvLyBSZXN0b3JlIHRyYW5zaXRpb25cblxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdG9nZ2xlQ2xhc3MoZWxlbWVudHMuY29udHJvbHMsIGNvbmZpZy5jbGFzc05hbWVzLm5vVHJhbnNpdGlvbiwgZmFsc2UpO1xuICAgICAgICAgIH0sIDApOyAvLyBEZWxheSBhIGxpdHRsZSBtb3JlIGZvciBtb3VzZSB1c2Vyc1xuXG4gICAgICAgICAgY29uc3QgZGVsYXkgPSB0aGlzLnRvdWNoID8gMzAwMCA6IDQwMDA7IC8vIENsZWFyIHRpbWVyXG5cbiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXJzLmNvbnRyb2xzKTsgLy8gSGlkZSBhZ2FpbiBhZnRlciBkZWxheVxuXG4gICAgICAgICAgdGltZXJzLmNvbnRyb2xzID0gc2V0VGltZW91dCgoKSA9PiB1aS50b2dnbGVDb250cm9scy5jYWxsKHBsYXllciwgZmFsc2UpLCBkZWxheSk7XG4gICAgICAgIH0pOyAvLyBNb3VzZSB3aGVlbCBmb3Igdm9sdW1lXG5cbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnRzLmlucHV0cy52b2x1bWUsICd3aGVlbCcsIGV2ZW50ID0+IHtcbiAgICAgICAgICAvLyBEZXRlY3QgXCJuYXR1cmFsXCIgc2Nyb2xsIC0gc3VwcG9ydGVkIG9uIE9TIFggU2FmYXJpIG9ubHlcbiAgICAgICAgICAvLyBPdGhlciBicm93c2VycyBvbiBPUyBYIHdpbGwgYmUgaW52ZXJ0ZWQgdW50aWwgc3VwcG9ydCBpbXByb3Zlc1xuICAgICAgICAgIGNvbnN0IGludmVydGVkID0gZXZlbnQud2Via2l0RGlyZWN0aW9uSW52ZXJ0ZWRGcm9tRGV2aWNlOyAvLyBHZXQgZGVsdGEgZnJvbSBldmVudC4gSW52ZXJ0IGlmIGBpbnZlcnRlZGAgaXMgdHJ1ZVxuXG4gICAgICAgICAgY29uc3QgW3gsIHldID0gW2V2ZW50LmRlbHRhWCwgLWV2ZW50LmRlbHRhWV0ubWFwKHZhbHVlID0+IGludmVydGVkID8gLXZhbHVlIDogdmFsdWUpOyAvLyBVc2luZyB0aGUgYmlnZ2VzdCBkZWx0YSwgbm9ybWFsaXplIHRvIDEgb3IgLTEgKG9yIDAgaWYgbm8gZGVsdGEpXG5cbiAgICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBNYXRoLnNpZ24oTWF0aC5hYnMoeCkgPiBNYXRoLmFicyh5KSA/IHggOiB5KTsgLy8gQ2hhbmdlIHRoZSB2b2x1bWUgYnkgMiVcblxuICAgICAgICAgIHBsYXllci5pbmNyZWFzZVZvbHVtZShkaXJlY3Rpb24gLyA1MCk7IC8vIERvbid0IGJyZWFrIHBhZ2Ugc2Nyb2xsaW5nIGF0IG1heCBhbmQgbWluXG5cbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICB2b2x1bWVcbiAgICAgICAgICB9ID0gcGxheWVyLm1lZGlhO1xuXG4gICAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gMSAmJiB2b2x1bWUgPCAxIHx8IGRpcmVjdGlvbiA9PT0gLTEgJiYgdm9sdW1lID4gMCkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sICd2b2x1bWUnLCBmYWxzZSk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5wbGF5ZXIgPSBfcGxheWVyO1xuICAgICAgdGhpcy5sYXN0S2V5ID0gbnVsbDtcbiAgICAgIHRoaXMuZm9jdXNUaW1lciA9IG51bGw7XG4gICAgICB0aGlzLmxhc3RLZXlEb3duID0gbnVsbDtcbiAgICAgIHRoaXMuaGFuZGxlS2V5ID0gdGhpcy5oYW5kbGVLZXkuYmluZCh0aGlzKTtcbiAgICAgIHRoaXMudG9nZ2xlTWVudSA9IHRoaXMudG9nZ2xlTWVudS5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy5zZXRUYWJGb2N1cyA9IHRoaXMuc2V0VGFiRm9jdXMuYmluZCh0aGlzKTtcbiAgICAgIHRoaXMuZmlyc3RUb3VjaCA9IHRoaXMuZmlyc3RUb3VjaC5iaW5kKHRoaXMpO1xuICAgIH0gLy8gSGFuZGxlIGtleSBwcmVzc2VzXG5cblxuICAgIGhhbmRsZUtleShldmVudCkge1xuICAgICAgY29uc3Qge1xuICAgICAgICBwbGF5ZXJcbiAgICAgIH0gPSB0aGlzO1xuICAgICAgY29uc3Qge1xuICAgICAgICBlbGVtZW50c1xuICAgICAgfSA9IHBsYXllcjtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAga2V5LFxuICAgICAgICB0eXBlLFxuICAgICAgICBhbHRLZXksXG4gICAgICAgIGN0cmxLZXksXG4gICAgICAgIG1ldGFLZXksXG4gICAgICAgIHNoaWZ0S2V5XG4gICAgICB9ID0gZXZlbnQ7XG4gICAgICBjb25zdCBwcmVzc2VkID0gdHlwZSA9PT0gJ2tleWRvd24nO1xuICAgICAgY29uc3QgcmVwZWF0ID0gcHJlc3NlZCAmJiBrZXkgPT09IHRoaXMubGFzdEtleTsgLy8gQmFpbCBpZiBhIG1vZGlmaWVyIGtleSBpcyBzZXRcblxuICAgICAgaWYgKGFsdEtleSB8fCBjdHJsS2V5IHx8IG1ldGFLZXkgfHwgc2hpZnRLZXkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBJZiB0aGUgZXZlbnQgaXMgYnViYmxlZCBmcm9tIHRoZSBtZWRpYSBlbGVtZW50XG4gICAgICAvLyBGaXJlZm94IGRvZXNuJ3QgZ2V0IHRoZSBrZXkgZm9yIHdoYXRldmVyIHJlYXNvblxuXG5cbiAgICAgIGlmICgha2V5KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gU2VlayBieSBpbmNyZW1lbnRcblxuXG4gICAgICBjb25zdCBzZWVrQnlJbmNyZW1lbnQgPSBpbmNyZW1lbnQgPT4ge1xuICAgICAgICAvLyBEaXZpZGUgdGhlIG1heCBkdXJhdGlvbiBpbnRvIDEwdGgncyBhbmQgdGltZXMgYnkgdGhlIG51bWJlciB2YWx1ZVxuICAgICAgICBwbGF5ZXIuY3VycmVudFRpbWUgPSBwbGF5ZXIuZHVyYXRpb24gLyAxMCAqIGluY3JlbWVudDtcbiAgICAgIH07IC8vIEhhbmRsZSB0aGUga2V5IG9uIGtleWRvd25cbiAgICAgIC8vIFJlc2V0IG9uIGtleXVwXG5cblxuICAgICAgaWYgKHByZXNzZWQpIHtcbiAgICAgICAgLy8gQ2hlY2sgZm9jdXNlZCBlbGVtZW50XG4gICAgICAgIC8vIGFuZCBpZiB0aGUgZm9jdXNlZCBlbGVtZW50IGlzIG5vdCBlZGl0YWJsZSAoZS5nLiB0ZXh0IGlucHV0KVxuICAgICAgICAvLyBhbmQgYW55IHRoYXQgYWNjZXB0IGtleSBpbnB1dCBodHRwOi8vd2ViYWltLm9yZy90ZWNobmlxdWVzL2tleWJvYXJkL1xuICAgICAgICBjb25zdCBmb2N1c2VkID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcblxuICAgICAgICBpZiAoaXMuZWxlbWVudChmb2N1c2VkKSkge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGVkaXRhYmxlXG4gICAgICAgICAgfSA9IHBsYXllci5jb25maWcuc2VsZWN0b3JzO1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIHNlZWtcbiAgICAgICAgICB9ID0gZWxlbWVudHMuaW5wdXRzO1xuXG4gICAgICAgICAgaWYgKGZvY3VzZWQgIT09IHNlZWsgJiYgbWF0Y2hlcyhmb2N1c2VkLCBlZGl0YWJsZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnU3BhY2UnICYmIG1hdGNoZXMoZm9jdXNlZCwgJ2J1dHRvbiwgW3JvbGVePVwibWVudWl0ZW1cIl0nKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfSAvLyBXaGljaCBrZXlzIHNob3VsZCB3ZSBwcmV2ZW50IGRlZmF1bHRcblxuXG4gICAgICAgIGNvbnN0IHByZXZlbnREZWZhdWx0ID0gWydTcGFjZScsICdBcnJvd0xlZnQnLCAnQXJyb3dVcCcsICdBcnJvd1JpZ2h0JywgJ0Fycm93RG93bicsICcwJywgJzEnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JywgJ2MnLCAnZicsICdrJywgJ2wnLCAnbSddOyAvLyBJZiB0aGUga2V5IGlzIGZvdW5kIHByZXZlbnQgZGVmYXVsdCAoZS5nLiBwcmV2ZW50IHNjcm9sbGluZyBmb3IgYXJyb3dzKVxuXG4gICAgICAgIGlmIChwcmV2ZW50RGVmYXVsdC5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgICAgY2FzZSAnMCc6XG4gICAgICAgICAgY2FzZSAnMSc6XG4gICAgICAgICAgY2FzZSAnMic6XG4gICAgICAgICAgY2FzZSAnMyc6XG4gICAgICAgICAgY2FzZSAnNCc6XG4gICAgICAgICAgY2FzZSAnNSc6XG4gICAgICAgICAgY2FzZSAnNic6XG4gICAgICAgICAgY2FzZSAnNyc6XG4gICAgICAgICAgY2FzZSAnOCc6XG4gICAgICAgICAgY2FzZSAnOSc6XG4gICAgICAgICAgICBpZiAoIXJlcGVhdCkge1xuICAgICAgICAgICAgICBzZWVrQnlJbmNyZW1lbnQocGFyc2VJbnQoa2V5LCAxMCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJ1NwYWNlJzpcbiAgICAgICAgICBjYXNlICdrJzpcbiAgICAgICAgICAgIGlmICghcmVwZWF0KSB7XG4gICAgICAgICAgICAgIHNpbGVuY2VQcm9taXNlKHBsYXllci50b2dnbGVQbGF5KCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgICAgcGxheWVyLmluY3JlYXNlVm9sdW1lKDAuMSk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgICAgICBwbGF5ZXIuZGVjcmVhc2VWb2x1bWUoMC4xKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnbSc6XG4gICAgICAgICAgICBpZiAoIXJlcGVhdCkge1xuICAgICAgICAgICAgICBwbGF5ZXIubXV0ZWQgPSAhcGxheWVyLm11dGVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICAgICAgcGxheWVyLmZvcndhcmQoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnQXJyb3dMZWZ0JzpcbiAgICAgICAgICAgIHBsYXllci5yZXdpbmQoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnZic6XG4gICAgICAgICAgICBwbGF5ZXIuZnVsbHNjcmVlbi50b2dnbGUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnYyc6XG4gICAgICAgICAgICBpZiAoIXJlcGVhdCkge1xuICAgICAgICAgICAgICBwbGF5ZXIudG9nZ2xlQ2FwdGlvbnMoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlICdsJzpcbiAgICAgICAgICAgIHBsYXllci5sb29wID0gIXBsYXllci5sb29wO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gLy8gRXNjYXBlIGlzIGhhbmRsZSBuYXRpdmVseSB3aGVuIGluIGZ1bGwgc2NyZWVuXG4gICAgICAgIC8vIFNvIHdlIG9ubHkgbmVlZCB0byB3b3JyeSBhYm91dCBub24gbmF0aXZlXG5cblxuICAgICAgICBpZiAoa2V5ID09PSAnRXNjYXBlJyAmJiAhcGxheWVyLmZ1bGxzY3JlZW4udXNpbmdOYXRpdmUgJiYgcGxheWVyLmZ1bGxzY3JlZW4uYWN0aXZlKSB7XG4gICAgICAgICAgcGxheWVyLmZ1bGxzY3JlZW4udG9nZ2xlKCk7XG4gICAgICAgIH0gLy8gU3RvcmUgbGFzdCBrZXkgZm9yIG5leHQgY3ljbGVcblxuXG4gICAgICAgIHRoaXMubGFzdEtleSA9IGtleTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubGFzdEtleSA9IG51bGw7XG4gICAgICB9XG4gICAgfSAvLyBUb2dnbGUgbWVudVxuXG5cbiAgICB0b2dnbGVNZW51KGV2ZW50KSB7XG4gICAgICBjb250cm9scy50b2dnbGVNZW51LmNhbGwodGhpcy5wbGF5ZXIsIGV2ZW50KTtcbiAgICB9IC8vIERldmljZSBpcyB0b3VjaCBlbmFibGVkXG5cblxuICB9XG5cbiAgdmFyIGNvbW1vbmpzR2xvYmFsID0gdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsVGhpcyA6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDoge307XG5cbiAgZnVuY3Rpb24gY3JlYXRlQ29tbW9uanNNb2R1bGUoZm4sIG1vZHVsZSkge1xuICBcdHJldHVybiBtb2R1bGUgPSB7IGV4cG9ydHM6IHt9IH0sIGZuKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMpLCBtb2R1bGUuZXhwb3J0cztcbiAgfVxuXG4gIHZhciBsb2FkanNfdW1kID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuICAgIChmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkge1xuICAgICAge1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICAgIH1cbiAgICB9KShjb21tb25qc0dsb2JhbCwgZnVuY3Rpb24gKCkge1xuICAgICAgLyoqXG4gICAgICAgKiBHbG9iYWwgZGVwZW5kZW5jaWVzLlxuICAgICAgICogQGdsb2JhbCB7T2JqZWN0fSBkb2N1bWVudCAtIERPTVxuICAgICAgICovXG4gICAgICB2YXIgZGV2bnVsbCA9IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgICAgIGJ1bmRsZUlkQ2FjaGUgPSB7fSxcbiAgICAgICAgICBidW5kbGVSZXN1bHRDYWNoZSA9IHt9LFxuICAgICAgICAgIGJ1bmRsZUNhbGxiYWNrUXVldWUgPSB7fTtcbiAgICAgIC8qKlxuICAgICAgICogU3Vic2NyaWJlIHRvIGJ1bmRsZSBsb2FkIGV2ZW50LlxuICAgICAgICogQHBhcmFtIHtzdHJpbmdbXX0gYnVuZGxlSWRzIC0gQnVuZGxlIGlkc1xuICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tGbiAtIFRoZSBjYWxsYmFjayBmdW5jdGlvblxuICAgICAgICovXG5cblxuICAgICAgZnVuY3Rpb24gc3Vic2NyaWJlKGJ1bmRsZUlkcywgY2FsbGJhY2tGbikge1xuICAgICAgICAvLyBsaXN0aWZ5XG4gICAgICAgIGJ1bmRsZUlkcyA9IGJ1bmRsZUlkcy5wdXNoID8gYnVuZGxlSWRzIDogW2J1bmRsZUlkc107XG4gICAgICAgIHZhciBkZXBzTm90Rm91bmQgPSBbXSxcbiAgICAgICAgICAgIGkgPSBidW5kbGVJZHMubGVuZ3RoLFxuICAgICAgICAgICAgbnVtV2FpdGluZyA9IGksXG4gICAgICAgICAgICBmbixcbiAgICAgICAgICAgIGJ1bmRsZUlkLFxuICAgICAgICAgICAgcixcbiAgICAgICAgICAgIHE7IC8vIGRlZmluZSBjYWxsYmFjayBmdW5jdGlvblxuXG4gICAgICAgIGZuID0gZnVuY3Rpb24gKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKSB7XG4gICAgICAgICAgaWYgKHBhdGhzTm90Rm91bmQubGVuZ3RoKSBkZXBzTm90Rm91bmQucHVzaChidW5kbGVJZCk7XG4gICAgICAgICAgbnVtV2FpdGluZy0tO1xuICAgICAgICAgIGlmICghbnVtV2FpdGluZykgY2FsbGJhY2tGbihkZXBzTm90Rm91bmQpO1xuICAgICAgICB9OyAvLyByZWdpc3RlciBjYWxsYmFja1xuXG5cbiAgICAgICAgd2hpbGUgKGktLSkge1xuICAgICAgICAgIGJ1bmRsZUlkID0gYnVuZGxlSWRzW2ldOyAvLyBleGVjdXRlIGNhbGxiYWNrIGlmIGluIHJlc3VsdCBjYWNoZVxuXG4gICAgICAgICAgciA9IGJ1bmRsZVJlc3VsdENhY2hlW2J1bmRsZUlkXTtcblxuICAgICAgICAgIGlmIChyKSB7XG4gICAgICAgICAgICBmbihidW5kbGVJZCwgcik7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9IC8vIGFkZCB0byBjYWxsYmFjayBxdWV1ZVxuXG5cbiAgICAgICAgICBxID0gYnVuZGxlQ2FsbGJhY2tRdWV1ZVtidW5kbGVJZF0gPSBidW5kbGVDYWxsYmFja1F1ZXVlW2J1bmRsZUlkXSB8fCBbXTtcbiAgICAgICAgICBxLnB1c2goZm4pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvKipcbiAgICAgICAqIFB1Ymxpc2ggYnVuZGxlIGxvYWQgZXZlbnQuXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBCdW5kbGUgaWRcbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IHBhdGhzTm90Rm91bmQgLSBMaXN0IG9mIGZpbGVzIG5vdCBmb3VuZFxuICAgICAgICovXG5cblxuICAgICAgZnVuY3Rpb24gcHVibGlzaChidW5kbGVJZCwgcGF0aHNOb3RGb3VuZCkge1xuICAgICAgICAvLyBleGl0IGlmIGlkIGlzbid0IGRlZmluZWRcbiAgICAgICAgaWYgKCFidW5kbGVJZCkgcmV0dXJuO1xuICAgICAgICB2YXIgcSA9IGJ1bmRsZUNhbGxiYWNrUXVldWVbYnVuZGxlSWRdOyAvLyBjYWNoZSByZXN1bHRcblxuICAgICAgICBidW5kbGVSZXN1bHRDYWNoZVtidW5kbGVJZF0gPSBwYXRoc05vdEZvdW5kOyAvLyBleGl0IGlmIHF1ZXVlIGlzIGVtcHR5XG5cbiAgICAgICAgaWYgKCFxKSByZXR1cm47IC8vIGVtcHR5IGNhbGxiYWNrIHF1ZXVlXG5cbiAgICAgICAgd2hpbGUgKHEubGVuZ3RoKSB7XG4gICAgICAgICAgcVswXShidW5kbGVJZCwgcGF0aHNOb3RGb3VuZCk7XG4gICAgICAgICAgcS5zcGxpY2UoMCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8qKlxuICAgICAgICogRXhlY3V0ZSBjYWxsYmFja3MuXG4gICAgICAgKiBAcGFyYW0ge09iamVjdCBvciBGdW5jdGlvbn0gYXJncyAtIFRoZSBjYWxsYmFjayBhcmdzXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBkZXBzTm90Rm91bmQgLSBMaXN0IG9mIGRlcGVuZGVuY2llcyBub3QgZm91bmRcbiAgICAgICAqL1xuXG5cbiAgICAgIGZ1bmN0aW9uIGV4ZWN1dGVDYWxsYmFja3MoYXJncywgZGVwc05vdEZvdW5kKSB7XG4gICAgICAgIC8vIGFjY2VwdCBmdW5jdGlvbiBhcyBhcmd1bWVudFxuICAgICAgICBpZiAoYXJncy5jYWxsKSBhcmdzID0ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGFyZ3NcbiAgICAgICAgfTsgLy8gc3VjY2VzcyBhbmQgZXJyb3IgY2FsbGJhY2tzXG5cbiAgICAgICAgaWYgKGRlcHNOb3RGb3VuZC5sZW5ndGgpIChhcmdzLmVycm9yIHx8IGRldm51bGwpKGRlcHNOb3RGb3VuZCk7ZWxzZSAoYXJncy5zdWNjZXNzIHx8IGRldm51bGwpKGFyZ3MpO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKiBMb2FkIGluZGl2aWR1YWwgZmlsZS5cbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIC0gVGhlIGZpbGUgcGF0aFxuICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tGbiAtIFRoZSBjYWxsYmFjayBmdW5jdGlvblxuICAgICAgICovXG5cblxuICAgICAgZnVuY3Rpb24gbG9hZEZpbGUocGF0aCwgY2FsbGJhY2tGbiwgYXJncywgbnVtVHJpZXMpIHtcbiAgICAgICAgdmFyIGRvYyA9IGRvY3VtZW50LFxuICAgICAgICAgICAgYXN5bmMgPSBhcmdzLmFzeW5jLFxuICAgICAgICAgICAgbWF4VHJpZXMgPSAoYXJncy5udW1SZXRyaWVzIHx8IDApICsgMSxcbiAgICAgICAgICAgIGJlZm9yZUNhbGxiYWNrRm4gPSBhcmdzLmJlZm9yZSB8fCBkZXZudWxsLFxuICAgICAgICAgICAgcGF0aG5hbWUgPSBwYXRoLnJlcGxhY2UoL1tcXD98I10uKiQvLCAnJyksXG4gICAgICAgICAgICBwYXRoU3RyaXBwZWQgPSBwYXRoLnJlcGxhY2UoL14oY3NzfGltZykhLywgJycpLFxuICAgICAgICAgICAgaXNMZWdhY3lJRUNzcyxcbiAgICAgICAgICAgIGU7XG4gICAgICAgIG51bVRyaWVzID0gbnVtVHJpZXMgfHwgMDtcblxuICAgICAgICBpZiAoLyheY3NzIXxcXC5jc3MkKS8udGVzdChwYXRobmFtZSkpIHtcbiAgICAgICAgICAvLyBjc3NcbiAgICAgICAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICAgICAgICBlLnJlbCA9ICdzdHlsZXNoZWV0JztcbiAgICAgICAgICBlLmhyZWYgPSBwYXRoU3RyaXBwZWQ7IC8vIHRhZyBJRTkrXG5cbiAgICAgICAgICBpc0xlZ2FjeUlFQ3NzID0gJ2hpZGVGb2N1cycgaW4gZTsgLy8gdXNlIHByZWxvYWQgaW4gSUUgRWRnZSAodG8gZGV0ZWN0IGxvYWQgZXJyb3JzKVxuXG4gICAgICAgICAgaWYgKGlzTGVnYWN5SUVDc3MgJiYgZS5yZWxMaXN0KSB7XG4gICAgICAgICAgICBpc0xlZ2FjeUlFQ3NzID0gMDtcbiAgICAgICAgICAgIGUucmVsID0gJ3ByZWxvYWQnO1xuICAgICAgICAgICAgZS5hcyA9ICdzdHlsZSc7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKC8oXmltZyF8XFwuKHBuZ3xnaWZ8anBnfHN2Z3x3ZWJwKSQpLy50ZXN0KHBhdGhuYW1lKSkge1xuICAgICAgICAgIC8vIGltYWdlXG4gICAgICAgICAgZSA9IGRvYy5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAgICAgICBlLnNyYyA9IHBhdGhTdHJpcHBlZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBqYXZhc2NyaXB0XG4gICAgICAgICAgZSA9IGRvYy5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgICBlLnNyYyA9IHBhdGg7XG4gICAgICAgICAgZS5hc3luYyA9IGFzeW5jID09PSB1bmRlZmluZWQgPyB0cnVlIDogYXN5bmM7XG4gICAgICAgIH1cblxuICAgICAgICBlLm9ubG9hZCA9IGUub25lcnJvciA9IGUub25iZWZvcmVsb2FkID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgICAgICAgdmFyIHJlc3VsdCA9IGV2LnR5cGVbMF07IC8vIHRyZWF0IGVtcHR5IHN0eWxlc2hlZXRzIGFzIGZhaWx1cmVzIHRvIGdldCBhcm91bmQgbGFjayBvZiBvbmVycm9yXG4gICAgICAgICAgLy8gc3VwcG9ydCBpbiBJRTktMTFcblxuICAgICAgICAgIGlmIChpc0xlZ2FjeUlFQ3NzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBpZiAoIWUuc2hlZXQuY3NzVGV4dC5sZW5ndGgpIHJlc3VsdCA9ICdlJztcbiAgICAgICAgICAgIH0gY2F0Y2ggKHgpIHtcbiAgICAgICAgICAgICAgLy8gc2hlZXRzIG9iamVjdHMgY3JlYXRlZCBmcm9tIGxvYWQgZXJyb3JzIGRvbid0IGFsbG93IGFjY2VzcyB0b1xuICAgICAgICAgICAgICAvLyBgY3NzVGV4dGAgKHVubGVzcyBlcnJvciBpcyBDb2RlOjE4IFNlY3VyaXR5RXJyb3IpXG4gICAgICAgICAgICAgIGlmICh4LmNvZGUgIT0gMTgpIHJlc3VsdCA9ICdlJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IC8vIGhhbmRsZSByZXRyaWVzIGluIGNhc2Ugb2YgbG9hZCBmYWlsdXJlXG5cblxuICAgICAgICAgIGlmIChyZXN1bHQgPT0gJ2UnKSB7XG4gICAgICAgICAgICAvLyBpbmNyZW1lbnQgY291bnRlclxuICAgICAgICAgICAgbnVtVHJpZXMgKz0gMTsgLy8gZXhpdCBmdW5jdGlvbiBhbmQgdHJ5IGFnYWluXG5cbiAgICAgICAgICAgIGlmIChudW1UcmllcyA8IG1heFRyaWVzKSB7XG4gICAgICAgICAgICAgIHJldHVybiBsb2FkRmlsZShwYXRoLCBjYWxsYmFja0ZuLCBhcmdzLCBudW1Ucmllcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIGlmIChlLnJlbCA9PSAncHJlbG9hZCcgJiYgZS5hcyA9PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICAvLyBhY3RpdmF0ZSBwcmVsb2FkZWQgc3R5bGVzaGVldHNcbiAgICAgICAgICAgIHJldHVybiBlLnJlbCA9ICdzdHlsZXNoZWV0JzsgLy8ganNoaW50IGlnbm9yZTpsaW5lXG4gICAgICAgICAgfSAvLyBleGVjdXRlIGNhbGxiYWNrXG5cblxuICAgICAgICAgIGNhbGxiYWNrRm4ocGF0aCwgcmVzdWx0LCBldi5kZWZhdWx0UHJldmVudGVkKTtcbiAgICAgICAgfTsgLy8gYWRkIHRvIGRvY3VtZW50ICh1bmxlc3MgY2FsbGJhY2sgcmV0dXJucyBgZmFsc2VgKVxuXG5cbiAgICAgICAgaWYgKGJlZm9yZUNhbGxiYWNrRm4ocGF0aCwgZSkgIT09IGZhbHNlKSBkb2MuaGVhZC5hcHBlbmRDaGlsZChlKTtcbiAgICAgIH1cbiAgICAgIC8qKlxuICAgICAgICogTG9hZCBtdWx0aXBsZSBmaWxlcy5cbiAgICAgICAqIEBwYXJhbSB7c3RyaW5nW119IHBhdGhzIC0gVGhlIGZpbGUgcGF0aHNcbiAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrRm4gLSBUaGUgY2FsbGJhY2sgZnVuY3Rpb25cbiAgICAgICAqL1xuXG5cbiAgICAgIGZ1bmN0aW9uIGxvYWRGaWxlcyhwYXRocywgY2FsbGJhY2tGbiwgYXJncykge1xuICAgICAgICAvLyBsaXN0aWZ5IHBhdGhzXG4gICAgICAgIHBhdGhzID0gcGF0aHMucHVzaCA/IHBhdGhzIDogW3BhdGhzXTtcbiAgICAgICAgdmFyIG51bVdhaXRpbmcgPSBwYXRocy5sZW5ndGgsXG4gICAgICAgICAgICB4ID0gbnVtV2FpdGluZyxcbiAgICAgICAgICAgIHBhdGhzTm90Rm91bmQgPSBbXSxcbiAgICAgICAgICAgIGZuLFxuICAgICAgICAgICAgaTsgLy8gZGVmaW5lIGNhbGxiYWNrIGZ1bmN0aW9uXG5cbiAgICAgICAgZm4gPSBmdW5jdGlvbiAocGF0aCwgcmVzdWx0LCBkZWZhdWx0UHJldmVudGVkKSB7XG4gICAgICAgICAgLy8gaGFuZGxlIGVycm9yXG4gICAgICAgICAgaWYgKHJlc3VsdCA9PSAnZScpIHBhdGhzTm90Rm91bmQucHVzaChwYXRoKTsgLy8gaGFuZGxlIGJlZm9yZWxvYWQgZXZlbnQuIElmIGRlZmF1bHRQcmV2ZW50ZWQgdGhlbiB0aGF0IG1lYW5zIHRoZSBsb2FkXG4gICAgICAgICAgLy8gd2lsbCBiZSBibG9ja2VkIChleC4gR2hvc3RlcnkvQUJQIG9uIFNhZmFyaSlcblxuICAgICAgICAgIGlmIChyZXN1bHQgPT0gJ2InKSB7XG4gICAgICAgICAgICBpZiAoZGVmYXVsdFByZXZlbnRlZCkgcGF0aHNOb3RGb3VuZC5wdXNoKHBhdGgpO2Vsc2UgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIG51bVdhaXRpbmctLTtcbiAgICAgICAgICBpZiAoIW51bVdhaXRpbmcpIGNhbGxiYWNrRm4ocGF0aHNOb3RGb3VuZCk7XG4gICAgICAgIH07IC8vIGxvYWQgc2NyaXB0c1xuXG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHg7IGkrKykgbG9hZEZpbGUocGF0aHNbaV0sIGZuLCBhcmdzKTtcbiAgICAgIH1cbiAgICAgIC8qKlxuICAgICAgICogSW5pdGlhdGUgc2NyaXB0IGxvYWQgYW5kIHJlZ2lzdGVyIGJ1bmRsZS5cbiAgICAgICAqIEBwYXJhbSB7KHN0cmluZ3xzdHJpbmdbXSl9IHBhdGhzIC0gVGhlIGZpbGUgcGF0aHNcbiAgICAgICAqIEBwYXJhbSB7KHN0cmluZ3xGdW5jdGlvbnxPYmplY3QpfSBbYXJnMV0gLSBUaGUgKDEpIGJ1bmRsZUlkIG9yICgyKSBzdWNjZXNzXG4gICAgICAgKiAgIGNhbGxiYWNrIG9yICgzKSBvYmplY3QgbGl0ZXJhbCB3aXRoIHN1Y2Nlc3MvZXJyb3IgYXJndW1lbnRzLCBudW1SZXRyaWVzLFxuICAgICAgICogICBldGMuXG4gICAgICAgKiBAcGFyYW0geyhGdW5jdGlvbnxPYmplY3QpfSBbYXJnMl0gLSBUaGUgKDEpIHN1Y2Nlc3MgY2FsbGJhY2sgb3IgKDIpIG9iamVjdFxuICAgICAgICogICBsaXRlcmFsIHdpdGggc3VjY2Vzcy9lcnJvciBhcmd1bWVudHMsIG51bVJldHJpZXMsIGV0Yy5cbiAgICAgICAqL1xuXG5cbiAgICAgIGZ1bmN0aW9uIGxvYWRqcyhwYXRocywgYXJnMSwgYXJnMikge1xuICAgICAgICB2YXIgYnVuZGxlSWQsIGFyZ3M7IC8vIGJ1bmRsZUlkIChpZiBzdHJpbmcpXG5cbiAgICAgICAgaWYgKGFyZzEgJiYgYXJnMS50cmltKSBidW5kbGVJZCA9IGFyZzE7IC8vIGFyZ3MgKGRlZmF1bHQgaXMge30pXG5cbiAgICAgICAgYXJncyA9IChidW5kbGVJZCA/IGFyZzIgOiBhcmcxKSB8fCB7fTsgLy8gdGhyb3cgZXJyb3IgaWYgYnVuZGxlIGlzIGFscmVhZHkgZGVmaW5lZFxuXG4gICAgICAgIGlmIChidW5kbGVJZCkge1xuICAgICAgICAgIGlmIChidW5kbGVJZCBpbiBidW5kbGVJZENhY2hlKSB7XG4gICAgICAgICAgICB0aHJvdyBcIkxvYWRKU1wiO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidW5kbGVJZENhY2hlW2J1bmRsZUlkXSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbG9hZEZuKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgIGxvYWRGaWxlcyhwYXRocywgZnVuY3Rpb24gKHBhdGhzTm90Rm91bmQpIHtcbiAgICAgICAgICAgIC8vIGV4ZWN1dGUgY2FsbGJhY2tzXG4gICAgICAgICAgICBleGVjdXRlQ2FsbGJhY2tzKGFyZ3MsIHBhdGhzTm90Rm91bmQpOyAvLyByZXNvbHZlIFByb21pc2VcblxuICAgICAgICAgICAgaWYgKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgZXhlY3V0ZUNhbGxiYWNrcyh7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogcmVzb2x2ZSxcbiAgICAgICAgICAgICAgICBlcnJvcjogcmVqZWN0XG4gICAgICAgICAgICAgIH0sIHBhdGhzTm90Rm91bmQpO1xuICAgICAgICAgICAgfSAvLyBwdWJsaXNoIGJ1bmRsZSBsb2FkIGV2ZW50XG5cblxuICAgICAgICAgICAgcHVibGlzaChidW5kbGVJZCwgcGF0aHNOb3RGb3VuZCk7XG4gICAgICAgICAgfSwgYXJncyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYXJncy5yZXR1cm5Qcm9taXNlKSByZXR1cm4gbmV3IFByb21pc2UobG9hZEZuKTtlbHNlIGxvYWRGbigpO1xuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKiBFeGVjdXRlIGNhbGxiYWNrcyB3aGVuIGRlcGVuZGVuY2llcyBoYXZlIGJlZW4gc2F0aXNmaWVkLlxuICAgICAgICogQHBhcmFtIHsoc3RyaW5nfHN0cmluZ1tdKX0gZGVwcyAtIExpc3Qgb2YgYnVuZGxlIGlkc1xuICAgICAgICogQHBhcmFtIHtPYmplY3R9IGFyZ3MgLSBzdWNjZXNzL2Vycm9yIGFyZ3VtZW50c1xuICAgICAgICovXG5cblxuICAgICAgbG9hZGpzLnJlYWR5ID0gZnVuY3Rpb24gcmVhZHkoZGVwcywgYXJncykge1xuICAgICAgICAvLyBzdWJzY3JpYmUgdG8gYnVuZGxlIGxvYWQgZXZlbnRcbiAgICAgICAgc3Vic2NyaWJlKGRlcHMsIGZ1bmN0aW9uIChkZXBzTm90Rm91bmQpIHtcbiAgICAgICAgICAvLyBleGVjdXRlIGNhbGxiYWNrc1xuICAgICAgICAgIGV4ZWN1dGVDYWxsYmFja3MoYXJncywgZGVwc05vdEZvdW5kKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBsb2FkanM7XG4gICAgICB9O1xuICAgICAgLyoqXG4gICAgICAgKiBNYW51YWxseSBzYXRpc2Z5IGJ1bmRsZSBkZXBlbmRlbmNpZXMuXG4gICAgICAgKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBUaGUgYnVuZGxlIGlkXG4gICAgICAgKi9cblxuXG4gICAgICBsb2FkanMuZG9uZSA9IGZ1bmN0aW9uIGRvbmUoYnVuZGxlSWQpIHtcbiAgICAgICAgcHVibGlzaChidW5kbGVJZCwgW10pO1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICogUmVzZXQgbG9hZGpzIGRlcGVuZGVuY2llcyBzdGF0dXNlc1xuICAgICAgICovXG5cblxuICAgICAgbG9hZGpzLnJlc2V0ID0gZnVuY3Rpb24gcmVzZXQoKSB7XG4gICAgICAgIGJ1bmRsZUlkQ2FjaGUgPSB7fTtcbiAgICAgICAgYnVuZGxlUmVzdWx0Q2FjaGUgPSB7fTtcbiAgICAgICAgYnVuZGxlQ2FsbGJhY2tRdWV1ZSA9IHt9O1xuICAgICAgfTtcbiAgICAgIC8qKlxuICAgICAgICogRGV0ZXJtaW5lIGlmIGJ1bmRsZSBoYXMgYWxyZWFkeSBiZWVuIGRlZmluZWRcbiAgICAgICAqIEBwYXJhbSBTdHJpbmd9IGJ1bmRsZUlkIC0gVGhlIGJ1bmRsZSBpZFxuICAgICAgICovXG5cblxuICAgICAgbG9hZGpzLmlzRGVmaW5lZCA9IGZ1bmN0aW9uIGlzRGVmaW5lZChidW5kbGVJZCkge1xuICAgICAgICByZXR1cm4gYnVuZGxlSWQgaW4gYnVuZGxlSWRDYWNoZTtcbiAgICAgIH07IC8vIGV4cG9ydFxuXG5cbiAgICAgIHJldHVybiBsb2FkanM7XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGZ1bmN0aW9uIGxvYWRTY3JpcHQodXJsKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGxvYWRqc191bWQodXJsLCB7XG4gICAgICAgIHN1Y2Nlc3M6IHJlc29sdmUsXG4gICAgICAgIGVycm9yOiByZWplY3RcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBwYXJzZUlkJDEodXJsKSB7XG4gICAgaWYgKGlzLmVtcHR5KHVybCkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGlmIChpcy5udW1iZXIoTnVtYmVyKHVybCkpKSB7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH1cblxuICAgIGNvbnN0IHJlZ2V4ID0gL14uKih2aW1lby5jb21cXC98dmlkZW9cXC8pKFxcZCspLiovO1xuICAgIHJldHVybiB1cmwubWF0Y2gocmVnZXgpID8gUmVnRXhwLiQyIDogdXJsO1xuICB9IC8vIFRyeSB0byBleHRyYWN0IGEgaGFzaCBmb3IgcHJpdmF0ZSB2aWRlb3MgZnJvbSB0aGUgVVJMXG5cblxuICBmdW5jdGlvbiBwYXJzZUhhc2godXJsKSB7XG4gICAgLyogVGhpcyByZWdleCBtYXRjaGVzIGEgaGV4YWRlY2ltYWwgaGFzaCBpZiBnaXZlbiBpbiBhbnkgb2YgdGhlc2UgZm9ybXM6XG4gICAgICogIC0gW2h0dHBzOi8vcGxheWVyLl12aW1lby5jb20vdmlkZW8ve2lkfS97aGFzaH1bP3BhcmFtc11cbiAgICAgKiAgLSBbaHR0cHM6Ly9wbGF5ZXIuXXZpbWVvLmNvbS92aWRlby97aWR9P2g9e2hhc2h9WyZwYXJhbXNdXG4gICAgICogIC0gW2h0dHBzOi8vcGxheWVyLl12aW1lby5jb20vdmlkZW8ve2lkfT9bcGFyYW1zXSZoPXtoYXNofVxuICAgICAqICAtIHZpZGVvL3tpZH0ve2hhc2h9XG4gICAgICogSWYgbWF0Y2hlZCwgdGhlIGhhc2ggaXMgYXZhaWxhYmxlIGluIGNhcHR1cmUgZ3JvdXAgNFxuICAgICAqL1xuICAgIGNvbnN0IHJlZ2V4ID0gL14uKih2aW1lby5jb21cXC98dmlkZW9cXC8pKFxcZCspKFxcPy4qJipoPXxcXC8pKyhbXFxkLGEtZl0rKS87XG4gICAgY29uc3QgZm91bmQgPSB1cmwubWF0Y2gocmVnZXgpO1xuICAgIHJldHVybiBmb3VuZCAmJiBmb3VuZC5sZW5ndGggPT09IDUgPyBmb3VuZFs0XSA6IG51bGw7XG4gIH0gLy8gU2V0IHBsYXliYWNrIHN0YXRlIGFuZCB0cmlnZ2VyIGNoYW5nZSAob25seSBvbiBhY3R1YWwgY2hhbmdlKVxuXG5cbiAgZnVuY3Rpb24gYXNzdXJlUGxheWJhY2tTdGF0ZSQxKHBsYXkpIHtcbiAgICBpZiAocGxheSAmJiAhdGhpcy5lbWJlZC5oYXNQbGF5ZWQpIHtcbiAgICAgIHRoaXMuZW1iZWQuaGFzUGxheWVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5tZWRpYS5wYXVzZWQgPT09IHBsYXkpIHtcbiAgICAgIHRoaXMubWVkaWEucGF1c2VkID0gIXBsYXk7XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCBwbGF5ID8gJ3BsYXknIDogJ3BhdXNlJyk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgdmltZW8gPSB7XG4gICAgc2V0dXAoKSB7XG4gICAgICBjb25zdCBwbGF5ZXIgPSB0aGlzOyAvLyBBZGQgZW1iZWQgY2xhc3MgZm9yIHJlc3BvbnNpdmVcblxuICAgICAgdG9nZ2xlQ2xhc3MocGxheWVyLmVsZW1lbnRzLndyYXBwZXIsIHBsYXllci5jb25maWcuY2xhc3NOYW1lcy5lbWJlZCwgdHJ1ZSk7IC8vIFNldCBzcGVlZCBvcHRpb25zIGZyb20gY29uZmlnXG5cbiAgICAgIHBsYXllci5vcHRpb25zLnNwZWVkID0gcGxheWVyLmNvbmZpZy5zcGVlZC5vcHRpb25zOyAvLyBTZXQgaW50aWFsIHJhdGlvXG5cbiAgICAgIHNldEFzcGVjdFJhdGlvLmNhbGwocGxheWVyKTsgLy8gTG9hZCB0aGUgU0RLIGlmIG5vdCBhbHJlYWR5XG5cbiAgICAgIGlmICghaXMub2JqZWN0KHdpbmRvdy5WaW1lbykpIHtcbiAgICAgICAgbG9hZFNjcmlwdChwbGF5ZXIuY29uZmlnLnVybHMudmltZW8uc2RrKS50aGVuKCgpID0+IHtcbiAgICAgICAgICB2aW1lby5yZWFkeS5jYWxsKHBsYXllcik7XG4gICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICBwbGF5ZXIuZGVidWcud2FybignVmltZW8gU0RLIChwbGF5ZXIuanMpIGZhaWxlZCB0byBsb2FkJywgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZpbWVvLnJlYWR5LmNhbGwocGxheWVyKTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gQVBJIFJlYWR5XG4gICAgcmVhZHkoKSB7XG4gICAgICBjb25zdCBwbGF5ZXIgPSB0aGlzO1xuICAgICAgY29uc3QgY29uZmlnID0gcGxheWVyLmNvbmZpZy52aW1lbztcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgcHJlbWl1bSxcbiAgICAgICAgcmVmZXJyZXJQb2xpY3ksXG4gICAgICAgIC4uLmZyYW1lUGFyYW1zXG4gICAgICB9ID0gY29uZmlnOyAvLyBHZXQgdGhlIHNvdXJjZSBVUkwgb3IgSURcblxuICAgICAgbGV0IHNvdXJjZSA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuICAgICAgbGV0IGhhc2ggPSAnJzsgLy8gR2V0IGZyb20gPGRpdj4gaWYgbmVlZGVkXG5cbiAgICAgIGlmIChpcy5lbXB0eShzb3VyY2UpKSB7XG4gICAgICAgIHNvdXJjZSA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUocGxheWVyLmNvbmZpZy5hdHRyaWJ1dGVzLmVtYmVkLmlkKTsgLy8gaGFzaCBjYW4gYWxzbyBiZSBzZXQgYXMgYXR0cmlidXRlIG9uIHRoZSA8ZGl2PlxuXG4gICAgICAgIGhhc2ggPSBwbGF5ZXIubWVkaWEuZ2V0QXR0cmlidXRlKHBsYXllci5jb25maWcuYXR0cmlidXRlcy5lbWJlZC5oYXNoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGhhc2ggPSBwYXJzZUhhc2goc291cmNlKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaGFzaFBhcmFtID0gaGFzaCA/IHtcbiAgICAgICAgaDogaGFzaFxuICAgICAgfSA6IHt9OyAvLyBJZiB0aGUgb3duZXIgaGFzIGEgcHJvIG9yIHByZW1pdW0gYWNjb3VudCB0aGVuIHdlIGNhbiBoaWRlIGNvbnRyb2xzIGV0Y1xuXG4gICAgICBpZiAocHJlbWl1bSkge1xuICAgICAgICBPYmplY3QuYXNzaWduKGZyYW1lUGFyYW1zLCB7XG4gICAgICAgICAgY29udHJvbHM6IGZhbHNlLFxuICAgICAgICAgIHNpZGVkb2NrOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgIH0gLy8gR2V0IFZpbWVvIHBhcmFtcyBmb3IgdGhlIGlmcmFtZVxuXG5cbiAgICAgIGNvbnN0IHBhcmFtcyA9IGJ1aWxkVXJsUGFyYW1zKHtcbiAgICAgICAgbG9vcDogcGxheWVyLmNvbmZpZy5sb29wLmFjdGl2ZSxcbiAgICAgICAgYXV0b3BsYXk6IHBsYXllci5hdXRvcGxheSxcbiAgICAgICAgbXV0ZWQ6IHBsYXllci5tdXRlZCxcbiAgICAgICAgZ2VzdHVyZTogJ21lZGlhJyxcbiAgICAgICAgcGxheXNpbmxpbmU6ICF0aGlzLmNvbmZpZy5mdWxsc2NyZWVuLmlvc05hdGl2ZSxcbiAgICAgICAgLy8gaGFzaCBoYXMgdG8gYmUgYWRkZWQgdG8gaWZyYW1lLVVSTFxuICAgICAgICAuLi5oYXNoUGFyYW0sXG4gICAgICAgIC4uLmZyYW1lUGFyYW1zXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGlkID0gcGFyc2VJZCQxKHNvdXJjZSk7IC8vIEJ1aWxkIGFuIGlmcmFtZVxuXG4gICAgICBjb25zdCBpZnJhbWUgPSBjcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgICAgIGNvbnN0IHNyYyA9IGZvcm1hdChwbGF5ZXIuY29uZmlnLnVybHMudmltZW8uaWZyYW1lLCBpZCwgcGFyYW1zKTtcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIHNyYyk7XG4gICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdhbGxvd2Z1bGxzY3JlZW4nLCAnJyk7XG4gICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdhbGxvdycsIFsnYXV0b3BsYXknLCAnZnVsbHNjcmVlbicsICdwaWN0dXJlLWluLXBpY3R1cmUnLCAnZW5jcnlwdGVkLW1lZGlhJywgJ2FjY2VsZXJvbWV0ZXInLCAnZ3lyb3Njb3BlJ10uam9pbignOyAnKSk7IC8vIFNldCB0aGUgcmVmZXJyZXIgcG9saWN5IGlmIHJlcXVpcmVkXG5cbiAgICAgIGlmICghaXMuZW1wdHkocmVmZXJyZXJQb2xpY3kpKSB7XG4gICAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3JlZmVycmVyUG9saWN5JywgcmVmZXJyZXJQb2xpY3kpO1xuICAgICAgfSAvLyBJbmplY3QgdGhlIHBhY2thZ2VcblxuXG4gICAgICBpZiAocHJlbWl1bSB8fCAhY29uZmlnLmN1c3RvbUNvbnRyb2xzKSB7XG4gICAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtcG9zdGVyJywgcGxheWVyLnBvc3Rlcik7XG4gICAgICAgIHBsYXllci5tZWRpYSA9IHJlcGxhY2VFbGVtZW50KGlmcmFtZSwgcGxheWVyLm1lZGlhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgY2xhc3M6IHBsYXllci5jb25maWcuY2xhc3NOYW1lcy5lbWJlZENvbnRhaW5lcixcbiAgICAgICAgICAnZGF0YS1wb3N0ZXInOiBwbGF5ZXIucG9zdGVyXG4gICAgICAgIH0pO1xuICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gICAgICAgIHBsYXllci5tZWRpYSA9IHJlcGxhY2VFbGVtZW50KHdyYXBwZXIsIHBsYXllci5tZWRpYSk7XG4gICAgICB9IC8vIEdldCBwb3N0ZXIgaW1hZ2VcblxuXG4gICAgICBpZiAoIWNvbmZpZy5jdXN0b21Db250cm9scykge1xuICAgICAgICBmZXRjaChmb3JtYXQocGxheWVyLmNvbmZpZy51cmxzLnZpbWVvLmFwaSwgc3JjKSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgaWYgKGlzLmVtcHR5KHJlc3BvbnNlKSB8fCAhcmVzcG9uc2UudGh1bWJuYWlsX3VybCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gLy8gU2V0IGFuZCBzaG93IHBvc3RlclxuXG5cbiAgICAgICAgICB1aS5zZXRQb3N0ZXIuY2FsbChwbGF5ZXIsIHJlc3BvbnNlLnRodW1ibmFpbF91cmwpLmNhdGNoKCgpID0+IHt9KTtcbiAgICAgICAgfSk7XG4gICAgICB9IC8vIFNldHVwIGluc3RhbmNlXG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdmltZW8vcGxheWVyLmpzXG5cblxuICAgICAgcGxheWVyLmVtYmVkID0gbmV3IHdpbmRvdy5WaW1lby5QbGF5ZXIoaWZyYW1lLCB7XG4gICAgICAgIGF1dG9wYXVzZTogcGxheWVyLmNvbmZpZy5hdXRvcGF1c2UsXG4gICAgICAgIG11dGVkOiBwbGF5ZXIubXV0ZWRcbiAgICAgIH0pO1xuICAgICAgcGxheWVyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG4gICAgICBwbGF5ZXIubWVkaWEuY3VycmVudFRpbWUgPSAwOyAvLyBEaXNhYmxlIG5hdGl2ZSB0ZXh0IHRyYWNrIHJlbmRlcmluZ1xuXG4gICAgICBpZiAocGxheWVyLnN1cHBvcnRlZC51aSkge1xuICAgICAgICBwbGF5ZXIuZW1iZWQuZGlzYWJsZVRleHRUcmFjaygpO1xuICAgICAgfSAvLyBDcmVhdGUgYSBmYXV4IEhUTUw1IEFQSSB1c2luZyB0aGUgVmltZW8gQVBJXG5cblxuICAgICAgcGxheWVyLm1lZGlhLnBsYXkgPSAoKSA9PiB7XG4gICAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUkMS5jYWxsKHBsYXllciwgdHJ1ZSk7XG4gICAgICAgIHJldHVybiBwbGF5ZXIuZW1iZWQucGxheSgpO1xuICAgICAgfTtcblxuICAgICAgcGxheWVyLm1lZGlhLnBhdXNlID0gKCkgPT4ge1xuICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlJDEuY2FsbChwbGF5ZXIsIGZhbHNlKTtcbiAgICAgICAgcmV0dXJuIHBsYXllci5lbWJlZC5wYXVzZSgpO1xuICAgICAgfTtcblxuICAgICAgcGxheWVyLm1lZGlhLnN0b3AgPSAoKSA9PiB7XG4gICAgICAgIHBsYXllci5wYXVzZSgpO1xuICAgICAgICBwbGF5ZXIuY3VycmVudFRpbWUgPSAwO1xuICAgICAgfTsgLy8gU2Vla2luZ1xuXG5cbiAgICAgIGxldCB7XG4gICAgICAgIGN1cnJlbnRUaW1lXG4gICAgICB9ID0gcGxheWVyLm1lZGlhO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ2N1cnJlbnRUaW1lJywge1xuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgcmV0dXJuIGN1cnJlbnRUaW1lO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldCh0aW1lKSB7XG4gICAgICAgICAgLy8gVmltZW8gd2lsbCBhdXRvbWF0aWNhbGx5IHBsYXkgb24gc2VlayBpZiB0aGUgdmlkZW8gaGFzbid0IGJlZW4gcGxheWVkIGJlZm9yZVxuICAgICAgICAgIC8vIEdldCBjdXJyZW50IHBhdXNlZCBzdGF0ZSBhbmQgdm9sdW1lIGV0Y1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGVtYmVkLFxuICAgICAgICAgICAgbWVkaWEsXG4gICAgICAgICAgICBwYXVzZWQsXG4gICAgICAgICAgICB2b2x1bWVcbiAgICAgICAgICB9ID0gcGxheWVyO1xuICAgICAgICAgIGNvbnN0IHJlc3RvcmVQYXVzZSA9IHBhdXNlZCAmJiAhZW1iZWQuaGFzUGxheWVkOyAvLyBTZXQgc2Vla2luZyBzdGF0ZSBhbmQgdHJpZ2dlciBldmVudFxuXG4gICAgICAgICAgbWVkaWEuc2Vla2luZyA9IHRydWU7XG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBtZWRpYSwgJ3NlZWtpbmcnKTsgLy8gSWYgcGF1c2VkLCBtdXRlIHVudGlsIHNlZWsgaXMgY29tcGxldGVcblxuICAgICAgICAgIFByb21pc2UucmVzb2x2ZShyZXN0b3JlUGF1c2UgJiYgZW1iZWQuc2V0Vm9sdW1lKDApKSAvLyBTZWVrXG4gICAgICAgICAgLnRoZW4oKCkgPT4gZW1iZWQuc2V0Q3VycmVudFRpbWUodGltZSkpIC8vIFJlc3RvcmUgcGF1c2VkXG4gICAgICAgICAgLnRoZW4oKCkgPT4gcmVzdG9yZVBhdXNlICYmIGVtYmVkLnBhdXNlKCkpIC8vIFJlc3RvcmUgdm9sdW1lXG4gICAgICAgICAgLnRoZW4oKCkgPT4gcmVzdG9yZVBhdXNlICYmIGVtYmVkLnNldFZvbHVtZSh2b2x1bWUpKS5jYXRjaCgoKSA9PiB7Ly8gRG8gbm90aGluZ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgIH0pOyAvLyBQbGF5YmFjayBzcGVlZFxuXG4gICAgICBsZXQgc3BlZWQgPSBwbGF5ZXIuY29uZmlnLnNwZWVkLnNlbGVjdGVkO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ3BsYXliYWNrUmF0ZScsIHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIHJldHVybiBzcGVlZDtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgICBwbGF5ZXIuZW1iZWQuc2V0UGxheWJhY2tSYXRlKGlucHV0KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHNwZWVkID0gaW5wdXQ7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3JhdGVjaGFuZ2UnKTtcbiAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBDYW5ub3Qgc2V0IFBsYXliYWNrIFJhdGUsIFZpZGVvIGlzIHByb2JhYmx5IG5vdCBvbiBQcm8gYWNjb3VudFxuICAgICAgICAgICAgcGxheWVyLm9wdGlvbnMuc3BlZWQgPSBbMV07XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgfSk7IC8vIFZvbHVtZVxuXG4gICAgICBsZXQge1xuICAgICAgICB2b2x1bWVcbiAgICAgIH0gPSBwbGF5ZXIuY29uZmlnO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ3ZvbHVtZScsIHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIHJldHVybiB2b2x1bWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0KGlucHV0KSB7XG4gICAgICAgICAgcGxheWVyLmVtYmVkLnNldFZvbHVtZShpbnB1dCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB2b2x1bWUgPSBpbnB1dDtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndm9sdW1lY2hhbmdlJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgfSk7IC8vIE11dGVkXG5cbiAgICAgIGxldCB7XG4gICAgICAgIG11dGVkXG4gICAgICB9ID0gcGxheWVyLmNvbmZpZztcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdtdXRlZCcsIHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIHJldHVybiBtdXRlZDtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgICBjb25zdCB0b2dnbGUgPSBpcy5ib29sZWFuKGlucHV0KSA/IGlucHV0IDogZmFsc2U7XG4gICAgICAgICAgcGxheWVyLmVtYmVkLnNldFZvbHVtZSh0b2dnbGUgPyAwIDogcGxheWVyLmNvbmZpZy52b2x1bWUpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgbXV0ZWQgPSB0b2dnbGU7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3ZvbHVtZWNoYW5nZScpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgIH0pOyAvLyBMb29wXG5cbiAgICAgIGxldCB7XG4gICAgICAgIGxvb3BcbiAgICAgIH0gPSBwbGF5ZXIuY29uZmlnO1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ2xvb3AnLCB7XG4gICAgICAgIGdldCgpIHtcbiAgICAgICAgICByZXR1cm4gbG9vcDtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgICBjb25zdCB0b2dnbGUgPSBpcy5ib29sZWFuKGlucHV0KSA/IGlucHV0IDogcGxheWVyLmNvbmZpZy5sb29wLmFjdGl2ZTtcbiAgICAgICAgICBwbGF5ZXIuZW1iZWQuc2V0TG9vcCh0b2dnbGUpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgbG9vcCA9IHRvZ2dsZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICB9KTsgLy8gU291cmNlXG5cbiAgICAgIGxldCBjdXJyZW50U3JjO1xuICAgICAgcGxheWVyLmVtYmVkLmdldFZpZGVvVXJsKCkudGhlbih2YWx1ZSA9PiB7XG4gICAgICAgIGN1cnJlbnRTcmMgPSB2YWx1ZTtcbiAgICAgICAgY29udHJvbHMuc2V0RG93bmxvYWRVcmwuY2FsbChwbGF5ZXIpO1xuICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICB0aGlzLmRlYnVnLndhcm4oZXJyb3IpO1xuICAgICAgfSk7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnY3VycmVudFNyYycsIHtcbiAgICAgICAgZ2V0KCkge1xuICAgICAgICAgIHJldHVybiBjdXJyZW50U3JjO1xuICAgICAgICB9XG5cbiAgICAgIH0pOyAvLyBFbmRlZFxuXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnZW5kZWQnLCB7XG4gICAgICAgIGdldCgpIHtcbiAgICAgICAgICByZXR1cm4gcGxheWVyLmN1cnJlbnRUaW1lID09PSBwbGF5ZXIuZHVyYXRpb247XG4gICAgICAgIH1cblxuICAgICAgfSk7IC8vIFNldCBhc3BlY3QgcmF0aW8gYmFzZWQgb24gdmlkZW8gc2l6ZVxuXG4gICAgICBQcm9taXNlLmFsbChbcGxheWVyLmVtYmVkLmdldFZpZGVvV2lkdGgoKSwgcGxheWVyLmVtYmVkLmdldFZpZGVvSGVpZ2h0KCldKS50aGVuKGRpbWVuc2lvbnMgPT4ge1xuICAgICAgICBjb25zdCBbd2lkdGgsIGhlaWdodF0gPSBkaW1lbnNpb25zO1xuICAgICAgICBwbGF5ZXIuZW1iZWQucmF0aW8gPSByb3VuZEFzcGVjdFJhdGlvKHdpZHRoLCBoZWlnaHQpO1xuICAgICAgICBzZXRBc3BlY3RSYXRpby5jYWxsKHRoaXMpO1xuICAgICAgfSk7IC8vIFNldCBhdXRvcGF1c2VcblxuICAgICAgcGxheWVyLmVtYmVkLnNldEF1dG9wYXVzZShwbGF5ZXIuY29uZmlnLmF1dG9wYXVzZSkudGhlbihzdGF0ZSA9PiB7XG4gICAgICAgIHBsYXllci5jb25maWcuYXV0b3BhdXNlID0gc3RhdGU7XG4gICAgICB9KTsgLy8gR2V0IHRpdGxlXG5cbiAgICAgIHBsYXllci5lbWJlZC5nZXRWaWRlb1RpdGxlKCkudGhlbih0aXRsZSA9PiB7XG4gICAgICAgIHBsYXllci5jb25maWcudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgdWkuc2V0VGl0bGUuY2FsbCh0aGlzKTtcbiAgICAgIH0pOyAvLyBHZXQgY3VycmVudCB0aW1lXG5cbiAgICAgIHBsYXllci5lbWJlZC5nZXRDdXJyZW50VGltZSgpLnRoZW4odmFsdWUgPT4ge1xuICAgICAgICBjdXJyZW50VGltZSA9IHZhbHVlO1xuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3RpbWV1cGRhdGUnKTtcbiAgICAgIH0pOyAvLyBHZXQgZHVyYXRpb25cblxuICAgICAgcGxheWVyLmVtYmVkLmdldER1cmF0aW9uKCkudGhlbih2YWx1ZSA9PiB7XG4gICAgICAgIHBsYXllci5tZWRpYS5kdXJhdGlvbiA9IHZhbHVlO1xuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2R1cmF0aW9uY2hhbmdlJyk7XG4gICAgICB9KTsgLy8gR2V0IGNhcHRpb25zXG5cbiAgICAgIHBsYXllci5lbWJlZC5nZXRUZXh0VHJhY2tzKCkudGhlbih0cmFja3MgPT4ge1xuICAgICAgICBwbGF5ZXIubWVkaWEudGV4dFRyYWNrcyA9IHRyYWNrcztcbiAgICAgICAgY2FwdGlvbnMuc2V0dXAuY2FsbChwbGF5ZXIpO1xuICAgICAgfSk7XG4gICAgICBwbGF5ZXIuZW1iZWQub24oJ2N1ZWNoYW5nZScsICh7XG4gICAgICAgIGN1ZXMgPSBbXVxuICAgICAgfSkgPT4ge1xuICAgICAgICBjb25zdCBzdHJpcHBlZEN1ZXMgPSBjdWVzLm1hcChjdWUgPT4gc3RyaXBIVE1MKGN1ZS50ZXh0KSk7XG4gICAgICAgIGNhcHRpb25zLnVwZGF0ZUN1ZXMuY2FsbChwbGF5ZXIsIHN0cmlwcGVkQ3Vlcyk7XG4gICAgICB9KTtcbiAgICAgIHBsYXllci5lbWJlZC5vbignbG9hZGVkJywgKCkgPT4ge1xuICAgICAgICAvLyBBc3N1cmUgc3RhdGUgYW5kIGV2ZW50cyBhcmUgdXBkYXRlZCBvbiBhdXRvcGxheVxuICAgICAgICBwbGF5ZXIuZW1iZWQuZ2V0UGF1c2VkKCkudGhlbihwYXVzZWQgPT4ge1xuICAgICAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUkMS5jYWxsKHBsYXllciwgIXBhdXNlZCk7XG5cbiAgICAgICAgICBpZiAoIXBhdXNlZCkge1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwbGF5aW5nJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoaXMuZWxlbWVudChwbGF5ZXIuZW1iZWQuZWxlbWVudCkgJiYgcGxheWVyLnN1cHBvcnRlZC51aSkge1xuICAgICAgICAgIGNvbnN0IGZyYW1lID0gcGxheWVyLmVtYmVkLmVsZW1lbnQ7IC8vIEZpeCBrZXlib2FyZCBmb2N1cyBpc3N1ZXNcbiAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvMzE3XG5cbiAgICAgICAgICBmcmFtZS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHBsYXllci5lbWJlZC5vbignYnVmZmVyc3RhcnQnLCAoKSA9PiB7XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnd2FpdGluZycpO1xuICAgICAgfSk7XG4gICAgICBwbGF5ZXIuZW1iZWQub24oJ2J1ZmZlcmVuZCcsICgpID0+IHtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwbGF5aW5nJyk7XG4gICAgICB9KTtcbiAgICAgIHBsYXllci5lbWJlZC5vbigncGxheScsICgpID0+IHtcbiAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZSQxLmNhbGwocGxheWVyLCB0cnVlKTtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwbGF5aW5nJyk7XG4gICAgICB9KTtcbiAgICAgIHBsYXllci5lbWJlZC5vbigncGF1c2UnLCAoKSA9PiB7XG4gICAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUkMS5jYWxsKHBsYXllciwgZmFsc2UpO1xuICAgICAgfSk7XG4gICAgICBwbGF5ZXIuZW1iZWQub24oJ3RpbWV1cGRhdGUnLCBkYXRhID0+IHtcbiAgICAgICAgcGxheWVyLm1lZGlhLnNlZWtpbmcgPSBmYWxzZTtcbiAgICAgICAgY3VycmVudFRpbWUgPSBkYXRhLnNlY29uZHM7XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZScpO1xuICAgICAgfSk7XG4gICAgICBwbGF5ZXIuZW1iZWQub24oJ3Byb2dyZXNzJywgZGF0YSA9PiB7XG4gICAgICAgIHBsYXllci5tZWRpYS5idWZmZXJlZCA9IGRhdGEucGVyY2VudDtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwcm9ncmVzcycpOyAvLyBDaGVjayBhbGwgbG9hZGVkXG5cbiAgICAgICAgaWYgKHBhcnNlSW50KGRhdGEucGVyY2VudCwgMTApID09PSAxKSB7XG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdjYW5wbGF5dGhyb3VnaCcpO1xuICAgICAgICB9IC8vIEdldCBkdXJhdGlvbiBhcyBpZiB3ZSBkbyBpdCBiZWZvcmUgbG9hZCwgaXQgZ2l2ZXMgYW4gaW5jb3JyZWN0IHZhbHVlXG4gICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy84OTFcblxuXG4gICAgICAgIHBsYXllci5lbWJlZC5nZXREdXJhdGlvbigpLnRoZW4odmFsdWUgPT4ge1xuICAgICAgICAgIGlmICh2YWx1ZSAhPT0gcGxheWVyLm1lZGlhLmR1cmF0aW9uKSB7XG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEuZHVyYXRpb24gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBwbGF5ZXIuZW1iZWQub24oJ3NlZWtlZCcsICgpID0+IHtcbiAgICAgICAgcGxheWVyLm1lZGlhLnNlZWtpbmcgPSBmYWxzZTtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdzZWVrZWQnKTtcbiAgICAgIH0pO1xuICAgICAgcGxheWVyLmVtYmVkLm9uKCdlbmRlZCcsICgpID0+IHtcbiAgICAgICAgcGxheWVyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZW5kZWQnKTtcbiAgICAgIH0pO1xuICAgICAgcGxheWVyLmVtYmVkLm9uKCdlcnJvcicsIGRldGFpbCA9PiB7XG4gICAgICAgIHBsYXllci5tZWRpYS5lcnJvciA9IGRldGFpbDtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdlcnJvcicpO1xuICAgICAgfSk7IC8vIFJlYnVpbGQgVUlcblxuICAgICAgaWYgKGNvbmZpZy5jdXN0b21Db250cm9scykge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHVpLmJ1aWxkLmNhbGwocGxheWVyKSwgMCk7XG4gICAgICB9XG4gICAgfVxuXG4gIH07XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBmdW5jdGlvbiBwYXJzZUlkKHVybCkge1xuICAgIGlmIChpcy5lbXB0eSh1cmwpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCByZWdleCA9IC9eLiooeW91dHUuYmVcXC98dlxcL3x1XFwvXFx3XFwvfGVtYmVkXFwvfHdhdGNoXFw/dj18JnY9KShbXiMmP10qKS4qLztcbiAgICByZXR1cm4gdXJsLm1hdGNoKHJlZ2V4KSA/IFJlZ0V4cC4kMiA6IHVybDtcbiAgfSAvLyBTZXQgcGxheWJhY2sgc3RhdGUgYW5kIHRyaWdnZXIgY2hhbmdlIChvbmx5IG9uIGFjdHVhbCBjaGFuZ2UpXG5cblxuICBmdW5jdGlvbiBhc3N1cmVQbGF5YmFja1N0YXRlKHBsYXkpIHtcbiAgICBpZiAocGxheSAmJiAhdGhpcy5lbWJlZC5oYXNQbGF5ZWQpIHtcbiAgICAgIHRoaXMuZW1iZWQuaGFzUGxheWVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5tZWRpYS5wYXVzZWQgPT09IHBsYXkpIHtcbiAgICAgIHRoaXMubWVkaWEucGF1c2VkID0gIXBsYXk7XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCBwbGF5ID8gJ3BsYXknIDogJ3BhdXNlJyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0SG9zdChjb25maWcpIHtcbiAgICBpZiAoY29uZmlnLm5vQ29va2llKSB7XG4gICAgICByZXR1cm4gJ2h0dHBzOi8vd3d3LnlvdXR1YmUtbm9jb29raWUuY29tJztcbiAgICB9XG5cbiAgICBpZiAod2luZG93LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cDonKSB7XG4gICAgICByZXR1cm4gJ2h0dHA6Ly93d3cueW91dHViZS5jb20nO1xuICAgIH0gLy8gVXNlIFlvdVR1YmUncyBkZWZhdWx0XG5cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBjb25zdCB5b3V0dWJlID0ge1xuICAgIHNldHVwKCkge1xuICAgICAgLy8gQWRkIGVtYmVkIGNsYXNzIGZvciByZXNwb25zaXZlXG4gICAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLndyYXBwZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuZW1iZWQsIHRydWUpOyAvLyBTZXR1cCBBUElcblxuICAgICAgaWYgKGlzLm9iamVjdCh3aW5kb3cuWVQpICYmIGlzLmZ1bmN0aW9uKHdpbmRvdy5ZVC5QbGF5ZXIpKSB7XG4gICAgICAgIHlvdXR1YmUucmVhZHkuY2FsbCh0aGlzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFJlZmVyZW5jZSBjdXJyZW50IGdsb2JhbCBjYWxsYmFja1xuICAgICAgICBjb25zdCBjYWxsYmFjayA9IHdpbmRvdy5vbllvdVR1YmVJZnJhbWVBUElSZWFkeTsgLy8gU2V0IGNhbGxiYWNrIHRvIHByb2Nlc3MgcXVldWVcblxuICAgICAgICB3aW5kb3cub25Zb3VUdWJlSWZyYW1lQVBJUmVhZHkgPSAoKSA9PiB7XG4gICAgICAgICAgLy8gQ2FsbCBnbG9iYWwgY2FsbGJhY2sgaWYgc2V0XG4gICAgICAgICAgaWYgKGlzLmZ1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB5b3V0dWJlLnJlYWR5LmNhbGwodGhpcyk7XG4gICAgICAgIH07IC8vIExvYWQgdGhlIFNES1xuXG5cbiAgICAgICAgbG9hZFNjcmlwdCh0aGlzLmNvbmZpZy51cmxzLnlvdXR1YmUuc2RrKS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdZb3VUdWJlIEFQSSBmYWlsZWQgdG8gbG9hZCcsIGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIC8vIEdldCB0aGUgbWVkaWEgdGl0bGVcbiAgICBnZXRUaXRsZSh2aWRlb0lkKSB7XG4gICAgICBjb25zdCB1cmwgPSBmb3JtYXQodGhpcy5jb25maWcudXJscy55b3V0dWJlLmFwaSwgdmlkZW9JZCk7XG4gICAgICBmZXRjaCh1cmwpLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgIGlmIChpcy5vYmplY3QoZGF0YSkpIHtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICB0aXRsZSxcbiAgICAgICAgICAgIGhlaWdodCxcbiAgICAgICAgICAgIHdpZHRoXG4gICAgICAgICAgfSA9IGRhdGE7IC8vIFNldCB0aXRsZVxuXG4gICAgICAgICAgdGhpcy5jb25maWcudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgICB1aS5zZXRUaXRsZS5jYWxsKHRoaXMpOyAvLyBTZXQgYXNwZWN0IHJhdGlvXG5cbiAgICAgICAgICB0aGlzLmVtYmVkLnJhdGlvID0gcm91bmRBc3BlY3RSYXRpbyh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNldEFzcGVjdFJhdGlvLmNhbGwodGhpcyk7XG4gICAgICB9KS5jYXRjaCgoKSA9PiB7XG4gICAgICAgIC8vIFNldCBhc3BlY3QgcmF0aW9cbiAgICAgICAgc2V0QXNwZWN0UmF0aW8uY2FsbCh0aGlzKTtcbiAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvLyBBUEkgcmVhZHlcbiAgICByZWFkeSgpIHtcbiAgICAgIGNvbnN0IHBsYXllciA9IHRoaXM7XG4gICAgICBjb25zdCBjb25maWcgPSBwbGF5ZXIuY29uZmlnLnlvdXR1YmU7IC8vIElnbm9yZSBhbHJlYWR5IHNldHVwIChyYWNlIGNvbmRpdGlvbilcblxuICAgICAgY29uc3QgY3VycmVudElkID0gcGxheWVyLm1lZGlhICYmIHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUoJ2lkJyk7XG5cbiAgICAgIGlmICghaXMuZW1wdHkoY3VycmVudElkKSAmJiBjdXJyZW50SWQuc3RhcnRzV2l0aCgneW91dHViZS0nKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIEdldCB0aGUgc291cmNlIFVSTCBvciBJRFxuXG5cbiAgICAgIGxldCBzb3VyY2UgPSBwbGF5ZXIubWVkaWEuZ2V0QXR0cmlidXRlKCdzcmMnKTsgLy8gR2V0IGZyb20gPGRpdj4gaWYgbmVlZGVkXG5cbiAgICAgIGlmIChpcy5lbXB0eShzb3VyY2UpKSB7XG4gICAgICAgIHNvdXJjZSA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUodGhpcy5jb25maWcuYXR0cmlidXRlcy5lbWJlZC5pZCk7XG4gICAgICB9IC8vIFJlcGxhY2UgdGhlIDxpZnJhbWU+IHdpdGggYSA8ZGl2PiBkdWUgdG8gWW91VHViZSBBUEkgaXNzdWVzXG5cblxuICAgICAgY29uc3QgdmlkZW9JZCA9IHBhcnNlSWQoc291cmNlKTtcbiAgICAgIGNvbnN0IGlkID0gZ2VuZXJhdGVJZChwbGF5ZXIucHJvdmlkZXIpOyAvLyBSZXBsYWNlIG1lZGlhIGVsZW1lbnRcblxuICAgICAgY29uc3QgY29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICBpZCxcbiAgICAgICAgJ2RhdGEtcG9zdGVyJzogY29uZmlnLmN1c3RvbUNvbnRyb2xzID8gcGxheWVyLnBvc3RlciA6IHVuZGVmaW5lZFxuICAgICAgfSk7XG4gICAgICBwbGF5ZXIubWVkaWEgPSByZXBsYWNlRWxlbWVudChjb250YWluZXIsIHBsYXllci5tZWRpYSk7IC8vIE9ubHkgbG9hZCB0aGUgcG9zdGVyIHdoZW4gdXNpbmcgY3VzdG9tIGNvbnRyb2xzXG5cbiAgICAgIGlmIChjb25maWcuY3VzdG9tQ29udHJvbHMpIHtcbiAgICAgICAgY29uc3QgcG9zdGVyU3JjID0gcyA9PiBgaHR0cHM6Ly9pLnl0aW1nLmNvbS92aS8ke3ZpZGVvSWR9LyR7c31kZWZhdWx0LmpwZ2A7IC8vIENoZWNrIHRodW1ibmFpbCBpbWFnZXMgaW4gb3JkZXIgb2YgcXVhbGl0eSwgYnV0IHJlamVjdCBmYWxsYmFjayB0aHVtYm5haWxzICgxMjBweCB3aWRlKVxuXG5cbiAgICAgICAgbG9hZEltYWdlKHBvc3RlclNyYygnbWF4cmVzJyksIDEyMSkgLy8gSGlnZXN0IHF1YWxpdHkgYW5kIHVucGFkZGVkXG4gICAgICAgIC5jYXRjaCgoKSA9PiBsb2FkSW1hZ2UocG9zdGVyU3JjKCdzZCcpLCAxMjEpKSAvLyA0ODBwIHBhZGRlZCA0OjNcbiAgICAgICAgLmNhdGNoKCgpID0+IGxvYWRJbWFnZShwb3N0ZXJTcmMoJ2hxJykpKSAvLyAzNjBwIHBhZGRlZCA0OjMuIEFsd2F5cyBleGlzdHNcbiAgICAgICAgLnRoZW4oaW1hZ2UgPT4gdWkuc2V0UG9zdGVyLmNhbGwocGxheWVyLCBpbWFnZS5zcmMpKS50aGVuKHNyYyA9PiB7XG4gICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHBhZGRlZCwgdXNlIGJhY2tncm91bmQtc2l6ZSBcImNvdmVyXCIgaW5zdGVhZCAobGlrZSB5b3V0dWJlIGRvZXMgdG9vIHdpdGggdGhlaXIgcG9zdGVycylcbiAgICAgICAgICBpZiAoIXNyYy5pbmNsdWRlcygnbWF4cmVzJykpIHtcbiAgICAgICAgICAgIHBsYXllci5lbGVtZW50cy5wb3N0ZXIuc3R5bGUuYmFja2dyb3VuZFNpemUgPSAnY292ZXInO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkuY2F0Y2goKCkgPT4ge30pO1xuICAgICAgfSAvLyBTZXR1cCBpbnN0YW5jZVxuICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20veW91dHViZS9pZnJhbWVfYXBpX3JlZmVyZW5jZVxuXG5cbiAgICAgIHBsYXllci5lbWJlZCA9IG5ldyB3aW5kb3cuWVQuUGxheWVyKHBsYXllci5tZWRpYSwge1xuICAgICAgICB2aWRlb0lkLFxuICAgICAgICBob3N0OiBnZXRIb3N0KGNvbmZpZyksXG4gICAgICAgIHBsYXllclZhcnM6IGV4dGVuZCh7fSwge1xuICAgICAgICAgIC8vIEF1dG9wbGF5XG4gICAgICAgICAgYXV0b3BsYXk6IHBsYXllci5jb25maWcuYXV0b3BsYXkgPyAxIDogMCxcbiAgICAgICAgICAvLyBpZnJhbWUgaW50ZXJmYWNlIGxhbmd1YWdlXG4gICAgICAgICAgaGw6IHBsYXllci5jb25maWcuaGwsXG4gICAgICAgICAgLy8gT25seSBzaG93IGNvbnRyb2xzIGlmIG5vdCBmdWxseSBzdXBwb3J0ZWQgb3Igb3B0ZWQgb3V0XG4gICAgICAgICAgY29udHJvbHM6IHBsYXllci5zdXBwb3J0ZWQudWkgJiYgY29uZmlnLmN1c3RvbUNvbnRyb2xzID8gMCA6IDEsXG4gICAgICAgICAgLy8gRGlzYWJsZSBrZXlib2FyZCBhcyB3ZSBoYW5kbGUgaXRcbiAgICAgICAgICBkaXNhYmxla2I6IDEsXG4gICAgICAgICAgLy8gQWxsb3cgaU9TIGlubGluZSBwbGF5YmFja1xuICAgICAgICAgIHBsYXlzaW5saW5lOiAhcGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmlvc05hdGl2ZSA/IDEgOiAwLFxuICAgICAgICAgIC8vIENhcHRpb25zIGFyZSBmbGFreSBvbiBZb3VUdWJlXG4gICAgICAgICAgY2NfbG9hZF9wb2xpY3k6IHBsYXllci5jYXB0aW9ucy5hY3RpdmUgPyAxIDogMCxcbiAgICAgICAgICBjY19sYW5nX3ByZWY6IHBsYXllci5jb25maWcuY2FwdGlvbnMubGFuZ3VhZ2UsXG4gICAgICAgICAgLy8gVHJhY2tpbmcgZm9yIHN0YXRzXG4gICAgICAgICAgd2lkZ2V0X3JlZmVycmVyOiB3aW5kb3cgPyB3aW5kb3cubG9jYXRpb24uaHJlZiA6IG51bGxcbiAgICAgICAgfSwgY29uZmlnKSxcbiAgICAgICAgZXZlbnRzOiB7XG4gICAgICAgICAgb25FcnJvcihldmVudCkge1xuICAgICAgICAgICAgLy8gWW91VHViZSBtYXkgZmlyZSBvbkVycm9yIHR3aWNlLCBzbyBvbmx5IGhhbmRsZSBpdCBvbmNlXG4gICAgICAgICAgICBpZiAoIXBsYXllci5tZWRpYS5lcnJvcikge1xuICAgICAgICAgICAgICBjb25zdCBjb2RlID0gZXZlbnQuZGF0YTsgLy8gTWVzc2FnZXMgY29waWVkIGZyb20gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20veW91dHViZS9pZnJhbWVfYXBpX3JlZmVyZW5jZSNvbkVycm9yXG5cbiAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IHtcbiAgICAgICAgICAgICAgICAyOiAnVGhlIHJlcXVlc3QgY29udGFpbnMgYW4gaW52YWxpZCBwYXJhbWV0ZXIgdmFsdWUuIEZvciBleGFtcGxlLCB0aGlzIGVycm9yIG9jY3VycyBpZiB5b3Ugc3BlY2lmeSBhIHZpZGVvIElEIHRoYXQgZG9lcyBub3QgaGF2ZSAxMSBjaGFyYWN0ZXJzLCBvciBpZiB0aGUgdmlkZW8gSUQgY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzLCBzdWNoIGFzIGV4Y2xhbWF0aW9uIHBvaW50cyBvciBhc3Rlcmlza3MuJyxcbiAgICAgICAgICAgICAgICA1OiAnVGhlIHJlcXVlc3RlZCBjb250ZW50IGNhbm5vdCBiZSBwbGF5ZWQgaW4gYW4gSFRNTDUgcGxheWVyIG9yIGFub3RoZXIgZXJyb3IgcmVsYXRlZCB0byB0aGUgSFRNTDUgcGxheWVyIGhhcyBvY2N1cnJlZC4nLFxuICAgICAgICAgICAgICAgIDEwMDogJ1RoZSB2aWRlbyByZXF1ZXN0ZWQgd2FzIG5vdCBmb3VuZC4gVGhpcyBlcnJvciBvY2N1cnMgd2hlbiBhIHZpZGVvIGhhcyBiZWVuIHJlbW92ZWQgKGZvciBhbnkgcmVhc29uKSBvciBoYXMgYmVlbiBtYXJrZWQgYXMgcHJpdmF0ZS4nLFxuICAgICAgICAgICAgICAgIDEwMTogJ1RoZSBvd25lciBvZiB0aGUgcmVxdWVzdGVkIHZpZGVvIGRvZXMgbm90IGFsbG93IGl0IHRvIGJlIHBsYXllZCBpbiBlbWJlZGRlZCBwbGF5ZXJzLicsXG4gICAgICAgICAgICAgICAgMTUwOiAnVGhlIG93bmVyIG9mIHRoZSByZXF1ZXN0ZWQgdmlkZW8gZG9lcyBub3QgYWxsb3cgaXQgdG8gYmUgcGxheWVkIGluIGVtYmVkZGVkIHBsYXllcnMuJ1xuICAgICAgICAgICAgICB9W2NvZGVdIHx8ICdBbiB1bmtub3duIGVycm9yIG9jY3VyZWQnO1xuICAgICAgICAgICAgICBwbGF5ZXIubWVkaWEuZXJyb3IgPSB7XG4gICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZXJyb3InKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuXG4gICAgICAgICAgb25QbGF5YmFja1JhdGVDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgICAgIC8vIEdldCB0aGUgaW5zdGFuY2VcbiAgICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gZXZlbnQudGFyZ2V0OyAvLyBHZXQgY3VycmVudCBzcGVlZFxuXG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEucGxheWJhY2tSYXRlID0gaW5zdGFuY2UuZ2V0UGxheWJhY2tSYXRlKCk7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3JhdGVjaGFuZ2UnKTtcbiAgICAgICAgICB9LFxuXG4gICAgICAgICAgb25SZWFkeShldmVudCkge1xuICAgICAgICAgICAgLy8gQmFpbCBpZiBvblJlYWR5IGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkLiBTZWUgaXNzdWUgIzExMDhcbiAgICAgICAgICAgIGlmIChpcy5mdW5jdGlvbihwbGF5ZXIubWVkaWEucGxheSkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSAvLyBHZXQgdGhlIGluc3RhbmNlXG5cblxuICAgICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBldmVudC50YXJnZXQ7IC8vIEdldCB0aGUgdGl0bGVcblxuICAgICAgICAgICAgeW91dHViZS5nZXRUaXRsZS5jYWxsKHBsYXllciwgdmlkZW9JZCk7IC8vIENyZWF0ZSBhIGZhdXggSFRNTDUgQVBJIHVzaW5nIHRoZSBZb3VUdWJlIEFQSVxuXG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEucGxheSA9ICgpID0+IHtcbiAgICAgICAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZS5jYWxsKHBsYXllciwgdHJ1ZSk7XG4gICAgICAgICAgICAgIGluc3RhbmNlLnBsYXlWaWRlbygpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcGxheWVyLm1lZGlhLnBhdXNlID0gKCkgPT4ge1xuICAgICAgICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCBmYWxzZSk7XG4gICAgICAgICAgICAgIGluc3RhbmNlLnBhdXNlVmlkZW8oKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5zdG9wID0gKCkgPT4ge1xuICAgICAgICAgICAgICBpbnN0YW5jZS5zdG9wVmlkZW8oKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5kdXJhdGlvbiA9IGluc3RhbmNlLmdldER1cmF0aW9uKCk7XG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEucGF1c2VkID0gdHJ1ZTsgLy8gU2Vla2luZ1xuXG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEuY3VycmVudFRpbWUgPSAwO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ2N1cnJlbnRUaW1lJywge1xuICAgICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlcihpbnN0YW5jZS5nZXRDdXJyZW50VGltZSgpKTtcbiAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICBzZXQodGltZSkge1xuICAgICAgICAgICAgICAgIC8vIElmIHBhdXNlZCBhbmQgbmV2ZXIgcGxheWVkLCBtdXRlIGF1ZGlvIHByZXZlbnRpdmVseSAoWW91VHViZSBzdGFydHMgcGxheWluZyBvbiBzZWVrIGlmIHRoZSB2aWRlbyBoYXNuJ3QgYmVlbiBwbGF5ZWQgeWV0KS5cbiAgICAgICAgICAgICAgICBpZiAocGxheWVyLnBhdXNlZCAmJiAhcGxheWVyLmVtYmVkLmhhc1BsYXllZCkge1xuICAgICAgICAgICAgICAgICAgcGxheWVyLmVtYmVkLm11dGUoKTtcbiAgICAgICAgICAgICAgICB9IC8vIFNldCBzZWVraW5nIHN0YXRlIGFuZCB0cmlnZ2VyIGV2ZW50XG5cblxuICAgICAgICAgICAgICAgIHBsYXllci5tZWRpYS5zZWVraW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3NlZWtpbmcnKTsgLy8gU2VlayBhZnRlciBldmVudHMgc2VudFxuXG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uuc2Vla1RvKHRpbWUpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pOyAvLyBQbGF5YmFjayBzcGVlZFxuXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAncGxheWJhY2tSYXRlJywge1xuICAgICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluc3RhbmNlLmdldFBsYXliYWNrUmF0ZSgpO1xuICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgIHNldChpbnB1dCkge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlLnNldFBsYXliYWNrUmF0ZShpbnB1dCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7IC8vIFZvbHVtZVxuXG4gICAgICAgICAgICBsZXQge1xuICAgICAgICAgICAgICB2b2x1bWVcbiAgICAgICAgICAgIH0gPSBwbGF5ZXIuY29uZmlnO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ3ZvbHVtZScsIHtcbiAgICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2b2x1bWU7XG4gICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgc2V0KGlucHV0KSB7XG4gICAgICAgICAgICAgICAgdm9sdW1lID0gaW5wdXQ7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uuc2V0Vm9sdW1lKHZvbHVtZSAqIDEwMCk7XG4gICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd2b2x1bWVjaGFuZ2UnKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTsgLy8gTXV0ZWRcblxuICAgICAgICAgICAgbGV0IHtcbiAgICAgICAgICAgICAgbXV0ZWRcbiAgICAgICAgICAgIH0gPSBwbGF5ZXIuY29uZmlnO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ211dGVkJywge1xuICAgICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG11dGVkO1xuICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgIHNldChpbnB1dCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRvZ2dsZSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiBtdXRlZDtcbiAgICAgICAgICAgICAgICBtdXRlZCA9IHRvZ2dsZTtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZVt0b2dnbGUgPyAnbXV0ZScgOiAndW5NdXRlJ10oKTtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5zZXRWb2x1bWUodm9sdW1lICogMTAwKTtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3ZvbHVtZWNoYW5nZScpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pOyAvLyBTb3VyY2VcblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ2N1cnJlbnRTcmMnLCB7XG4gICAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zdGFuY2UuZ2V0VmlkZW9VcmwoKTtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTsgLy8gRW5kZWRcblxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ2VuZGVkJywge1xuICAgICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllci5jdXJyZW50VGltZSA9PT0gcGxheWVyLmR1cmF0aW9uO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pOyAvLyBHZXQgYXZhaWxhYmxlIHNwZWVkc1xuXG4gICAgICAgICAgICBjb25zdCBzcGVlZHMgPSBpbnN0YW5jZS5nZXRBdmFpbGFibGVQbGF5YmFja1JhdGVzKCk7IC8vIEZpbHRlciBiYXNlZCBvbiBjb25maWdcblxuICAgICAgICAgICAgcGxheWVyLm9wdGlvbnMuc3BlZWQgPSBzcGVlZHMuZmlsdGVyKHMgPT4gcGxheWVyLmNvbmZpZy5zcGVlZC5vcHRpb25zLmluY2x1ZGVzKHMpKTsgLy8gU2V0IHRoZSB0YWJpbmRleCB0byBhdm9pZCBmb2N1cyBlbnRlcmluZyBpZnJhbWVcblxuICAgICAgICAgICAgaWYgKHBsYXllci5zdXBwb3J0ZWQudWkgJiYgY29uZmlnLmN1c3RvbUNvbnRyb2xzKSB7XG4gICAgICAgICAgICAgIHBsYXllci5tZWRpYS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3RpbWV1cGRhdGUnKTtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UnKTsgLy8gUmVzZXQgdGltZXJcblxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwbGF5ZXIudGltZXJzLmJ1ZmZlcmluZyk7IC8vIFNldHVwIGJ1ZmZlcmluZ1xuXG4gICAgICAgICAgICBwbGF5ZXIudGltZXJzLmJ1ZmZlcmluZyA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgLy8gR2V0IGxvYWRlZCAlIGZyb20gWW91VHViZVxuICAgICAgICAgICAgICBwbGF5ZXIubWVkaWEuYnVmZmVyZWQgPSBpbnN0YW5jZS5nZXRWaWRlb0xvYWRlZEZyYWN0aW9uKCk7IC8vIFRyaWdnZXIgcHJvZ3Jlc3Mgb25seSB3aGVuIHdlIGFjdHVhbGx5IGJ1ZmZlciBzb21ldGhpbmdcblxuICAgICAgICAgICAgICBpZiAocGxheWVyLm1lZGlhLmxhc3RCdWZmZXJlZCA9PT0gbnVsbCB8fCBwbGF5ZXIubWVkaWEubGFzdEJ1ZmZlcmVkIDwgcGxheWVyLm1lZGlhLmJ1ZmZlcmVkKSB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwcm9ncmVzcycpO1xuICAgICAgICAgICAgICB9IC8vIFNldCBsYXN0IGJ1ZmZlciBwb2ludFxuXG5cbiAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLmxhc3RCdWZmZXJlZCA9IHBsYXllci5tZWRpYS5idWZmZXJlZDsgLy8gQmFpbCBpZiB3ZSdyZSBhdCAxMDAlXG5cbiAgICAgICAgICAgICAgaWYgKHBsYXllci5tZWRpYS5idWZmZXJlZCA9PT0gMSkge1xuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwocGxheWVyLnRpbWVycy5idWZmZXJpbmcpOyAvLyBUcmlnZ2VyIGV2ZW50XG5cbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2NhbnBsYXl0aHJvdWdoJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDIwMCk7IC8vIFJlYnVpbGQgVUlcblxuICAgICAgICAgICAgaWYgKGNvbmZpZy5jdXN0b21Db250cm9scykge1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHVpLmJ1aWxkLmNhbGwocGxheWVyKSwgNTApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG5cbiAgICAgICAgICBvblN0YXRlQ2hhbmdlKGV2ZW50KSB7XG4gICAgICAgICAgICAvLyBHZXQgdGhlIGluc3RhbmNlXG4gICAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IGV2ZW50LnRhcmdldDsgLy8gUmVzZXQgdGltZXJcblxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwbGF5ZXIudGltZXJzLnBsYXlpbmcpO1xuICAgICAgICAgICAgY29uc3Qgc2Vla2VkID0gcGxheWVyLm1lZGlhLnNlZWtpbmcgJiYgWzEsIDJdLmluY2x1ZGVzKGV2ZW50LmRhdGEpO1xuXG4gICAgICAgICAgICBpZiAoc2Vla2VkKSB7XG4gICAgICAgICAgICAgIC8vIFVuc2V0IHNlZWtpbmcgYW5kIGZpcmUgc2Vla2VkIGV2ZW50XG4gICAgICAgICAgICAgIHBsYXllci5tZWRpYS5zZWVraW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnc2Vla2VkJyk7XG4gICAgICAgICAgICB9IC8vIEhhbmRsZSBldmVudHNcbiAgICAgICAgICAgIC8vIC0xICAgVW5zdGFydGVkXG4gICAgICAgICAgICAvLyAwICAgIEVuZGVkXG4gICAgICAgICAgICAvLyAxICAgIFBsYXlpbmdcbiAgICAgICAgICAgIC8vIDIgICAgUGF1c2VkXG4gICAgICAgICAgICAvLyAzICAgIEJ1ZmZlcmluZ1xuICAgICAgICAgICAgLy8gNSAgICBWaWRlbyBjdWVkXG5cblxuICAgICAgICAgICAgc3dpdGNoIChldmVudC5kYXRhKSB7XG4gICAgICAgICAgICAgIGNhc2UgLTE6XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHNjcnViYmVyXG4gICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlJyk7IC8vIEdldCBsb2FkZWQgJSBmcm9tIFlvdVR1YmVcblxuICAgICAgICAgICAgICAgIHBsYXllci5tZWRpYS5idWZmZXJlZCA9IGluc3RhbmNlLmdldFZpZGVvTG9hZGVkRnJhY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3Byb2dyZXNzJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGFzc3VyZVBsYXliYWNrU3RhdGUuY2FsbChwbGF5ZXIsIGZhbHNlKTsgLy8gWW91VHViZSBkb2Vzbid0IHN1cHBvcnQgbG9vcCBmb3IgYSBzaW5nbGUgdmlkZW8sIHNvIG1pbWljayBpdC5cblxuICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIubWVkaWEubG9vcCkge1xuICAgICAgICAgICAgICAgICAgLy8gWW91VHViZSBuZWVkcyBhIGNhbGwgdG8gYHN0b3BWaWRlb2AgYmVmb3JlIHBsYXlpbmcgYWdhaW5cbiAgICAgICAgICAgICAgICAgIGluc3RhbmNlLnN0b3BWaWRlbygpO1xuICAgICAgICAgICAgICAgICAgaW5zdGFuY2UucGxheVZpZGVvKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZW5kZWQnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgLy8gUmVzdG9yZSBwYXVzZWQgc3RhdGUgKFlvdVR1YmUgc3RhcnRzIHBsYXlpbmcgb24gc2VlayBpZiB0aGUgdmlkZW8gaGFzbid0IGJlZW4gcGxheWVkIHlldClcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmN1c3RvbUNvbnRyb2xzICYmICFwbGF5ZXIuY29uZmlnLmF1dG9wbGF5ICYmIHBsYXllci5tZWRpYS5wYXVzZWQgJiYgIXBsYXllci5lbWJlZC5oYXNQbGF5ZWQpIHtcbiAgICAgICAgICAgICAgICAgIHBsYXllci5tZWRpYS5wYXVzZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncGxheWluZycpOyAvLyBQb2xsIHRvIGdldCBwbGF5YmFjayBwcm9ncmVzc1xuXG4gICAgICAgICAgICAgICAgICBwbGF5ZXIudGltZXJzLnBsYXlpbmcgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZScpO1xuICAgICAgICAgICAgICAgICAgfSwgNTApOyAvLyBDaGVjayBkdXJhdGlvbiBhZ2FpbiBkdWUgdG8gWW91VHViZSBidWdcbiAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy8zNzRcbiAgICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvZ2RhdGEtaXNzdWVzL2lzc3Vlcy9kZXRhaWw/aWQ9ODY5MFxuXG4gICAgICAgICAgICAgICAgICBpZiAocGxheWVyLm1lZGlhLmR1cmF0aW9uICE9PSBpbnN0YW5jZS5nZXREdXJhdGlvbigpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBsYXllci5tZWRpYS5kdXJhdGlvbiA9IGluc3RhbmNlLmdldER1cmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UnKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgLy8gUmVzdG9yZSBhdWRpbyAoWW91VHViZSBzdGFydHMgcGxheWluZyBvbiBzZWVrIGlmIHRoZSB2aWRlbyBoYXNuJ3QgYmVlbiBwbGF5ZWQgeWV0KVxuICAgICAgICAgICAgICAgIGlmICghcGxheWVyLm11dGVkKSB7XG4gICAgICAgICAgICAgICAgICBwbGF5ZXIuZW1iZWQudW5NdXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZS5jYWxsKHBsYXllciwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHdhaXRpbmcgZXZlbnQgdG8gYWRkIGxvYWRpbmcgY2xhc3NlcyB0byBjb250YWluZXIgYXMgdGhlIHZpZGVvIGJ1ZmZlcnMuXG4gICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd3YWl0aW5nJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lciwgJ3N0YXRlY2hhbmdlJywgZmFsc2UsIHtcbiAgICAgICAgICAgICAgY29kZTogZXZlbnQuZGF0YVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICB9O1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIGNvbnN0IG1lZGlhID0ge1xuICAgIC8vIFNldHVwIG1lZGlhXG4gICAgc2V0dXAoKSB7XG4gICAgICAvLyBJZiB0aGVyZSdzIG5vIG1lZGlhLCBiYWlsXG4gICAgICBpZiAoIXRoaXMubWVkaWEpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdObyBtZWRpYSBlbGVtZW50IGZvdW5kIScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIEFkZCB0eXBlIGNsYXNzXG5cblxuICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudHlwZS5yZXBsYWNlKCd7MH0nLCB0aGlzLnR5cGUpLCB0cnVlKTsgLy8gQWRkIHByb3ZpZGVyIGNsYXNzXG5cbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnByb3ZpZGVyLnJlcGxhY2UoJ3swfScsIHRoaXMucHJvdmlkZXIpLCB0cnVlKTsgLy8gQWRkIHZpZGVvIGNsYXNzIGZvciBlbWJlZHNcbiAgICAgIC8vIFRoaXMgd2lsbCByZXF1aXJlIGNoYW5nZXMgaWYgYXVkaW8gZW1iZWRzIGFyZSBhZGRlZFxuXG4gICAgICBpZiAodGhpcy5pc0VtYmVkKSB7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnR5cGUucmVwbGFjZSgnezB9JywgJ3ZpZGVvJyksIHRydWUpO1xuICAgICAgfSAvLyBJbmplY3QgdGhlIHBsYXllciB3cmFwcGVyXG5cblxuICAgICAgaWYgKHRoaXMuaXNWaWRlbykge1xuICAgICAgICAvLyBDcmVhdGUgdGhlIHdyYXBwZXIgZGl2XG4gICAgICAgIHRoaXMuZWxlbWVudHMud3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy52aWRlb1xuICAgICAgICB9KTsgLy8gV3JhcCB0aGUgdmlkZW8gaW4gYSBjb250YWluZXJcblxuICAgICAgICB3cmFwKHRoaXMubWVkaWEsIHRoaXMuZWxlbWVudHMud3JhcHBlcik7IC8vIFBvc3RlciBpbWFnZSBjb250YWluZXJcblxuICAgICAgICB0aGlzLmVsZW1lbnRzLnBvc3RlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5wb3N0ZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZWxlbWVudHMud3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLnBvc3Rlcik7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgaHRtbDUuc2V0dXAuY2FsbCh0aGlzKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1lvdVR1YmUpIHtcbiAgICAgICAgeW91dHViZS5zZXR1cC5jYWxsKHRoaXMpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmlzVmltZW8pIHtcbiAgICAgICAgdmltZW8uc2V0dXAuY2FsbCh0aGlzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgfTtcblxuICBjb25zdCBkZXN0cm95ID0gaW5zdGFuY2UgPT4ge1xuICAgIC8vIERlc3Ryb3kgb3VyIGFkc01hbmFnZXJcbiAgICBpZiAoaW5zdGFuY2UubWFuYWdlcikge1xuICAgICAgaW5zdGFuY2UubWFuYWdlci5kZXN0cm95KCk7XG4gICAgfSAvLyBEZXN0cm95IG91ciBhZHNNYW5hZ2VyXG5cblxuICAgIGlmIChpbnN0YW5jZS5lbGVtZW50cy5kaXNwbGF5Q29udGFpbmVyKSB7XG4gICAgICBpbnN0YW5jZS5lbGVtZW50cy5kaXNwbGF5Q29udGFpbmVyLmRlc3Ryb3koKTtcbiAgICB9XG5cbiAgICBpbnN0YW5jZS5lbGVtZW50cy5jb250YWluZXIucmVtb3ZlKCk7XG4gIH07XG5cbiAgY2xhc3MgQWRzIHtcbiAgICAvKipcbiAgICAgKiBBZHMgY29uc3RydWN0b3IuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHBsYXllclxuICAgICAqIEByZXR1cm4ge0Fkc31cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihwbGF5ZXIpIHtcbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwibG9hZFwiLCAoKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIENoZWNrIGlmIHRoZSBHb29nbGUgSU1BMyBTREsgaXMgbG9hZGVkIG9yIGxvYWQgaXQgb3Vyc2VsdmVzXG5cblxuICAgICAgICBpZiAoIWlzLm9iamVjdCh3aW5kb3cuZ29vZ2xlKSB8fCAhaXMub2JqZWN0KHdpbmRvdy5nb29nbGUuaW1hKSkge1xuICAgICAgICAgIGxvYWRTY3JpcHQodGhpcy5wbGF5ZXIuY29uZmlnLnVybHMuZ29vZ2xlSU1BLnNkaykudGhlbigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlYWR5KCk7XG4gICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgLy8gU2NyaXB0IGZhaWxlZCB0byBsb2FkIG9yIGlzIGJsb2NrZWRcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignZXJyb3InLCBuZXcgRXJyb3IoJ0dvb2dsZSBJTUEgU0RLIGZhaWxlZCB0byBsb2FkJykpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucmVhZHkoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicmVhZHlcIiwgKCkgPT4ge1xuICAgICAgICAvLyBEb3VibGUgY2hlY2sgd2UncmUgZW5hYmxlZFxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgICAgIGRlc3Ryb3kodGhpcyk7XG4gICAgICAgIH0gLy8gU3RhcnQgdGlja2luZyBvdXIgc2FmZXR5IHRpbWVyLiBJZiB0aGUgd2hvbGUgYWR2ZXJ0aXNlbWVudFxuICAgICAgICAvLyB0aGluZyBkb2Vzbid0IHJlc29sdmUgd2l0aGluIG91ciBzZXQgdGltZTsgd2UgYmFpbFxuXG5cbiAgICAgICAgdGhpcy5zdGFydFNhZmV0eVRpbWVyKDEyMDAwLCAncmVhZHkoKScpOyAvLyBDbGVhciB0aGUgc2FmZXR5IHRpbWVyXG5cbiAgICAgICAgdGhpcy5tYW5hZ2VyUHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmNsZWFyU2FmZXR5VGltZXIoJ29uQWRzTWFuYWdlckxvYWRlZCgpJyk7XG4gICAgICAgIH0pOyAvLyBTZXQgbGlzdGVuZXJzIG9uIHRoZSBQbHlyIGluc3RhbmNlXG5cbiAgICAgICAgdGhpcy5saXN0ZW5lcnMoKTsgLy8gU2V0dXAgdGhlIElNQSBTREtcblxuICAgICAgICB0aGlzLnNldHVwSU1BKCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJzZXR1cElNQVwiLCAoKSA9PiB7XG4gICAgICAgIC8vIENyZWF0ZSB0aGUgY29udGFpbmVyIGZvciBvdXIgYWR2ZXJ0aXNlbWVudHNcbiAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmFkc1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudHMuY29udGFpbmVyKTsgLy8gU28gd2UgY2FuIHJ1biBWUEFJRDJcblxuICAgICAgICBnb29nbGUuaW1hLnNldHRpbmdzLnNldFZwYWlkTW9kZShnb29nbGUuaW1hLkltYVNka1NldHRpbmdzLlZwYWlkTW9kZS5FTkFCTEVEKTsgLy8gU2V0IGxhbmd1YWdlXG5cbiAgICAgICAgZ29vZ2xlLmltYS5zZXR0aW5ncy5zZXRMb2NhbGUodGhpcy5wbGF5ZXIuY29uZmlnLmFkcy5sYW5ndWFnZSk7IC8vIFNldCBwbGF5YmFjayBmb3IgaU9TMTArXG5cbiAgICAgICAgZ29vZ2xlLmltYS5zZXR0aW5ncy5zZXREaXNhYmxlQ3VzdG9tUGxheWJhY2tGb3JJT1MxMFBsdXModGhpcy5wbGF5ZXIuY29uZmlnLnBsYXlzaW5saW5lKTsgLy8gV2UgYXNzdW1lIHRoZSBhZENvbnRhaW5lciBpcyB0aGUgdmlkZW8gY29udGFpbmVyIG9mIHRoZSBwbHlyIGVsZW1lbnQgdGhhdCB3aWxsIGhvdXNlIHRoZSBhZHNcblxuICAgICAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXlDb250YWluZXIgPSBuZXcgZ29vZ2xlLmltYS5BZERpc3BsYXlDb250YWluZXIodGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMucGxheWVyLm1lZGlhKTsgLy8gQ3JlYXRlIGFkcyBsb2FkZXJcblxuICAgICAgICB0aGlzLmxvYWRlciA9IG5ldyBnb29nbGUuaW1hLkFkc0xvYWRlcih0aGlzLmVsZW1lbnRzLmRpc3BsYXlDb250YWluZXIpOyAvLyBMaXN0ZW4gYW5kIHJlc3BvbmQgdG8gYWRzIGxvYWRlZCBhbmQgZXJyb3IgZXZlbnRzXG5cbiAgICAgICAgdGhpcy5sb2FkZXIuYWRkRXZlbnRMaXN0ZW5lcihnb29nbGUuaW1hLkFkc01hbmFnZXJMb2FkZWRFdmVudC5UeXBlLkFEU19NQU5BR0VSX0xPQURFRCwgZXZlbnQgPT4gdGhpcy5vbkFkc01hbmFnZXJMb2FkZWQoZXZlbnQpLCBmYWxzZSk7XG4gICAgICAgIHRoaXMubG9hZGVyLmFkZEV2ZW50TGlzdGVuZXIoZ29vZ2xlLmltYS5BZEVycm9yRXZlbnQuVHlwZS5BRF9FUlJPUiwgZXJyb3IgPT4gdGhpcy5vbkFkRXJyb3IoZXJyb3IpLCBmYWxzZSk7IC8vIFJlcXVlc3QgdmlkZW8gYWRzIHRvIGJlIHByZS1sb2FkZWRcblxuICAgICAgICB0aGlzLnJlcXVlc3RBZHMoKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInJlcXVlc3RBZHNcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgY29udGFpbmVyXG4gICAgICAgIH0gPSB0aGlzLnBsYXllci5lbGVtZW50cztcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIFJlcXVlc3QgdmlkZW8gYWRzXG4gICAgICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBnb29nbGUuaW1hLkFkc1JlcXVlc3QoKTtcbiAgICAgICAgICByZXF1ZXN0LmFkVGFnVXJsID0gdGhpcy50YWdVcmw7IC8vIFNwZWNpZnkgdGhlIGxpbmVhciBhbmQgbm9ubGluZWFyIHNsb3Qgc2l6ZXMuIFRoaXMgaGVscHMgdGhlIFNES1xuICAgICAgICAgIC8vIHRvIHNlbGVjdCB0aGUgY29ycmVjdCBjcmVhdGl2ZSBpZiBtdWx0aXBsZSBhcmUgcmV0dXJuZWRcblxuICAgICAgICAgIHJlcXVlc3QubGluZWFyQWRTbG90V2lkdGggPSBjb250YWluZXIub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgcmVxdWVzdC5saW5lYXJBZFNsb3RIZWlnaHQgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgIHJlcXVlc3Qubm9uTGluZWFyQWRTbG90V2lkdGggPSBjb250YWluZXIub2Zmc2V0V2lkdGg7XG4gICAgICAgICAgcmVxdWVzdC5ub25MaW5lYXJBZFNsb3RIZWlnaHQgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0OyAvLyBXZSBvbmx5IG92ZXJsYXkgYWRzIGFzIHdlIG9ubHkgc3VwcG9ydCB2aWRlby5cblxuICAgICAgICAgIHJlcXVlc3QuZm9yY2VOb25MaW5lYXJGdWxsU2xvdCA9IGZhbHNlOyAvLyBNdXRlIGJhc2VkIG9uIGN1cnJlbnQgc3RhdGVcblxuICAgICAgICAgIHJlcXVlc3Quc2V0QWRXaWxsUGxheU11dGVkKCF0aGlzLnBsYXllci5tdXRlZCk7XG4gICAgICAgICAgdGhpcy5sb2FkZXIucmVxdWVzdEFkcyhyZXF1ZXN0KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICB0aGlzLm9uQWRFcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInBvbGxDb3VudGRvd25cIiwgKHN0YXJ0ID0gZmFsc2UpID0+IHtcbiAgICAgICAgaWYgKCFzdGFydCkge1xuICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jb3VudGRvd25UaW1lcik7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWJhZGdlLXRleHQnKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1cGRhdGUgPSAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgdGltZSA9IGZvcm1hdFRpbWUoTWF0aC5tYXgodGhpcy5tYW5hZ2VyLmdldFJlbWFpbmluZ1RpbWUoKSwgMCkpO1xuICAgICAgICAgIGNvbnN0IGxhYmVsID0gYCR7aTE4bi5nZXQoJ2FkdmVydGlzZW1lbnQnLCB0aGlzLnBsYXllci5jb25maWcpfSAtICR7dGltZX1gO1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS1iYWRnZS10ZXh0JywgbGFiZWwpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuY291bnRkb3duVGltZXIgPSBzZXRJbnRlcnZhbCh1cGRhdGUsIDEwMCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJvbkFkc01hbmFnZXJMb2FkZWRcIiwgZXZlbnQgPT4ge1xuICAgICAgICAvLyBMb2FkIGNvdWxkIG9jY3VyIGFmdGVyIGEgc291cmNlIGNoYW5nZSAocmFjZSBjb25kaXRpb24pXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIEdldCB0aGUgYWRzIG1hbmFnZXJcblxuXG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gbmV3IGdvb2dsZS5pbWEuQWRzUmVuZGVyaW5nU2V0dGluZ3MoKTsgLy8gVGVsbCB0aGUgU0RLIHRvIHNhdmUgYW5kIHJlc3RvcmUgY29udGVudCB2aWRlbyBzdGF0ZSBvbiBvdXIgYmVoYWxmXG5cbiAgICAgICAgc2V0dGluZ3MucmVzdG9yZUN1c3RvbVBsYXliYWNrU3RhdGVPbkFkQnJlYWtDb21wbGV0ZSA9IHRydWU7XG4gICAgICAgIHNldHRpbmdzLmVuYWJsZVByZWxvYWRpbmcgPSB0cnVlOyAvLyBUaGUgU0RLIGlzIHBvbGxpbmcgY3VycmVudFRpbWUgb24gdGhlIGNvbnRlbnRQbGF5YmFjay4gQW5kIG5lZWRzIGEgZHVyYXRpb25cbiAgICAgICAgLy8gc28gaXQgY2FuIGRldGVybWluZSB3aGVuIHRvIHN0YXJ0IHRoZSBtaWQtIGFuZCBwb3N0LXJvbGxcblxuICAgICAgICB0aGlzLm1hbmFnZXIgPSBldmVudC5nZXRBZHNNYW5hZ2VyKHRoaXMucGxheWVyLCBzZXR0aW5ncyk7IC8vIEdldCB0aGUgY3VlIHBvaW50cyBmb3IgYW55IG1pZC1yb2xscyBieSBmaWx0ZXJpbmcgb3V0IHRoZSBwcmUtIGFuZCBwb3N0LXJvbGxcblxuICAgICAgICB0aGlzLmN1ZVBvaW50cyA9IHRoaXMubWFuYWdlci5nZXRDdWVQb2ludHMoKTsgLy8gQWRkIGxpc3RlbmVycyB0byB0aGUgcmVxdWlyZWQgZXZlbnRzXG4gICAgICAgIC8vIEFkdmVydGlzZW1lbnQgZXJyb3IgZXZlbnRzXG5cbiAgICAgICAgdGhpcy5tYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoZ29vZ2xlLmltYS5BZEVycm9yRXZlbnQuVHlwZS5BRF9FUlJPUiwgZXJyb3IgPT4gdGhpcy5vbkFkRXJyb3IoZXJyb3IpKTsgLy8gQWR2ZXJ0aXNlbWVudCByZWd1bGFyIGV2ZW50c1xuXG4gICAgICAgIE9iamVjdC5rZXlzKGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlKS5mb3JFYWNoKHR5cGUgPT4ge1xuICAgICAgICAgIHRoaXMubWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlW3R5cGVdLCBlID0+IHRoaXMub25BZEV2ZW50KGUpKTtcbiAgICAgICAgfSk7IC8vIFJlc29sdmUgb3VyIGFkc01hbmFnZXJcblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2xvYWRlZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiYWRkQ3VlUG9pbnRzXCIsICgpID0+IHtcbiAgICAgICAgLy8gQWRkIGFkdmVydGlzZW1lbnQgY3VlJ3Mgd2l0aGluIHRoZSB0aW1lIGxpbmUgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmICghaXMuZW1wdHkodGhpcy5jdWVQb2ludHMpKSB7XG4gICAgICAgICAgdGhpcy5jdWVQb2ludHMuZm9yRWFjaChjdWVQb2ludCA9PiB7XG4gICAgICAgICAgICBpZiAoY3VlUG9pbnQgIT09IDAgJiYgY3VlUG9pbnQgIT09IC0xICYmIGN1ZVBvaW50IDwgdGhpcy5wbGF5ZXIuZHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgY29uc3Qgc2Vla0VsZW1lbnQgPSB0aGlzLnBsYXllci5lbGVtZW50cy5wcm9ncmVzcztcblxuICAgICAgICAgICAgICBpZiAoaXMuZWxlbWVudChzZWVrRWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdWVQZXJjZW50YWdlID0gMTAwIC8gdGhpcy5wbGF5ZXIuZHVyYXRpb24gKiBjdWVQb2ludDtcbiAgICAgICAgICAgICAgICBjb25zdCBjdWUgPSBjcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICAgICAgICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmN1ZXNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjdWUuc3R5bGUubGVmdCA9IGAke2N1ZVBlcmNlbnRhZ2UudG9TdHJpbmcoKX0lYDtcbiAgICAgICAgICAgICAgICBzZWVrRWxlbWVudC5hcHBlbmRDaGlsZChjdWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcIm9uQWRFdmVudFwiLCBldmVudCA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBjb250YWluZXJcbiAgICAgICAgfSA9IHRoaXMucGxheWVyLmVsZW1lbnRzOyAvLyBSZXRyaWV2ZSB0aGUgYWQgZnJvbSB0aGUgZXZlbnQuIFNvbWUgZXZlbnRzIChlLmcuIEFMTF9BRFNfQ09NUExFVEVEKVxuICAgICAgICAvLyBkb24ndCBoYXZlIGFkIG9iamVjdCBhc3NvY2lhdGVkXG5cbiAgICAgICAgY29uc3QgYWQgPSBldmVudC5nZXRBZCgpO1xuICAgICAgICBjb25zdCBhZERhdGEgPSBldmVudC5nZXRBZERhdGEoKTsgLy8gUHJveHkgZXZlbnRcblxuICAgICAgICBjb25zdCBkaXNwYXRjaEV2ZW50ID0gdHlwZSA9PiB7XG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcy5wbGF5ZXIsIHRoaXMucGxheWVyLm1lZGlhLCBgYWRzJHt0eXBlLnJlcGxhY2UoL18vZywgJycpLnRvTG93ZXJDYXNlKCl9YCk7XG4gICAgICAgIH07IC8vIEJ1YmJsZSB0aGUgZXZlbnRcblxuXG4gICAgICAgIGRpc3BhdGNoRXZlbnQoZXZlbnQudHlwZSk7XG5cbiAgICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5MT0FERUQ6XG4gICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBldmVudCBzZW50IGZvciBhbiBhZCAtIGl0IGlzIHBvc3NpYmxlIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZVxuICAgICAgICAgICAgLy8gYWQgaXMgYSB2aWRlbyBhZCBvciBhbiBvdmVybGF5XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2xvYWRlZCcpOyAvLyBTdGFydCBjb3VudGRvd25cblxuICAgICAgICAgICAgdGhpcy5wb2xsQ291bnRkb3duKHRydWUpO1xuXG4gICAgICAgICAgICBpZiAoIWFkLmlzTGluZWFyKCkpIHtcbiAgICAgICAgICAgICAgLy8gUG9zaXRpb24gQWREaXNwbGF5Q29udGFpbmVyIGNvcnJlY3RseSBmb3Igb3ZlcmxheVxuICAgICAgICAgICAgICBhZC53aWR0aCA9IGNvbnRhaW5lci5vZmZzZXRXaWR0aDtcbiAgICAgICAgICAgICAgYWQuaGVpZ2h0ID0gY29udGFpbmVyLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIH0gLy8gY29uc29sZS5pbmZvKCdBZCB0eXBlOiAnICsgZXZlbnQuZ2V0QWQoKS5nZXRBZFBvZEluZm8oKS5nZXRQb2RJbmRleCgpKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUuaW5mbygnQWQgdGltZTogJyArIGV2ZW50LmdldEFkKCkuZ2V0QWRQb2RJbmZvKCkuZ2V0VGltZU9mZnNldCgpKTtcblxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuU1RBUlRFRDpcbiAgICAgICAgICAgIC8vIFNldCB2b2x1bWUgdG8gbWF0Y2ggcGxheWVyXG4gICAgICAgICAgICB0aGlzLm1hbmFnZXIuc2V0Vm9sdW1lKHRoaXMucGxheWVyLnZvbHVtZSk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuQUxMX0FEU19DT01QTEVURUQ6XG4gICAgICAgICAgICAvLyBBbGwgYWRzIGZvciB0aGUgY3VycmVudCB2aWRlb3MgYXJlIGRvbmUuIFdlIGNhbiBub3cgcmVxdWVzdCBuZXcgYWR2ZXJ0aXNlbWVudHNcbiAgICAgICAgICAgIC8vIGluIGNhc2UgdGhlIHZpZGVvIGlzIHJlLXBsYXllZFxuICAgICAgICAgICAgLy8gVE9ETzogRXhhbXBsZSBmb3Igd2hhdCBoYXBwZW5zIHdoZW4gYSBuZXh0IHZpZGVvIGluIGEgcGxheWxpc3Qgd291bGQgYmUgbG9hZGVkLlxuICAgICAgICAgICAgLy8gU28gaGVyZSB3ZSBsb2FkIGEgbmV3IHZpZGVvIHdoZW4gYWxsIGFkcyBhcmUgZG9uZS5cbiAgICAgICAgICAgIC8vIFRoZW4gd2UgbG9hZCBuZXcgYWRzIHdpdGhpbiBhIG5ldyBhZHNNYW5hZ2VyLiBXaGVuIHRoZSB2aWRlb1xuICAgICAgICAgICAgLy8gSXMgc3RhcnRlZCAtIGFmdGVyIC0gdGhlIGFkcyBhcmUgbG9hZGVkLCB0aGVuIHdlIGdldCBhZHMuXG4gICAgICAgICAgICAvLyBZb3UgY2FuIGFsc28gZWFzaWx5IHRlc3QgY2FuY2VsbGluZyBhbmQgcmVsb2FkaW5nIGJ5IHJ1bm5pbmdcbiAgICAgICAgICAgIC8vIHBsYXllci5hZHMuY2FuY2VsKCkgYW5kIHBsYXllci5hZHMucGxheSBmcm9tIHRoZSBjb25zb2xlIEkgZ3Vlc3MuXG4gICAgICAgICAgICAvLyB0aGlzLnBsYXllci5zb3VyY2UgPSB7XG4gICAgICAgICAgICAvLyAgICAgdHlwZTogJ3ZpZGVvJyxcbiAgICAgICAgICAgIC8vICAgICB0aXRsZTogJ1ZpZXcgRnJvbSBBIEJsdWUgTW9vbicsXG4gICAgICAgICAgICAvLyAgICAgc291cmNlczogW3tcbiAgICAgICAgICAgIC8vICAgICAgICAgc3JjOlxuICAgICAgICAgICAgLy8gJ2h0dHBzOi8vY2RuLnBseXIuaW8vc3RhdGljL2RlbW8vVmlld19Gcm9tX0FfQmx1ZV9Nb29uX1RyYWlsZXItSEQubXA0JywgdHlwZTpcbiAgICAgICAgICAgIC8vICd2aWRlby9tcDQnLCB9XSwgcG9zdGVyOlxuICAgICAgICAgICAgLy8gJ2h0dHBzOi8vY2RuLnBseXIuaW8vc3RhdGljL2RlbW8vVmlld19Gcm9tX0FfQmx1ZV9Nb29uX1RyYWlsZXItSEQuanBnJywgdHJhY2tzOlxuICAgICAgICAgICAgLy8gWyB7IGtpbmQ6ICdjYXB0aW9ucycsIGxhYmVsOiAnRW5nbGlzaCcsIHNyY2xhbmc6ICdlbicsIHNyYzpcbiAgICAgICAgICAgIC8vICdodHRwczovL2Nkbi5wbHlyLmlvL3N0YXRpYy9kZW1vL1ZpZXdfRnJvbV9BX0JsdWVfTW9vbl9UcmFpbGVyLUhELmVuLnZ0dCcsXG4gICAgICAgICAgICAvLyBkZWZhdWx0OiB0cnVlLCB9LCB7IGtpbmQ6ICdjYXB0aW9ucycsIGxhYmVsOiAnRnJlbmNoJywgc3JjbGFuZzogJ2ZyJywgc3JjOlxuICAgICAgICAgICAgLy8gJ2h0dHBzOi8vY2RuLnBseXIuaW8vc3RhdGljL2RlbW8vVmlld19Gcm9tX0FfQmx1ZV9Nb29uX1RyYWlsZXItSEQuZnIudnR0JywgfSwgXSxcbiAgICAgICAgICAgIC8vIH07XG4gICAgICAgICAgICAvLyBUT0RPOiBTbyB0aGVyZSBpcyBzdGlsbCB0aGlzIHRoaW5nIHdoZXJlIGEgdmlkZW8gc2hvdWxkIG9ubHkgYmUgYWxsb3dlZCB0byBzdGFydFxuICAgICAgICAgICAgLy8gcGxheWluZyB3aGVuIHRoZSBJTUEgU0RLIGlzIHJlYWR5IG9yIGhhcyBmYWlsZWRcbiAgICAgICAgICAgIGlmICh0aGlzLnBsYXllci5lbmRlZCkge1xuICAgICAgICAgICAgICB0aGlzLmxvYWRBZHMoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIFRoZSBTREsgd29uJ3QgYWxsb3cgbmV3IGFkcyB0byBiZSBjYWxsZWQgd2l0aG91dCByZWNlaXZpbmcgYSBjb250ZW50Q29tcGxldGUoKVxuICAgICAgICAgICAgICB0aGlzLmxvYWRlci5jb250ZW50Q29tcGxldGUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkNPTlRFTlRfUEFVU0VfUkVRVUVTVEVEOlxuICAgICAgICAgICAgLy8gVGhpcyBldmVudCBpbmRpY2F0ZXMgdGhlIGFkIGhhcyBzdGFydGVkIC0gdGhlIHZpZGVvIHBsYXllciBjYW4gYWRqdXN0IHRoZSBVSSxcbiAgICAgICAgICAgIC8vIGZvciBleGFtcGxlIGRpc3BsYXkgYSBwYXVzZSBidXR0b24gYW5kIHJlbWFpbmluZyB0aW1lLiBGaXJlZCB3aGVuIGNvbnRlbnQgc2hvdWxkXG4gICAgICAgICAgICAvLyBiZSBwYXVzZWQuIFRoaXMgdXN1YWxseSBoYXBwZW5zIHJpZ2h0IGJlZm9yZSBhbiBhZCBpcyBhYm91dCB0byBjb3ZlciB0aGUgY29udGVudFxuICAgICAgICAgICAgdGhpcy5wYXVzZUNvbnRlbnQoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5DT05URU5UX1JFU1VNRV9SRVFVRVNURUQ6XG4gICAgICAgICAgICAvLyBUaGlzIGV2ZW50IGluZGljYXRlcyB0aGUgYWQgaGFzIGZpbmlzaGVkIC0gdGhlIHZpZGVvIHBsYXllciBjYW4gcGVyZm9ybVxuICAgICAgICAgICAgLy8gYXBwcm9wcmlhdGUgVUkgYWN0aW9ucywgc3VjaCBhcyByZW1vdmluZyB0aGUgdGltZXIgZm9yIHJlbWFpbmluZyB0aW1lIGRldGVjdGlvbi5cbiAgICAgICAgICAgIC8vIEZpcmVkIHdoZW4gY29udGVudCBzaG91bGQgYmUgcmVzdW1lZC4gVGhpcyB1c3VhbGx5IGhhcHBlbnMgd2hlbiBhbiBhZCBmaW5pc2hlc1xuICAgICAgICAgICAgLy8gb3IgY29sbGFwc2VzXG4gICAgICAgICAgICB0aGlzLnBvbGxDb3VudGRvd24oKTtcbiAgICAgICAgICAgIHRoaXMucmVzdW1lQ29udGVudCgpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBjYXNlIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkxPRzpcbiAgICAgICAgICAgIGlmIChhZERhdGEuYWRFcnJvcikge1xuICAgICAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy53YXJuKGBOb24tZmF0YWwgYWQgZXJyb3I6ICR7YWREYXRhLmFkRXJyb3IuZ2V0TWVzc2FnZSgpfWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwib25BZEVycm9yXCIsIGV2ZW50ID0+IHtcbiAgICAgICAgdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcud2FybignQWRzIGVycm9yJywgZXZlbnQpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwibGlzdGVuZXJzXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGNvbnRhaW5lclxuICAgICAgICB9ID0gdGhpcy5wbGF5ZXIuZWxlbWVudHM7XG4gICAgICAgIGxldCB0aW1lO1xuICAgICAgICB0aGlzLnBsYXllci5vbignY2FucGxheScsICgpID0+IHtcbiAgICAgICAgICB0aGlzLmFkZEN1ZVBvaW50cygpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wbGF5ZXIub24oJ2VuZGVkJywgKCkgPT4ge1xuICAgICAgICAgIHRoaXMubG9hZGVyLmNvbnRlbnRDb21wbGV0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wbGF5ZXIub24oJ3RpbWV1cGRhdGUnLCAoKSA9PiB7XG4gICAgICAgICAgdGltZSA9IHRoaXMucGxheWVyLmN1cnJlbnRUaW1lO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wbGF5ZXIub24oJ3NlZWtlZCcsICgpID0+IHtcbiAgICAgICAgICBjb25zdCBzZWVrZWRUaW1lID0gdGhpcy5wbGF5ZXIuY3VycmVudFRpbWU7XG5cbiAgICAgICAgICBpZiAoaXMuZW1wdHkodGhpcy5jdWVQb2ludHMpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5jdWVQb2ludHMuZm9yRWFjaCgoY3VlUG9pbnQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBpZiAodGltZSA8IGN1ZVBvaW50ICYmIGN1ZVBvaW50IDwgc2Vla2VkVGltZSkge1xuICAgICAgICAgICAgICB0aGlzLm1hbmFnZXIuZGlzY2FyZEFkQnJlYWsoKTtcbiAgICAgICAgICAgICAgdGhpcy5jdWVQb2ludHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7IC8vIExpc3RlbiB0byB0aGUgcmVzaXppbmcgb2YgdGhlIHdpbmRvdy4gQW5kIHJlc2l6ZSBhZCBhY2NvcmRpbmdseVxuICAgICAgICAvLyBUT0RPOiBldmVudHVhbGx5IGltcGxlbWVudCBSZXNpemVPYnNlcnZlclxuXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7XG4gICAgICAgICAgaWYgKHRoaXMubWFuYWdlcikge1xuICAgICAgICAgICAgdGhpcy5tYW5hZ2VyLnJlc2l6ZShjb250YWluZXIub2Zmc2V0V2lkdGgsIGNvbnRhaW5lci5vZmZzZXRIZWlnaHQsIGdvb2dsZS5pbWEuVmlld01vZGUuTk9STUFMKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicGxheVwiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBjb250YWluZXJcbiAgICAgICAgfSA9IHRoaXMucGxheWVyLmVsZW1lbnRzO1xuXG4gICAgICAgIGlmICghdGhpcy5tYW5hZ2VyUHJvbWlzZSkge1xuICAgICAgICAgIHRoaXMucmVzdW1lQ29udGVudCgpO1xuICAgICAgICB9IC8vIFBsYXkgdGhlIHJlcXVlc3RlZCBhZHZlcnRpc2VtZW50IHdoZW5ldmVyIHRoZSBhZHNNYW5hZ2VyIGlzIHJlYWR5XG5cblxuICAgICAgICB0aGlzLm1hbmFnZXJQcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIC8vIFNldCB2b2x1bWUgdG8gbWF0Y2ggcGxheWVyXG4gICAgICAgICAgdGhpcy5tYW5hZ2VyLnNldFZvbHVtZSh0aGlzLnBsYXllci52b2x1bWUpOyAvLyBJbml0aWFsaXplIHRoZSBjb250YWluZXIuIE11c3QgYmUgZG9uZSB2aWEgYSB1c2VyIGFjdGlvbiBvbiBtb2JpbGUgZGV2aWNlc1xuXG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5kaXNwbGF5Q29udGFpbmVyLmluaXRpYWxpemUoKTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgYWRzIG1hbmFnZXIuIEFkIHJ1bGVzIHBsYXlsaXN0IHdpbGwgc3RhcnQgYXQgdGhpcyB0aW1lXG4gICAgICAgICAgICAgIHRoaXMubWFuYWdlci5pbml0KGNvbnRhaW5lci5vZmZzZXRXaWR0aCwgY29udGFpbmVyLm9mZnNldEhlaWdodCwgZ29vZ2xlLmltYS5WaWV3TW9kZS5OT1JNQUwpOyAvLyBDYWxsIHBsYXkgdG8gc3RhcnQgc2hvd2luZyB0aGUgYWQuIFNpbmdsZSB2aWRlbyBhbmQgb3ZlcmxheSBhZHMgd2lsbFxuICAgICAgICAgICAgICAvLyBzdGFydCBhdCB0aGlzIHRpbWU7IHRoZSBjYWxsIHdpbGwgYmUgaWdub3JlZCBmb3IgYWQgcnVsZXNcblxuICAgICAgICAgICAgICB0aGlzLm1hbmFnZXIuc3RhcnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgfSBjYXRjaCAoYWRFcnJvcikge1xuICAgICAgICAgICAgLy8gQW4gZXJyb3IgbWF5IGJlIHRocm93biBpZiB0aGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlXG4gICAgICAgICAgICAvLyBWQVNUIHJlc3BvbnNlXG4gICAgICAgICAgICB0aGlzLm9uQWRFcnJvcihhZEVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pLmNhdGNoKCgpID0+IHt9KTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInJlc3VtZUNvbnRlbnRcIiwgKCkgPT4ge1xuICAgICAgICAvLyBIaWRlIHRoZSBhZHZlcnRpc2VtZW50IGNvbnRhaW5lclxuICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5zdHlsZS56SW5kZXggPSAnJzsgLy8gQWQgaXMgc3RvcHBlZFxuXG4gICAgICAgIHRoaXMucGxheWluZyA9IGZhbHNlOyAvLyBQbGF5IHZpZGVvXG5cbiAgICAgICAgc2lsZW5jZVByb21pc2UodGhpcy5wbGF5ZXIubWVkaWEucGxheSgpKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInBhdXNlQ29udGVudFwiLCAoKSA9PiB7XG4gICAgICAgIC8vIFNob3cgdGhlIGFkdmVydGlzZW1lbnQgY29udGFpbmVyXG4gICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnN0eWxlLnpJbmRleCA9IDM7IC8vIEFkIGlzIHBsYXlpbmdcblxuICAgICAgICB0aGlzLnBsYXlpbmcgPSB0cnVlOyAvLyBQYXVzZSBvdXIgdmlkZW8uXG5cbiAgICAgICAgdGhpcy5wbGF5ZXIubWVkaWEucGF1c2UoKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImNhbmNlbFwiLCAoKSA9PiB7XG4gICAgICAgIC8vIFBhdXNlIG91ciB2aWRlb1xuICAgICAgICBpZiAodGhpcy5pbml0aWFsaXplZCkge1xuICAgICAgICAgIHRoaXMucmVzdW1lQ29udGVudCgpO1xuICAgICAgICB9IC8vIFRlbGwgb3VyIGluc3RhbmNlIHRoYXQgd2UncmUgZG9uZSBmb3Igbm93XG5cblxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2Vycm9yJyk7IC8vIFJlLWNyZWF0ZSBvdXIgYWRzTWFuYWdlclxuXG4gICAgICAgIHRoaXMubG9hZEFkcygpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwibG9hZEFkc1wiLCAoKSA9PiB7XG4gICAgICAgIC8vIFRlbGwgb3VyIGFkc01hbmFnZXIgdG8gZ28gYnllIGJ5ZVxuICAgICAgICB0aGlzLm1hbmFnZXJQcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIC8vIERlc3Ryb3kgb3VyIGFkc01hbmFnZXJcbiAgICAgICAgICBpZiAodGhpcy5tYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLm1hbmFnZXIuZGVzdHJveSgpO1xuICAgICAgICAgIH0gLy8gUmUtc2V0IG91ciBhZHNNYW5hZ2VyIHByb21pc2VzXG5cblxuICAgICAgICAgIHRoaXMubWFuYWdlclByb21pc2UgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgIHRoaXMub24oJ2xvYWRlZCcsIHJlc29sdmUpO1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKHRoaXMubWFuYWdlcik7XG4gICAgICAgICAgfSk7IC8vIE5vdyB0aGF0IHRoZSBtYW5hZ2VyIGhhcyBiZWVuIGRlc3Ryb3llZCBzZXQgaXQgdG8gYWxzbyBiZSB1bi1pbml0aWFsaXplZFxuXG4gICAgICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlOyAvLyBOb3cgcmVxdWVzdCBzb21lIG5ldyBhZHZlcnRpc2VtZW50c1xuXG4gICAgICAgICAgdGhpcy5yZXF1ZXN0QWRzKCk7XG4gICAgICAgIH0pLmNhdGNoKCgpID0+IHt9KTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInRyaWdnZXJcIiwgKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgICAgIGNvbnN0IGhhbmRsZXJzID0gdGhpcy5ldmVudHNbZXZlbnRdO1xuXG4gICAgICAgIGlmIChpcy5hcnJheShoYW5kbGVycykpIHtcbiAgICAgICAgICBoYW5kbGVycy5mb3JFYWNoKGhhbmRsZXIgPT4ge1xuICAgICAgICAgICAgaWYgKGlzLmZ1bmN0aW9uKGhhbmRsZXIpKSB7XG4gICAgICAgICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcIm9uXCIsIChldmVudCwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgaWYgKCFpcy5hcnJheSh0aGlzLmV2ZW50c1tldmVudF0pKSB7XG4gICAgICAgICAgdGhpcy5ldmVudHNbZXZlbnRdID0gW107XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmV2ZW50c1tldmVudF0ucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic3RhcnRTYWZldHlUaW1lclwiLCAodGltZSwgZnJvbSkgPT4ge1xuICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYFNhZmV0eSB0aW1lciBpbnZva2VkIGZyb206ICR7ZnJvbX1gKTtcbiAgICAgICAgdGhpcy5zYWZldHlUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuY2FuY2VsKCk7XG4gICAgICAgICAgdGhpcy5jbGVhclNhZmV0eVRpbWVyKCdzdGFydFNhZmV0eVRpbWVyKCknKTtcbiAgICAgICAgfSwgdGltZSk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJjbGVhclNhZmV0eVRpbWVyXCIsIGZyb20gPT4ge1xuICAgICAgICBpZiAoIWlzLm51bGxPclVuZGVmaW5lZCh0aGlzLnNhZmV0eVRpbWVyKSkge1xuICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgU2FmZXR5IHRpbWVyIGNsZWFyZWQgZnJvbTogJHtmcm9tfWApO1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNhZmV0eVRpbWVyKTtcbiAgICAgICAgICB0aGlzLnNhZmV0eVRpbWVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHRoaXMucGxheWVyID0gcGxheWVyO1xuICAgICAgdGhpcy5jb25maWcgPSBwbGF5ZXIuY29uZmlnLmFkcztcbiAgICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuICAgICAgdGhpcy5lbGVtZW50cyA9IHtcbiAgICAgICAgY29udGFpbmVyOiBudWxsLFxuICAgICAgICBkaXNwbGF5Q29udGFpbmVyOiBudWxsXG4gICAgICB9O1xuICAgICAgdGhpcy5tYW5hZ2VyID0gbnVsbDtcbiAgICAgIHRoaXMubG9hZGVyID0gbnVsbDtcbiAgICAgIHRoaXMuY3VlUG9pbnRzID0gbnVsbDtcbiAgICAgIHRoaXMuZXZlbnRzID0ge307XG4gICAgICB0aGlzLnNhZmV0eVRpbWVyID0gbnVsbDtcbiAgICAgIHRoaXMuY291bnRkb3duVGltZXIgPSBudWxsOyAvLyBTZXR1cCBhIHByb21pc2UgdG8gcmVzb2x2ZSB3aGVuIHRoZSBJTUEgbWFuYWdlciBpcyByZWFkeVxuXG4gICAgICB0aGlzLm1hbmFnZXJQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAvLyBUaGUgYWQgaXMgbG9hZGVkIGFuZCByZWFkeVxuICAgICAgICB0aGlzLm9uKCdsb2FkZWQnLCByZXNvbHZlKTsgLy8gQWRzIGZhaWxlZFxuXG4gICAgICAgIHRoaXMub24oJ2Vycm9yJywgcmVqZWN0KTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5sb2FkKCk7XG4gICAgfVxuXG4gICAgZ2V0IGVuYWJsZWQoKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGNvbmZpZ1xuICAgICAgfSA9IHRoaXM7XG4gICAgICByZXR1cm4gdGhpcy5wbGF5ZXIuaXNIVE1MNSAmJiB0aGlzLnBsYXllci5pc1ZpZGVvICYmIGNvbmZpZy5lbmFibGVkICYmICghaXMuZW1wdHkoY29uZmlnLnB1Ymxpc2hlcklkKSB8fCBpcy51cmwoY29uZmlnLnRhZ1VybCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb2FkIHRoZSBJTUEgU0RLXG4gICAgICovXG5cblxuICAgIC8vIEJ1aWxkIHRoZSB0YWcgVVJMXG4gICAgZ2V0IHRhZ1VybCgpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgY29uZmlnXG4gICAgICB9ID0gdGhpcztcblxuICAgICAgaWYgKGlzLnVybChjb25maWcudGFnVXJsKSkge1xuICAgICAgICByZXR1cm4gY29uZmlnLnRhZ1VybDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgICBBVl9QVUJMSVNIRVJJRDogJzU4YzI1YmIwMDczZWY0NDhiMTA4N2FkNicsXG4gICAgICAgIEFWX0NIQU5ORUxJRDogJzVhMDQ1OGRjMjhhMDYxNDVlNDUxOWQyMScsXG4gICAgICAgIEFWX1VSTDogd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLFxuICAgICAgICBjYjogRGF0ZS5ub3coKSxcbiAgICAgICAgQVZfV0lEVEg6IDY0MCxcbiAgICAgICAgQVZfSEVJR0hUOiA0ODAsXG4gICAgICAgIEFWX0NESU0yOiBjb25maWcucHVibGlzaGVySWRcbiAgICAgIH07XG4gICAgICBjb25zdCBiYXNlID0gJ2h0dHBzOi8vZ28uYW5pdmlldy5jb20vYXBpL2Fkc2VydmVyNi92YXN0Lyc7XG4gICAgICByZXR1cm4gYCR7YmFzZX0/JHtidWlsZFVybFBhcmFtcyhwYXJhbXMpfWA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluIG9yZGVyIGZvciB0aGUgU0RLIHRvIGRpc3BsYXkgYWRzIGZvciBvdXIgdmlkZW8sIHdlIG5lZWQgdG8gdGVsbCBpdCB3aGVyZSB0byBwdXQgdGhlbSxcbiAgICAgKiBzbyBoZXJlIHdlIGRlZmluZSBvdXIgYWQgY29udGFpbmVyLiBUaGlzIGRpdiBpcyBzZXQgdXAgdG8gcmVuZGVyIG9uIHRvcCBvZiB0aGUgdmlkZW8gcGxheWVyLlxuICAgICAqIFVzaW5nIHRoZSBjb2RlIGJlbG93LCB3ZSB0ZWxsIHRoZSBTREsgdG8gcmVuZGVyIGFkcyB3aXRoaW4gdGhhdCBkaXYuIFdlIGFsc28gcHJvdmlkZSBhXG4gICAgICogaGFuZGxlIHRvIHRoZSBjb250ZW50IHZpZGVvIHBsYXllciAtIHRoZSBTREsgd2lsbCBwb2xsIHRoZSBjdXJyZW50IHRpbWUgb2Ygb3VyIHBsYXllciB0b1xuICAgICAqIHByb3Blcmx5IHBsYWNlIG1pZC1yb2xscy4gQWZ0ZXIgd2UgY3JlYXRlIHRoZSBhZCBkaXNwbGF5IGNvbnRhaW5lciwgd2UgaW5pdGlhbGl6ZSBpdC4gT25cbiAgICAgKiBtb2JpbGUgZGV2aWNlcywgdGhpcyBpbml0aWFsaXphdGlvbiBpcyBkb25lIGFzIHRoZSByZXN1bHQgb2YgYSB1c2VyIGFjdGlvbi5cbiAgICAgKi9cblxuXG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIG51bWJlciB3aG9zZSB2YWx1ZSBpcyBsaW1pdGVkIHRvIHRoZSBnaXZlbiByYW5nZS5cbiAgICpcbiAgICogRXhhbXBsZTogbGltaXQgdGhlIG91dHB1dCBvZiB0aGlzIGNvbXB1dGF0aW9uIHRvIGJldHdlZW4gMCBhbmQgMjU1XG4gICAqICh4ICogMjU1KS5jbGFtcCgwLCAyNTUpXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBpbnB1dFxuICAgKiBAcGFyYW0ge051bWJlcn0gbWluIFRoZSBsb3dlciBib3VuZGFyeSBvZiB0aGUgb3V0cHV0IHJhbmdlXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBtYXggVGhlIHVwcGVyIGJvdW5kYXJ5IG9mIHRoZSBvdXRwdXQgcmFuZ2VcbiAgICogQHJldHVybnMgQSBudW1iZXIgd2l0aGluIHRoZSBib3VuZHMgb2YgbWluIGFuZCBtYXhcbiAgICogQHR5cGUgTnVtYmVyXG4gICAqL1xuICBmdW5jdGlvbiBjbGFtcChpbnB1dCA9IDAsIG1pbiA9IDAsIG1heCA9IDI1NSkge1xuICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heChpbnB1dCwgbWluKSwgbWF4KTtcbiAgfVxuXG4gIGNvbnN0IHBhcnNlVnR0ID0gdnR0RGF0YVN0cmluZyA9PiB7XG4gICAgY29uc3QgcHJvY2Vzc2VkTGlzdCA9IFtdO1xuICAgIGNvbnN0IGZyYW1lcyA9IHZ0dERhdGFTdHJpbmcuc3BsaXQoL1xcclxcblxcclxcbnxcXG5cXG58XFxyXFxyLyk7XG4gICAgZnJhbWVzLmZvckVhY2goZnJhbWUgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgICBjb25zdCBsaW5lcyA9IGZyYW1lLnNwbGl0KC9cXHJcXG58XFxufFxcci8pO1xuICAgICAgbGluZXMuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgaWYgKCFpcy5udW1iZXIocmVzdWx0LnN0YXJ0VGltZSkpIHtcbiAgICAgICAgICAvLyBUaGUgbGluZSB3aXRoIHN0YXJ0IGFuZCBlbmQgdGltZXMgb24gaXQgaXMgdGhlIGZpcnN0IGxpbmUgb2YgaW50ZXJlc3RcbiAgICAgICAgICBjb25zdCBtYXRjaFRpbWVzID0gbGluZS5tYXRjaCgvKFswLTldezJ9KT86PyhbMC05XXsyfSk6KFswLTldezJ9KS4oWzAtOV17MiwzfSkoID8tLT4gPykoWzAtOV17Mn0pPzo/KFswLTldezJ9KTooWzAtOV17Mn0pLihbMC05XXsyLDN9KS8pOyAvLyBOb3RlIHRoYXQgdGhpcyBjdXJyZW50bHkgaWdub3JlcyBjYXB0aW9uIGZvcm1hdHRpbmcgZGlyZWN0aXZlcyB0aGF0IGFyZSBvcHRpb25hbGx5IG9uIHRoZSBlbmQgb2YgdGhpcyBsaW5lIC0gZmluZSBmb3Igbm9uLWNhcHRpb25zIFZUVFxuXG4gICAgICAgICAgaWYgKG1hdGNoVGltZXMpIHtcbiAgICAgICAgICAgIHJlc3VsdC5zdGFydFRpbWUgPSBOdW1iZXIobWF0Y2hUaW1lc1sxXSB8fCAwKSAqIDYwICogNjAgKyBOdW1iZXIobWF0Y2hUaW1lc1syXSkgKiA2MCArIE51bWJlcihtYXRjaFRpbWVzWzNdKSArIE51bWJlcihgMC4ke21hdGNoVGltZXNbNF19YCk7XG4gICAgICAgICAgICByZXN1bHQuZW5kVGltZSA9IE51bWJlcihtYXRjaFRpbWVzWzZdIHx8IDApICogNjAgKiA2MCArIE51bWJlcihtYXRjaFRpbWVzWzddKSAqIDYwICsgTnVtYmVyKG1hdGNoVGltZXNbOF0pICsgTnVtYmVyKGAwLiR7bWF0Y2hUaW1lc1s5XX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoIWlzLmVtcHR5KGxpbmUudHJpbSgpKSAmJiBpcy5lbXB0eShyZXN1bHQudGV4dCkpIHtcbiAgICAgICAgICAvLyBJZiB3ZSBhbHJlYWR5IGhhdmUgdGhlIHN0YXJ0VGltZSwgdGhlbiB3ZSdyZSBkZWZpbml0ZWx5IHVwIHRvIHRoZSB0ZXh0IGxpbmUocylcbiAgICAgICAgICBjb25zdCBsaW5lU3BsaXQgPSBsaW5lLnRyaW0oKS5zcGxpdCgnI3h5d2g9Jyk7XG4gICAgICAgICAgW3Jlc3VsdC50ZXh0XSA9IGxpbmVTcGxpdDsgLy8gSWYgdGhlcmUncyBjb250ZW50IGluIGxpbmVTcGxpdFsxXSwgdGhlbiB3ZSBoYXZlIHNwcml0ZXMuIElmIG5vdCwgdGhlbiBpdCdzIGp1c3Qgb25lIGZyYW1lIHBlciBpbWFnZVxuXG4gICAgICAgICAgaWYgKGxpbmVTcGxpdFsxXSkge1xuICAgICAgICAgICAgW3Jlc3VsdC54LCByZXN1bHQueSwgcmVzdWx0LncsIHJlc3VsdC5oXSA9IGxpbmVTcGxpdFsxXS5zcGxpdCgnLCcpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChyZXN1bHQudGV4dCkge1xuICAgICAgICBwcm9jZXNzZWRMaXN0LnB1c2gocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcHJvY2Vzc2VkTGlzdDtcbiAgfTtcbiAgLyoqXG4gICAqIFByZXZpZXcgdGh1bWJuYWlscyBmb3Igc2VlayBob3ZlciBhbmQgc2NydWJiaW5nXG4gICAqIFNlZWtpbmc6IEhvdmVyIG92ZXIgdGhlIHNlZWsgYmFyIChkZXNrdG9wIG9ubHkpOiBzaG93cyBhIHNtYWxsIHByZXZpZXcgY29udGFpbmVyIGFib3ZlIHRoZSBzZWVrIGJhclxuICAgKiBTY3J1YmJpbmc6IENsaWNrIGFuZCBkcmFnIHRoZSBzZWVrIGJhciAoZGVza3RvcCBhbmQgbW9iaWxlKTogc2hvd3MgdGhlIHByZXZpZXcgaW1hZ2Ugb3ZlciB0aGUgZW50aXJlIHZpZGVvLCBhcyBpZiB0aGUgdmlkZW8gaXMgc2NydWJiaW5nIGF0IHZlcnkgaGlnaCBzcGVlZFxuICAgKlxuICAgKiBOb3RlczpcbiAgICogLSBUaHVtYnMgYXJlIHNldCB2aWEgSlMgc2V0dGluZ3Mgb24gUGx5ciBpbml0LCBub3QgSFRNTDUgJ3RyYWNrJyBwcm9wZXJ0eS4gVXNpbmcgdGhlIHRyYWNrIHByb3BlcnR5IHdvdWxkIGJlIGEgYml0IGdyb3NzLCBiZWNhdXNlIGl0IGRvZXNuJ3Qgc3VwcG9ydCBjdXN0b20gJ2tpbmRzJy4ga2luZD1tZXRhZGF0YSBtaWdodCBiZSB1c2VkIGZvciBzb21ldGhpbmcgZWxzZSwgYW5kIHdlIHdhbnQgdG8gYWxsb3cgbXVsdGlwbGUgdGh1bWJuYWlscyB0cmFja3MuIFRyYWNrcyBtdXN0IGhhdmUgYSB1bmlxdWUgY29tYmluYXRpb24gb2YgJ2tpbmQnIGFuZCAnbGFiZWwnLiBXZSB3b3VsZCBoYXZlIHRvIGRvIHNvbWV0aGluZyBsaWtlIGtpbmQ9bWV0YWRhdGEsbGFiZWw9dGh1bWJuYWlsczEgLyBraW5kPW1ldGFkYXRhLGxhYmVsPXRodW1ibmFpbHMyLiBTcXVhcmUgcGVnLCByb3VuZCBob2xlXG4gICAqIC0gVlRUIGluZm86IHRoZSBpbWFnZSBVUkwgaXMgcmVsYXRpdmUgdG8gdGhlIFZUVCwgbm90IHRoZSBjdXJyZW50IGRvY3VtZW50LiBCdXQgaWYgdGhlIHVybCBzdGFydHMgd2l0aCBhIHNsYXNoLCBpdCB3aWxsIG5hdHVyYWxseSBiZSByZWxhdGl2ZSB0byB0aGUgY3VycmVudCBkb21haW4uIGh0dHBzOi8vc3VwcG9ydC5qd3BsYXllci5jb20vYXJ0aWNsZXMvaG93LXRvLWFkZC1wcmV2aWV3LXRodW1ibmFpbHNcbiAgICogLSBUaGlzIGltcGxlbWVudGF0aW9uIHVzZXMgbXVsdGlwbGUgc2VwYXJhdGUgaW1nIGVsZW1lbnRzLiBPdGhlciBpbXBsZW1lbnRhdGlvbnMgdXNlIGJhY2tncm91bmQtaW1hZ2Ugb24gb25lIGVsZW1lbnQuIFRoaXMgd291bGQgYmUgbmljZSBhbmQgc2ltcGxlLCBidXQgRmlyZWZveCBhbmQgU2FmYXJpIGhhdmUgZmxpY2tlcmluZyBpc3N1ZXMgd2l0aCByZXBsYWNpbmcgYmFja2dyb3VuZHMgb2YgbGFyZ2VyIGltYWdlcy4gSXQgc2VlbXMgdGhhdCBZb3VUdWJlIHBlcmhhcHMgb25seSBhdm9pZHMgdGhpcyBiZWNhdXNlIHRoZXkgZG9uJ3QgaGF2ZSB0aGUgb3B0aW9uIGZvciBoaWdoLXJlcyBwcmV2aWV3cyAoZXZlbiB0aGUgZnVsbHNjcmVlbiBvbmVzLCB3aGVuIG1vdXNlZG93bi9zZWVraW5nKS4gSW1hZ2VzIGFwcGVhciBvdmVyIHRoZSB0b3Agb2YgZWFjaCBvdGhlciwgYW5kIHByZXZpb3VzIG9uZXMgYXJlIGRpc2NhcmRlZCBvbmNlIHRoZSBuZXcgb25lcyBoYXZlIGJlZW4gcmVuZGVyZWRcbiAgICovXG5cblxuICBjb25zdCBmaXRSYXRpbyA9IChyYXRpbywgb3V0ZXIpID0+IHtcbiAgICBjb25zdCB0YXJnZXRSYXRpbyA9IG91dGVyLndpZHRoIC8gb3V0ZXIuaGVpZ2h0O1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuXG4gICAgaWYgKHJhdGlvID4gdGFyZ2V0UmF0aW8pIHtcbiAgICAgIHJlc3VsdC53aWR0aCA9IG91dGVyLndpZHRoO1xuICAgICAgcmVzdWx0LmhlaWdodCA9IDEgLyByYXRpbyAqIG91dGVyLndpZHRoO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQuaGVpZ2h0ID0gb3V0ZXIuaGVpZ2h0O1xuICAgICAgcmVzdWx0LndpZHRoID0gcmF0aW8gKiBvdXRlci5oZWlnaHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBjbGFzcyBQcmV2aWV3VGh1bWJuYWlscyB7XG4gICAgLyoqXG4gICAgICogUHJldmlld1RodW1ibmFpbHMgY29uc3RydWN0b3IuXG4gICAgICogQHBhcmFtIHtQbHlyfSBwbGF5ZXJcbiAgICAgKiBAcmV0dXJuIHtQcmV2aWV3VGh1bWJuYWlsc31cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihwbGF5ZXIpIHtcbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwibG9hZFwiLCAoKSA9PiB7XG4gICAgICAgIC8vIFRvZ2dsZSB0aGUgcmVndWxhciBzZWVrIHRvb2x0aXBcbiAgICAgICAgaWYgKHRoaXMucGxheWVyLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXApIHtcbiAgICAgICAgICB0aGlzLnBsYXllci5lbGVtZW50cy5kaXNwbGF5LnNlZWtUb29sdGlwLmhpZGRlbiA9IHRoaXMuZW5hYmxlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkKSByZXR1cm47XG4gICAgICAgIHRoaXMuZ2V0VGh1bWJuYWlscygpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBSZW5kZXIgRE9NIGVsZW1lbnRzXG5cblxuICAgICAgICAgIHRoaXMucmVuZGVyKCk7IC8vIENoZWNrIHRvIHNlZSBpZiB0aHVtYiBjb250YWluZXIgc2l6ZSB3YXMgc3BlY2lmaWVkIG1hbnVhbGx5IGluIENTU1xuXG4gICAgICAgICAgdGhpcy5kZXRlcm1pbmVDb250YWluZXJBdXRvU2l6aW5nKCk7XG4gICAgICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImdldFRodW1ibmFpbHNcIiwgKCkgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgc3JjXG4gICAgICAgICAgfSA9IHRoaXMucGxheWVyLmNvbmZpZy5wcmV2aWV3VGh1bWJuYWlscztcblxuICAgICAgICAgIGlmIChpcy5lbXB0eShzcmMpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcHJldmlld1RodW1ibmFpbHMuc3JjIGNvbmZpZyBhdHRyaWJ1dGUnKTtcbiAgICAgICAgICB9IC8vIFJlc29sdmUgcHJvbWlzZVxuXG5cbiAgICAgICAgICBjb25zdCBzb3J0QW5kUmVzb2x2ZSA9ICgpID0+IHtcbiAgICAgICAgICAgIC8vIFNvcnQgc21hbGxlc3QgdG8gYmlnZ2VzdCAoZS5nLiwgWzEyMHAsIDQ4MHAsIDEwODBwXSlcbiAgICAgICAgICAgIHRoaXMudGh1bWJuYWlscy5zb3J0KCh4LCB5KSA9PiB4LmhlaWdodCAtIHkuaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZygnUHJldmlldyB0aHVtYm5haWxzJywgdGhpcy50aHVtYm5haWxzKTtcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICB9OyAvLyBWaWEgY2FsbGJhY2soKVxuXG5cbiAgICAgICAgICBpZiAoaXMuZnVuY3Rpb24oc3JjKSkge1xuICAgICAgICAgICAgc3JjKHRodW1ibmFpbHMgPT4ge1xuICAgICAgICAgICAgICB0aGlzLnRodW1ibmFpbHMgPSB0aHVtYm5haWxzO1xuICAgICAgICAgICAgICBzb3J0QW5kUmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSAvLyBWVFQgdXJsc1xuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gSWYgc3RyaW5nLCBjb252ZXJ0IGludG8gc2luZ2xlLWVsZW1lbnQgbGlzdFxuICAgICAgICAgICAgY29uc3QgdXJscyA9IGlzLnN0cmluZyhzcmMpID8gW3NyY10gOiBzcmM7IC8vIExvb3AgdGhyb3VnaCBlYWNoIHNyYyBVUkwuIERvd25sb2FkIGFuZCBwcm9jZXNzIHRoZSBWVFQgZmlsZSwgc3RvcmluZyB0aGUgcmVzdWx0aW5nIGRhdGEgaW4gdGhpcy50aHVtYm5haWxzXG5cbiAgICAgICAgICAgIGNvbnN0IHByb21pc2VzID0gdXJscy5tYXAodSA9PiB0aGlzLmdldFRodW1ibmFpbCh1KSk7IC8vIFJlc29sdmVcblxuICAgICAgICAgICAgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oc29ydEFuZFJlc29sdmUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJnZXRUaHVtYm5haWxcIiwgdXJsID0+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgIGZldGNoKHVybCkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0aHVtYm5haWwgPSB7XG4gICAgICAgICAgICAgIGZyYW1lczogcGFyc2VWdHQocmVzcG9uc2UpLFxuICAgICAgICAgICAgICBoZWlnaHQ6IG51bGwsXG4gICAgICAgICAgICAgIHVybFByZWZpeDogJydcbiAgICAgICAgICAgIH07IC8vIElmIHRoZSBVUkxzIGRvbid0IHN0YXJ0IHdpdGggJy8nLCB0aGVuIHdlIG5lZWQgdG8gc2V0IHRoZWlyIHJlbGF0aXZlIHBhdGggdG8gYmUgdGhlIGxvY2F0aW9uIG9mIHRoZSBWVFQgZmlsZVxuICAgICAgICAgICAgLy8gSWYgdGhlIFVSTHMgZG8gc3RhcnQgd2l0aCAnLycsIHRoZW4gdGhleSBvYnZpb3VzbHkgZG9uJ3QgbmVlZCBhIHByZWZpeCwgc28gaXQgd2lsbCByZW1haW4gYmxhbmtcbiAgICAgICAgICAgIC8vIElmIHRoZSB0aHVtYm5haWwgVVJMcyBzdGFydCB3aXRoIHdpdGggbm9uZSBvZiAnLycsICdodHRwOi8vJyBvciAnaHR0cHM6Ly8nLCB0aGVuIHdlIG5lZWQgdG8gc2V0IHRoZWlyIHJlbGF0aXZlIHBhdGggdG8gYmUgdGhlIGxvY2F0aW9uIG9mIHRoZSBWVFQgZmlsZVxuXG4gICAgICAgICAgICBpZiAoIXRodW1ibmFpbC5mcmFtZXNbMF0udGV4dC5zdGFydHNXaXRoKCcvJykgJiYgIXRodW1ibmFpbC5mcmFtZXNbMF0udGV4dC5zdGFydHNXaXRoKCdodHRwOi8vJykgJiYgIXRodW1ibmFpbC5mcmFtZXNbMF0udGV4dC5zdGFydHNXaXRoKCdodHRwczovLycpKSB7XG4gICAgICAgICAgICAgIHRodW1ibmFpbC51cmxQcmVmaXggPSB1cmwuc3Vic3RyaW5nKDAsIHVybC5sYXN0SW5kZXhPZignLycpICsgMSk7XG4gICAgICAgICAgICB9IC8vIERvd25sb2FkIHRoZSBmaXJzdCBmcmFtZSwgc28gdGhhdCB3ZSBjYW4gZGV0ZXJtaW5lL3NldCB0aGUgaGVpZ2h0IG9mIHRoaXMgdGh1bWJuYWlsc0RlZlxuXG5cbiAgICAgICAgICAgIGNvbnN0IHRlbXBJbWFnZSA9IG5ldyBJbWFnZSgpO1xuXG4gICAgICAgICAgICB0ZW1wSW1hZ2Uub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgICB0aHVtYm5haWwuaGVpZ2h0ID0gdGVtcEltYWdlLm5hdHVyYWxIZWlnaHQ7XG4gICAgICAgICAgICAgIHRodW1ibmFpbC53aWR0aCA9IHRlbXBJbWFnZS5uYXR1cmFsV2lkdGg7XG4gICAgICAgICAgICAgIHRoaXMudGh1bWJuYWlscy5wdXNoKHRodW1ibmFpbCk7XG4gICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRlbXBJbWFnZS5zcmMgPSB0aHVtYm5haWwudXJsUHJlZml4ICsgdGh1bWJuYWlsLmZyYW1lc1swXS50ZXh0O1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInN0YXJ0TW92ZVwiLCBldmVudCA9PiB7XG4gICAgICAgIGlmICghdGhpcy5sb2FkZWQpIHJldHVybjtcbiAgICAgICAgaWYgKCFpcy5ldmVudChldmVudCkgfHwgIVsndG91Y2htb3ZlJywgJ21vdXNlbW92ZSddLmluY2x1ZGVzKGV2ZW50LnR5cGUpKSByZXR1cm47IC8vIFdhaXQgdW50aWwgbWVkaWEgaGFzIGEgZHVyYXRpb25cblxuICAgICAgICBpZiAoIXRoaXMucGxheWVyLm1lZGlhLmR1cmF0aW9uKSByZXR1cm47XG5cbiAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICd0b3VjaG1vdmUnKSB7XG4gICAgICAgICAgLy8gQ2FsY3VsYXRlIHNlZWsgaG92ZXIgcG9zaXRpb24gYXMgYXBwcm94IHZpZGVvIHNlY29uZHNcbiAgICAgICAgICB0aGlzLnNlZWtUaW1lID0gdGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24gKiAodGhpcy5wbGF5ZXIuZWxlbWVudHMuaW5wdXRzLnNlZWsudmFsdWUgLyAxMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBfdGhpcyRwbGF5ZXIkY29uZmlnJG0sIF90aGlzJHBsYXllciRjb25maWckbTI7XG5cbiAgICAgICAgICAvLyBDYWxjdWxhdGUgc2VlayBob3ZlciBwb3NpdGlvbiBhcyBhcHByb3ggdmlkZW8gc2Vjb25kc1xuICAgICAgICAgIGNvbnN0IGNsaWVudFJlY3QgPSB0aGlzLnBsYXllci5lbGVtZW50cy5wcm9ncmVzcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICBjb25zdCBwZXJjZW50YWdlID0gMTAwIC8gY2xpZW50UmVjdC53aWR0aCAqIChldmVudC5wYWdlWCAtIGNsaWVudFJlY3QubGVmdCk7XG4gICAgICAgICAgdGhpcy5zZWVrVGltZSA9IHRoaXMucGxheWVyLm1lZGlhLmR1cmF0aW9uICogKHBlcmNlbnRhZ2UgLyAxMDApO1xuXG4gICAgICAgICAgaWYgKHRoaXMuc2Vla1RpbWUgPCAwKSB7XG4gICAgICAgICAgICAvLyBUaGUgbW91c2Vtb3ZlIGZpcmVzIGZvciAxMCtweCBvdXQgdG8gdGhlIGxlZnRcbiAgICAgICAgICAgIHRoaXMuc2Vla1RpbWUgPSAwO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLnNlZWtUaW1lID4gdGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24gLSAxKSB7XG4gICAgICAgICAgICAvLyBUb29rIDEgc2Vjb25kIG9mZiB0aGUgZHVyYXRpb24gZm9yIHNhZmV0eSwgYmVjYXVzZSBkaWZmZXJlbnQgcGxheWVycyBjYW4gZGlzYWdyZWUgb24gdGhlIHJlYWwgZHVyYXRpb24gb2YgYSB2aWRlb1xuICAgICAgICAgICAgdGhpcy5zZWVrVGltZSA9IHRoaXMucGxheWVyLm1lZGlhLmR1cmF0aW9uIC0gMTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm1vdXNlUG9zWCA9IGV2ZW50LnBhZ2VYOyAvLyBTZXQgdGltZSB0ZXh0IGluc2lkZSBpbWFnZSBjb250YWluZXJcblxuICAgICAgICAgIHRoaXMuZWxlbWVudHMudGh1bWIudGltZS5pbm5lclRleHQgPSBmb3JtYXRUaW1lKHRoaXMuc2Vla1RpbWUpOyAvLyBHZXQgbWFya2VyIHBvaW50IGZvciB0aW1lXG5cbiAgICAgICAgICBjb25zdCBwb2ludCA9IChfdGhpcyRwbGF5ZXIkY29uZmlnJG0gPSB0aGlzLnBsYXllci5jb25maWcubWFya2VycykgPT09IG51bGwgfHwgX3RoaXMkcGxheWVyJGNvbmZpZyRtID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX3RoaXMkcGxheWVyJGNvbmZpZyRtMiA9IF90aGlzJHBsYXllciRjb25maWckbS5wb2ludHMpID09PSBudWxsIHx8IF90aGlzJHBsYXllciRjb25maWckbTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHBsYXllciRjb25maWckbTIuZmluZCgoe1xuICAgICAgICAgICAgdGltZTogdFxuICAgICAgICAgIH0pID0+IHQgPT09IE1hdGgucm91bmQodGhpcy5zZWVrVGltZSkpOyAvLyBBcHBlbmQgdGhlIHBvaW50IGxhYmVsIHRvIHRoZSB0b29sdGlwXG5cbiAgICAgICAgICBpZiAocG9pbnQpIHtcbiAgICAgICAgICAgIC8vIHRoaXMuZWxlbWVudHMudGh1bWIudGltZS5pbm5lclRleHQuY29uY2F0KCdcXG4nKTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudHMudGh1bWIudGltZS5pbnNlcnRBZGphY2VudEhUTUwoJ2FmdGVyYmVnaW4nLCBgJHtwb2ludC5sYWJlbH08YnI+YCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IC8vIERvd25sb2FkIGFuZCBzaG93IGltYWdlXG5cblxuICAgICAgICB0aGlzLnNob3dJbWFnZUF0Q3VycmVudFRpbWUoKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImVuZE1vdmVcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLnRvZ2dsZVRodW1iQ29udGFpbmVyKGZhbHNlLCB0cnVlKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInN0YXJ0U2NydWJiaW5nXCIsIGV2ZW50ID0+IHtcbiAgICAgICAgLy8gT25seSBhY3Qgb24gbGVmdCBtb3VzZSBidXR0b24gKDApLCBvciB0b3VjaCBkZXZpY2UgKGV2ZW50LmJ1dHRvbiBkb2VzIG5vdCBleGlzdCBvciBpcyBmYWxzZSlcbiAgICAgICAgaWYgKGlzLm51bGxPclVuZGVmaW5lZChldmVudC5idXR0b24pIHx8IGV2ZW50LmJ1dHRvbiA9PT0gZmFsc2UgfHwgZXZlbnQuYnV0dG9uID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5tb3VzZURvd24gPSB0cnVlOyAvLyBXYWl0IHVudGlsIG1lZGlhIGhhcyBhIGR1cmF0aW9uXG5cbiAgICAgICAgICBpZiAodGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlU2NydWJiaW5nQ29udGFpbmVyKHRydWUpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVUaHVtYkNvbnRhaW5lcihmYWxzZSwgdHJ1ZSk7IC8vIERvd25sb2FkIGFuZCBzaG93IGltYWdlXG5cbiAgICAgICAgICAgIHRoaXMuc2hvd0ltYWdlQXRDdXJyZW50VGltZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiZW5kU2NydWJiaW5nXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5tb3VzZURvd24gPSBmYWxzZTsgLy8gSGlkZSBzY3J1YmJpbmcgcHJldmlldy4gQnV0IHdhaXQgdW50aWwgdGhlIHZpZGVvIGhhcyBzdWNjZXNzZnVsbHkgc2Vla2VkIGJlZm9yZSBoaWRpbmcgdGhlIHNjcnViYmluZyBwcmV2aWV3XG5cbiAgICAgICAgaWYgKE1hdGguY2VpbCh0aGlzLmxhc3RUaW1lKSA9PT0gTWF0aC5jZWlsKHRoaXMucGxheWVyLm1lZGlhLmN1cnJlbnRUaW1lKSkge1xuICAgICAgICAgIC8vIFRoZSB2aWRlbyB3YXMgYWxyZWFkeSBzZWVrZWQvbG9hZGVkIGF0IHRoZSBjaG9zZW4gdGltZSAtIGhpZGUgaW1tZWRpYXRlbHlcbiAgICAgICAgICB0aGlzLnRvZ2dsZVNjcnViYmluZ0NvbnRhaW5lcihmYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gVGhlIHZpZGVvIGhhc24ndCBzZWVrZWQgeWV0LiBXYWl0IGZvciB0aGF0XG4gICAgICAgICAgb25jZS5jYWxsKHRoaXMucGxheWVyLCB0aGlzLnBsYXllci5tZWRpYSwgJ3RpbWV1cGRhdGUnLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBSZS1jaGVjayBtb3VzZWRvd24gLSB3ZSBtaWdodCBoYXZlIGFscmVhZHkgc3RhcnRlZCBzY3J1YmJpbmcgYWdhaW5cbiAgICAgICAgICAgIGlmICghdGhpcy5tb3VzZURvd24pIHtcbiAgICAgICAgICAgICAgdGhpcy50b2dnbGVTY3J1YmJpbmdDb250YWluZXIoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJsaXN0ZW5lcnNcIiwgKCkgPT4ge1xuICAgICAgICAvLyBIaWRlIHRodW1ibmFpbCBwcmV2aWV3IC0gb24gbW91c2UgY2xpY2ssIG1vdXNlIGxlYXZlIChpbiBsaXN0ZW5lcnMuanMgZm9yIG5vdyksIGFuZCB2aWRlbyBwbGF5L3NlZWsuIEFsbCBmb3VyIGFyZSByZXF1aXJlZCwgZS5nLiwgZm9yIGJ1ZmZlcmluZ1xuICAgICAgICB0aGlzLnBsYXllci5vbigncGxheScsICgpID0+IHtcbiAgICAgICAgICB0aGlzLnRvZ2dsZVRodW1iQ29udGFpbmVyKGZhbHNlLCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucGxheWVyLm9uKCdzZWVrZWQnLCAoKSA9PiB7XG4gICAgICAgICAgdGhpcy50b2dnbGVUaHVtYkNvbnRhaW5lcihmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBsYXllci5vbigndGltZXVwZGF0ZScsICgpID0+IHtcbiAgICAgICAgICB0aGlzLmxhc3RUaW1lID0gdGhpcy5wbGF5ZXIubWVkaWEuY3VycmVudFRpbWU7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicmVuZGVyXCIsICgpID0+IHtcbiAgICAgICAgLy8gQ3JlYXRlIEhUTUwgZWxlbWVudDogcGx5cl9fcHJldmlldy10aHVtYm5haWwtY29udGFpbmVyXG4gICAgICAgIHRoaXMuZWxlbWVudHMudGh1bWIuY29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgIGNsYXNzOiB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5wcmV2aWV3VGh1bWJuYWlscy50aHVtYkNvbnRhaW5lclxuICAgICAgICB9KTsgLy8gV3JhcHBlciBmb3IgdGhlIGltYWdlIGZvciBzdHlsaW5nXG5cbiAgICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICBjbGFzczogdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMucHJldmlld1RodW1ibmFpbHMuaW1hZ2VDb250YWluZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZWxlbWVudHMudGh1bWIuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXIpOyAvLyBDcmVhdGUgSFRNTCBlbGVtZW50LCBwYXJlbnQrc3BhbjogdGltZSB0ZXh0IChlLmcuLCAwMTozMjowMClcblxuICAgICAgICBjb25zdCB0aW1lQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICAgIGNsYXNzOiB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5wcmV2aWV3VGh1bWJuYWlscy50aW1lQ29udGFpbmVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmVsZW1lbnRzLnRodW1iLnRpbWUgPSBjcmVhdGVFbGVtZW50KCdzcGFuJywge30sICcwMDowMCcpO1xuICAgICAgICB0aW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudHMudGh1bWIudGltZSk7XG4gICAgICAgIHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQodGltZUNvbnRhaW5lcik7IC8vIEluamVjdCB0aGUgd2hvbGUgdGh1bWJcblxuICAgICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLnBsYXllci5lbGVtZW50cy5wcm9ncmVzcykpIHtcbiAgICAgICAgICB0aGlzLnBsYXllci5lbGVtZW50cy5wcm9ncmVzcy5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLnRodW1iLmNvbnRhaW5lcik7XG4gICAgICAgIH0gLy8gQ3JlYXRlIEhUTUwgZWxlbWVudDogcGx5cl9fcHJldmlldy1zY3J1YmJpbmctY29udGFpbmVyXG5cblxuICAgICAgICB0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLnByZXZpZXdUaHVtYm5haWxzLnNjcnViYmluZ0NvbnRhaW5lclxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wbGF5ZXIuZWxlbWVudHMud3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiZGVzdHJveVwiLCAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnRzLnRodW1iLmNvbnRhaW5lcikge1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMudGh1bWIuY29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lcikge1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lci5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic2hvd0ltYWdlQXRDdXJyZW50VGltZVwiLCAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLm1vdXNlRG93bikge1xuICAgICAgICAgIHRoaXMuc2V0U2NydWJiaW5nQ29udGFpbmVyU2l6ZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2V0VGh1bWJDb250YWluZXJTaXplQW5kUG9zKCk7XG4gICAgICAgIH0gLy8gRmluZCB0aGUgZGVzaXJlZCB0aHVtYm5haWwgaW5kZXhcbiAgICAgICAgLy8gVE9ETzogSGFuZGxlIGEgdmlkZW8gbG9uZ2VyIHRoYW4gdGhlIHRodW1icyB3aGVyZSB0aHVtYk51bSBpcyBudWxsXG5cblxuICAgICAgICBjb25zdCB0aHVtYk51bSA9IHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXMuZmluZEluZGV4KGZyYW1lID0+IHRoaXMuc2Vla1RpbWUgPj0gZnJhbWUuc3RhcnRUaW1lICYmIHRoaXMuc2Vla1RpbWUgPD0gZnJhbWUuZW5kVGltZSk7XG4gICAgICAgIGNvbnN0IGhhc1RodW1iID0gdGh1bWJOdW0gPj0gMDtcbiAgICAgICAgbGV0IHF1YWxpdHlJbmRleCA9IDA7IC8vIFNob3cgdGhlIHRodW1iIGNvbnRhaW5lciBpZiB3ZSdyZSBub3Qgc2NydWJiaW5nXG5cbiAgICAgICAgaWYgKCF0aGlzLm1vdXNlRG93bikge1xuICAgICAgICAgIHRoaXMudG9nZ2xlVGh1bWJDb250YWluZXIoaGFzVGh1bWIpO1xuICAgICAgICB9IC8vIE5vIG1hdGNoaW5nIHRodW1iIGZvdW5kXG5cblxuICAgICAgICBpZiAoIWhhc1RodW1iKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIENoZWNrIHRvIHNlZSBpZiB3ZSd2ZSBhbHJlYWR5IGRvd25sb2FkZWQgaGlnaGVyIHF1YWxpdHkgdmVyc2lvbnMgb2YgdGhpcyBpbWFnZVxuXG5cbiAgICAgICAgdGhpcy50aHVtYm5haWxzLmZvckVhY2goKHRodW1ibmFpbCwgaW5kZXgpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5sb2FkZWRJbWFnZXMuaW5jbHVkZXModGh1bWJuYWlsLmZyYW1lc1t0aHVtYk51bV0udGV4dCkpIHtcbiAgICAgICAgICAgIHF1YWxpdHlJbmRleCA9IGluZGV4O1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7IC8vIE9ubHkgcHJvY2VlZCBpZiBlaXRoZXIgdGh1bWIgbnVtIG9yIHRodW1iZmlsZW5hbWUgaGFzIGNoYW5nZWRcblxuICAgICAgICBpZiAodGh1bWJOdW0gIT09IHRoaXMuc2hvd2luZ1RodW1iKSB7XG4gICAgICAgICAgdGhpcy5zaG93aW5nVGh1bWIgPSB0aHVtYk51bTtcbiAgICAgICAgICB0aGlzLmxvYWRJbWFnZShxdWFsaXR5SW5kZXgpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJsb2FkSW1hZ2VcIiwgKHF1YWxpdHlJbmRleCA9IDApID0+IHtcbiAgICAgICAgY29uc3QgdGh1bWJOdW0gPSB0aGlzLnNob3dpbmdUaHVtYjtcbiAgICAgICAgY29uc3QgdGh1bWJuYWlsID0gdGhpcy50aHVtYm5haWxzW3F1YWxpdHlJbmRleF07XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICB1cmxQcmVmaXhcbiAgICAgICAgfSA9IHRodW1ibmFpbDtcbiAgICAgICAgY29uc3QgZnJhbWUgPSB0aHVtYm5haWwuZnJhbWVzW3RodW1iTnVtXTtcbiAgICAgICAgY29uc3QgdGh1bWJGaWxlbmFtZSA9IHRodW1ibmFpbC5mcmFtZXNbdGh1bWJOdW1dLnRleHQ7XG4gICAgICAgIGNvbnN0IHRodW1iVXJsID0gdXJsUHJlZml4ICsgdGh1bWJGaWxlbmFtZTtcblxuICAgICAgICBpZiAoIXRoaXMuY3VycmVudEltYWdlRWxlbWVudCB8fCB0aGlzLmN1cnJlbnRJbWFnZUVsZW1lbnQuZGF0YXNldC5maWxlbmFtZSAhPT0gdGh1bWJGaWxlbmFtZSkge1xuICAgICAgICAgIC8vIElmIHdlJ3JlIGFscmVhZHkgbG9hZGluZyBhIHByZXZpb3VzIGltYWdlLCByZW1vdmUgaXRzIG9ubG9hZCBoYW5kbGVyIC0gd2UgZG9uJ3Qgd2FudCBpdCB0byBsb2FkIGFmdGVyIHRoaXMgb25lXG4gICAgICAgICAgLy8gT25seSBkbyB0aGlzIGlmIG5vdCB1c2luZyBzcHJpdGVzLiBXaXRob3V0IHNwcml0ZXMgd2UgcmVhbGx5IHdhbnQgdG8gc2hvdyBhcyBtYW55IGltYWdlcyBhcyBwb3NzaWJsZSwgYXMgYSBiZXN0LWVmZm9ydFxuICAgICAgICAgIGlmICh0aGlzLmxvYWRpbmdJbWFnZSAmJiB0aGlzLnVzaW5nU3ByaXRlcykge1xuICAgICAgICAgICAgdGhpcy5sb2FkaW5nSW1hZ2Uub25sb2FkID0gbnVsbDtcbiAgICAgICAgICB9IC8vIFdlJ3JlIGJ1aWxkaW5nIGFuZCBhZGRpbmcgYSBuZXcgaW1hZ2UuIEluIG90aGVyIGltcGxlbWVudGF0aW9ucyBvZiBzaW1pbGFyIGZ1bmN0aW9uYWxpdHkgKFlvdVR1YmUpLCBiYWNrZ3JvdW5kIGltYWdlXG4gICAgICAgICAgLy8gaXMgaW5zdGVhZCB1c2VkLiBCdXQgdGhpcyBjYXVzZXMgaXNzdWVzIHdpdGggbGFyZ2VyIGltYWdlcyBpbiBGaXJlZm94IGFuZCBTYWZhcmkgLSBzd2l0Y2hpbmcgYmV0d2VlbiBiYWNrZ3JvdW5kXG4gICAgICAgICAgLy8gaW1hZ2VzIGNhdXNlcyBhIGZsaWNrZXIuIFB1dHRpbmcgYSBuZXcgaW1hZ2Ugb3ZlciB0aGUgdG9wIGRvZXMgbm90XG5cblxuICAgICAgICAgIGNvbnN0IHByZXZpZXdJbWFnZSA9IG5ldyBJbWFnZSgpO1xuICAgICAgICAgIHByZXZpZXdJbWFnZS5zcmMgPSB0aHVtYlVybDtcbiAgICAgICAgICBwcmV2aWV3SW1hZ2UuZGF0YXNldC5pbmRleCA9IHRodW1iTnVtO1xuICAgICAgICAgIHByZXZpZXdJbWFnZS5kYXRhc2V0LmZpbGVuYW1lID0gdGh1bWJGaWxlbmFtZTtcbiAgICAgICAgICB0aGlzLnNob3dpbmdUaHVtYkZpbGVuYW1lID0gdGh1bWJGaWxlbmFtZTtcbiAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYExvYWRpbmcgaW1hZ2U6ICR7dGh1bWJVcmx9YCk7IC8vIEZvciBzb21lIHJlYXNvbiwgcGFzc2luZyB0aGUgbmFtZWQgZnVuY3Rpb24gZGlyZWN0bHkgY2F1c2VzIGl0IHRvIGV4ZWN1dGUgaW1tZWRpYXRlbHkuIFNvIEkndmUgd3JhcHBlZCBpdCBpbiBhbiBhbm9ueW1vdXMgZnVuY3Rpb24uLi5cblxuICAgICAgICAgIHByZXZpZXdJbWFnZS5vbmxvYWQgPSAoKSA9PiB0aGlzLnNob3dJbWFnZShwcmV2aWV3SW1hZ2UsIGZyYW1lLCBxdWFsaXR5SW5kZXgsIHRodW1iTnVtLCB0aHVtYkZpbGVuYW1lLCB0cnVlKTtcblxuICAgICAgICAgIHRoaXMubG9hZGluZ0ltYWdlID0gcHJldmlld0ltYWdlO1xuICAgICAgICAgIHRoaXMucmVtb3ZlT2xkSW1hZ2VzKHByZXZpZXdJbWFnZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gVXBkYXRlIHRoZSBleGlzdGluZyBpbWFnZVxuICAgICAgICAgIHRoaXMuc2hvd0ltYWdlKHRoaXMuY3VycmVudEltYWdlRWxlbWVudCwgZnJhbWUsIHF1YWxpdHlJbmRleCwgdGh1bWJOdW0sIHRodW1iRmlsZW5hbWUsIGZhbHNlKTtcbiAgICAgICAgICB0aGlzLmN1cnJlbnRJbWFnZUVsZW1lbnQuZGF0YXNldC5pbmRleCA9IHRodW1iTnVtO1xuICAgICAgICAgIHRoaXMucmVtb3ZlT2xkSW1hZ2VzKHRoaXMuY3VycmVudEltYWdlRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInNob3dJbWFnZVwiLCAocHJldmlld0ltYWdlLCBmcmFtZSwgcXVhbGl0eUluZGV4LCB0aHVtYk51bSwgdGh1bWJGaWxlbmFtZSwgbmV3SW1hZ2UgPSB0cnVlKSA9PiB7XG4gICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgU2hvd2luZyB0aHVtYjogJHt0aHVtYkZpbGVuYW1lfS4gbnVtOiAke3RodW1iTnVtfS4gcXVhbDogJHtxdWFsaXR5SW5kZXh9LiBuZXdpbWc6ICR7bmV3SW1hZ2V9YCk7XG4gICAgICAgIHRoaXMuc2V0SW1hZ2VTaXplQW5kT2Zmc2V0KHByZXZpZXdJbWFnZSwgZnJhbWUpO1xuXG4gICAgICAgIGlmIChuZXdJbWFnZSkge1xuICAgICAgICAgIHRoaXMuY3VycmVudEltYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKHByZXZpZXdJbWFnZSk7XG4gICAgICAgICAgdGhpcy5jdXJyZW50SW1hZ2VFbGVtZW50ID0gcHJldmlld0ltYWdlO1xuXG4gICAgICAgICAgaWYgKCF0aGlzLmxvYWRlZEltYWdlcy5pbmNsdWRlcyh0aHVtYkZpbGVuYW1lKSkge1xuICAgICAgICAgICAgdGhpcy5sb2FkZWRJbWFnZXMucHVzaCh0aHVtYkZpbGVuYW1lKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gLy8gUHJlbG9hZCBpbWFnZXMgYmVmb3JlIGFuZCBhZnRlciB0aGUgY3VycmVudCBvbmVcbiAgICAgICAgLy8gU2hvdyBoaWdoZXIgcXVhbGl0eSBvZiB0aGUgc2FtZSBmcmFtZVxuICAgICAgICAvLyBFYWNoIHN0ZXAgaGVyZSBoYXMgYSBzaG9ydCB0aW1lIGRlbGF5LCBhbmQgb25seSBjb250aW51ZXMgaWYgc3RpbGwgaG92ZXJpbmcvc2Vla2luZyB0aGUgc2FtZSBzcG90LiBUaGlzIGlzIHRvIHByb3RlY3Qgc2xvdyBjb25uZWN0aW9ucyBmcm9tIG92ZXJsb2FkaW5nXG5cblxuICAgICAgICB0aGlzLnByZWxvYWROZWFyYnkodGh1bWJOdW0sIHRydWUpLnRoZW4odGhpcy5wcmVsb2FkTmVhcmJ5KHRodW1iTnVtLCBmYWxzZSkpLnRoZW4odGhpcy5nZXRIaWdoZXJRdWFsaXR5KHF1YWxpdHlJbmRleCwgcHJldmlld0ltYWdlLCBmcmFtZSwgdGh1bWJGaWxlbmFtZSkpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicmVtb3ZlT2xkSW1hZ2VzXCIsIGN1cnJlbnRJbWFnZSA9PiB7XG4gICAgICAgIC8vIEdldCBhIGxpc3Qgb2YgYWxsIGltYWdlcywgY29udmVydCBpdCBmcm9tIGEgRE9NIGxpc3QgdG8gYW4gYXJyYXlcbiAgICAgICAgQXJyYXkuZnJvbSh0aGlzLmN1cnJlbnRJbWFnZUNvbnRhaW5lci5jaGlsZHJlbikuZm9yRWFjaChpbWFnZSA9PiB7XG4gICAgICAgICAgaWYgKGltYWdlLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2ltZycpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCByZW1vdmVEZWxheSA9IHRoaXMudXNpbmdTcHJpdGVzID8gNTAwIDogMTAwMDtcblxuICAgICAgICAgIGlmIChpbWFnZS5kYXRhc2V0LmluZGV4ICE9PSBjdXJyZW50SW1hZ2UuZGF0YXNldC5pbmRleCAmJiAhaW1hZ2UuZGF0YXNldC5kZWxldGluZykge1xuICAgICAgICAgICAgLy8gV2FpdCAyMDBtcywgYXMgdGhlIG5ldyBpbWFnZSBjYW4gdGFrZSBzb21lIHRpbWUgdG8gc2hvdyBvbiBjZXJ0YWluIGJyb3dzZXJzIChldmVuIHRob3VnaCBpdCB3YXMgZG93bmxvYWRlZCBiZWZvcmUgc2hvd2luZykuIFRoaXMgd2lsbCBwcmV2ZW50IGZsaWNrZXIsIGFuZCBzaG93IHNvbWUgZ2VuZXJvc2l0eSB0b3dhcmRzIHNsb3dlciBjbGllbnRzXG4gICAgICAgICAgICAvLyBGaXJzdCBzZXQgYXR0cmlidXRlICdkZWxldGluZycgdG8gcHJldmVudCBtdWx0aS1oYW5kbGluZyBvZiB0aGlzIG9uIHJlcGVhdCBmaXJpbmcgb2YgdGhpcyBmdW5jdGlvblxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICAgICAgICBpbWFnZS5kYXRhc2V0LmRlbGV0aW5nID0gdHJ1ZTsgLy8gVGhpcyBoYXMgdG8gYmUgc2V0IGJlZm9yZSB0aGUgdGltZW91dCAtIHRvIHByZXZlbnQgaXNzdWVzIHN3aXRjaGluZyBiZXR3ZWVuIGhvdmVyIGFuZCBzY3J1YlxuXG4gICAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICAgIGN1cnJlbnRJbWFnZUNvbnRhaW5lclxuICAgICAgICAgICAgfSA9IHRoaXM7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgY3VycmVudEltYWdlQ29udGFpbmVyLnJlbW92ZUNoaWxkKGltYWdlKTtcbiAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBSZW1vdmluZyB0aHVtYjogJHtpbWFnZS5kYXRhc2V0LmZpbGVuYW1lfWApO1xuICAgICAgICAgICAgfSwgcmVtb3ZlRGVsYXkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJwcmVsb2FkTmVhcmJ5XCIsICh0aHVtYk51bSwgZm9yd2FyZCA9IHRydWUpID0+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgb2xkVGh1bWJGaWxlbmFtZSA9IHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXNbdGh1bWJOdW1dLnRleHQ7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnNob3dpbmdUaHVtYkZpbGVuYW1lID09PSBvbGRUaHVtYkZpbGVuYW1lKSB7XG4gICAgICAgICAgICAgIC8vIEZpbmQgdGhlIG5lYXJlc3QgdGh1bWJzIHdpdGggZGlmZmVyZW50IGZpbGVuYW1lcy4gU29tZXRpbWVzIGl0J2xsIGJlIHRoZSBuZXh0IGluZGV4LCBidXQgaW4gdGhlIGNhc2Ugb2Ygc3ByaXRlcywgaXQgbWlnaHQgYmUgMTAwKyBhd2F5XG4gICAgICAgICAgICAgIGxldCB0aHVtYm5haWxzQ2xvbmU7XG5cbiAgICAgICAgICAgICAgaWYgKGZvcndhcmQpIHtcbiAgICAgICAgICAgICAgICB0aHVtYm5haWxzQ2xvbmUgPSB0aGlzLnRodW1ibmFpbHNbMF0uZnJhbWVzLnNsaWNlKHRodW1iTnVtKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHVtYm5haWxzQ2xvbmUgPSB0aGlzLnRodW1ibmFpbHNbMF0uZnJhbWVzLnNsaWNlKDAsIHRodW1iTnVtKS5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBsZXQgZm91bmRPbmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgdGh1bWJuYWlsc0Nsb25lLmZvckVhY2goZnJhbWUgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1RodW1iRmlsZW5hbWUgPSBmcmFtZS50ZXh0O1xuXG4gICAgICAgICAgICAgICAgaWYgKG5ld1RodW1iRmlsZW5hbWUgIT09IG9sZFRodW1iRmlsZW5hbWUpIHtcbiAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIG9uZSB3aXRoIGEgZGlmZmVyZW50IGZpbGVuYW1lLiBNYWtlIHN1cmUgaXQgaGFzbid0IGFscmVhZHkgYmVlbiBsb2FkZWQgb24gdGhpcyBwYWdlIHZpc2l0XG4gICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubG9hZGVkSW1hZ2VzLmluY2x1ZGVzKG5ld1RodW1iRmlsZW5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvdW5kT25lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBQcmVsb2FkaW5nIHRodW1iIGZpbGVuYW1lOiAke25ld1RodW1iRmlsZW5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgICAgICAgICAgICB1cmxQcmVmaXhcbiAgICAgICAgICAgICAgICAgICAgfSA9IHRoaXMudGh1bWJuYWlsc1swXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGh1bWJVUkwgPSB1cmxQcmVmaXggKyBuZXdUaHVtYkZpbGVuYW1lO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2aWV3SW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld0ltYWdlLnNyYyA9IHRodW1iVVJMO1xuXG4gICAgICAgICAgICAgICAgICAgIHByZXZpZXdJbWFnZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBQcmVsb2FkZWQgdGh1bWIgZmlsZW5hbWU6ICR7bmV3VGh1bWJGaWxlbmFtZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubG9hZGVkSW1hZ2VzLmluY2x1ZGVzKG5ld1RodW1iRmlsZW5hbWUpKSB0aGlzLmxvYWRlZEltYWdlcy5wdXNoKG5ld1RodW1iRmlsZW5hbWUpOyAvLyBXZSBkb24ndCByZXNvbHZlIHVudGlsIHRoZSB0aHVtYiBpcyBsb2FkZWRcblxuICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pOyAvLyBJZiB0aGVyZSBhcmUgbm9uZSB0byBwcmVsb2FkIHRoZW4gd2Ugd2FudCB0byByZXNvbHZlIGltbWVkaWF0ZWx5XG5cbiAgICAgICAgICAgICAgaWYgKCFmb3VuZE9uZSkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIDMwMCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiZ2V0SGlnaGVyUXVhbGl0eVwiLCAoY3VycmVudFF1YWxpdHlJbmRleCwgcHJldmlld0ltYWdlLCBmcmFtZSwgdGh1bWJGaWxlbmFtZSkgPT4ge1xuICAgICAgICBpZiAoY3VycmVudFF1YWxpdHlJbmRleCA8IHRoaXMudGh1bWJuYWlscy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgLy8gT25seSB1c2UgdGhlIGhpZ2hlciBxdWFsaXR5IHZlcnNpb24gaWYgaXQncyBnb2luZyB0byBsb29rIGFueSBiZXR0ZXIgLSBpZiB0aGUgY3VycmVudCB0aHVtYiBpcyBvZiBhIGxvd2VyIHBpeGVsIGRlbnNpdHkgdGhhbiB0aGUgdGh1bWJuYWlsIGNvbnRhaW5lclxuICAgICAgICAgIGxldCBwcmV2aWV3SW1hZ2VIZWlnaHQgPSBwcmV2aWV3SW1hZ2UubmF0dXJhbEhlaWdodDtcblxuICAgICAgICAgIGlmICh0aGlzLnVzaW5nU3ByaXRlcykge1xuICAgICAgICAgICAgcHJldmlld0ltYWdlSGVpZ2h0ID0gZnJhbWUuaDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAocHJldmlld0ltYWdlSGVpZ2h0IDwgdGhpcy50aHVtYkNvbnRhaW5lckhlaWdodCkge1xuICAgICAgICAgICAgLy8gUmVjdXJzZSBiYWNrIHRvIHRoZSBsb2FkSW1hZ2UgZnVuY3Rpb24gLSBzaG93IGEgaGlnaGVyIHF1YWxpdHkgb25lLCBidXQgb25seSBpZiB0aGUgdmlld2VyIGlzIG9uIHRoaXMgZnJhbWUgZm9yIGEgd2hpbGVcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIG1vdXNlIGhhc24ndCBhbHJlYWR5IG1vdmVkIG9uIGFuZCBzdGFydGVkIGhvdmVyaW5nIGF0IGFub3RoZXIgaW1hZ2VcbiAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvd2luZ1RodW1iRmlsZW5hbWUgPT09IHRodW1iRmlsZW5hbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYFNob3dpbmcgaGlnaGVyIHF1YWxpdHkgdGh1bWIgZm9yOiAke3RodW1iRmlsZW5hbWV9YCk7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkSW1hZ2UoY3VycmVudFF1YWxpdHlJbmRleCArIDEpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAzMDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwidG9nZ2xlVGh1bWJDb250YWluZXJcIiwgKHRvZ2dsZSA9IGZhbHNlLCBjbGVhclNob3dpbmcgPSBmYWxzZSkgPT4ge1xuICAgICAgICBjb25zdCBjbGFzc05hbWUgPSB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5wcmV2aWV3VGh1bWJuYWlscy50aHVtYkNvbnRhaW5lclNob3duO1xuICAgICAgICB0aGlzLmVsZW1lbnRzLnRodW1iLmNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKGNsYXNzTmFtZSwgdG9nZ2xlKTtcblxuICAgICAgICBpZiAoIXRvZ2dsZSAmJiBjbGVhclNob3dpbmcpIHtcbiAgICAgICAgICB0aGlzLnNob3dpbmdUaHVtYiA9IG51bGw7XG4gICAgICAgICAgdGhpcy5zaG93aW5nVGh1bWJGaWxlbmFtZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInRvZ2dsZVNjcnViYmluZ0NvbnRhaW5lclwiLCAodG9nZ2xlID0gZmFsc2UpID0+IHtcbiAgICAgICAgY29uc3QgY2xhc3NOYW1lID0gdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMucHJldmlld1RodW1ibmFpbHMuc2NydWJiaW5nQ29udGFpbmVyU2hvd247XG4gICAgICAgIHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKGNsYXNzTmFtZSwgdG9nZ2xlKTtcblxuICAgICAgICBpZiAoIXRvZ2dsZSkge1xuICAgICAgICAgIHRoaXMuc2hvd2luZ1RodW1iID0gbnVsbDtcbiAgICAgICAgICB0aGlzLnNob3dpbmdUaHVtYkZpbGVuYW1lID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwiZGV0ZXJtaW5lQ29udGFpbmVyQXV0b1NpemluZ1wiLCAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnRzLnRodW1iLmltYWdlQ29udGFpbmVyLmNsaWVudEhlaWdodCA+IDIwIHx8IHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXIuY2xpZW50V2lkdGggPiAyMCkge1xuICAgICAgICAgIC8vIFRoaXMgd2lsbCBwcmV2ZW50IGF1dG8gc2l6aW5nIGluIHRoaXMuc2V0VGh1bWJDb250YWluZXJTaXplQW5kUG9zKClcbiAgICAgICAgICB0aGlzLnNpemVTcGVjaWZpZWRJbkNTUyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInNldFRodW1iQ29udGFpbmVyU2l6ZUFuZFBvc1wiLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBpbWFnZUNvbnRhaW5lclxuICAgICAgICB9ID0gdGhpcy5lbGVtZW50cy50aHVtYjtcblxuICAgICAgICBpZiAoIXRoaXMuc2l6ZVNwZWNpZmllZEluQ1NTKSB7XG4gICAgICAgICAgY29uc3QgdGh1bWJXaWR0aCA9IE1hdGguZmxvb3IodGhpcy50aHVtYkNvbnRhaW5lckhlaWdodCAqIHRoaXMudGh1bWJBc3BlY3RSYXRpbyk7XG4gICAgICAgICAgaW1hZ2VDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gYCR7dGhpcy50aHVtYkNvbnRhaW5lckhlaWdodH1weGA7XG4gICAgICAgICAgaW1hZ2VDb250YWluZXIuc3R5bGUud2lkdGggPSBgJHt0aHVtYldpZHRofXB4YDtcbiAgICAgICAgfSBlbHNlIGlmIChpbWFnZUNvbnRhaW5lci5jbGllbnRIZWlnaHQgPiAyMCAmJiBpbWFnZUNvbnRhaW5lci5jbGllbnRXaWR0aCA8IDIwKSB7XG4gICAgICAgICAgY29uc3QgdGh1bWJXaWR0aCA9IE1hdGguZmxvb3IoaW1hZ2VDb250YWluZXIuY2xpZW50SGVpZ2h0ICogdGhpcy50aHVtYkFzcGVjdFJhdGlvKTtcbiAgICAgICAgICBpbWFnZUNvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke3RodW1iV2lkdGh9cHhgO1xuICAgICAgICB9IGVsc2UgaWYgKGltYWdlQ29udGFpbmVyLmNsaWVudEhlaWdodCA8IDIwICYmIGltYWdlQ29udGFpbmVyLmNsaWVudFdpZHRoID4gMjApIHtcbiAgICAgICAgICBjb25zdCB0aHVtYkhlaWdodCA9IE1hdGguZmxvb3IoaW1hZ2VDb250YWluZXIuY2xpZW50V2lkdGggLyB0aGlzLnRodW1iQXNwZWN0UmF0aW8pO1xuICAgICAgICAgIGltYWdlQ29udGFpbmVyLnN0eWxlLmhlaWdodCA9IGAke3RodW1iSGVpZ2h0fXB4YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0VGh1bWJDb250YWluZXJQb3MoKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInNldFRodW1iQ29udGFpbmVyUG9zXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2NydWJiZXJSZWN0ID0gdGhpcy5wbGF5ZXIuZWxlbWVudHMucHJvZ3Jlc3MuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lclJlY3QgPSB0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBjb250YWluZXJcbiAgICAgICAgfSA9IHRoaXMuZWxlbWVudHMudGh1bWI7IC8vIEZpbmQgdGhlIGxvd2VzdCBhbmQgaGlnaGVzdCBkZXNpcmVkIGxlZnQtcG9zaXRpb24sIHNvIHdlIGRvbid0IHNsaWRlIG91dCB0aGUgc2lkZSBvZiB0aGUgdmlkZW8gY29udGFpbmVyXG5cbiAgICAgICAgY29uc3QgbWluID0gY29udGFpbmVyUmVjdC5sZWZ0IC0gc2NydWJiZXJSZWN0LmxlZnQgKyAxMDtcbiAgICAgICAgY29uc3QgbWF4ID0gY29udGFpbmVyUmVjdC5yaWdodCAtIHNjcnViYmVyUmVjdC5sZWZ0IC0gY29udGFpbmVyLmNsaWVudFdpZHRoIC0gMTA7IC8vIFNldCBwcmV2aWV3IGNvbnRhaW5lciBwb3NpdGlvbiB0bzogbW91c2Vwb3MsIG1pbnVzIHNlZWtiYXIubGVmdCwgbWludXMgaGFsZiBvZiBwcmV2aWV3Q29udGFpbmVyLmNsaWVudFdpZHRoXG5cbiAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLm1vdXNlUG9zWCAtIHNjcnViYmVyUmVjdC5sZWZ0IC0gY29udGFpbmVyLmNsaWVudFdpZHRoIC8gMjtcbiAgICAgICAgY29uc3QgY2xhbXBlZCA9IGNsYW1wKHBvc2l0aW9uLCBtaW4sIG1heCk7IC8vIE1vdmUgdGhlIHBvcG92ZXIgcG9zaXRpb25cblxuICAgICAgICBjb250YWluZXIuc3R5bGUubGVmdCA9IGAke2NsYW1wZWR9cHhgOyAvLyBUaGUgYXJyb3cgY2FuIGZvbGxvdyB0aGUgY3Vyc29yXG5cbiAgICAgICAgY29udGFpbmVyLnN0eWxlLnNldFByb3BlcnR5KCctLXByZXZpZXctYXJyb3ctb2Zmc2V0JywgYCR7cG9zaXRpb24gLSBjbGFtcGVkfXB4YCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJzZXRTY3J1YmJpbmdDb250YWluZXJTaXplXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgIGhlaWdodFxuICAgICAgICB9ID0gZml0UmF0aW8odGhpcy50aHVtYkFzcGVjdFJhdGlvLCB7XG4gICAgICAgICAgd2lkdGg6IHRoaXMucGxheWVyLm1lZGlhLmNsaWVudFdpZHRoLFxuICAgICAgICAgIGhlaWdodDogdGhpcy5wbGF5ZXIubWVkaWEuY2xpZW50SGVpZ2h0XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIuc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHtoZWlnaHR9cHhgO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwic2V0SW1hZ2VTaXplQW5kT2Zmc2V0XCIsIChwcmV2aWV3SW1hZ2UsIGZyYW1lKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy51c2luZ1Nwcml0ZXMpIHJldHVybjsgLy8gRmluZCBkaWZmZXJlbmNlIGJldHdlZW4gaGVpZ2h0IGFuZCBwcmV2aWV3IGNvbnRhaW5lciBoZWlnaHRcblxuICAgICAgICBjb25zdCBtdWx0aXBsaWVyID0gdGhpcy50aHVtYkNvbnRhaW5lckhlaWdodCAvIGZyYW1lLmg7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuXG4gICAgICAgIHByZXZpZXdJbWFnZS5zdHlsZS5oZWlnaHQgPSBgJHtwcmV2aWV3SW1hZ2UubmF0dXJhbEhlaWdodCAqIG11bHRpcGxpZXJ9cHhgOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cblxuICAgICAgICBwcmV2aWV3SW1hZ2Uuc3R5bGUud2lkdGggPSBgJHtwcmV2aWV3SW1hZ2UubmF0dXJhbFdpZHRoICogbXVsdGlwbGllcn1weGA7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuXG4gICAgICAgIHByZXZpZXdJbWFnZS5zdHlsZS5sZWZ0ID0gYC0ke2ZyYW1lLnggKiBtdWx0aXBsaWVyfXB4YDsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG5cbiAgICAgICAgcHJldmlld0ltYWdlLnN0eWxlLnRvcCA9IGAtJHtmcmFtZS55ICogbXVsdGlwbGllcn1weGA7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5wbGF5ZXIgPSBwbGF5ZXI7XG4gICAgICB0aGlzLnRodW1ibmFpbHMgPSBbXTtcbiAgICAgIHRoaXMubG9hZGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmxhc3RNb3VzZU1vdmVUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIHRoaXMubW91c2VEb3duID0gZmFsc2U7XG4gICAgICB0aGlzLmxvYWRlZEltYWdlcyA9IFtdO1xuICAgICAgdGhpcy5lbGVtZW50cyA9IHtcbiAgICAgICAgdGh1bWI6IHt9LFxuICAgICAgICBzY3J1YmJpbmc6IHt9XG4gICAgICB9O1xuICAgICAgdGhpcy5sb2FkKCk7XG4gICAgfVxuXG4gICAgZ2V0IGVuYWJsZWQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5wbGF5ZXIuaXNIVE1MNSAmJiB0aGlzLnBsYXllci5pc1ZpZGVvICYmIHRoaXMucGxheWVyLmNvbmZpZy5wcmV2aWV3VGh1bWJuYWlscy5lbmFibGVkO1xuICAgIH1cblxuICAgIGdldCBjdXJyZW50SW1hZ2VDb250YWluZXIoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tb3VzZURvd24gPyB0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIgOiB0aGlzLmVsZW1lbnRzLnRodW1iLmltYWdlQ29udGFpbmVyO1xuICAgIH1cblxuICAgIGdldCB1c2luZ1Nwcml0ZXMoKSB7XG4gICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy50aHVtYm5haWxzWzBdLmZyYW1lc1swXSkuaW5jbHVkZXMoJ3cnKTtcbiAgICB9XG5cbiAgICBnZXQgdGh1bWJBc3BlY3RSYXRpbygpIHtcbiAgICAgIGlmICh0aGlzLnVzaW5nU3ByaXRlcykge1xuICAgICAgICByZXR1cm4gdGhpcy50aHVtYm5haWxzWzBdLmZyYW1lc1swXS53IC8gdGhpcy50aHVtYm5haWxzWzBdLmZyYW1lc1swXS5oO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy50aHVtYm5haWxzWzBdLndpZHRoIC8gdGhpcy50aHVtYm5haWxzWzBdLmhlaWdodDtcbiAgICB9XG5cbiAgICBnZXQgdGh1bWJDb250YWluZXJIZWlnaHQoKSB7XG4gICAgICBpZiAodGhpcy5tb3VzZURvd24pIHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGhlaWdodFxuICAgICAgICB9ID0gZml0UmF0aW8odGhpcy50aHVtYkFzcGVjdFJhdGlvLCB7XG4gICAgICAgICAgd2lkdGg6IHRoaXMucGxheWVyLm1lZGlhLmNsaWVudFdpZHRoLFxuICAgICAgICAgIGhlaWdodDogdGhpcy5wbGF5ZXIubWVkaWEuY2xpZW50SGVpZ2h0XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaGVpZ2h0O1xuICAgICAgfSAvLyBJZiBjc3MgaXMgdXNlZCB0aGlzIG5lZWRzIHRvIHJldHVybiB0aGUgY3NzIGhlaWdodCBmb3Igc3ByaXRlcyB0byB3b3JrIChzZWUgc2V0SW1hZ2VTaXplQW5kT2Zmc2V0KVxuXG5cbiAgICAgIGlmICh0aGlzLnNpemVTcGVjaWZpZWRJbkNTUykge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lci5jbGllbnRIZWlnaHQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBNYXRoLmZsb29yKHRoaXMucGxheWVyLm1lZGlhLmNsaWVudFdpZHRoIC8gdGhpcy50aHVtYkFzcGVjdFJhdGlvIC8gNCk7XG4gICAgfVxuXG4gICAgZ2V0IGN1cnJlbnRJbWFnZUVsZW1lbnQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tb3VzZURvd24gPyB0aGlzLmN1cnJlbnRTY3J1YmJpbmdJbWFnZUVsZW1lbnQgOiB0aGlzLmN1cnJlbnRUaHVtYm5haWxJbWFnZUVsZW1lbnQ7XG4gICAgfVxuXG4gICAgc2V0IGN1cnJlbnRJbWFnZUVsZW1lbnQoZWxlbWVudCkge1xuICAgICAgaWYgKHRoaXMubW91c2VEb3duKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFNjcnViYmluZ0ltYWdlRWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmN1cnJlbnRUaHVtYm5haWxJbWFnZUVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgfVxuICAgIH1cblxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgY29uc3Qgc291cmNlID0ge1xuICAgIC8vIEFkZCBlbGVtZW50cyB0byBIVE1MNSBtZWRpYSAoc291cmNlLCB0cmFja3MsIGV0YylcbiAgICBpbnNlcnRFbGVtZW50cyh0eXBlLCBhdHRyaWJ1dGVzKSB7XG4gICAgICBpZiAoaXMuc3RyaW5nKGF0dHJpYnV0ZXMpKSB7XG4gICAgICAgIGluc2VydEVsZW1lbnQodHlwZSwgdGhpcy5tZWRpYSwge1xuICAgICAgICAgIHNyYzogYXR0cmlidXRlc1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoaXMuYXJyYXkoYXR0cmlidXRlcykpIHtcbiAgICAgICAgYXR0cmlidXRlcy5mb3JFYWNoKGF0dHJpYnV0ZSA9PiB7XG4gICAgICAgICAgaW5zZXJ0RWxlbWVudCh0eXBlLCB0aGlzLm1lZGlhLCBhdHRyaWJ1dGUpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgLy8gVXBkYXRlIHNvdXJjZVxuICAgIC8vIFNvdXJjZXMgYXJlIG5vdCBjaGVja2VkIGZvciBzdXBwb3J0IHNvIGJlIGNhcmVmdWxcbiAgICBjaGFuZ2UoaW5wdXQpIHtcbiAgICAgIGlmICghZ2V0RGVlcChpbnB1dCwgJ3NvdXJjZXMubGVuZ3RoJykpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdJbnZhbGlkIHNvdXJjZSBmb3JtYXQnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBDYW5jZWwgY3VycmVudCBuZXR3b3JrIHJlcXVlc3RzXG5cblxuICAgICAgaHRtbDUuY2FuY2VsUmVxdWVzdHMuY2FsbCh0aGlzKTsgLy8gRGVzdHJveSBpbnN0YW5jZSBhbmQgcmUtc2V0dXBcblxuICAgICAgdGhpcy5kZXN0cm95LmNhbGwodGhpcywgKCkgPT4ge1xuICAgICAgICAvLyBSZXNldCBxdWFsaXR5IG9wdGlvbnNcbiAgICAgICAgdGhpcy5vcHRpb25zLnF1YWxpdHkgPSBbXTsgLy8gUmVtb3ZlIGVsZW1lbnRzXG5cbiAgICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLm1lZGlhKTtcbiAgICAgICAgdGhpcy5tZWRpYSA9IG51bGw7IC8vIFJlc2V0IGNsYXNzIG5hbWVcblxuICAgICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcikpIHtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5yZW1vdmVBdHRyaWJ1dGUoJ2NsYXNzJyk7XG4gICAgICAgIH0gLy8gU2V0IHRoZSB0eXBlIGFuZCBwcm92aWRlclxuXG5cbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIHNvdXJjZXMsXG4gICAgICAgICAgdHlwZVxuICAgICAgICB9ID0gaW5wdXQ7XG4gICAgICAgIGNvbnN0IFt7XG4gICAgICAgICAgcHJvdmlkZXIgPSBwcm92aWRlcnMuaHRtbDUsXG4gICAgICAgICAgc3JjXG4gICAgICAgIH1dID0gc291cmNlcztcbiAgICAgICAgY29uc3QgdGFnTmFtZSA9IHByb3ZpZGVyID09PSAnaHRtbDUnID8gdHlwZSA6ICdkaXYnO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gcHJvdmlkZXIgPT09ICdodG1sNScgPyB7fSA6IHtcbiAgICAgICAgICBzcmNcbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCB7XG4gICAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICAgdHlwZSxcbiAgICAgICAgICAvLyBDaGVjayBmb3Igc3VwcG9ydFxuICAgICAgICAgIHN1cHBvcnRlZDogc3VwcG9ydC5jaGVjayh0eXBlLCBwcm92aWRlciwgdGhpcy5jb25maWcucGxheXNpbmxpbmUpLFxuICAgICAgICAgIC8vIENyZWF0ZSBuZXcgZWxlbWVudFxuICAgICAgICAgIG1lZGlhOiBjcmVhdGVFbGVtZW50KHRhZ05hbWUsIGF0dHJpYnV0ZXMpXG4gICAgICAgIH0pOyAvLyBJbmplY3QgdGhlIG5ldyBlbGVtZW50XG5cbiAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5tZWRpYSk7IC8vIEF1dG9wbGF5IHRoZSBuZXcgc291cmNlP1xuXG4gICAgICAgIGlmIChpcy5ib29sZWFuKGlucHV0LmF1dG9wbGF5KSkge1xuICAgICAgICAgIHRoaXMuY29uZmlnLmF1dG9wbGF5ID0gaW5wdXQuYXV0b3BsYXk7XG4gICAgICAgIH0gLy8gU2V0IGF0dHJpYnV0ZXMgZm9yIGF1ZGlvIGFuZCB2aWRlb1xuXG5cbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5jcm9zc29yaWdpbikge1xuICAgICAgICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ2Nyb3Nzb3JpZ2luJywgJycpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5hdXRvcGxheSkge1xuICAgICAgICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ2F1dG9wbGF5JywgJycpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghaXMuZW1wdHkoaW5wdXQucG9zdGVyKSkge1xuICAgICAgICAgICAgdGhpcy5wb3N0ZXIgPSBpbnB1dC5wb3N0ZXI7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmxvb3AuYWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnbG9vcCcsICcnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhpcy5jb25maWcubXV0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMubWVkaWEuc2V0QXR0cmlidXRlKCdtdXRlZCcsICcnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhpcy5jb25maWcucGxheXNpbmxpbmUpIHtcbiAgICAgICAgICAgIHRoaXMubWVkaWEuc2V0QXR0cmlidXRlKCdwbGF5c2lubGluZScsICcnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gLy8gUmVzdG9yZSBjbGFzcyBob29rXG5cblxuICAgICAgICB1aS5hZGRTdHlsZUhvb2suY2FsbCh0aGlzKTsgLy8gU2V0IG5ldyBzb3VyY2VzIGZvciBodG1sNVxuXG4gICAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgICBzb3VyY2UuaW5zZXJ0RWxlbWVudHMuY2FsbCh0aGlzLCAnc291cmNlJywgc291cmNlcyk7XG4gICAgICAgIH0gLy8gU2V0IHZpZGVvIHRpdGxlXG5cblxuICAgICAgICB0aGlzLmNvbmZpZy50aXRsZSA9IGlucHV0LnRpdGxlOyAvLyBTZXQgdXAgZnJvbSBzY3JhdGNoXG5cbiAgICAgICAgbWVkaWEuc2V0dXAuY2FsbCh0aGlzKTsgLy8gSFRNTDUgc3R1ZmZcblxuICAgICAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICAgICAgLy8gU2V0dXAgY2FwdGlvbnNcbiAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoaW5wdXQpLmluY2x1ZGVzKCd0cmFja3MnKSkge1xuICAgICAgICAgICAgc291cmNlLmluc2VydEVsZW1lbnRzLmNhbGwodGhpcywgJ3RyYWNrJywgaW5wdXQudHJhY2tzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gLy8gSWYgSFRNTDUgb3IgZW1iZWQgYnV0IG5vdCBmdWxseSBzdXBwb3J0ZWQsIHNldHVwSW50ZXJmYWNlIGFuZCBjYWxsIHJlYWR5IG5vd1xuXG5cbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSB8fCB0aGlzLmlzRW1iZWQgJiYgIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICAgICAgLy8gU2V0dXAgaW50ZXJmYWNlXG4gICAgICAgICAgdWkuYnVpbGQuY2FsbCh0aGlzKTtcbiAgICAgICAgfSAvLyBMb2FkIEhUTUw1IHNvdXJjZXNcblxuXG4gICAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgICB0aGlzLm1lZGlhLmxvYWQoKTtcbiAgICAgICAgfSAvLyBVcGRhdGUgcHJldmlld1RodW1ibmFpbHMgY29uZmlnICYgcmVsb2FkIHBsdWdpblxuXG5cbiAgICAgICAgaWYgKCFpcy5lbXB0eShpbnB1dC5wcmV2aWV3VGh1bWJuYWlscykpIHtcbiAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLCBpbnB1dC5wcmV2aWV3VGh1bWJuYWlscyk7IC8vIENsZWFudXAgcHJldmlld1RodW1ibmFpbHMgcGx1Z2luIGlmIGl0IHdhcyBsb2FkZWRcblxuICAgICAgICAgIGlmICh0aGlzLnByZXZpZXdUaHVtYm5haWxzICYmIHRoaXMucHJldmlld1RodW1ibmFpbHMubG9hZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnByZXZpZXdUaHVtYm5haWxzLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMgPSBudWxsO1xuICAgICAgICAgIH0gLy8gQ3JlYXRlIG5ldyBpbnN0YW5jZSBpZiBpdCBpcyBzdGlsbCBlbmFibGVkXG5cblxuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5wcmV2aWV3VGh1bWJuYWlscy5lbmFibGVkKSB7XG4gICAgICAgICAgICB0aGlzLnByZXZpZXdUaHVtYm5haWxzID0gbmV3IFByZXZpZXdUaHVtYm5haWxzKHRoaXMpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSAvLyBVcGRhdGUgdGhlIGZ1bGxzY3JlZW4gc3VwcG9ydFxuXG5cbiAgICAgICAgdGhpcy5mdWxsc2NyZWVuLnVwZGF0ZSgpO1xuICAgICAgfSwgdHJ1ZSk7XG4gICAgfVxuXG4gIH07XG5cbiAgLy8gVE9ETzogVXNlIGEgV2Vha01hcCBmb3IgcHJpdmF0ZSBnbG9iYWxzXG4gIC8vIGNvbnN0IGdsb2JhbHMgPSBuZXcgV2Vha01hcCgpO1xuICAvLyBQbHlyIGluc3RhbmNlXG5cbiAgY2xhc3MgUGx5ciB7XG4gICAgY29uc3RydWN0b3IodGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInBsYXlcIiwgKCkgPT4ge1xuICAgICAgICBpZiAoIWlzLmZ1bmN0aW9uKHRoaXMubWVkaWEucGxheSkpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSAvLyBJbnRlY2VwdCBwbGF5IHdpdGggYWRzXG5cblxuICAgICAgICBpZiAodGhpcy5hZHMgJiYgdGhpcy5hZHMuZW5hYmxlZCkge1xuICAgICAgICAgIHRoaXMuYWRzLm1hbmFnZXJQcm9taXNlLnRoZW4oKCkgPT4gdGhpcy5hZHMucGxheSgpKS5jYXRjaCgoKSA9PiBzaWxlbmNlUHJvbWlzZSh0aGlzLm1lZGlhLnBsYXkoKSkpO1xuICAgICAgICB9IC8vIFJldHVybiB0aGUgcHJvbWlzZSAoZm9yIEhUTUw1KVxuXG5cbiAgICAgICAgcmV0dXJuIHRoaXMubWVkaWEucGxheSgpO1xuICAgICAgfSk7XG5cbiAgICAgIF9kZWZpbmVQcm9wZXJ0eSQxKHRoaXMsIFwicGF1c2VcIiwgKCkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMucGxheWluZyB8fCAhaXMuZnVuY3Rpb24odGhpcy5tZWRpYS5wYXVzZSkpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLm1lZGlhLnBhdXNlKCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJ0b2dnbGVQbGF5XCIsIGlucHV0ID0+IHtcbiAgICAgICAgLy8gVG9nZ2xlIGJhc2VkIG9uIGN1cnJlbnQgc3RhdGUgaWYgbm90aGluZyBwYXNzZWRcbiAgICAgICAgY29uc3QgdG9nZ2xlID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6ICF0aGlzLnBsYXlpbmc7XG5cbiAgICAgICAgaWYgKHRvZ2dsZSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLnBsYXkoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLnBhdXNlKCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJzdG9wXCIsICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIHRoaXMucGF1c2UoKTtcbiAgICAgICAgICB0aGlzLnJlc3RhcnQoKTtcbiAgICAgICAgfSBlbHNlIGlmIChpcy5mdW5jdGlvbih0aGlzLm1lZGlhLnN0b3ApKSB7XG4gICAgICAgICAgdGhpcy5tZWRpYS5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInJlc3RhcnRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLmN1cnJlbnRUaW1lID0gMDtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInJld2luZFwiLCBzZWVrVGltZSA9PiB7XG4gICAgICAgIHRoaXMuY3VycmVudFRpbWUgLT0gaXMubnVtYmVyKHNlZWtUaW1lKSA/IHNlZWtUaW1lIDogdGhpcy5jb25maWcuc2Vla1RpbWU7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJmb3J3YXJkXCIsIHNlZWtUaW1lID0+IHtcbiAgICAgICAgdGhpcy5jdXJyZW50VGltZSArPSBpcy5udW1iZXIoc2Vla1RpbWUpID8gc2Vla1RpbWUgOiB0aGlzLmNvbmZpZy5zZWVrVGltZTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcImluY3JlYXNlVm9sdW1lXCIsIHN0ZXAgPT4ge1xuICAgICAgICBjb25zdCB2b2x1bWUgPSB0aGlzLm1lZGlhLm11dGVkID8gMCA6IHRoaXMudm9sdW1lO1xuICAgICAgICB0aGlzLnZvbHVtZSA9IHZvbHVtZSArIChpcy5udW1iZXIoc3RlcCkgPyBzdGVwIDogMCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJkZWNyZWFzZVZvbHVtZVwiLCBzdGVwID0+IHtcbiAgICAgICAgdGhpcy5pbmNyZWFzZVZvbHVtZSgtc3RlcCk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJhaXJwbGF5XCIsICgpID0+IHtcbiAgICAgICAgLy8gU2hvdyBkaWFsb2cgaWYgc3VwcG9ydGVkXG4gICAgICAgIGlmIChzdXBwb3J0LmFpcnBsYXkpIHtcbiAgICAgICAgICB0aGlzLm1lZGlhLndlYmtpdFNob3dQbGF5YmFja1RhcmdldFBpY2tlcigpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJ0b2dnbGVDb250cm9sc1wiLCB0b2dnbGUgPT4ge1xuICAgICAgICAvLyBEb24ndCB0b2dnbGUgaWYgbWlzc2luZyBVSSBzdXBwb3J0IG9yIGlmIGl0J3MgYXVkaW9cbiAgICAgICAgaWYgKHRoaXMuc3VwcG9ydGVkLnVpICYmICF0aGlzLmlzQXVkaW8pIHtcbiAgICAgICAgICAvLyBHZXQgc3RhdGUgYmVmb3JlIGNoYW5nZVxuICAgICAgICAgIGNvbnN0IGlzSGlkZGVuID0gaGFzQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaGlkZUNvbnRyb2xzKTsgLy8gTmVnYXRlIHRoZSBhcmd1bWVudCBpZiBub3QgdW5kZWZpbmVkIHNpbmNlIGFkZGluZyB0aGUgY2xhc3MgdG8gaGlkZXMgdGhlIGNvbnRyb2xzXG5cbiAgICAgICAgICBjb25zdCBmb3JjZSA9IHR5cGVvZiB0b2dnbGUgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogIXRvZ2dsZTsgLy8gQXBwbHkgYW5kIGdldCB1cGRhdGVkIHN0YXRlXG5cbiAgICAgICAgICBjb25zdCBoaWRpbmcgPSB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRlQ29udHJvbHMsIGZvcmNlKTsgLy8gQ2xvc2UgbWVudVxuXG4gICAgICAgICAgaWYgKGhpZGluZyAmJiBpcy5hcnJheSh0aGlzLmNvbmZpZy5jb250cm9scykgJiYgdGhpcy5jb25maWcuY29udHJvbHMuaW5jbHVkZXMoJ3NldHRpbmdzJykgJiYgIWlzLmVtcHR5KHRoaXMuY29uZmlnLnNldHRpbmdzKSkge1xuICAgICAgICAgICAgY29udHJvbHMudG9nZ2xlTWVudS5jYWxsKHRoaXMsIGZhbHNlKTtcbiAgICAgICAgICB9IC8vIFRyaWdnZXIgZXZlbnQgb24gY2hhbmdlXG5cblxuICAgICAgICAgIGlmIChoaWRpbmcgIT09IGlzSGlkZGVuKSB7XG4gICAgICAgICAgICBjb25zdCBldmVudE5hbWUgPSBoaWRpbmcgPyAnY29udHJvbHNoaWRkZW4nIDogJ2NvbnRyb2xzc2hvd24nO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcywgdGhpcy5tZWRpYSwgZXZlbnROYW1lKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gIWhpZGluZztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcIm9uXCIsIChldmVudCwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgb24uY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgZXZlbnQsIGNhbGxiYWNrKTtcbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcIm9uY2VcIiwgKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xuICAgICAgICBvbmNlLmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5jb250YWluZXIsIGV2ZW50LCBjYWxsYmFjayk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJvZmZcIiwgKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xuICAgICAgICBvZmYodGhpcy5lbGVtZW50cy5jb250YWluZXIsIGV2ZW50LCBjYWxsYmFjayk7XG4gICAgICB9KTtcblxuICAgICAgX2RlZmluZVByb3BlcnR5JDEodGhpcywgXCJkZXN0cm95XCIsIChjYWxsYmFjaywgc29mdCA9IGZhbHNlKSA9PiB7XG4gICAgICAgIGlmICghdGhpcy5yZWFkeSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRvbmUgPSAoKSA9PiB7XG4gICAgICAgICAgLy8gUmVzZXQgb3ZlcmZsb3cgKGluY2FzZSBkZXN0cm95ZWQgd2hpbGUgaW4gZnVsbHNjcmVlbilcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJyc7IC8vIEdDIGZvciBlbWJlZFxuXG4gICAgICAgICAgdGhpcy5lbWJlZCA9IG51bGw7IC8vIElmIGl0J3MgYSBzb2Z0IGRlc3Ryb3ksIG1ha2UgbWluaW1hbCBjaGFuZ2VzXG5cbiAgICAgICAgICBpZiAoc29mdCkge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuZWxlbWVudHMpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAvLyBSZW1vdmUgZWxlbWVudHNcbiAgICAgICAgICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLmVsZW1lbnRzLmJ1dHRvbnMucGxheSk7XG4gICAgICAgICAgICAgIHJlbW92ZUVsZW1lbnQodGhpcy5lbGVtZW50cy5jYXB0aW9ucyk7XG4gICAgICAgICAgICAgIHJlbW92ZUVsZW1lbnQodGhpcy5lbGVtZW50cy5jb250cm9scyk7XG4gICAgICAgICAgICAgIHJlbW92ZUVsZW1lbnQodGhpcy5lbGVtZW50cy53cmFwcGVyKTsgLy8gQ2xlYXIgZm9yIEdDXG5cbiAgICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5idXR0b25zLnBsYXkgPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmNhcHRpb25zID0gbnVsbDtcbiAgICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5jb250cm9scyA9IG51bGw7XG4gICAgICAgICAgICAgIHRoaXMuZWxlbWVudHMud3JhcHBlciA9IG51bGw7XG4gICAgICAgICAgICB9IC8vIENhbGxiYWNrXG5cblxuICAgICAgICAgICAgaWYgKGlzLmZ1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBVbmJpbmQgbGlzdGVuZXJzXG4gICAgICAgICAgICB1bmJpbmRMaXN0ZW5lcnMuY2FsbCh0aGlzKTsgLy8gQ2FuY2VsIGN1cnJlbnQgbmV0d29yayByZXF1ZXN0c1xuXG4gICAgICAgICAgICBodG1sNS5jYW5jZWxSZXF1ZXN0cy5jYWxsKHRoaXMpOyAvLyBSZXBsYWNlIHRoZSBjb250YWluZXIgd2l0aCB0aGUgb3JpZ2luYWwgZWxlbWVudCBwcm92aWRlZFxuXG4gICAgICAgICAgICByZXBsYWNlRWxlbWVudCh0aGlzLmVsZW1lbnRzLm9yaWdpbmFsLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcik7IC8vIEV2ZW50XG5cbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMub3JpZ2luYWwsICdkZXN0cm95ZWQnLCB0cnVlKTsgLy8gQ2FsbGJhY2tcblxuICAgICAgICAgICAgaWYgKGlzLmZ1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMuZWxlbWVudHMub3JpZ2luYWwpO1xuICAgICAgICAgICAgfSAvLyBSZXNldCBzdGF0ZVxuXG5cbiAgICAgICAgICAgIHRoaXMucmVhZHkgPSBmYWxzZTsgLy8gQ2xlYXIgZm9yIGdhcmJhZ2UgY29sbGVjdGlvblxuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5lbGVtZW50cyA9IG51bGw7XG4gICAgICAgICAgICAgIHRoaXMubWVkaWEgPSBudWxsO1xuICAgICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07IC8vIFN0b3AgcGxheWJhY2tcblxuXG4gICAgICAgIHRoaXMuc3RvcCgpOyAvLyBDbGVhciB0aW1lb3V0c1xuXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5sb2FkaW5nKTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmNvbnRyb2xzKTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnJlc2l6ZWQpOyAvLyBQcm92aWRlciBzcGVjaWZpYyBzdHVmZlxuXG4gICAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgICAvLyBSZXN0b3JlIG5hdGl2ZSB2aWRlbyBjb250cm9sc1xuICAgICAgICAgIHVpLnRvZ2dsZU5hdGl2ZUNvbnRyb2xzLmNhbGwodGhpcywgdHJ1ZSk7IC8vIENsZWFuIHVwXG5cbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1lvdVR1YmUpIHtcbiAgICAgICAgICAvLyBDbGVhciB0aW1lcnNcbiAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXJzLmJ1ZmZlcmluZyk7XG4gICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVycy5wbGF5aW5nKTsgLy8gRGVzdHJveSBZb3VUdWJlIEFQSVxuXG4gICAgICAgICAgaWYgKHRoaXMuZW1iZWQgIT09IG51bGwgJiYgaXMuZnVuY3Rpb24odGhpcy5lbWJlZC5kZXN0cm95KSkge1xuICAgICAgICAgICAgdGhpcy5lbWJlZC5kZXN0cm95KCk7XG4gICAgICAgICAgfSAvLyBDbGVhbiB1cFxuXG5cbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1ZpbWVvKSB7XG4gICAgICAgICAgLy8gRGVzdHJveSBWaW1lbyBBUElcbiAgICAgICAgICAvLyB0aGVuIGNsZWFuIHVwICh3YWl0LCB0byBwcmV2ZW50IHBvc3RtZXNzYWdlIGVycm9ycylcbiAgICAgICAgICBpZiAodGhpcy5lbWJlZCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5lbWJlZC51bmxvYWQoKS50aGVuKGRvbmUpO1xuICAgICAgICAgIH0gLy8gVmltZW8gZG9lcyBub3QgYWx3YXlzIHJldHVyblxuXG5cbiAgICAgICAgICBzZXRUaW1lb3V0KGRvbmUsIDIwMCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBfZGVmaW5lUHJvcGVydHkkMSh0aGlzLCBcInN1cHBvcnRzXCIsIHR5cGUgPT4gc3VwcG9ydC5taW1lLmNhbGwodGhpcywgdHlwZSkpO1xuXG4gICAgICB0aGlzLnRpbWVycyA9IHt9OyAvLyBTdGF0ZVxuXG4gICAgICB0aGlzLnJlYWR5ID0gZmFsc2U7XG4gICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuZmFpbGVkID0gZmFsc2U7IC8vIFRvdWNoIGRldmljZVxuXG4gICAgICB0aGlzLnRvdWNoID0gc3VwcG9ydC50b3VjaDsgLy8gU2V0IHRoZSBtZWRpYSBlbGVtZW50XG5cbiAgICAgIHRoaXMubWVkaWEgPSB0YXJnZXQ7IC8vIFN0cmluZyBzZWxlY3RvciBwYXNzZWRcblxuICAgICAgaWYgKGlzLnN0cmluZyh0aGlzLm1lZGlhKSkge1xuICAgICAgICB0aGlzLm1lZGlhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLm1lZGlhKTtcbiAgICAgIH0gLy8galF1ZXJ5LCBOb2RlTGlzdCBvciBBcnJheSBwYXNzZWQsIHVzZSBmaXJzdCBlbGVtZW50XG5cblxuICAgICAgaWYgKHdpbmRvdy5qUXVlcnkgJiYgdGhpcy5tZWRpYSBpbnN0YW5jZW9mIGpRdWVyeSB8fCBpcy5ub2RlTGlzdCh0aGlzLm1lZGlhKSB8fCBpcy5hcnJheSh0aGlzLm1lZGlhKSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICAgICAgdGhpcy5tZWRpYSA9IHRoaXMubWVkaWFbMF07XG4gICAgICB9IC8vIFNldCBjb25maWdcblxuXG4gICAgICB0aGlzLmNvbmZpZyA9IGV4dGVuZCh7fSwgZGVmYXVsdHMsIFBseXIuZGVmYXVsdHMsIG9wdGlvbnMgfHwge30sICgoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodGhpcy5tZWRpYS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGx5ci1jb25maWcnKSk7XG4gICAgICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICAgIH0pKCkpOyAvLyBFbGVtZW50cyBjYWNoZVxuXG4gICAgICB0aGlzLmVsZW1lbnRzID0ge1xuICAgICAgICBjb250YWluZXI6IG51bGwsXG4gICAgICAgIGZ1bGxzY3JlZW46IG51bGwsXG4gICAgICAgIGNhcHRpb25zOiBudWxsLFxuICAgICAgICBidXR0b25zOiB7fSxcbiAgICAgICAgZGlzcGxheToge30sXG4gICAgICAgIHByb2dyZXNzOiB7fSxcbiAgICAgICAgaW5wdXRzOiB7fSxcbiAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICBwb3B1cDogbnVsbCxcbiAgICAgICAgICBtZW51OiBudWxsLFxuICAgICAgICAgIHBhbmVsczoge30sXG4gICAgICAgICAgYnV0dG9uczoge31cbiAgICAgICAgfVxuICAgICAgfTsgLy8gQ2FwdGlvbnNcblxuICAgICAgdGhpcy5jYXB0aW9ucyA9IHtcbiAgICAgICAgYWN0aXZlOiBudWxsLFxuICAgICAgICBjdXJyZW50VHJhY2s6IC0xLFxuICAgICAgICBtZXRhOiBuZXcgV2Vha01hcCgpXG4gICAgICB9OyAvLyBGdWxsc2NyZWVuXG5cbiAgICAgIHRoaXMuZnVsbHNjcmVlbiA9IHtcbiAgICAgICAgYWN0aXZlOiBmYWxzZVxuICAgICAgfTsgLy8gT3B0aW9uc1xuXG4gICAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICAgIHNwZWVkOiBbXSxcbiAgICAgICAgcXVhbGl0eTogW11cbiAgICAgIH07IC8vIERlYnVnZ2luZ1xuICAgICAgLy8gVE9ETzogbW92ZSB0byBnbG9iYWxzXG5cbiAgICAgIHRoaXMuZGVidWcgPSBuZXcgQ29uc29sZSh0aGlzLmNvbmZpZy5kZWJ1Zyk7IC8vIExvZyBjb25maWcgb3B0aW9ucyBhbmQgc3VwcG9ydFxuXG4gICAgICB0aGlzLmRlYnVnLmxvZygnQ29uZmlnJywgdGhpcy5jb25maWcpO1xuICAgICAgdGhpcy5kZWJ1Zy5sb2coJ1N1cHBvcnQnLCBzdXBwb3J0KTsgLy8gV2UgbmVlZCBhbiBlbGVtZW50IHRvIHNldHVwXG5cbiAgICAgIGlmIChpcy5udWxsT3JVbmRlZmluZWQodGhpcy5tZWRpYSkgfHwgIWlzLmVsZW1lbnQodGhpcy5tZWRpYSkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiBubyBzdWl0YWJsZSBlbGVtZW50IHBhc3NlZCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIEJhaWwgaWYgdGhlIGVsZW1lbnQgaXMgaW5pdGlhbGl6ZWRcblxuXG4gICAgICBpZiAodGhpcy5tZWRpYS5wbHlyKSB7XG4gICAgICAgIHRoaXMuZGVidWcud2FybignVGFyZ2V0IGFscmVhZHkgc2V0dXAnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBCYWlsIGlmIG5vdCBlbmFibGVkXG5cblxuICAgICAgaWYgKCF0aGlzLmNvbmZpZy5lbmFibGVkKSB7XG4gICAgICAgIHRoaXMuZGVidWcuZXJyb3IoJ1NldHVwIGZhaWxlZDogZGlzYWJsZWQgYnkgY29uZmlnJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gQmFpbCBpZiBkaXNhYmxlZCBvciBubyBiYXNpYyBzdXBwb3J0XG4gICAgICAvLyBZb3UgbWF5IHdhbnQgdG8gZGlzYWJsZSBjZXJ0YWluIFVBcyBldGNcblxuXG4gICAgICBpZiAoIXN1cHBvcnQuY2hlY2soKS5hcGkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiBubyBzdXBwb3J0Jyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gLy8gQ2FjaGUgb3JpZ2luYWwgZWxlbWVudCBzdGF0ZSBmb3IgLmRlc3Ryb3koKVxuXG5cbiAgICAgIGNvbnN0IGNsb25lID0gdGhpcy5tZWRpYS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICBjbG9uZS5hdXRvcGxheSA9IGZhbHNlO1xuICAgICAgdGhpcy5lbGVtZW50cy5vcmlnaW5hbCA9IGNsb25lOyAvLyBTZXQgbWVkaWEgdHlwZSBiYXNlZCBvbiB0YWcgb3IgZGF0YSBhdHRyaWJ1dGVcbiAgICAgIC8vIFN1cHBvcnRlZDogdmlkZW8sIGF1ZGlvLCB2aW1lbywgeW91dHViZVxuXG4gICAgICBjb25zdCBfdHlwZSA9IHRoaXMubWVkaWEudGFnTmFtZS50b0xvd2VyQ2FzZSgpOyAvLyBFbWJlZCBwcm9wZXJ0aWVzXG5cblxuICAgICAgbGV0IGlmcmFtZSA9IG51bGw7XG4gICAgICBsZXQgdXJsID0gbnVsbDsgLy8gRGlmZmVyZW50IHNldHVwIGJhc2VkIG9uIHR5cGVcblxuICAgICAgc3dpdGNoIChfdHlwZSkge1xuICAgICAgICBjYXNlICdkaXYnOlxuICAgICAgICAgIC8vIEZpbmQgdGhlIGZyYW1lXG4gICAgICAgICAgaWZyYW1lID0gdGhpcy5tZWRpYS5xdWVyeVNlbGVjdG9yKCdpZnJhbWUnKTsgLy8gPGlmcmFtZT4gdHlwZVxuXG4gICAgICAgICAgaWYgKGlzLmVsZW1lbnQoaWZyYW1lKSkge1xuICAgICAgICAgICAgLy8gRGV0ZWN0IHByb3ZpZGVyXG4gICAgICAgICAgICB1cmwgPSBwYXJzZVVybChpZnJhbWUuZ2V0QXR0cmlidXRlKCdzcmMnKSk7XG4gICAgICAgICAgICB0aGlzLnByb3ZpZGVyID0gZ2V0UHJvdmlkZXJCeVVybCh1cmwudG9TdHJpbmcoKSk7IC8vIFJld29yayBlbGVtZW50c1xuXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciA9IHRoaXMubWVkaWE7XG4gICAgICAgICAgICB0aGlzLm1lZGlhID0gaWZyYW1lOyAvLyBSZXNldCBjbGFzc25hbWVcblxuICAgICAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuY2xhc3NOYW1lID0gJyc7IC8vIEdldCBhdHRyaWJ1dGVzIGZyb20gVVJMIGFuZCBzZXQgY29uZmlnXG5cbiAgICAgICAgICAgIGlmICh1cmwuc2VhcmNoLmxlbmd0aCkge1xuICAgICAgICAgICAgICBjb25zdCB0cnV0aHkgPSBbJzEnLCAndHJ1ZSddO1xuXG4gICAgICAgICAgICAgIGlmICh0cnV0aHkuaW5jbHVkZXModXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2F1dG9wbGF5JykpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcuYXV0b3BsYXkgPSB0cnVlO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKHRydXRoeS5pbmNsdWRlcyh1cmwuc2VhcmNoUGFyYW1zLmdldCgnbG9vcCcpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfSAvLyBUT0RPOiByZXBsYWNlIGZ1bGxzY3JlZW4uaW9zTmF0aXZlIHdpdGggdGhpcyBwbGF5c2lubGluZSBjb25maWcgb3B0aW9uXG4gICAgICAgICAgICAgIC8vIFlvdVR1YmUgcmVxdWlyZXMgdGhlIHBsYXlzaW5saW5lIGluIHRoZSBVUkxcblxuXG4gICAgICAgICAgICAgIGlmICh0aGlzLmlzWW91VHViZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLnBsYXlzaW5saW5lID0gdHJ1dGh5LmluY2x1ZGVzKHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdwbGF5c2lubGluZScpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy55b3V0dWJlLmhsID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2hsJyk7IC8vIFRPRE86IFNob3VsZCB0aGlzIGJlIHNldHRpbmcgbGFuZ3VhZ2U/XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcucGxheXNpbmxpbmUgPSB0cnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIDxkaXY+IHdpdGggYXR0cmlidXRlc1xuICAgICAgICAgICAgdGhpcy5wcm92aWRlciA9IHRoaXMubWVkaWEuZ2V0QXR0cmlidXRlKHRoaXMuY29uZmlnLmF0dHJpYnV0ZXMuZW1iZWQucHJvdmlkZXIpOyAvLyBSZW1vdmUgYXR0cmlidXRlXG5cbiAgICAgICAgICAgIHRoaXMubWVkaWEucmVtb3ZlQXR0cmlidXRlKHRoaXMuY29uZmlnLmF0dHJpYnV0ZXMuZW1iZWQucHJvdmlkZXIpO1xuICAgICAgICAgIH0gLy8gVW5zdXBwb3J0ZWQgb3IgbWlzc2luZyBwcm92aWRlclxuXG5cbiAgICAgICAgICBpZiAoaXMuZW1wdHkodGhpcy5wcm92aWRlcikgfHwgIU9iamVjdC52YWx1ZXMocHJvdmlkZXJzKS5pbmNsdWRlcyh0aGlzLnByb3ZpZGVyKSkge1xuICAgICAgICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiBJbnZhbGlkIHByb3ZpZGVyJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSAvLyBBdWRpbyB3aWxsIGNvbWUgbGF0ZXIgZm9yIGV4dGVybmFsIHByb3ZpZGVyc1xuXG5cbiAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlcy52aWRlbztcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICd2aWRlbyc6XG4gICAgICAgIGNhc2UgJ2F1ZGlvJzpcbiAgICAgICAgICB0aGlzLnR5cGUgPSBfdHlwZTtcbiAgICAgICAgICB0aGlzLnByb3ZpZGVyID0gcHJvdmlkZXJzLmh0bWw1OyAvLyBHZXQgY29uZmlnIGZyb20gYXR0cmlidXRlc1xuXG4gICAgICAgICAgaWYgKHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCdjcm9zc29yaWdpbicpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5jcm9zc29yaWdpbiA9IHRydWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCdhdXRvcGxheScpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5hdXRvcGxheSA9IHRydWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCdwbGF5c2lubGluZScpIHx8IHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCd3ZWJraXQtcGxheXNpbmxpbmUnKSkge1xuICAgICAgICAgICAgdGhpcy5jb25maWcucGxheXNpbmxpbmUgPSB0cnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLm1lZGlhLmhhc0F0dHJpYnV0ZSgnbXV0ZWQnKSkge1xuICAgICAgICAgICAgdGhpcy5jb25maWcubXV0ZWQgPSB0cnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICh0aGlzLm1lZGlhLmhhc0F0dHJpYnV0ZSgnbG9vcCcpKSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aGlzLmRlYnVnLmVycm9yKCdTZXR1cCBmYWlsZWQ6IHVuc3VwcG9ydGVkIHR5cGUnKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIENoZWNrIGZvciBzdXBwb3J0IGFnYWluIGJ1dCB3aXRoIHR5cGVcblxuXG4gICAgICB0aGlzLnN1cHBvcnRlZCA9IHN1cHBvcnQuY2hlY2sodGhpcy50eXBlLCB0aGlzLnByb3ZpZGVyLCB0aGlzLmNvbmZpZy5wbGF5c2lubGluZSk7IC8vIElmIG5vIHN1cHBvcnQgZm9yIGV2ZW4gQVBJLCBiYWlsXG5cbiAgICAgIGlmICghdGhpcy5zdXBwb3J0ZWQuYXBpKSB7XG4gICAgICAgIHRoaXMuZGVidWcuZXJyb3IoJ1NldHVwIGZhaWxlZDogbm8gc3VwcG9ydCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMgPSBbXTsgLy8gQ3JlYXRlIGxpc3RlbmVyc1xuXG4gICAgICB0aGlzLmxpc3RlbmVycyA9IG5ldyBMaXN0ZW5lcnModGhpcyk7IC8vIFNldHVwIGxvY2FsIHN0b3JhZ2UgZm9yIHVzZXIgc2V0dGluZ3NcblxuICAgICAgdGhpcy5zdG9yYWdlID0gbmV3IFN0b3JhZ2UodGhpcyk7IC8vIFN0b3JlIHJlZmVyZW5jZVxuXG4gICAgICB0aGlzLm1lZGlhLnBseXIgPSB0aGlzOyAvLyBXcmFwIG1lZGlhXG5cbiAgICAgIGlmICghaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcikpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgdGFiaW5kZXg6IDBcbiAgICAgICAgfSk7XG4gICAgICAgIHdyYXAodGhpcy5tZWRpYSwgdGhpcy5lbGVtZW50cy5jb250YWluZXIpO1xuICAgICAgfSAvLyBNaWdyYXRlIGN1c3RvbSBwcm9wZXJ0aWVzIGZyb20gbWVkaWEgdG8gY29udGFpbmVyIChzbyB0aGV5IHdvcmsg8J+YiSlcblxuXG4gICAgICB1aS5taWdyYXRlU3R5bGVzLmNhbGwodGhpcyk7IC8vIEFkZCBzdHlsZSBob29rXG5cbiAgICAgIHVpLmFkZFN0eWxlSG9vay5jYWxsKHRoaXMpOyAvLyBTZXR1cCBtZWRpYVxuXG4gICAgICBtZWRpYS5zZXR1cC5jYWxsKHRoaXMpOyAvLyBMaXN0ZW4gZm9yIGV2ZW50cyBpZiBkZWJ1Z2dpbmdcblxuICAgICAgaWYgKHRoaXMuY29uZmlnLmRlYnVnKSB7XG4gICAgICAgIG9uLmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmV2ZW50cy5qb2luKCcgJyksIGV2ZW50ID0+IHtcbiAgICAgICAgICB0aGlzLmRlYnVnLmxvZyhgZXZlbnQ6ICR7ZXZlbnQudHlwZX1gKTtcbiAgICAgICAgfSk7XG4gICAgICB9IC8vIFNldHVwIGZ1bGxzY3JlZW5cblxuXG4gICAgICB0aGlzLmZ1bGxzY3JlZW4gPSBuZXcgRnVsbHNjcmVlbih0aGlzKTsgLy8gU2V0dXAgaW50ZXJmYWNlXG4gICAgICAvLyBJZiBlbWJlZCBidXQgbm90IGZ1bGx5IHN1cHBvcnRlZCwgYnVpbGQgaW50ZXJmYWNlIG5vdyB0byBhdm9pZCBmbGFzaCBvZiBjb250cm9sc1xuXG4gICAgICBpZiAodGhpcy5pc0hUTUw1IHx8IHRoaXMuaXNFbWJlZCAmJiAhdGhpcy5zdXBwb3J0ZWQudWkpIHtcbiAgICAgICAgdWkuYnVpbGQuY2FsbCh0aGlzKTtcbiAgICAgIH0gLy8gQ29udGFpbmVyIGxpc3RlbmVyc1xuXG5cbiAgICAgIHRoaXMubGlzdGVuZXJzLmNvbnRhaW5lcigpOyAvLyBHbG9iYWwgbGlzdGVuZXJzXG5cbiAgICAgIHRoaXMubGlzdGVuZXJzLmdsb2JhbCgpOyAvLyBTZXR1cCBhZHMgaWYgcHJvdmlkZWRcblxuICAgICAgaWYgKHRoaXMuY29uZmlnLmFkcy5lbmFibGVkKSB7XG4gICAgICAgIHRoaXMuYWRzID0gbmV3IEFkcyh0aGlzKTtcbiAgICAgIH0gLy8gQXV0b3BsYXkgaWYgcmVxdWlyZWRcblxuXG4gICAgICBpZiAodGhpcy5pc0hUTUw1ICYmIHRoaXMuY29uZmlnLmF1dG9wbGF5KSB7XG4gICAgICAgIHRoaXMub25jZSgnY2FucGxheScsICgpID0+IHNpbGVuY2VQcm9taXNlKHRoaXMucGxheSgpKSk7XG4gICAgICB9IC8vIFNlZWsgdGltZSB3aWxsIGJlIHJlY29yZGVkIChpbiBsaXN0ZW5lcnMuanMpIHNvIHdlIGNhbiBwcmV2ZW50IGhpZGluZyBjb250cm9scyBmb3IgYSBmZXcgc2Vjb25kcyBhZnRlciBzZWVrXG5cblxuICAgICAgdGhpcy5sYXN0U2Vla1RpbWUgPSAwOyAvLyBTZXR1cCBwcmV2aWV3IHRodW1ibmFpbHMgaWYgZW5hYmxlZFxuXG4gICAgICBpZiAodGhpcy5jb25maWcucHJldmlld1RodW1ibmFpbHMuZW5hYmxlZCkge1xuICAgICAgICB0aGlzLnByZXZpZXdUaHVtYm5haWxzID0gbmV3IFByZXZpZXdUaHVtYm5haWxzKHRoaXMpO1xuICAgICAgfVxuICAgIH0gLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQVBJXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBUeXBlcyBhbmQgcHJvdmlkZXIgaGVscGVyc1xuICAgICAqL1xuXG5cbiAgICBnZXQgaXNIVE1MNSgpIHtcbiAgICAgIHJldHVybiB0aGlzLnByb3ZpZGVyID09PSBwcm92aWRlcnMuaHRtbDU7XG4gICAgfVxuXG4gICAgZ2V0IGlzRW1iZWQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5pc1lvdVR1YmUgfHwgdGhpcy5pc1ZpbWVvO1xuICAgIH1cblxuICAgIGdldCBpc1lvdVR1YmUoKSB7XG4gICAgICByZXR1cm4gdGhpcy5wcm92aWRlciA9PT0gcHJvdmlkZXJzLnlvdXR1YmU7XG4gICAgfVxuXG4gICAgZ2V0IGlzVmltZW8oKSB7XG4gICAgICByZXR1cm4gdGhpcy5wcm92aWRlciA9PT0gcHJvdmlkZXJzLnZpbWVvO1xuICAgIH1cblxuICAgIGdldCBpc1ZpZGVvKCkge1xuICAgICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gdHlwZXMudmlkZW87XG4gICAgfVxuXG4gICAgZ2V0IGlzQXVkaW8oKSB7XG4gICAgICByZXR1cm4gdGhpcy50eXBlID09PSB0eXBlcy5hdWRpbztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGxheSB0aGUgbWVkaWEsIG9yIHBsYXkgdGhlIGFkdmVydGlzZW1lbnQgKGlmIHRoZXkgYXJlIG5vdCBibG9ja2VkKVxuICAgICAqL1xuXG5cbiAgICAvKipcbiAgICAgKiBHZXQgcGxheWluZyBzdGF0ZVxuICAgICAqL1xuICAgIGdldCBwbGF5aW5nKCkge1xuICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5yZWFkeSAmJiAhdGhpcy5wYXVzZWQgJiYgIXRoaXMuZW5kZWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgcGF1c2VkIHN0YXRlXG4gICAgICovXG5cblxuICAgIGdldCBwYXVzZWQoKSB7XG4gICAgICByZXR1cm4gQm9vbGVhbih0aGlzLm1lZGlhLnBhdXNlZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBzdG9wcGVkIHN0YXRlXG4gICAgICovXG5cblxuICAgIGdldCBzdG9wcGVkKCkge1xuICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5wYXVzZWQgJiYgdGhpcy5jdXJyZW50VGltZSA9PT0gMCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBlbmRlZCBzdGF0ZVxuICAgICAqL1xuXG5cbiAgICBnZXQgZW5kZWQoKSB7XG4gICAgICByZXR1cm4gQm9vbGVhbih0aGlzLm1lZGlhLmVuZGVkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlIHBsYXliYWNrIGJhc2VkIG9uIGN1cnJlbnQgc3RhdHVzXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpbnB1dFxuICAgICAqL1xuXG5cbiAgICAvKipcbiAgICAgKiBTZWVrIHRvIGEgdGltZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbnB1dCAtIHdoZXJlIHRvIHNlZWsgdG8gaW4gc2Vjb25kcy4gRGVmYXVsdHMgdG8gMCAodGhlIHN0YXJ0KVxuICAgICAqL1xuICAgIHNldCBjdXJyZW50VGltZShpbnB1dCkge1xuICAgICAgLy8gQmFpbCBpZiBtZWRpYSBkdXJhdGlvbiBpc24ndCBhdmFpbGFibGUgeWV0XG4gICAgICBpZiAoIXRoaXMuZHVyYXRpb24pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBWYWxpZGF0ZSBpbnB1dFxuXG5cbiAgICAgIGNvbnN0IGlucHV0SXNWYWxpZCA9IGlzLm51bWJlcihpbnB1dCkgJiYgaW5wdXQgPiAwOyAvLyBTZXRcblxuICAgICAgdGhpcy5tZWRpYS5jdXJyZW50VGltZSA9IGlucHV0SXNWYWxpZCA/IE1hdGgubWluKGlucHV0LCB0aGlzLmR1cmF0aW9uKSA6IDA7IC8vIExvZ2dpbmdcblxuICAgICAgdGhpcy5kZWJ1Zy5sb2coYFNlZWtpbmcgdG8gJHt0aGlzLmN1cnJlbnRUaW1lfSBzZWNvbmRzYCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBjdXJyZW50IHRpbWVcbiAgICAgKi9cblxuXG4gICAgZ2V0IGN1cnJlbnRUaW1lKCkge1xuICAgICAgcmV0dXJuIE51bWJlcih0aGlzLm1lZGlhLmN1cnJlbnRUaW1lKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGJ1ZmZlcmVkXG4gICAgICovXG5cblxuICAgIGdldCBidWZmZXJlZCgpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgYnVmZmVyZWRcbiAgICAgIH0gPSB0aGlzLm1lZGlhOyAvLyBZb3VUdWJlIC8gVmltZW8gcmV0dXJuIGEgZmxvYXQgYmV0d2VlbiAwLTFcblxuICAgICAgaWYgKGlzLm51bWJlcihidWZmZXJlZCkpIHtcbiAgICAgICAgcmV0dXJuIGJ1ZmZlcmVkO1xuICAgICAgfSAvLyBIVE1MNVxuICAgICAgLy8gVE9ETzogSGFuZGxlIGJ1ZmZlcmVkIGNodW5rcyBvZiB0aGUgbWVkaWFcbiAgICAgIC8vIChpLmUuIHNlZWsgdG8gYW5vdGhlciBzZWN0aW9uIGJ1ZmZlcnMgb25seSB0aGF0IHNlY3Rpb24pXG5cblxuICAgICAgaWYgKGJ1ZmZlcmVkICYmIGJ1ZmZlcmVkLmxlbmd0aCAmJiB0aGlzLmR1cmF0aW9uID4gMCkge1xuICAgICAgICByZXR1cm4gYnVmZmVyZWQuZW5kKDApIC8gdGhpcy5kdXJhdGlvbjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBzZWVraW5nIHN0YXR1c1xuICAgICAqL1xuXG5cbiAgICBnZXQgc2Vla2luZygpIHtcbiAgICAgIHJldHVybiBCb29sZWFuKHRoaXMubWVkaWEuc2Vla2luZyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgZHVyYXRpb24gb2YgdGhlIGN1cnJlbnQgbWVkaWFcbiAgICAgKi9cblxuXG4gICAgZ2V0IGR1cmF0aW9uKCkge1xuICAgICAgLy8gRmF1eCBkdXJhdGlvbiBzZXQgdmlhIGNvbmZpZ1xuICAgICAgY29uc3QgZmF1eER1cmF0aW9uID0gcGFyc2VGbG9hdCh0aGlzLmNvbmZpZy5kdXJhdGlvbik7IC8vIE1lZGlhIGR1cmF0aW9uIGNhbiBiZSBOYU4gb3IgSW5maW5pdHkgYmVmb3JlIHRoZSBtZWRpYSBoYXMgbG9hZGVkXG5cbiAgICAgIGNvbnN0IHJlYWxEdXJhdGlvbiA9ICh0aGlzLm1lZGlhIHx8IHt9KS5kdXJhdGlvbjtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gIWlzLm51bWJlcihyZWFsRHVyYXRpb24pIHx8IHJlYWxEdXJhdGlvbiA9PT0gSW5maW5pdHkgPyAwIDogcmVhbER1cmF0aW9uOyAvLyBJZiBjb25maWcgZHVyYXRpb24gaXMgZnVua3ksIHVzZSByZWd1bGFyIGR1cmF0aW9uXG5cbiAgICAgIHJldHVybiBmYXV4RHVyYXRpb24gfHwgZHVyYXRpb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgcGxheWVyIHZvbHVtZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSB2YWx1ZSAtIG11c3QgYmUgYmV0d2VlbiAwIGFuZCAxLiBEZWZhdWx0cyB0byB0aGUgdmFsdWUgZnJvbSBsb2NhbCBzdG9yYWdlIGFuZCBjb25maWcudm9sdW1lIGlmIG5vdCBzZXQgaW4gc3RvcmFnZVxuICAgICAqL1xuXG5cbiAgICBzZXQgdm9sdW1lKHZhbHVlKSB7XG4gICAgICBsZXQgdm9sdW1lID0gdmFsdWU7XG4gICAgICBjb25zdCBtYXggPSAxO1xuICAgICAgY29uc3QgbWluID0gMDtcblxuICAgICAgaWYgKGlzLnN0cmluZyh2b2x1bWUpKSB7XG4gICAgICAgIHZvbHVtZSA9IE51bWJlcih2b2x1bWUpO1xuICAgICAgfSAvLyBMb2FkIHZvbHVtZSBmcm9tIHN0b3JhZ2UgaWYgbm8gdmFsdWUgc3BlY2lmaWVkXG5cblxuICAgICAgaWYgKCFpcy5udW1iZXIodm9sdW1lKSkge1xuICAgICAgICB2b2x1bWUgPSB0aGlzLnN0b3JhZ2UuZ2V0KCd2b2x1bWUnKTtcbiAgICAgIH0gLy8gVXNlIGNvbmZpZyBpZiBhbGwgZWxzZSBmYWlsc1xuXG5cbiAgICAgIGlmICghaXMubnVtYmVyKHZvbHVtZSkpIHtcbiAgICAgICAgKHtcbiAgICAgICAgICB2b2x1bWVcbiAgICAgICAgfSA9IHRoaXMuY29uZmlnKTtcbiAgICAgIH0gLy8gTWF4aW11bSBpcyB2b2x1bWVNYXhcblxuXG4gICAgICBpZiAodm9sdW1lID4gbWF4KSB7XG4gICAgICAgIHZvbHVtZSA9IG1heDtcbiAgICAgIH0gLy8gTWluaW11bSBpcyB2b2x1bWVNaW5cblxuXG4gICAgICBpZiAodm9sdW1lIDwgbWluKSB7XG4gICAgICAgIHZvbHVtZSA9IG1pbjtcbiAgICAgIH0gLy8gVXBkYXRlIGNvbmZpZ1xuXG5cbiAgICAgIHRoaXMuY29uZmlnLnZvbHVtZSA9IHZvbHVtZTsgLy8gU2V0IHRoZSBwbGF5ZXIgdm9sdW1lXG5cbiAgICAgIHRoaXMubWVkaWEudm9sdW1lID0gdm9sdW1lOyAvLyBJZiBtdXRlZCwgYW5kIHdlJ3JlIGluY3JlYXNpbmcgdm9sdW1lIG1hbnVhbGx5LCByZXNldCBtdXRlZCBzdGF0ZVxuXG4gICAgICBpZiAoIWlzLmVtcHR5KHZhbHVlKSAmJiB0aGlzLm11dGVkICYmIHZvbHVtZSA+IDApIHtcbiAgICAgICAgdGhpcy5tdXRlZCA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcGxheWVyIHZvbHVtZVxuICAgICAqL1xuXG5cbiAgICBnZXQgdm9sdW1lKCkge1xuICAgICAgcmV0dXJuIE51bWJlcih0aGlzLm1lZGlhLnZvbHVtZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluY3JlYXNlIHZvbHVtZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gc3RlcCAtIEhvdyBtdWNoIHRvIGRlY3JlYXNlIGJ5IChiZXR3ZWVuIDAgYW5kIDEpXG4gICAgICovXG5cblxuICAgIC8qKlxuICAgICAqIFNldCBtdXRlZCBzdGF0ZVxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gbXV0ZVxuICAgICAqL1xuICAgIHNldCBtdXRlZChtdXRlKSB7XG4gICAgICBsZXQgdG9nZ2xlID0gbXV0ZTsgLy8gTG9hZCBtdXRlZCBzdGF0ZSBmcm9tIHN0b3JhZ2VcblxuICAgICAgaWYgKCFpcy5ib29sZWFuKHRvZ2dsZSkpIHtcbiAgICAgICAgdG9nZ2xlID0gdGhpcy5zdG9yYWdlLmdldCgnbXV0ZWQnKTtcbiAgICAgIH0gLy8gVXNlIGNvbmZpZyBpZiBhbGwgZWxzZSBmYWlsc1xuXG5cbiAgICAgIGlmICghaXMuYm9vbGVhbih0b2dnbGUpKSB7XG4gICAgICAgIHRvZ2dsZSA9IHRoaXMuY29uZmlnLm11dGVkO1xuICAgICAgfSAvLyBVcGRhdGUgY29uZmlnXG5cblxuICAgICAgdGhpcy5jb25maWcubXV0ZWQgPSB0b2dnbGU7IC8vIFNldCBtdXRlIG9uIHRoZSBwbGF5ZXJcblxuICAgICAgdGhpcy5tZWRpYS5tdXRlZCA9IHRvZ2dsZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgbXV0ZWQgc3RhdGVcbiAgICAgKi9cblxuXG4gICAgZ2V0IG11dGVkKCkge1xuICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5tZWRpYS5tdXRlZCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIHRoZSBtZWRpYSBoYXMgYXVkaW9cbiAgICAgKi9cblxuXG4gICAgZ2V0IGhhc0F1ZGlvKCkge1xuICAgICAgLy8gQXNzdW1lIHllcyBmb3IgYWxsIG5vbiBIVE1MNSAoYXMgd2UgY2FuJ3QgdGVsbC4uLilcbiAgICAgIGlmICghdGhpcy5pc0hUTUw1KSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5pc0F1ZGlvKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSAvLyBHZXQgYXVkaW8gdHJhY2tzXG5cblxuICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5tZWRpYS5tb3pIYXNBdWRpbykgfHwgQm9vbGVhbih0aGlzLm1lZGlhLndlYmtpdEF1ZGlvRGVjb2RlZEJ5dGVDb3VudCkgfHwgQm9vbGVhbih0aGlzLm1lZGlhLmF1ZGlvVHJhY2tzICYmIHRoaXMubWVkaWEuYXVkaW9UcmFja3MubGVuZ3RoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHBsYXliYWNrIHNwZWVkXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0IC0gdGhlIHNwZWVkIG9mIHBsYXliYWNrICgwLjUtMi4wKVxuICAgICAqL1xuXG5cbiAgICBzZXQgc3BlZWQoaW5wdXQpIHtcbiAgICAgIGxldCBzcGVlZCA9IG51bGw7XG5cbiAgICAgIGlmIChpcy5udW1iZXIoaW5wdXQpKSB7XG4gICAgICAgIHNwZWVkID0gaW5wdXQ7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXMubnVtYmVyKHNwZWVkKSkge1xuICAgICAgICBzcGVlZCA9IHRoaXMuc3RvcmFnZS5nZXQoJ3NwZWVkJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXMubnVtYmVyKHNwZWVkKSkge1xuICAgICAgICBzcGVlZCA9IHRoaXMuY29uZmlnLnNwZWVkLnNlbGVjdGVkO1xuICAgICAgfSAvLyBDbGFtcCB0byBtaW4vbWF4XG5cblxuICAgICAgY29uc3Qge1xuICAgICAgICBtaW5pbXVtU3BlZWQ6IG1pbixcbiAgICAgICAgbWF4aW11bVNwZWVkOiBtYXhcbiAgICAgIH0gPSB0aGlzO1xuICAgICAgc3BlZWQgPSBjbGFtcChzcGVlZCwgbWluLCBtYXgpOyAvLyBVcGRhdGUgY29uZmlnXG5cbiAgICAgIHRoaXMuY29uZmlnLnNwZWVkLnNlbGVjdGVkID0gc3BlZWQ7IC8vIFNldCBtZWRpYSBzcGVlZFxuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMubWVkaWEpIHtcbiAgICAgICAgICB0aGlzLm1lZGlhLnBsYXliYWNrUmF0ZSA9IHNwZWVkO1xuICAgICAgICB9XG4gICAgICB9LCAwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgcGxheWJhY2sgc3BlZWRcbiAgICAgKi9cblxuXG4gICAgZ2V0IHNwZWVkKCkge1xuICAgICAgcmV0dXJuIE51bWJlcih0aGlzLm1lZGlhLnBsYXliYWNrUmF0ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbWluaW11bSBhbGxvd2VkIHNwZWVkXG4gICAgICovXG5cblxuICAgIGdldCBtaW5pbXVtU3BlZWQoKSB7XG4gICAgICBpZiAodGhpcy5pc1lvdVR1YmUpIHtcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20veW91dHViZS9pZnJhbWVfYXBpX3JlZmVyZW5jZSNzZXRQbGF5YmFja1JhdGVcbiAgICAgICAgcmV0dXJuIE1hdGgubWluKC4uLnRoaXMub3B0aW9ucy5zcGVlZCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmlzVmltZW8pIHtcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3ZpbWVvL3BsYXllci5qcy8jc2V0cGxheWJhY2tyYXRlcGxheWJhY2tyYXRlLW51bWJlci1wcm9taXNlbnVtYmVyLXJhbmdlZXJyb3JlcnJvclxuICAgICAgICByZXR1cm4gMC41O1xuICAgICAgfSAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzIzMjAwMjAvMTE5MTMxOVxuXG5cbiAgICAgIHJldHVybiAwLjA2MjU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgbWF4aW11bSBhbGxvd2VkIHNwZWVkXG4gICAgICovXG5cblxuICAgIGdldCBtYXhpbXVtU3BlZWQoKSB7XG4gICAgICBpZiAodGhpcy5pc1lvdVR1YmUpIHtcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20veW91dHViZS9pZnJhbWVfYXBpX3JlZmVyZW5jZSNzZXRQbGF5YmFja1JhdGVcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KC4uLnRoaXMub3B0aW9ucy5zcGVlZCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmlzVmltZW8pIHtcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3ZpbWVvL3BsYXllci5qcy8jc2V0cGxheWJhY2tyYXRlcGxheWJhY2tyYXRlLW51bWJlci1wcm9taXNlbnVtYmVyLXJhbmdlZXJyb3JlcnJvclxuICAgICAgICByZXR1cm4gMjtcbiAgICAgIH0gLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzMyMzIwMDIwLzExOTEzMTlcblxuXG4gICAgICByZXR1cm4gMTY7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCBwbGF5YmFjayBxdWFsaXR5XG4gICAgICogQ3VycmVudGx5IEhUTUw1ICYgWW91VHViZSBvbmx5XG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0IC0gUXVhbGl0eSBsZXZlbFxuICAgICAqL1xuXG5cbiAgICBzZXQgcXVhbGl0eShpbnB1dCkge1xuICAgICAgY29uc3QgY29uZmlnID0gdGhpcy5jb25maWcucXVhbGl0eTtcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMucXVhbGl0eTtcblxuICAgICAgaWYgKCFvcHRpb25zLmxlbmd0aCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxldCBxdWFsaXR5ID0gWyFpcy5lbXB0eShpbnB1dCkgJiYgTnVtYmVyKGlucHV0KSwgdGhpcy5zdG9yYWdlLmdldCgncXVhbGl0eScpLCBjb25maWcuc2VsZWN0ZWQsIGNvbmZpZy5kZWZhdWx0XS5maW5kKGlzLm51bWJlcik7XG4gICAgICBsZXQgdXBkYXRlU3RvcmFnZSA9IHRydWU7XG5cbiAgICAgIGlmICghb3B0aW9ucy5pbmNsdWRlcyhxdWFsaXR5KSkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGNsb3Nlc3Qob3B0aW9ucywgcXVhbGl0eSk7XG4gICAgICAgIHRoaXMuZGVidWcud2FybihgVW5zdXBwb3J0ZWQgcXVhbGl0eSBvcHRpb246ICR7cXVhbGl0eX0sIHVzaW5nICR7dmFsdWV9IGluc3RlYWRgKTtcbiAgICAgICAgcXVhbGl0eSA9IHZhbHVlOyAvLyBEb24ndCB1cGRhdGUgc3RvcmFnZSBpZiBxdWFsaXR5IGlzIG5vdCBzdXBwb3J0ZWRcblxuICAgICAgICB1cGRhdGVTdG9yYWdlID0gZmFsc2U7XG4gICAgICB9IC8vIFVwZGF0ZSBjb25maWdcblxuXG4gICAgICBjb25maWcuc2VsZWN0ZWQgPSBxdWFsaXR5OyAvLyBTZXQgcXVhbGl0eVxuXG4gICAgICB0aGlzLm1lZGlhLnF1YWxpdHkgPSBxdWFsaXR5OyAvLyBTYXZlIHRvIHN0b3JhZ2VcblxuICAgICAgaWYgKHVwZGF0ZVN0b3JhZ2UpIHtcbiAgICAgICAgdGhpcy5zdG9yYWdlLnNldCh7XG4gICAgICAgICAgcXVhbGl0eVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgcXVhbGl0eSBsZXZlbFxuICAgICAqL1xuXG5cbiAgICBnZXQgcXVhbGl0eSgpIHtcbiAgICAgIHJldHVybiB0aGlzLm1lZGlhLnF1YWxpdHk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRvZ2dsZSBsb29wXG4gICAgICogVE9ETzogRmluaXNoIGZhbmN5IG5ldyBsb2dpYy4gU2V0IHRoZSBpbmRpY2F0b3Igb24gbG9hZCBhcyB1c2VyIG1heSBwYXNzIGxvb3AgYXMgY29uZmlnXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpbnB1dCAtIFdoZXRoZXIgdG8gbG9vcCBvciBub3RcbiAgICAgKi9cblxuXG4gICAgc2V0IGxvb3AoaW5wdXQpIHtcbiAgICAgIGNvbnN0IHRvZ2dsZSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiB0aGlzLmNvbmZpZy5sb29wLmFjdGl2ZTtcbiAgICAgIHRoaXMuY29uZmlnLmxvb3AuYWN0aXZlID0gdG9nZ2xlO1xuICAgICAgdGhpcy5tZWRpYS5sb29wID0gdG9nZ2xlOyAvLyBTZXQgZGVmYXVsdCB0byBiZSBhIHRydWUgdG9nZ2xlXG5cbiAgICAgIC8qIGNvbnN0IHR5cGUgPSBbJ3N0YXJ0JywgJ2VuZCcsICdhbGwnLCAnbm9uZScsICd0b2dnbGUnXS5pbmNsdWRlcyhpbnB1dCkgPyBpbnB1dCA6ICd0b2dnbGUnO1xuICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgICAgY2FzZSAnc3RhcnQnOlxuICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmxvb3AuZW5kICYmIHRoaXMuY29uZmlnLmxvb3AuZW5kIDw9IHRoaXMuY3VycmVudFRpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmVuZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID0gdGhpcy5jdXJyZW50VGltZTtcbiAgICAgICAgICAgICAgICAgIC8vIHRoaXMuY29uZmlnLmxvb3AuaW5kaWNhdG9yLnN0YXJ0ID0gdGhpcy5lbGVtZW50cy5kaXNwbGF5LnBsYXllZC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgY2FzZSAnZW5kJzpcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID49IHRoaXMuY3VycmVudFRpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gdGhpcy5jdXJyZW50VGltZTtcbiAgICAgICAgICAgICAgICAgIC8vIHRoaXMuY29uZmlnLmxvb3AuaW5kaWNhdG9yLmVuZCA9IHRoaXMuZWxlbWVudHMuZGlzcGxheS5wbGF5ZWQudmFsdWU7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgIGNhc2UgJ2FsbCc6XG4gICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gdGhpcy5kdXJhdGlvbiAtIDI7XG4gICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmluZGljYXRvci5zdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmluZGljYXRvci5lbmQgPSAxMDA7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgIGNhc2UgJ3RvZ2dsZSc6XG4gICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb25maWcubG9vcC5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmVuZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3Auc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gdGhpcy5kdXJhdGlvbiAtIDI7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH0gKi9cbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgbG9vcCBzdGF0ZVxuICAgICAqL1xuXG5cbiAgICBnZXQgbG9vcCgpIHtcbiAgICAgIHJldHVybiBCb29sZWFuKHRoaXMubWVkaWEubG9vcCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCBuZXcgbWVkaWEgc291cmNlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGlucHV0IC0gVGhlIG5ldyBzb3VyY2Ugb2JqZWN0IChzZWUgZG9jcylcbiAgICAgKi9cblxuXG4gICAgc2V0IHNvdXJjZShpbnB1dCkge1xuICAgICAgc291cmNlLmNoYW5nZS5jYWxsKHRoaXMsIGlucHV0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGN1cnJlbnQgc291cmNlXG4gICAgICovXG5cblxuICAgIGdldCBzb3VyY2UoKSB7XG4gICAgICByZXR1cm4gdGhpcy5tZWRpYS5jdXJyZW50U3JjO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgYSBkb3dubG9hZCBVUkwgKGVpdGhlciBzb3VyY2Ugb3IgY3VzdG9tKVxuICAgICAqL1xuXG5cbiAgICBnZXQgZG93bmxvYWQoKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGRvd25sb2FkXG4gICAgICB9ID0gdGhpcy5jb25maWcudXJscztcbiAgICAgIHJldHVybiBpcy51cmwoZG93bmxvYWQpID8gZG93bmxvYWQgOiB0aGlzLnNvdXJjZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBkb3dubG9hZCBVUkxcbiAgICAgKi9cblxuXG4gICAgc2V0IGRvd25sb2FkKGlucHV0KSB7XG4gICAgICBpZiAoIWlzLnVybChpbnB1dCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmNvbmZpZy51cmxzLmRvd25sb2FkID0gaW5wdXQ7XG4gICAgICBjb250cm9scy5zZXREb3dubG9hZFVybC5jYWxsKHRoaXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIHBvc3RlciBpbWFnZSBmb3IgYSB2aWRlb1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCAtIHRoZSBVUkwgZm9yIHRoZSBuZXcgcG9zdGVyIGltYWdlXG4gICAgICovXG5cblxuICAgIHNldCBwb3N0ZXIoaW5wdXQpIHtcbiAgICAgIGlmICghdGhpcy5pc1ZpZGVvKSB7XG4gICAgICAgIHRoaXMuZGVidWcud2FybignUG9zdGVyIGNhbiBvbmx5IGJlIHNldCBmb3IgdmlkZW8nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB1aS5zZXRQb3N0ZXIuY2FsbCh0aGlzLCBpbnB1dCwgZmFsc2UpLmNhdGNoKCgpID0+IHt9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IHBvc3RlciBpbWFnZVxuICAgICAqL1xuXG5cbiAgICBnZXQgcG9zdGVyKCkge1xuICAgICAgaWYgKCF0aGlzLmlzVmlkZW8pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLm1lZGlhLmdldEF0dHJpYnV0ZSgncG9zdGVyJykgfHwgdGhpcy5tZWRpYS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcG9zdGVyJyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBhc3BlY3QgcmF0aW8gaW4gdXNlXG4gICAgICovXG5cblxuICAgIGdldCByYXRpbygpIHtcbiAgICAgIGlmICghdGhpcy5pc1ZpZGVvKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByYXRpbyA9IHJlZHVjZUFzcGVjdFJhdGlvKGdldEFzcGVjdFJhdGlvLmNhbGwodGhpcykpO1xuICAgICAgcmV0dXJuIGlzLmFycmF5KHJhdGlvKSA/IHJhdGlvLmpvaW4oJzonKSA6IHJhdGlvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdmlkZW8gYXNwZWN0IHJhdGlvXG4gICAgICovXG5cblxuICAgIHNldCByYXRpbyhpbnB1dCkge1xuICAgICAgaWYgKCF0aGlzLmlzVmlkZW8pIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdBc3BlY3QgcmF0aW8gY2FuIG9ubHkgYmUgc2V0IGZvciB2aWRlbycpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICghaXMuc3RyaW5nKGlucHV0KSB8fCAhdmFsaWRhdGVBc3BlY3RSYXRpbyhpbnB1dCkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy5lcnJvcihgSW52YWxpZCBhc3BlY3QgcmF0aW8gc3BlY2lmaWVkICgke2lucHV0fSlgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmNvbmZpZy5yYXRpbyA9IHJlZHVjZUFzcGVjdFJhdGlvKGlucHV0KTtcbiAgICAgIHNldEFzcGVjdFJhdGlvLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgYXV0b3BsYXkgc3RhdGVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlucHV0IC0gV2hldGhlciB0byBhdXRvcGxheSBvciBub3RcbiAgICAgKi9cblxuXG4gICAgc2V0IGF1dG9wbGF5KGlucHV0KSB7XG4gICAgICB0aGlzLmNvbmZpZy5hdXRvcGxheSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiB0aGlzLmNvbmZpZy5hdXRvcGxheTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IGF1dG9wbGF5IHN0YXRlXG4gICAgICovXG5cblxuICAgIGdldCBhdXRvcGxheSgpIHtcbiAgICAgIHJldHVybiBCb29sZWFuKHRoaXMuY29uZmlnLmF1dG9wbGF5KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlIGNhcHRpb25zXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpbnB1dCAtIFdoZXRoZXIgdG8gZW5hYmxlIGNhcHRpb25zXG4gICAgICovXG5cblxuICAgIHRvZ2dsZUNhcHRpb25zKGlucHV0KSB7XG4gICAgICBjYXB0aW9ucy50b2dnbGUuY2FsbCh0aGlzLCBpbnB1dCwgZmFsc2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGNhcHRpb24gdHJhY2sgYnkgaW5kZXhcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gaW5wdXQgLSBDYXB0aW9uIGluZGV4XG4gICAgICovXG5cblxuICAgIHNldCBjdXJyZW50VHJhY2soaW5wdXQpIHtcbiAgICAgIGNhcHRpb25zLnNldC5jYWxsKHRoaXMsIGlucHV0LCBmYWxzZSk7XG4gICAgICBjYXB0aW9ucy5zZXR1cC5jYWxsKHRoaXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgY2FwdGlvbiB0cmFjayBpbmRleCAoLTEgaWYgZGlzYWJsZWQpXG4gICAgICovXG5cblxuICAgIGdldCBjdXJyZW50VHJhY2soKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHRvZ2dsZWQsXG4gICAgICAgIGN1cnJlbnRUcmFja1xuICAgICAgfSA9IHRoaXMuY2FwdGlvbnM7XG4gICAgICByZXR1cm4gdG9nZ2xlZCA/IGN1cnJlbnRUcmFjayA6IC0xO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIHdhbnRlZCBsYW5ndWFnZSBmb3IgY2FwdGlvbnNcbiAgICAgKiBTaW5jZSB0cmFja3MgY2FuIGJlIGFkZGVkIGxhdGVyIGl0IHdvbid0IHVwZGF0ZSB0aGUgYWN0dWFsIGNhcHRpb24gdHJhY2sgdW50aWwgdGhlcmUgaXMgYSBtYXRjaGluZyB0cmFja1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCAtIFR3byBjaGFyYWN0ZXIgSVNPIGxhbmd1YWdlIGNvZGUgKGUuZy4gRU4sIEZSLCBQVCwgZXRjKVxuICAgICAqL1xuXG5cbiAgICBzZXQgbGFuZ3VhZ2UoaW5wdXQpIHtcbiAgICAgIGNhcHRpb25zLnNldExhbmd1YWdlLmNhbGwodGhpcywgaW5wdXQsIGZhbHNlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBjdXJyZW50IHRyYWNrJ3MgbGFuZ3VhZ2VcbiAgICAgKi9cblxuXG4gICAgZ2V0IGxhbmd1YWdlKCkge1xuICAgICAgcmV0dXJuIChjYXB0aW9ucy5nZXRDdXJyZW50VHJhY2suY2FsbCh0aGlzKSB8fCB7fSkubGFuZ3VhZ2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRvZ2dsZSBwaWN0dXJlLWluLXBpY3R1cmUgcGxheWJhY2sgb24gV2ViS2l0L01hY09TXG4gICAgICogVE9ETzogdXBkYXRlIHBsYXllciB3aXRoIHN0YXRlLCBzdXBwb3J0LCBlbmFibGVkXG4gICAgICogVE9ETzogZGV0ZWN0IG91dHNpZGUgY2hhbmdlc1xuICAgICAqL1xuXG5cbiAgICBzZXQgcGlwKGlucHV0KSB7XG4gICAgICAvLyBCYWlsIGlmIG5vIHN1cHBvcnRcbiAgICAgIGlmICghc3VwcG9ydC5waXApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSAvLyBUb2dnbGUgYmFzZWQgb24gY3VycmVudCBzdGF0ZSBpZiBub3QgcGFzc2VkXG5cblxuICAgICAgY29uc3QgdG9nZ2xlID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6ICF0aGlzLnBpcDsgLy8gVG9nZ2xlIGJhc2VkIG9uIGN1cnJlbnQgc3RhdGVcbiAgICAgIC8vIFNhZmFyaVxuXG4gICAgICBpZiAoaXMuZnVuY3Rpb24odGhpcy5tZWRpYS53ZWJraXRTZXRQcmVzZW50YXRpb25Nb2RlKSkge1xuICAgICAgICB0aGlzLm1lZGlhLndlYmtpdFNldFByZXNlbnRhdGlvbk1vZGUodG9nZ2xlID8gcGlwLmFjdGl2ZSA6IHBpcC5pbmFjdGl2ZSk7XG4gICAgICB9IC8vIENocm9tZVxuXG5cbiAgICAgIGlmIChpcy5mdW5jdGlvbih0aGlzLm1lZGlhLnJlcXVlc3RQaWN0dXJlSW5QaWN0dXJlKSkge1xuICAgICAgICBpZiAoIXRoaXMucGlwICYmIHRvZ2dsZSkge1xuICAgICAgICAgIHRoaXMubWVkaWEucmVxdWVzdFBpY3R1cmVJblBpY3R1cmUoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBpcCAmJiAhdG9nZ2xlKSB7XG4gICAgICAgICAgZG9jdW1lbnQuZXhpdFBpY3R1cmVJblBpY3R1cmUoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgcGljdHVyZS1pbi1waWN0dXJlIHN0YXRlXG4gICAgICovXG5cblxuICAgIGdldCBwaXAoKSB7XG4gICAgICBpZiAoIXN1cHBvcnQucGlwKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSAvLyBTYWZhcmlcblxuXG4gICAgICBpZiAoIWlzLmVtcHR5KHRoaXMubWVkaWEud2Via2l0UHJlc2VudGF0aW9uTW9kZSkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWVkaWEud2Via2l0UHJlc2VudGF0aW9uTW9kZSA9PT0gcGlwLmFjdGl2ZTtcbiAgICAgIH0gLy8gQ2hyb21lXG5cblxuICAgICAgcmV0dXJuIHRoaXMubWVkaWEgPT09IGRvY3VtZW50LnBpY3R1cmVJblBpY3R1cmVFbGVtZW50O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBwcmV2aWV3IHRodWJtbmFpbHMgZm9yIHRoZSBjdXJyZW50IHNvdXJjZVxuICAgICAqL1xuXG5cbiAgICBzZXRQcmV2aWV3VGh1bWJuYWlscyh0aHVtYm5haWxTb3VyY2UpIHtcbiAgICAgIGlmICh0aGlzLnByZXZpZXdUaHVtYm5haWxzICYmIHRoaXMucHJldmlld1RodW1ibmFpbHMubG9hZGVkKSB7XG4gICAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnByZXZpZXdUaHVtYm5haWxzID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmNvbmZpZy5wcmV2aWV3VGh1bWJuYWlscywgdGh1bWJuYWlsU291cmNlKTsgLy8gQ3JlYXRlIG5ldyBpbnN0YW5jZSBpZiBpdCBpcyBzdGlsbCBlbmFibGVkXG5cbiAgICAgIGlmICh0aGlzLmNvbmZpZy5wcmV2aWV3VGh1bWJuYWlscy5lbmFibGVkKSB7XG4gICAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMgPSBuZXcgUHJldmlld1RodW1ibmFpbHModGhpcyk7XG4gICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRyaWdnZXIgdGhlIGFpcnBsYXkgZGlhbG9nXG4gICAgICogVE9ETzogdXBkYXRlIHBsYXllciB3aXRoIHN0YXRlLCBzdXBwb3J0LCBlbmFibGVkXG4gICAgICovXG5cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGZvciBzdXBwb3J0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgLSBQbGF5ZXIgdHlwZSAoYXVkaW8vdmlkZW8pXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHByb3ZpZGVyIC0gUHJvdmlkZXIgKGh0bWw1L3lvdXR1YmUvdmltZW8pXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBpbmxpbmUgLSBXaGVyZSBwbGF5ZXIgaGFzIGBwbGF5c2lubGluZWAgc3R0cmlidXRlXG4gICAgICovXG4gICAgc3RhdGljIHN1cHBvcnRlZCh0eXBlLCBwcm92aWRlciwgaW5saW5lKSB7XG4gICAgICByZXR1cm4gc3VwcG9ydC5jaGVjayh0eXBlLCBwcm92aWRlciwgaW5saW5lKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9hZCBhbiBTVkcgc3ByaXRlIGludG8gdGhlIHBhZ2VcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIC0gVVJMIGZvciB0aGUgU1ZHIHNwcml0ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbaWRdIC0gVW5pcXVlIElEXG4gICAgICovXG5cblxuICAgIHN0YXRpYyBsb2FkU3ByaXRlKHVybCwgaWQpIHtcbiAgICAgIHJldHVybiBsb2FkU3ByaXRlKHVybCwgaWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXR1cCBtdWx0aXBsZSBpbnN0YW5jZXNcbiAgICAgKiBAcGFyYW0geyp9IHNlbGVjdG9yXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcbiAgICAgKi9cblxuXG4gICAgc3RhdGljIHNldHVwKHNlbGVjdG9yLCBvcHRpb25zID0ge30pIHtcbiAgICAgIGxldCB0YXJnZXRzID0gbnVsbDtcblxuICAgICAgaWYgKGlzLnN0cmluZyhzZWxlY3RvcikpIHtcbiAgICAgICAgdGFyZ2V0cyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpO1xuICAgICAgfSBlbHNlIGlmIChpcy5ub2RlTGlzdChzZWxlY3RvcikpIHtcbiAgICAgICAgdGFyZ2V0cyA9IEFycmF5LmZyb20oc2VsZWN0b3IpO1xuICAgICAgfSBlbHNlIGlmIChpcy5hcnJheShzZWxlY3RvcikpIHtcbiAgICAgICAgdGFyZ2V0cyA9IHNlbGVjdG9yLmZpbHRlcihpcy5lbGVtZW50KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzLmVtcHR5KHRhcmdldHMpKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGFyZ2V0cy5tYXAodCA9PiBuZXcgUGx5cih0LCBvcHRpb25zKSk7XG4gICAgfVxuXG4gIH1cblxuICBQbHlyLmRlZmF1bHRzID0gY2xvbmVEZWVwKGRlZmF1bHRzKTtcblxuICByZXR1cm4gUGx5cjtcblxufSkpO1xuIiwiZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGUsdCl7aWYoIShlIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX1mdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyhlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXt2YXIgcj10W25dO3IuZW51bWVyYWJsZT1yLmVudW1lcmFibGV8fCExLHIuY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIHImJihyLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxyLmtleSxyKX19ZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKGUsdCxuKXtyZXR1cm4gdCYmX2RlZmluZVByb3BlcnRpZXMoZS5wcm90b3R5cGUsdCksbiYmX2RlZmluZVByb3BlcnRpZXMoZSxuKSxlfWZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShlLHQsbil7cmV0dXJuIHQgaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTpuLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1uLGV9ZnVuY3Rpb24gb3duS2V5cyhlLHQpe3ZhciBuPU9iamVjdC5rZXlzKGUpO2lmKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7dCYmKHI9ci5maWx0ZXIoKGZ1bmN0aW9uKHQpe3JldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsdCkuZW51bWVyYWJsZX0pKSksbi5wdXNoLmFwcGx5KG4scil9cmV0dXJuIG59ZnVuY3Rpb24gX29iamVjdFNwcmVhZDIoZSl7Zm9yKHZhciB0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyl7dmFyIG49bnVsbCE9YXJndW1lbnRzW3RdP2FyZ3VtZW50c1t0XTp7fTt0JTI/b3duS2V5cyhPYmplY3QobiksITApLmZvckVhY2goKGZ1bmN0aW9uKHQpe19kZWZpbmVQcm9wZXJ0eShlLHQsblt0XSl9KSk6T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnM/T2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSxPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhuKSk6b3duS2V5cyhPYmplY3QobikpLmZvckVhY2goKGZ1bmN0aW9uKHQpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLHQpKX0pKX1yZXR1cm4gZX12YXIgZGVmYXVsdHM9e2FkZENTUzohMCx0aHVtYldpZHRoOjE1LHdhdGNoOiEwfTtmdW5jdGlvbiBtYXRjaGVzKGUsdCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0KSkuaW5jbHVkZXModGhpcyl9LmNhbGwoZSx0KX1mdW5jdGlvbiB0cmlnZ2VyKGUsdCl7aWYoZSYmdCl7dmFyIG49bmV3IEV2ZW50KHQse2J1YmJsZXM6ITB9KTtlLmRpc3BhdGNoRXZlbnQobil9fXZhciBnZXRDb25zdHJ1Y3Rvcj1mdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZT9lLmNvbnN0cnVjdG9yOm51bGx9LGluc3RhbmNlT2Y9ZnVuY3Rpb24oZSx0KXtyZXR1cm4hIShlJiZ0JiZlIGluc3RhbmNlb2YgdCl9LGlzTnVsbE9yVW5kZWZpbmVkPWZ1bmN0aW9uKGUpe3JldHVybiBudWxsPT1lfSxpc09iamVjdD1mdW5jdGlvbihlKXtyZXR1cm4gZ2V0Q29uc3RydWN0b3IoZSk9PT1PYmplY3R9LGlzTnVtYmVyPWZ1bmN0aW9uKGUpe3JldHVybiBnZXRDb25zdHJ1Y3RvcihlKT09PU51bWJlciYmIU51bWJlci5pc05hTihlKX0saXNTdHJpbmc9ZnVuY3Rpb24oZSl7cmV0dXJuIGdldENvbnN0cnVjdG9yKGUpPT09U3RyaW5nfSxpc0Jvb2xlYW49ZnVuY3Rpb24oZSl7cmV0dXJuIGdldENvbnN0cnVjdG9yKGUpPT09Qm9vbGVhbn0saXNGdW5jdGlvbj1mdW5jdGlvbihlKXtyZXR1cm4gZ2V0Q29uc3RydWN0b3IoZSk9PT1GdW5jdGlvbn0saXNBcnJheT1mdW5jdGlvbihlKXtyZXR1cm4gQXJyYXkuaXNBcnJheShlKX0saXNOb2RlTGlzdD1mdW5jdGlvbihlKXtyZXR1cm4gaW5zdGFuY2VPZihlLE5vZGVMaXN0KX0saXNFbGVtZW50PWZ1bmN0aW9uKGUpe3JldHVybiBpbnN0YW5jZU9mKGUsRWxlbWVudCl9LGlzRXZlbnQ9ZnVuY3Rpb24oZSl7cmV0dXJuIGluc3RhbmNlT2YoZSxFdmVudCl9LGlzRW1wdHk9ZnVuY3Rpb24oZSl7cmV0dXJuIGlzTnVsbE9yVW5kZWZpbmVkKGUpfHwoaXNTdHJpbmcoZSl8fGlzQXJyYXkoZSl8fGlzTm9kZUxpc3QoZSkpJiYhZS5sZW5ndGh8fGlzT2JqZWN0KGUpJiYhT2JqZWN0LmtleXMoZSkubGVuZ3RofSxpcz17bnVsbE9yVW5kZWZpbmVkOmlzTnVsbE9yVW5kZWZpbmVkLG9iamVjdDppc09iamVjdCxudW1iZXI6aXNOdW1iZXIsc3RyaW5nOmlzU3RyaW5nLGJvb2xlYW46aXNCb29sZWFuLGZ1bmN0aW9uOmlzRnVuY3Rpb24sYXJyYXk6aXNBcnJheSxub2RlTGlzdDppc05vZGVMaXN0LGVsZW1lbnQ6aXNFbGVtZW50LGV2ZW50OmlzRXZlbnQsZW1wdHk6aXNFbXB0eX07ZnVuY3Rpb24gZ2V0RGVjaW1hbFBsYWNlcyhlKXt2YXIgdD1cIlwiLmNvbmNhdChlKS5tYXRjaCgvKD86XFwuKFxcZCspKT8oPzpbZUVdKFsrLV0/XFxkKykpPyQvKTtyZXR1cm4gdD9NYXRoLm1heCgwLCh0WzFdP3RbMV0ubGVuZ3RoOjApLSh0WzJdPyt0WzJdOjApKTowfWZ1bmN0aW9uIHJvdW5kKGUsdCl7aWYoMT50KXt2YXIgbj1nZXREZWNpbWFsUGxhY2VzKHQpO3JldHVybiBwYXJzZUZsb2F0KGUudG9GaXhlZChuKSl9cmV0dXJuIE1hdGgucm91bmQoZS90KSp0fXZhciBSYW5nZVRvdWNoPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4pe19jbGFzc0NhbGxDaGVjayh0aGlzLGUpLGlzLmVsZW1lbnQodCk/dGhpcy5lbGVtZW50PXQ6aXMuc3RyaW5nKHQpJiYodGhpcy5lbGVtZW50PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodCkpLGlzLmVsZW1lbnQodGhpcy5lbGVtZW50KSYmaXMuZW1wdHkodGhpcy5lbGVtZW50LnJhbmdlVG91Y2gpJiYodGhpcy5jb25maWc9X29iamVjdFNwcmVhZDIoe30sZGVmYXVsdHMse30sbiksdGhpcy5pbml0KCkpfXJldHVybiBfY3JlYXRlQ2xhc3MoZSxbe2tleTpcImluaXRcIix2YWx1ZTpmdW5jdGlvbigpe2UuZW5hYmxlZCYmKHRoaXMuY29uZmlnLmFkZENTUyYmKHRoaXMuZWxlbWVudC5zdHlsZS51c2VyU2VsZWN0PVwibm9uZVwiLHRoaXMuZWxlbWVudC5zdHlsZS53ZWJLaXRVc2VyU2VsZWN0PVwibm9uZVwiLHRoaXMuZWxlbWVudC5zdHlsZS50b3VjaEFjdGlvbj1cIm1hbmlwdWxhdGlvblwiKSx0aGlzLmxpc3RlbmVycyghMCksdGhpcy5lbGVtZW50LnJhbmdlVG91Y2g9dGhpcyl9fSx7a2V5OlwiZGVzdHJveVwiLHZhbHVlOmZ1bmN0aW9uKCl7ZS5lbmFibGVkJiYodGhpcy5jb25maWcuYWRkQ1NTJiYodGhpcy5lbGVtZW50LnN0eWxlLnVzZXJTZWxlY3Q9XCJcIix0aGlzLmVsZW1lbnQuc3R5bGUud2ViS2l0VXNlclNlbGVjdD1cIlwiLHRoaXMuZWxlbWVudC5zdHlsZS50b3VjaEFjdGlvbj1cIlwiKSx0aGlzLmxpc3RlbmVycyghMSksdGhpcy5lbGVtZW50LnJhbmdlVG91Y2g9bnVsbCl9fSx7a2V5OlwibGlzdGVuZXJzXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcyxuPWU/XCJhZGRFdmVudExpc3RlbmVyXCI6XCJyZW1vdmVFdmVudExpc3RlbmVyXCI7W1widG91Y2hzdGFydFwiLFwidG91Y2htb3ZlXCIsXCJ0b3VjaGVuZFwiXS5mb3JFYWNoKChmdW5jdGlvbihlKXt0LmVsZW1lbnRbbl0oZSwoZnVuY3Rpb24oZSl7cmV0dXJuIHQuc2V0KGUpfSksITEpfSkpfX0se2tleTpcImdldFwiLHZhbHVlOmZ1bmN0aW9uKHQpe2lmKCFlLmVuYWJsZWR8fCFpcy5ldmVudCh0KSlyZXR1cm4gbnVsbDt2YXIgbixyPXQudGFyZ2V0LGk9dC5jaGFuZ2VkVG91Y2hlc1swXSxvPXBhcnNlRmxvYXQoci5nZXRBdHRyaWJ1dGUoXCJtaW5cIikpfHwwLHM9cGFyc2VGbG9hdChyLmdldEF0dHJpYnV0ZShcIm1heFwiKSl8fDEwMCx1PXBhcnNlRmxvYXQoci5nZXRBdHRyaWJ1dGUoXCJzdGVwXCIpKXx8MSxjPXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksYT0xMDAvYy53aWR0aCoodGhpcy5jb25maWcudGh1bWJXaWR0aC8yKS8xMDA7cmV0dXJuIDA+KG49MTAwL2Mud2lkdGgqKGkuY2xpZW50WC1jLmxlZnQpKT9uPTA6MTAwPG4mJihuPTEwMCksNTA+bj9uLT0oMTAwLTIqbikqYTo1MDxuJiYobis9Mioobi01MCkqYSksbytyb3VuZChuLzEwMCoocy1vKSx1KX19LHtrZXk6XCJzZXRcIix2YWx1ZTpmdW5jdGlvbih0KXtlLmVuYWJsZWQmJmlzLmV2ZW50KHQpJiYhdC50YXJnZXQuZGlzYWJsZWQmJih0LnByZXZlbnREZWZhdWx0KCksdC50YXJnZXQudmFsdWU9dGhpcy5nZXQodCksdHJpZ2dlcih0LnRhcmdldCxcInRvdWNoZW5kXCI9PT10LnR5cGU/XCJjaGFuZ2VcIjpcImlucHV0XCIpKX19XSxbe2tleTpcInNldHVwXCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIG49MTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOnt9LHI9bnVsbDtpZihpcy5lbXB0eSh0KXx8aXMuc3RyaW5nKHQpP3I9QXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGlzLnN0cmluZyh0KT90OidpbnB1dFt0eXBlPVwicmFuZ2VcIl0nKSk6aXMuZWxlbWVudCh0KT9yPVt0XTppcy5ub2RlTGlzdCh0KT9yPUFycmF5LmZyb20odCk6aXMuYXJyYXkodCkmJihyPXQuZmlsdGVyKGlzLmVsZW1lbnQpKSxpcy5lbXB0eShyKSlyZXR1cm4gbnVsbDt2YXIgaT1fb2JqZWN0U3ByZWFkMih7fSxkZWZhdWx0cyx7fSxuKTtpZihpcy5zdHJpbmcodCkmJmkud2F0Y2gpe3ZhciBvPW5ldyBNdXRhdGlvbk9ic2VydmVyKChmdW5jdGlvbihuKXtBcnJheS5mcm9tKG4pLmZvckVhY2goKGZ1bmN0aW9uKG4pe0FycmF5LmZyb20obi5hZGRlZE5vZGVzKS5mb3JFYWNoKChmdW5jdGlvbihuKXtpcy5lbGVtZW50KG4pJiZtYXRjaGVzKG4sdCkmJm5ldyBlKG4saSl9KSl9KSl9KSk7by5vYnNlcnZlKGRvY3VtZW50LmJvZHkse2NoaWxkTGlzdDohMCxzdWJ0cmVlOiEwfSl9cmV0dXJuIHIubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gbmV3IGUodCxuKX0pKX19LHtrZXk6XCJlbmFibGVkXCIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuXCJvbnRvdWNoc3RhcnRcImluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudH19XSksZX0oKTtleHBvcnQgZGVmYXVsdCBSYW5nZVRvdWNoOyIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBUeXBlIGNoZWNraW5nIHV0aWxzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBnZXRDb25zdHJ1Y3RvciA9IChpbnB1dCkgPT4gKGlucHV0ICE9PSBudWxsICYmIHR5cGVvZiBpbnB1dCAhPT0gJ3VuZGVmaW5lZCcgPyBpbnB1dC5jb25zdHJ1Y3RvciA6IG51bGwpO1xuY29uc3QgaW5zdGFuY2VPZiA9IChpbnB1dCwgY29uc3RydWN0b3IpID0+IEJvb2xlYW4oaW5wdXQgJiYgY29uc3RydWN0b3IgJiYgaW5wdXQgaW5zdGFuY2VvZiBjb25zdHJ1Y3Rvcik7XG5jb25zdCBpc051bGxPclVuZGVmaW5lZCA9IChpbnB1dCkgPT4gaW5wdXQgPT09IG51bGwgfHwgdHlwZW9mIGlucHV0ID09PSAndW5kZWZpbmVkJztcbmNvbnN0IGlzT2JqZWN0ID0gKGlucHV0KSA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IE9iamVjdDtcbmNvbnN0IGlzTnVtYmVyID0gKGlucHV0KSA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IE51bWJlciAmJiAhTnVtYmVyLmlzTmFOKGlucHV0KTtcbmNvbnN0IGlzU3RyaW5nID0gKGlucHV0KSA9PiBnZXRDb25zdHJ1Y3RvcihpbnB1dCkgPT09IFN0cmluZztcbmNvbnN0IGlzQm9vbGVhbiA9IChpbnB1dCkgPT4gZ2V0Q29uc3RydWN0b3IoaW5wdXQpID09PSBCb29sZWFuO1xuY29uc3QgaXNGdW5jdGlvbiA9IChpbnB1dCkgPT4gZ2V0Q29uc3RydWN0b3IoaW5wdXQpID09PSBGdW5jdGlvbjtcbmNvbnN0IGlzQXJyYXkgPSAoaW5wdXQpID0+IEFycmF5LmlzQXJyYXkoaW5wdXQpO1xuY29uc3QgaXNXZWFrTWFwID0gKGlucHV0KSA9PiBpbnN0YW5jZU9mKGlucHV0LCBXZWFrTWFwKTtcbmNvbnN0IGlzTm9kZUxpc3QgPSAoaW5wdXQpID0+IGluc3RhbmNlT2YoaW5wdXQsIE5vZGVMaXN0KTtcbmNvbnN0IGlzVGV4dE5vZGUgPSAoaW5wdXQpID0+IGdldENvbnN0cnVjdG9yKGlucHV0KSA9PT0gVGV4dDtcbmNvbnN0IGlzRXZlbnQgPSAoaW5wdXQpID0+IGluc3RhbmNlT2YoaW5wdXQsIEV2ZW50KTtcbmNvbnN0IGlzS2V5Ym9hcmRFdmVudCA9IChpbnB1dCkgPT4gaW5zdGFuY2VPZihpbnB1dCwgS2V5Ym9hcmRFdmVudCk7XG5jb25zdCBpc0N1ZSA9IChpbnB1dCkgPT4gaW5zdGFuY2VPZihpbnB1dCwgd2luZG93LlRleHRUcmFja0N1ZSkgfHwgaW5zdGFuY2VPZihpbnB1dCwgd2luZG93LlZUVEN1ZSk7XG5jb25zdCBpc1RyYWNrID0gKGlucHV0KSA9PiBpbnN0YW5jZU9mKGlucHV0LCBUZXh0VHJhY2spIHx8ICghaXNOdWxsT3JVbmRlZmluZWQoaW5wdXQpICYmIGlzU3RyaW5nKGlucHV0LmtpbmQpKTtcbmNvbnN0IGlzUHJvbWlzZSA9IChpbnB1dCkgPT4gaW5zdGFuY2VPZihpbnB1dCwgUHJvbWlzZSkgJiYgaXNGdW5jdGlvbihpbnB1dC50aGVuKTtcblxuY29uc3QgaXNFbGVtZW50ID0gKGlucHV0KSA9PlxuICBpbnB1dCAhPT0gbnVsbCAmJlxuICB0eXBlb2YgaW5wdXQgPT09ICdvYmplY3QnICYmXG4gIGlucHV0Lm5vZGVUeXBlID09PSAxICYmXG4gIHR5cGVvZiBpbnB1dC5zdHlsZSA9PT0gJ29iamVjdCcgJiZcbiAgdHlwZW9mIGlucHV0Lm93bmVyRG9jdW1lbnQgPT09ICdvYmplY3QnO1xuXG5jb25zdCBpc0VtcHR5ID0gKGlucHV0KSA9PlxuICBpc051bGxPclVuZGVmaW5lZChpbnB1dCkgfHxcbiAgKChpc1N0cmluZyhpbnB1dCkgfHwgaXNBcnJheShpbnB1dCkgfHwgaXNOb2RlTGlzdChpbnB1dCkpICYmICFpbnB1dC5sZW5ndGgpIHx8XG4gIChpc09iamVjdChpbnB1dCkgJiYgIU9iamVjdC5rZXlzKGlucHV0KS5sZW5ndGgpO1xuXG5jb25zdCBpc1VybCA9IChpbnB1dCkgPT4ge1xuICAvLyBBY2NlcHQgYSBVUkwgb2JqZWN0XG4gIGlmIChpbnN0YW5jZU9mKGlucHV0LCB3aW5kb3cuVVJMKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLy8gTXVzdCBiZSBzdHJpbmcgZnJvbSBoZXJlXG4gIGlmICghaXNTdHJpbmcoaW5wdXQpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gQWRkIHRoZSBwcm90b2NvbCBpZiByZXF1aXJlZFxuICBsZXQgc3RyaW5nID0gaW5wdXQ7XG4gIGlmICghaW5wdXQuc3RhcnRzV2l0aCgnaHR0cDovLycpIHx8ICFpbnB1dC5zdGFydHNXaXRoKCdodHRwczovLycpKSB7XG4gICAgc3RyaW5nID0gYGh0dHA6Ly8ke2lucHV0fWA7XG4gIH1cblxuICB0cnkge1xuICAgIHJldHVybiAhaXNFbXB0eShuZXcgVVJMKHN0cmluZykuaG9zdG5hbWUpO1xuICB9IGNhdGNoIChfKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG51bGxPclVuZGVmaW5lZDogaXNOdWxsT3JVbmRlZmluZWQsXG4gIG9iamVjdDogaXNPYmplY3QsXG4gIG51bWJlcjogaXNOdW1iZXIsXG4gIHN0cmluZzogaXNTdHJpbmcsXG4gIGJvb2xlYW46IGlzQm9vbGVhbixcbiAgZnVuY3Rpb246IGlzRnVuY3Rpb24sXG4gIGFycmF5OiBpc0FycmF5LFxuICB3ZWFrTWFwOiBpc1dlYWtNYXAsXG4gIG5vZGVMaXN0OiBpc05vZGVMaXN0LFxuICBlbGVtZW50OiBpc0VsZW1lbnQsXG4gIHRleHROb2RlOiBpc1RleHROb2RlLFxuICBldmVudDogaXNFdmVudCxcbiAga2V5Ym9hcmRFdmVudDogaXNLZXlib2FyZEV2ZW50LFxuICBjdWU6IGlzQ3VlLFxuICB0cmFjazogaXNUcmFjayxcbiAgcHJvbWlzZTogaXNQcm9taXNlLFxuICB1cmw6IGlzVXJsLFxuICBlbXB0eTogaXNFbXB0eSxcbn07XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQW5pbWF0aW9uIHV0aWxzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgaXMgZnJvbSAnLi9pcyc7XG5cbmV4cG9ydCBjb25zdCB0cmFuc2l0aW9uRW5kRXZlbnQgPSAoKCkgPT4ge1xuICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuXG4gIGNvbnN0IGV2ZW50cyA9IHtcbiAgICBXZWJraXRUcmFuc2l0aW9uOiAnd2Via2l0VHJhbnNpdGlvbkVuZCcsXG4gICAgTW96VHJhbnNpdGlvbjogJ3RyYW5zaXRpb25lbmQnLFxuICAgIE9UcmFuc2l0aW9uOiAnb1RyYW5zaXRpb25FbmQgb3RyYW5zaXRpb25lbmQnLFxuICAgIHRyYW5zaXRpb246ICd0cmFuc2l0aW9uZW5kJyxcbiAgfTtcblxuICBjb25zdCB0eXBlID0gT2JqZWN0LmtleXMoZXZlbnRzKS5maW5kKChldmVudCkgPT4gZWxlbWVudC5zdHlsZVtldmVudF0gIT09IHVuZGVmaW5lZCk7XG5cbiAgcmV0dXJuIGlzLnN0cmluZyh0eXBlKSA/IGV2ZW50c1t0eXBlXSA6IGZhbHNlO1xufSkoKTtcblxuLy8gRm9yY2UgcmVwYWludCBvZiBlbGVtZW50XG5leHBvcnQgZnVuY3Rpb24gcmVwYWludChlbGVtZW50LCBkZWxheSkge1xuICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICBlbGVtZW50LmhpZGRlbiA9IHRydWU7XG5cbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtZXhwcmVzc2lvbnNcbiAgICAgIGVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICAgIGVsZW1lbnQuaGlkZGVuID0gZmFsc2U7XG4gICAgfSBjYXRjaCAoXykge1xuICAgICAgLy8gRG8gbm90aGluZ1xuICAgIH1cbiAgfSwgZGVsYXkpO1xufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEJyb3dzZXIgc25pZmZpbmdcbi8vIFVuZm9ydHVuYXRlbHksIGR1ZSB0byBtaXhlZCBzdXBwb3J0LCBVQSBzbmlmZmluZyBpcyByZXF1aXJlZFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuY29uc3QgYnJvd3NlciA9IHtcbiAgaXNJRTogQm9vbGVhbih3aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRNb2RlKSxcbiAgaXNFZGdlOiB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmNsdWRlcygnRWRnZScpLFxuICBpc1dlYmtpdDogJ1dlYmtpdEFwcGVhcmFuY2UnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSAmJiAhL0VkZ2UvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksXG4gIGlzSVBob25lOiAvKGlQaG9uZXxpUG9kKS9naS50ZXN0KG5hdmlnYXRvci5wbGF0Zm9ybSksXG4gIGlzSW9zOlxuICAgIChuYXZpZ2F0b3IucGxhdGZvcm0gPT09ICdNYWNJbnRlbCcgJiYgbmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzID4gMSkgfHxcbiAgICAvKGlQYWR8aVBob25lfGlQb2QpL2dpLnRlc3QobmF2aWdhdG9yLnBsYXRmb3JtKSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGJyb3dzZXI7XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gT2JqZWN0IHV0aWxzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgaXMgZnJvbSAnLi9pcyc7XG5cbi8vIENsb25lIG5lc3RlZCBvYmplY3RzXG5leHBvcnQgZnVuY3Rpb24gY2xvbmVEZWVwKG9iamVjdCkge1xuICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvYmplY3QpKTtcbn1cblxuLy8gR2V0IGEgbmVzdGVkIHZhbHVlIGluIGFuIG9iamVjdFxuZXhwb3J0IGZ1bmN0aW9uIGdldERlZXAob2JqZWN0LCBwYXRoKSB7XG4gIHJldHVybiBwYXRoLnNwbGl0KCcuJykucmVkdWNlKChvYmosIGtleSkgPT4gb2JqICYmIG9ialtrZXldLCBvYmplY3QpO1xufVxuXG4vLyBEZWVwIGV4dGVuZCBkZXN0aW5hdGlvbiBvYmplY3Qgd2l0aCBOIG1vcmUgb2JqZWN0c1xuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuZCh0YXJnZXQgPSB7fSwgLi4uc291cmNlcykge1xuICBpZiAoIXNvdXJjZXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfVxuXG4gIGNvbnN0IHNvdXJjZSA9IHNvdXJjZXMuc2hpZnQoKTtcblxuICBpZiAoIWlzLm9iamVjdChzb3VyY2UpKSB7XG4gICAgcmV0dXJuIHRhcmdldDtcbiAgfVxuXG4gIE9iamVjdC5rZXlzKHNvdXJjZSkuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgaWYgKGlzLm9iamVjdChzb3VyY2Vba2V5XSkpIHtcbiAgICAgIGlmICghT2JqZWN0LmtleXModGFyZ2V0KS5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7IFtrZXldOiB7fSB9KTtcbiAgICAgIH1cblxuICAgICAgZXh0ZW5kKHRhcmdldFtrZXldLCBzb3VyY2Vba2V5XSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7IFtrZXldOiBzb3VyY2Vba2V5XSB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBleHRlbmQodGFyZ2V0LCAuLi5zb3VyY2VzKTtcbn1cbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBFbGVtZW50IHV0aWxzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgaXMgZnJvbSAnLi9pcyc7XG5pbXBvcnQgeyBleHRlbmQgfSBmcm9tICcuL29iamVjdHMnO1xuXG4vLyBXcmFwIGFuIGVsZW1lbnRcbmV4cG9ydCBmdW5jdGlvbiB3cmFwKGVsZW1lbnRzLCB3cmFwcGVyKSB7XG4gIC8vIENvbnZlcnQgYGVsZW1lbnRzYCB0byBhbiBhcnJheSwgaWYgbmVjZXNzYXJ5LlxuICBjb25zdCB0YXJnZXRzID0gZWxlbWVudHMubGVuZ3RoID8gZWxlbWVudHMgOiBbZWxlbWVudHNdO1xuXG4gIC8vIExvb3BzIGJhY2t3YXJkcyB0byBwcmV2ZW50IGhhdmluZyB0byBjbG9uZSB0aGUgd3JhcHBlciBvbiB0aGVcbiAgLy8gZmlyc3QgZWxlbWVudCAoc2VlIGBjaGlsZGAgYmVsb3cpLlxuICBBcnJheS5mcm9tKHRhcmdldHMpXG4gICAgLnJldmVyc2UoKVxuICAgIC5mb3JFYWNoKChlbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgY2hpbGQgPSBpbmRleCA+IDAgPyB3cmFwcGVyLmNsb25lTm9kZSh0cnVlKSA6IHdyYXBwZXI7XG4gICAgICAvLyBDYWNoZSB0aGUgY3VycmVudCBwYXJlbnQgYW5kIHNpYmxpbmcuXG4gICAgICBjb25zdCBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICBjb25zdCBzaWJsaW5nID0gZWxlbWVudC5uZXh0U2libGluZztcblxuICAgICAgLy8gV3JhcCB0aGUgZWxlbWVudCAoaXMgYXV0b21hdGljYWxseSByZW1vdmVkIGZyb20gaXRzIGN1cnJlbnRcbiAgICAgIC8vIHBhcmVudCkuXG4gICAgICBjaGlsZC5hcHBlbmRDaGlsZChlbGVtZW50KTtcblxuICAgICAgLy8gSWYgdGhlIGVsZW1lbnQgaGFkIGEgc2libGluZywgaW5zZXJ0IHRoZSB3cmFwcGVyIGJlZm9yZVxuICAgICAgLy8gdGhlIHNpYmxpbmcgdG8gbWFpbnRhaW4gdGhlIEhUTUwgc3RydWN0dXJlOyBvdGhlcndpc2UsIGp1c3RcbiAgICAgIC8vIGFwcGVuZCBpdCB0byB0aGUgcGFyZW50LlxuICAgICAgaWYgKHNpYmxpbmcpIHtcbiAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShjaGlsZCwgc2libGluZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwYXJlbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgICAgfVxuICAgIH0pO1xufVxuXG4vLyBTZXQgYXR0cmlidXRlc1xuZXhwb3J0IGZ1bmN0aW9uIHNldEF0dHJpYnV0ZXMoZWxlbWVudCwgYXR0cmlidXRlcykge1xuICBpZiAoIWlzLmVsZW1lbnQoZWxlbWVudCkgfHwgaXMuZW1wdHkoYXR0cmlidXRlcykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBBc3N1bWUgbnVsbCBhbmQgdW5kZWZpbmVkIGF0dHJpYnV0ZXMgc2hvdWxkIGJlIGxlZnQgb3V0LFxuICAvLyBTZXR0aW5nIHRoZW0gd291bGQgb3RoZXJ3aXNlIGNvbnZlcnQgdGhlbSB0byBcIm51bGxcIiBhbmQgXCJ1bmRlZmluZWRcIlxuICBPYmplY3QuZW50cmllcyhhdHRyaWJ1dGVzKVxuICAgIC5maWx0ZXIoKFssIHZhbHVlXSkgPT4gIWlzLm51bGxPclVuZGVmaW5lZCh2YWx1ZSkpXG4gICAgLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4gZWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCB2YWx1ZSkpO1xufVxuXG4vLyBDcmVhdGUgYSBEb2N1bWVudEZyYWdtZW50XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRWxlbWVudCh0eXBlLCBhdHRyaWJ1dGVzLCB0ZXh0KSB7XG4gIC8vIENyZWF0ZSBhIG5ldyA8ZWxlbWVudD5cbiAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodHlwZSk7XG5cbiAgLy8gU2V0IGFsbCBwYXNzZWQgYXR0cmlidXRlc1xuICBpZiAoaXMub2JqZWN0KGF0dHJpYnV0ZXMpKSB7XG4gICAgc2V0QXR0cmlidXRlcyhlbGVtZW50LCBhdHRyaWJ1dGVzKTtcbiAgfVxuXG4gIC8vIEFkZCB0ZXh0IG5vZGVcbiAgaWYgKGlzLnN0cmluZyh0ZXh0KSkge1xuICAgIGVsZW1lbnQuaW5uZXJUZXh0ID0gdGV4dDtcbiAgfVxuXG4gIC8vIFJldHVybiBidWlsdCBlbGVtZW50XG4gIHJldHVybiBlbGVtZW50O1xufVxuXG4vLyBJbmFlcnQgYW4gZWxlbWVudCBhZnRlciBhbm90aGVyXG5leHBvcnQgZnVuY3Rpb24gaW5zZXJ0QWZ0ZXIoZWxlbWVudCwgdGFyZ2V0KSB7XG4gIGlmICghaXMuZWxlbWVudChlbGVtZW50KSB8fCAhaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGFyZ2V0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGVsZW1lbnQsIHRhcmdldC5uZXh0U2libGluZyk7XG59XG5cbi8vIEluc2VydCBhIERvY3VtZW50RnJhZ21lbnRcbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRFbGVtZW50KHR5cGUsIHBhcmVudCwgYXR0cmlidXRlcywgdGV4dCkge1xuICBpZiAoIWlzLmVsZW1lbnQocGFyZW50KSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHBhcmVudC5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KHR5cGUsIGF0dHJpYnV0ZXMsIHRleHQpKTtcbn1cblxuLy8gUmVtb3ZlIGVsZW1lbnQocylcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVFbGVtZW50KGVsZW1lbnQpIHtcbiAgaWYgKGlzLm5vZGVMaXN0KGVsZW1lbnQpIHx8IGlzLmFycmF5KGVsZW1lbnQpKSB7XG4gICAgQXJyYXkuZnJvbShlbGVtZW50KS5mb3JFYWNoKHJlbW92ZUVsZW1lbnQpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICghaXMuZWxlbWVudChlbGVtZW50KSB8fCAhaXMuZWxlbWVudChlbGVtZW50LnBhcmVudE5vZGUpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xufVxuXG4vLyBSZW1vdmUgYWxsIGNoaWxkIGVsZW1lbnRzXG5leHBvcnQgZnVuY3Rpb24gZW1wdHlFbGVtZW50KGVsZW1lbnQpIHtcbiAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IHsgbGVuZ3RoIH0gPSBlbGVtZW50LmNoaWxkTm9kZXM7XG5cbiAgd2hpbGUgKGxlbmd0aCA+IDApIHtcbiAgICBlbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQubGFzdENoaWxkKTtcbiAgICBsZW5ndGggLT0gMTtcbiAgfVxufVxuXG4vLyBSZXBsYWNlIGVsZW1lbnRcbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlRWxlbWVudChuZXdDaGlsZCwgb2xkQ2hpbGQpIHtcbiAgaWYgKCFpcy5lbGVtZW50KG9sZENoaWxkKSB8fCAhaXMuZWxlbWVudChvbGRDaGlsZC5wYXJlbnROb2RlKSB8fCAhaXMuZWxlbWVudChuZXdDaGlsZCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIG9sZENoaWxkLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKG5ld0NoaWxkLCBvbGRDaGlsZCk7XG5cbiAgcmV0dXJuIG5ld0NoaWxkO1xufVxuXG4vLyBHZXQgYW4gYXR0cmlidXRlIG9iamVjdCBmcm9tIGEgc3RyaW5nIHNlbGVjdG9yXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3RvcihzZWwsIGV4aXN0aW5nQXR0cmlidXRlcykge1xuICAvLyBGb3IgZXhhbXBsZTpcbiAgLy8gJy50ZXN0JyB0byB7IGNsYXNzOiAndGVzdCcgfVxuICAvLyAnI3Rlc3QnIHRvIHsgaWQ6ICd0ZXN0JyB9XG4gIC8vICdbZGF0YS10ZXN0PVwidGVzdFwiXScgdG8geyAnZGF0YS10ZXN0JzogJ3Rlc3QnIH1cblxuICBpZiAoIWlzLnN0cmluZyhzZWwpIHx8IGlzLmVtcHR5KHNlbCkpIHtcbiAgICByZXR1cm4ge307XG4gIH1cblxuICBjb25zdCBhdHRyaWJ1dGVzID0ge307XG4gIGNvbnN0IGV4aXN0aW5nID0gZXh0ZW5kKHt9LCBleGlzdGluZ0F0dHJpYnV0ZXMpO1xuXG4gIHNlbC5zcGxpdCgnLCcpLmZvckVhY2goKHMpID0+IHtcbiAgICAvLyBSZW1vdmUgd2hpdGVzcGFjZVxuICAgIGNvbnN0IHNlbGVjdG9yID0gcy50cmltKCk7XG4gICAgY29uc3QgY2xhc3NOYW1lID0gc2VsZWN0b3IucmVwbGFjZSgnLicsICcnKTtcbiAgICBjb25zdCBzdHJpcHBlZCA9IHNlbGVjdG9yLnJlcGxhY2UoL1tbXFxdXS9nLCAnJyk7XG4gICAgLy8gR2V0IHRoZSBwYXJ0cyBhbmQgdmFsdWVcbiAgICBjb25zdCBwYXJ0cyA9IHN0cmlwcGVkLnNwbGl0KCc9Jyk7XG4gICAgY29uc3QgW2tleV0gPSBwYXJ0cztcbiAgICBjb25zdCB2YWx1ZSA9IHBhcnRzLmxlbmd0aCA+IDEgPyBwYXJ0c1sxXS5yZXBsYWNlKC9bXCInXS9nLCAnJykgOiAnJztcbiAgICAvLyBHZXQgdGhlIGZpcnN0IGNoYXJhY3RlclxuICAgIGNvbnN0IHN0YXJ0ID0gc2VsZWN0b3IuY2hhckF0KDApO1xuXG4gICAgc3dpdGNoIChzdGFydCkge1xuICAgICAgY2FzZSAnLic6XG4gICAgICAgIC8vIEFkZCB0byBleGlzdGluZyBjbGFzc25hbWVcbiAgICAgICAgaWYgKGlzLnN0cmluZyhleGlzdGluZy5jbGFzcykpIHtcbiAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gYCR7ZXhpc3RpbmcuY2xhc3N9ICR7Y2xhc3NOYW1lfWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyA9IGNsYXNzTmFtZTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnIyc6XG4gICAgICAgIC8vIElEIHNlbGVjdG9yXG4gICAgICAgIGF0dHJpYnV0ZXMuaWQgPSBzZWxlY3Rvci5yZXBsYWNlKCcjJywgJycpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnWyc6XG4gICAgICAgIC8vIEF0dHJpYnV0ZSBzZWxlY3RvclxuICAgICAgICBhdHRyaWJ1dGVzW2tleV0gPSB2YWx1ZTtcblxuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gZXh0ZW5kKGV4aXN0aW5nLCBhdHRyaWJ1dGVzKTtcbn1cblxuLy8gVG9nZ2xlIGhpZGRlblxuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZUhpZGRlbihlbGVtZW50LCBoaWRkZW4pIHtcbiAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgbGV0IGhpZGUgPSBoaWRkZW47XG5cbiAgaWYgKCFpcy5ib29sZWFuKGhpZGUpKSB7XG4gICAgaGlkZSA9ICFlbGVtZW50LmhpZGRlbjtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICBlbGVtZW50LmhpZGRlbiA9IGhpZGU7XG59XG5cbi8vIE1pcnJvciBFbGVtZW50LmNsYXNzTGlzdC50b2dnbGUsIHdpdGggSUUgY29tcGF0aWJpbGl0eSBmb3IgXCJmb3JjZVwiIGFyZ3VtZW50XG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lLCBmb3JjZSkge1xuICBpZiAoaXMubm9kZUxpc3QoZWxlbWVudCkpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShlbGVtZW50KS5tYXAoKGUpID0+IHRvZ2dsZUNsYXNzKGUsIGNsYXNzTmFtZSwgZm9yY2UpKTtcbiAgfVxuXG4gIGlmIChpcy5lbGVtZW50KGVsZW1lbnQpKSB7XG4gICAgbGV0IG1ldGhvZCA9ICd0b2dnbGUnO1xuICAgIGlmICh0eXBlb2YgZm9yY2UgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICBtZXRob2QgPSBmb3JjZSA/ICdhZGQnIDogJ3JlbW92ZSc7XG4gICAgfVxuXG4gICAgZWxlbWVudC5jbGFzc0xpc3RbbWV0aG9kXShjbGFzc05hbWUpO1xuICAgIHJldHVybiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG4vLyBIYXMgY2xhc3MgbmFtZVxuZXhwb3J0IGZ1bmN0aW9uIGhhc0NsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICByZXR1cm4gaXMuZWxlbWVudChlbGVtZW50KSAmJiBlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xufVxuXG4vLyBFbGVtZW50IG1hdGNoZXMgc2VsZWN0b3JcbmV4cG9ydCBmdW5jdGlvbiBtYXRjaGVzKGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gIGNvbnN0IHsgcHJvdG90eXBlIH0gPSBFbGVtZW50O1xuXG4gIGZ1bmN0aW9uIG1hdGNoKCkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKS5pbmNsdWRlcyh0aGlzKTtcbiAgfVxuXG4gIGNvbnN0IG1ldGhvZCA9XG4gICAgcHJvdG90eXBlLm1hdGNoZXMgfHxcbiAgICBwcm90b3R5cGUud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8XG4gICAgcHJvdG90eXBlLm1vek1hdGNoZXNTZWxlY3RvciB8fFxuICAgIHByb3RvdHlwZS5tc01hdGNoZXNTZWxlY3RvciB8fFxuICAgIG1hdGNoO1xuXG4gIHJldHVybiBtZXRob2QuY2FsbChlbGVtZW50LCBzZWxlY3Rvcik7XG59XG5cbi8vIENsb3Nlc3QgYW5jZXN0b3IgZWxlbWVudCBtYXRjaGluZyBzZWxlY3RvciAoYWxzbyB0ZXN0cyBlbGVtZW50IGl0c2VsZilcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0KGVsZW1lbnQsIHNlbGVjdG9yKSB7XG4gIGNvbnN0IHsgcHJvdG90eXBlIH0gPSBFbGVtZW50O1xuXG4gIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9FbGVtZW50L2Nsb3Nlc3QjUG9seWZpbGxcbiAgZnVuY3Rpb24gY2xvc2VzdEVsZW1lbnQoKSB7XG4gICAgbGV0IGVsID0gdGhpcztcblxuICAgIGRvIHtcbiAgICAgIGlmIChtYXRjaGVzLm1hdGNoZXMoZWwsIHNlbGVjdG9yKSkgcmV0dXJuIGVsO1xuICAgICAgZWwgPSBlbC5wYXJlbnRFbGVtZW50IHx8IGVsLnBhcmVudE5vZGU7XG4gICAgfSB3aGlsZSAoZWwgIT09IG51bGwgJiYgZWwubm9kZVR5cGUgPT09IDEpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgY29uc3QgbWV0aG9kID0gcHJvdG90eXBlLmNsb3Nlc3QgfHwgY2xvc2VzdEVsZW1lbnQ7XG5cbiAgcmV0dXJuIG1ldGhvZC5jYWxsKGVsZW1lbnQsIHNlbGVjdG9yKTtcbn1cblxuLy8gRmluZCBhbGwgZWxlbWVudHNcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50cyhzZWxlY3Rvcikge1xuICByZXR1cm4gdGhpcy5lbGVtZW50cy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG59XG5cbi8vIEZpbmQgYSBzaW5nbGUgZWxlbWVudFxuZXhwb3J0IGZ1bmN0aW9uIGdldEVsZW1lbnQoc2VsZWN0b3IpIHtcbiAgcmV0dXJuIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xufVxuXG4vLyBTZXQgZm9jdXMgYW5kIHRhYiBmb2N1cyBjbGFzc1xuZXhwb3J0IGZ1bmN0aW9uIHNldEZvY3VzKGVsZW1lbnQgPSBudWxsLCB0YWJGb2N1cyA9IGZhbHNlKSB7XG4gIGlmICghaXMuZWxlbWVudChlbGVtZW50KSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIFNldCByZWd1bGFyIGZvY3VzXG4gIGVsZW1lbnQuZm9jdXMoeyBwcmV2ZW50U2Nyb2xsOiB0cnVlIH0pO1xuXG4gIC8vIElmIHdlIHdhbnQgdG8gbWltaWMga2V5Ym9hcmQgZm9jdXMgdmlhIHRhYlxuICBpZiAodGFiRm9jdXMpIHtcbiAgICB0b2dnbGVDbGFzcyhlbGVtZW50LCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnRhYkZvY3VzKTtcbiAgfVxufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgc3VwcG9ydCBjaGVja3Ncbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCB7IHRyYW5zaXRpb25FbmRFdmVudCB9IGZyb20gJy4vdXRpbHMvYW5pbWF0aW9uJztcbmltcG9ydCBicm93c2VyIGZyb20gJy4vdXRpbHMvYnJvd3Nlcic7XG5pbXBvcnQgeyBjcmVhdGVFbGVtZW50IH0gZnJvbSAnLi91dGlscy9lbGVtZW50cyc7XG5pbXBvcnQgaXMgZnJvbSAnLi91dGlscy9pcyc7XG5cbi8vIERlZmF1bHQgY29kZWNzIGZvciBjaGVja2luZyBtaW1ldHlwZSBzdXBwb3J0XG5jb25zdCBkZWZhdWx0Q29kZWNzID0ge1xuICAnYXVkaW8vb2dnJzogJ3ZvcmJpcycsXG4gICdhdWRpby93YXYnOiAnMScsXG4gICd2aWRlby93ZWJtJzogJ3ZwOCwgdm9yYmlzJyxcbiAgJ3ZpZGVvL21wNCc6ICdhdmMxLjQyRTAxRSwgbXA0YS40MC4yJyxcbiAgJ3ZpZGVvL29nZyc6ICd0aGVvcmEnLFxufTtcblxuLy8gQ2hlY2sgZm9yIGZlYXR1cmUgc3VwcG9ydFxuY29uc3Qgc3VwcG9ydCA9IHtcbiAgLy8gQmFzaWMgc3VwcG9ydFxuICBhdWRpbzogJ2NhblBsYXlUeXBlJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhdWRpbycpLFxuICB2aWRlbzogJ2NhblBsYXlUeXBlJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpLFxuXG4gIC8vIENoZWNrIGZvciBzdXBwb3J0XG4gIC8vIEJhc2ljIGZ1bmN0aW9uYWxpdHkgdnMgZnVsbCBVSVxuICBjaGVjayh0eXBlLCBwcm92aWRlciwgcGxheXNpbmxpbmUpIHtcbiAgICBjb25zdCBjYW5QbGF5SW5saW5lID0gYnJvd3Nlci5pc0lQaG9uZSAmJiBwbGF5c2lubGluZSAmJiBzdXBwb3J0LnBsYXlzaW5saW5lO1xuICAgIGNvbnN0IGFwaSA9IHN1cHBvcnRbdHlwZV0gfHwgcHJvdmlkZXIgIT09ICdodG1sNSc7XG4gICAgY29uc3QgdWkgPSBhcGkgJiYgc3VwcG9ydC5yYW5nZUlucHV0ICYmICh0eXBlICE9PSAndmlkZW8nIHx8ICFicm93c2VyLmlzSVBob25lIHx8IGNhblBsYXlJbmxpbmUpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGFwaSxcbiAgICAgIHVpLFxuICAgIH07XG4gIH0sXG5cbiAgLy8gUGljdHVyZS1pbi1waWN0dXJlIHN1cHBvcnRcbiAgLy8gU2FmYXJpICYgQ2hyb21lIG9ubHkgY3VycmVudGx5XG4gIHBpcDogKCgpID0+IHtcbiAgICBpZiAoYnJvd3Nlci5pc0lQaG9uZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFNhZmFyaVxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLmFwcGxlLmNvbS9kb2N1bWVudGF0aW9uL3dlYmtpdGpzL2FkZGluZ19waWN0dXJlX2luX3BpY3R1cmVfdG9feW91cl9zYWZhcmlfbWVkaWFfY29udHJvbHNcbiAgICBpZiAoaXMuZnVuY3Rpb24oY3JlYXRlRWxlbWVudCgndmlkZW8nKS53ZWJraXRTZXRQcmVzZW50YXRpb25Nb2RlKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gQ2hyb21lXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vd2ViL3VwZGF0ZXMvMjAxOC8xMC93YXRjaC12aWRlby11c2luZy1waWN0dXJlLWluLXBpY3R1cmVcbiAgICBpZiAoZG9jdW1lbnQucGljdHVyZUluUGljdHVyZUVuYWJsZWQgJiYgIWNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJykuZGlzYWJsZVBpY3R1cmVJblBpY3R1cmUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSkoKSxcblxuICAvLyBBaXJwbGF5IHN1cHBvcnRcbiAgLy8gU2FmYXJpIG9ubHkgY3VycmVudGx5XG4gIGFpcnBsYXk6IGlzLmZ1bmN0aW9uKHdpbmRvdy5XZWJLaXRQbGF5YmFja1RhcmdldEF2YWlsYWJpbGl0eUV2ZW50KSxcblxuICAvLyBJbmxpbmUgcGxheWJhY2sgc3VwcG9ydFxuICAvLyBodHRwczovL3dlYmtpdC5vcmcvYmxvZy82Nzg0L25ldy12aWRlby1wb2xpY2llcy1mb3ItaW9zL1xuICBwbGF5c2lubGluZTogJ3BsYXlzSW5saW5lJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpLFxuXG4gIC8vIENoZWNrIGZvciBtaW1lIHR5cGUgc3VwcG9ydCBhZ2FpbnN0IGEgcGxheWVyIGluc3RhbmNlXG4gIC8vIENyZWRpdHM6IGh0dHA6Ly9kaXZlaW50b2h0bWw1LmluZm8vZXZlcnl0aGluZy5odG1sXG4gIC8vIFJlbGF0ZWQ6IGh0dHA6Ly93d3cubGVhbmJhY2twbGF5ZXIuY29tL3Rlc3QvaDVtdC5odG1sXG4gIG1pbWUoaW5wdXQpIHtcbiAgICBpZiAoaXMuZW1wdHkoaW5wdXQpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgW21lZGlhVHlwZV0gPSBpbnB1dC5zcGxpdCgnLycpO1xuICAgIGxldCB0eXBlID0gaW5wdXQ7XG5cbiAgICAvLyBWZXJpZnkgd2UncmUgdXNpbmcgSFRNTDUgYW5kIHRoZXJlJ3Mgbm8gbWVkaWEgdHlwZSBtaXNtYXRjaFxuICAgIGlmICghdGhpcy5pc0hUTUw1IHx8IG1lZGlhVHlwZSAhPT0gdGhpcy50eXBlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gQWRkIGNvZGVjIGlmIHJlcXVpcmVkXG4gICAgaWYgKE9iamVjdC5rZXlzKGRlZmF1bHRDb2RlY3MpLmluY2x1ZGVzKHR5cGUpKSB7XG4gICAgICB0eXBlICs9IGA7IGNvZGVjcz1cIiR7ZGVmYXVsdENvZGVjc1tpbnB1dF19XCJgO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gQm9vbGVhbih0eXBlICYmIHRoaXMubWVkaWEuY2FuUGxheVR5cGUodHlwZSkucmVwbGFjZSgvbm8vLCAnJykpO1xuICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gQ2hlY2sgZm9yIHRleHRUcmFja3Mgc3VwcG9ydFxuICB0ZXh0VHJhY2tzOiAndGV4dFRyYWNrcycgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKSxcblxuICAvLyA8aW5wdXQgdHlwZT1cInJhbmdlXCI+IFNsaWRlcnNcbiAgcmFuZ2VJbnB1dDogKCgpID0+IHtcbiAgICBjb25zdCByYW5nZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgcmFuZ2UudHlwZSA9ICdyYW5nZSc7XG4gICAgcmV0dXJuIHJhbmdlLnR5cGUgPT09ICdyYW5nZSc7XG4gIH0pKCksXG5cbiAgLy8gVG91Y2hcbiAgLy8gTk9URTogUmVtZW1iZXIgYSBkZXZpY2UgY2FuIGJlIG1vdXNlICsgdG91Y2ggZW5hYmxlZCBzbyB3ZSBjaGVjayBvbiBmaXJzdCB0b3VjaCBldmVudFxuICB0b3VjaDogJ29udG91Y2hzdGFydCcgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFxuXG4gIC8vIERldGVjdCB0cmFuc2l0aW9ucyBzdXBwb3J0XG4gIHRyYW5zaXRpb25zOiB0cmFuc2l0aW9uRW5kRXZlbnQgIT09IGZhbHNlLFxuXG4gIC8vIFJlZHVjZWQgbW90aW9uIGlPUyAmIE1hY09TIHNldHRpbmdcbiAgLy8gaHR0cHM6Ly93ZWJraXQub3JnL2Jsb2cvNzU1MS9yZXNwb25zaXZlLWRlc2lnbi1mb3ItbW90aW9uL1xuICByZWR1Y2VkTW90aW9uOiAnbWF0Y2hNZWRpYScgaW4gd2luZG93ICYmIHdpbmRvdy5tYXRjaE1lZGlhKCcocHJlZmVycy1yZWR1Y2VkLW1vdGlvbiknKS5tYXRjaGVzLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgc3VwcG9ydDtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBFdmVudCB1dGlsc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IGlzIGZyb20gJy4vaXMnO1xuXG4vLyBDaGVjayBmb3IgcGFzc2l2ZSBldmVudCBsaXN0ZW5lciBzdXBwb3J0XG4vLyBodHRwczovL2dpdGh1Yi5jb20vV0lDRy9FdmVudExpc3RlbmVyT3B0aW9ucy9ibG9iL2doLXBhZ2VzL2V4cGxhaW5lci5tZFxuLy8gaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1OUE02MTcySjIyZ1xuY29uc3Qgc3VwcG9ydHNQYXNzaXZlTGlzdGVuZXJzID0gKCgpID0+IHtcbiAgLy8gVGVzdCB2aWEgYSBnZXR0ZXIgaW4gdGhlIG9wdGlvbnMgb2JqZWN0IHRvIHNlZSBpZiB0aGUgcGFzc2l2ZSBwcm9wZXJ0eSBpcyBhY2Nlc3NlZFxuICBsZXQgc3VwcG9ydGVkID0gZmFsc2U7XG4gIHRyeSB7XG4gICAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ3Bhc3NpdmUnLCB7XG4gICAgICBnZXQoKSB7XG4gICAgICAgIHN1cHBvcnRlZCA9IHRydWU7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndGVzdCcsIG51bGwsIG9wdGlvbnMpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0ZXN0JywgbnVsbCwgb3B0aW9ucyk7XG4gIH0gY2F0Y2ggKF8pIHtcbiAgICAvLyBEbyBub3RoaW5nXG4gIH1cblxuICByZXR1cm4gc3VwcG9ydGVkO1xufSkoKTtcblxuLy8gVG9nZ2xlIGV2ZW50IGxpc3RlbmVyXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlTGlzdGVuZXIoZWxlbWVudCwgZXZlbnQsIGNhbGxiYWNrLCB0b2dnbGUgPSBmYWxzZSwgcGFzc2l2ZSA9IHRydWUsIGNhcHR1cmUgPSBmYWxzZSkge1xuICAvLyBCYWlsIGlmIG5vIGVsZW1lbnQsIGV2ZW50LCBvciBjYWxsYmFja1xuICBpZiAoIWVsZW1lbnQgfHwgISgnYWRkRXZlbnRMaXN0ZW5lcicgaW4gZWxlbWVudCkgfHwgaXMuZW1wdHkoZXZlbnQpIHx8ICFpcy5mdW5jdGlvbihjYWxsYmFjaykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBBbGxvdyBtdWx0aXBsZSBldmVudHNcbiAgY29uc3QgZXZlbnRzID0gZXZlbnQuc3BsaXQoJyAnKTtcbiAgLy8gQnVpbGQgb3B0aW9uc1xuICAvLyBEZWZhdWx0IHRvIGp1c3QgdGhlIGNhcHR1cmUgYm9vbGVhbiBmb3IgYnJvd3NlcnMgd2l0aCBubyBwYXNzaXZlIGxpc3RlbmVyIHN1cHBvcnRcbiAgbGV0IG9wdGlvbnMgPSBjYXB0dXJlO1xuXG4gIC8vIElmIHBhc3NpdmUgZXZlbnRzIGxpc3RlbmVycyBhcmUgc3VwcG9ydGVkXG4gIGlmIChzdXBwb3J0c1Bhc3NpdmVMaXN0ZW5lcnMpIHtcbiAgICBvcHRpb25zID0ge1xuICAgICAgLy8gV2hldGhlciB0aGUgbGlzdGVuZXIgY2FuIGJlIHBhc3NpdmUgKGkuZS4gZGVmYXVsdCBuZXZlciBwcmV2ZW50ZWQpXG4gICAgICBwYXNzaXZlLFxuICAgICAgLy8gV2hldGhlciB0aGUgbGlzdGVuZXIgaXMgYSBjYXB0dXJpbmcgbGlzdGVuZXIgb3Igbm90XG4gICAgICBjYXB0dXJlLFxuICAgIH07XG4gIH1cblxuICAvLyBJZiBhIHNpbmdsZSBub2RlIGlzIHBhc3NlZCwgYmluZCB0aGUgZXZlbnQgbGlzdGVuZXJcbiAgZXZlbnRzLmZvckVhY2goKHR5cGUpID0+IHtcbiAgICBpZiAodGhpcyAmJiB0aGlzLmV2ZW50TGlzdGVuZXJzICYmIHRvZ2dsZSkge1xuICAgICAgLy8gQ2FjaGUgZXZlbnQgbGlzdGVuZXJcbiAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaCh7IGVsZW1lbnQsIHR5cGUsIGNhbGxiYWNrLCBvcHRpb25zIH0pO1xuICAgIH1cblxuICAgIGVsZW1lbnRbdG9nZ2xlID8gJ2FkZEV2ZW50TGlzdGVuZXInIDogJ3JlbW92ZUV2ZW50TGlzdGVuZXInXSh0eXBlLCBjYWxsYmFjaywgb3B0aW9ucyk7XG4gIH0pO1xufVxuXG4vLyBCaW5kIGV2ZW50IGhhbmRsZXJcbmV4cG9ydCBmdW5jdGlvbiBvbihlbGVtZW50LCBldmVudHMgPSAnJywgY2FsbGJhY2ssIHBhc3NpdmUgPSB0cnVlLCBjYXB0dXJlID0gZmFsc2UpIHtcbiAgdG9nZ2xlTGlzdGVuZXIuY2FsbCh0aGlzLCBlbGVtZW50LCBldmVudHMsIGNhbGxiYWNrLCB0cnVlLCBwYXNzaXZlLCBjYXB0dXJlKTtcbn1cblxuLy8gVW5iaW5kIGV2ZW50IGhhbmRsZXJcbmV4cG9ydCBmdW5jdGlvbiBvZmYoZWxlbWVudCwgZXZlbnRzID0gJycsIGNhbGxiYWNrLCBwYXNzaXZlID0gdHJ1ZSwgY2FwdHVyZSA9IGZhbHNlKSB7XG4gIHRvZ2dsZUxpc3RlbmVyLmNhbGwodGhpcywgZWxlbWVudCwgZXZlbnRzLCBjYWxsYmFjaywgZmFsc2UsIHBhc3NpdmUsIGNhcHR1cmUpO1xufVxuXG4vLyBCaW5kIG9uY2Utb25seSBldmVudCBoYW5kbGVyXG5leHBvcnQgZnVuY3Rpb24gb25jZShlbGVtZW50LCBldmVudHMgPSAnJywgY2FsbGJhY2ssIHBhc3NpdmUgPSB0cnVlLCBjYXB0dXJlID0gZmFsc2UpIHtcbiAgY29uc3Qgb25jZUNhbGxiYWNrID0gKC4uLmFyZ3MpID0+IHtcbiAgICBvZmYoZWxlbWVudCwgZXZlbnRzLCBvbmNlQ2FsbGJhY2ssIHBhc3NpdmUsIGNhcHR1cmUpO1xuICAgIGNhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICB9O1xuXG4gIHRvZ2dsZUxpc3RlbmVyLmNhbGwodGhpcywgZWxlbWVudCwgZXZlbnRzLCBvbmNlQ2FsbGJhY2ssIHRydWUsIHBhc3NpdmUsIGNhcHR1cmUpO1xufVxuXG4vLyBUcmlnZ2VyIGV2ZW50XG5leHBvcnQgZnVuY3Rpb24gdHJpZ2dlckV2ZW50KGVsZW1lbnQsIHR5cGUgPSAnJywgYnViYmxlcyA9IGZhbHNlLCBkZXRhaWwgPSB7fSkge1xuICAvLyBCYWlsIGlmIG5vIGVsZW1lbnRcbiAgaWYgKCFpcy5lbGVtZW50KGVsZW1lbnQpIHx8IGlzLmVtcHR5KHR5cGUpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gQ3JlYXRlIGFuZCBkaXNwYXRjaCB0aGUgZXZlbnRcbiAgY29uc3QgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQodHlwZSwge1xuICAgIGJ1YmJsZXMsXG4gICAgZGV0YWlsOiB7IC4uLmRldGFpbCwgcGx5cjogdGhpcyB9LFxuICB9KTtcblxuICAvLyBEaXNwYXRjaCB0aGUgZXZlbnRcbiAgZWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbn1cblxuLy8gVW5iaW5kIGFsbCBjYWNoZWQgZXZlbnQgbGlzdGVuZXJzXG5leHBvcnQgZnVuY3Rpb24gdW5iaW5kTGlzdGVuZXJzKCkge1xuICBpZiAodGhpcyAmJiB0aGlzLmV2ZW50TGlzdGVuZXJzKSB7XG4gICAgdGhpcy5ldmVudExpc3RlbmVycy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCB7IGVsZW1lbnQsIHR5cGUsIGNhbGxiYWNrLCBvcHRpb25zIH0gPSBpdGVtO1xuICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGNhbGxiYWNrLCBvcHRpb25zKTtcbiAgICB9KTtcblxuICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMgPSBbXTtcbiAgfVxufVxuXG4vLyBSdW4gbWV0aG9kIHdoZW4gLyBpZiBwbGF5ZXIgaXMgcmVhZHlcbmV4cG9ydCBmdW5jdGlvbiByZWFkeSgpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PlxuICAgIHRoaXMucmVhZHkgPyBzZXRUaW1lb3V0KHJlc29sdmUsIDApIDogb24uY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgJ3JlYWR5JywgcmVzb2x2ZSksXG4gICkudGhlbigoKSA9PiB7fSk7XG59XG4iLCJpbXBvcnQgaXMgZnJvbSAnLi9pcyc7XG4vKipcbiAqIFNpbGVuY2UgYSBQcm9taXNlLWxpa2Ugb2JqZWN0LlxuICogVGhpcyBpcyB1c2VmdWwgZm9yIGF2b2lkaW5nIG5vbi1oYXJtZnVsLCBidXQgcG90ZW50aWFsbHkgY29uZnVzaW5nIFwidW5jYXVnaHRcbiAqIHBsYXkgcHJvbWlzZVwiIHJlamVjdGlvbiBlcnJvciBtZXNzYWdlcy5cbiAqIEBwYXJhbSAge09iamVjdH0gdmFsdWUgQW4gb2JqZWN0IHRoYXQgbWF5IG9yIG1heSBub3QgYmUgYFByb21pc2VgLWxpa2UuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaWxlbmNlUHJvbWlzZSh2YWx1ZSkge1xuICBpZiAoaXMucHJvbWlzZSh2YWx1ZSkpIHtcbiAgICB2YWx1ZS50aGVuKG51bGwsICgpID0+IHt9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCB7IHNpbGVuY2VQcm9taXNlIH07XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQXJyYXkgdXRpbHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBpcyBmcm9tICcuL2lzJztcblxuLy8gUmVtb3ZlIGR1cGxpY2F0ZXMgaW4gYW4gYXJyYXlcbmV4cG9ydCBmdW5jdGlvbiBkZWR1cGUoYXJyYXkpIHtcbiAgaWYgKCFpcy5hcnJheShhcnJheSkpIHtcbiAgICByZXR1cm4gYXJyYXk7XG4gIH1cblxuICByZXR1cm4gYXJyYXkuZmlsdGVyKChpdGVtLCBpbmRleCkgPT4gYXJyYXkuaW5kZXhPZihpdGVtKSA9PT0gaW5kZXgpO1xufVxuXG4vLyBHZXQgdGhlIGNsb3Nlc3QgdmFsdWUgaW4gYW4gYXJyYXlcbmV4cG9ydCBmdW5jdGlvbiBjbG9zZXN0KGFycmF5LCB2YWx1ZSkge1xuICBpZiAoIWlzLmFycmF5KGFycmF5KSB8fCAhYXJyYXkubGVuZ3RoKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gYXJyYXkucmVkdWNlKChwcmV2LCBjdXJyKSA9PiAoTWF0aC5hYnMoY3VyciAtIHZhbHVlKSA8IE1hdGguYWJzKHByZXYgLSB2YWx1ZSkgPyBjdXJyIDogcHJldikpO1xufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFN0eWxlIHV0aWxzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgeyBjbG9zZXN0IH0gZnJvbSAnLi9hcnJheXMnO1xuaW1wb3J0IGlzIGZyb20gJy4vaXMnO1xuXG4vLyBDaGVjayBzdXBwb3J0IGZvciBhIENTUyBkZWNsYXJhdGlvblxuZXhwb3J0IGZ1bmN0aW9uIHN1cHBvcnRzQ1NTKGRlY2xhcmF0aW9uKSB7XG4gIGlmICghd2luZG93IHx8ICF3aW5kb3cuQ1NTKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHdpbmRvdy5DU1Muc3VwcG9ydHMoZGVjbGFyYXRpb24pO1xufVxuXG4vLyBTdGFuZGFyZC9jb21tb24gYXNwZWN0IHJhdGlvc1xuY29uc3Qgc3RhbmRhcmRSYXRpb3MgPSBbXG4gIFsxLCAxXSxcbiAgWzQsIDNdLFxuICBbMywgNF0sXG4gIFs1LCA0XSxcbiAgWzQsIDVdLFxuICBbMywgMl0sXG4gIFsyLCAzXSxcbiAgWzE2LCAxMF0sXG4gIFsxMCwgMTZdLFxuICBbMTYsIDldLFxuICBbOSwgMTZdLFxuICBbMjEsIDldLFxuICBbOSwgMjFdLFxuICBbMzIsIDldLFxuICBbOSwgMzJdLFxuXS5yZWR1Y2UoKG91dCwgW3gsIHldKSA9PiAoeyAuLi5vdXQsIFt4IC8geV06IFt4LCB5XSB9KSwge30pO1xuXG4vLyBWYWxpZGF0ZSBhbiBhc3BlY3QgcmF0aW9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUFzcGVjdFJhdGlvKGlucHV0KSB7XG4gIGlmICghaXMuYXJyYXkoaW5wdXQpICYmICghaXMuc3RyaW5nKGlucHV0KSB8fCAhaW5wdXQuaW5jbHVkZXMoJzonKSkpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBjb25zdCByYXRpbyA9IGlzLmFycmF5KGlucHV0KSA/IGlucHV0IDogaW5wdXQuc3BsaXQoJzonKTtcblxuICByZXR1cm4gcmF0aW8ubWFwKE51bWJlcikuZXZlcnkoaXMubnVtYmVyKTtcbn1cblxuLy8gUmVkdWNlIGFuIGFzcGVjdCByYXRpbyB0byBpdCdzIGxvd2VzdCBmb3JtXG5leHBvcnQgZnVuY3Rpb24gcmVkdWNlQXNwZWN0UmF0aW8ocmF0aW8pIHtcbiAgaWYgKCFpcy5hcnJheShyYXRpbykgfHwgIXJhdGlvLmV2ZXJ5KGlzLm51bWJlcikpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IFt3aWR0aCwgaGVpZ2h0XSA9IHJhdGlvO1xuICBjb25zdCBnZXREaXZpZGVyID0gKHcsIGgpID0+IChoID09PSAwID8gdyA6IGdldERpdmlkZXIoaCwgdyAlIGgpKTtcbiAgY29uc3QgZGl2aWRlciA9IGdldERpdmlkZXIod2lkdGgsIGhlaWdodCk7XG5cbiAgcmV0dXJuIFt3aWR0aCAvIGRpdmlkZXIsIGhlaWdodCAvIGRpdmlkZXJdO1xufVxuXG4vLyBDYWxjdWxhdGUgYW4gYXNwZWN0IHJhdGlvXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXNwZWN0UmF0aW8oaW5wdXQpIHtcbiAgY29uc3QgcGFyc2UgPSAocmF0aW8pID0+ICh2YWxpZGF0ZUFzcGVjdFJhdGlvKHJhdGlvKSA/IHJhdGlvLnNwbGl0KCc6JykubWFwKE51bWJlcikgOiBudWxsKTtcbiAgLy8gVHJ5IHByb3ZpZGVkIHJhdGlvXG4gIGxldCByYXRpbyA9IHBhcnNlKGlucHV0KTtcblxuICAvLyBHZXQgZnJvbSBjb25maWdcbiAgaWYgKHJhdGlvID09PSBudWxsKSB7XG4gICAgcmF0aW8gPSBwYXJzZSh0aGlzLmNvbmZpZy5yYXRpbyk7XG4gIH1cblxuICAvLyBHZXQgZnJvbSBlbWJlZFxuICBpZiAocmF0aW8gPT09IG51bGwgJiYgIWlzLmVtcHR5KHRoaXMuZW1iZWQpICYmIGlzLmFycmF5KHRoaXMuZW1iZWQucmF0aW8pKSB7XG4gICAgKHsgcmF0aW8gfSA9IHRoaXMuZW1iZWQpO1xuICB9XG5cbiAgLy8gR2V0IGZyb20gSFRNTDUgdmlkZW9cbiAgaWYgKHJhdGlvID09PSBudWxsICYmIHRoaXMuaXNIVE1MNSkge1xuICAgIGNvbnN0IHsgdmlkZW9XaWR0aCwgdmlkZW9IZWlnaHQgfSA9IHRoaXMubWVkaWE7XG4gICAgcmF0aW8gPSBbdmlkZW9XaWR0aCwgdmlkZW9IZWlnaHRdO1xuICB9XG5cbiAgcmV0dXJuIHJlZHVjZUFzcGVjdFJhdGlvKHJhdGlvKTtcbn1cblxuLy8gU2V0IGFzcGVjdCByYXRpbyBmb3IgcmVzcG9uc2l2ZSBjb250YWluZXJcbmV4cG9ydCBmdW5jdGlvbiBzZXRBc3BlY3RSYXRpbyhpbnB1dCkge1xuICBpZiAoIXRoaXMuaXNWaWRlbykge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIGNvbnN0IHsgd3JhcHBlciB9ID0gdGhpcy5lbGVtZW50cztcbiAgY29uc3QgcmF0aW8gPSBnZXRBc3BlY3RSYXRpby5jYWxsKHRoaXMsIGlucHV0KTtcblxuICBpZiAoIWlzLmFycmF5KHJhdGlvKSkge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIGNvbnN0IFt4LCB5XSA9IHJlZHVjZUFzcGVjdFJhdGlvKHJhdGlvKTtcbiAgY29uc3QgdXNlTmF0aXZlID0gc3VwcG9ydHNDU1MoYGFzcGVjdC1yYXRpbzogJHt4fS8ke3l9YCk7XG4gIGNvbnN0IHBhZGRpbmcgPSAoMTAwIC8geCkgKiB5O1xuXG4gIGlmICh1c2VOYXRpdmUpIHtcbiAgICB3cmFwcGVyLnN0eWxlLmFzcGVjdFJhdGlvID0gYCR7eH0vJHt5fWA7XG4gIH0gZWxzZSB7XG4gICAgd3JhcHBlci5zdHlsZS5wYWRkaW5nQm90dG9tID0gYCR7cGFkZGluZ30lYDtcbiAgfVxuXG4gIC8vIEZvciBWaW1lbyB3ZSBoYXZlIGFuIGV4dHJhIDxkaXY+IHRvIGhpZGUgdGhlIHN0YW5kYXJkIGNvbnRyb2xzIGFuZCBVSVxuICBpZiAodGhpcy5pc1ZpbWVvICYmICF0aGlzLmNvbmZpZy52aW1lby5wcmVtaXVtICYmIHRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgY29uc3QgaGVpZ2h0ID0gKDEwMCAvIHRoaXMubWVkaWEub2Zmc2V0V2lkdGgpICogcGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5tZWRpYSkucGFkZGluZ0JvdHRvbSwgMTApO1xuICAgIGNvbnN0IG9mZnNldCA9IChoZWlnaHQgLSBwYWRkaW5nKSAvIChoZWlnaHQgLyA1MCk7XG5cbiAgICBpZiAodGhpcy5mdWxsc2NyZWVuLmFjdGl2ZSkge1xuICAgICAgd3JhcHBlci5zdHlsZS5wYWRkaW5nQm90dG9tID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tZWRpYS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlWSgtJHtvZmZzZXR9JSlgO1xuICAgIH1cbiAgfSBlbHNlIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQodGhpcy5jb25maWcuY2xhc3NOYW1lcy52aWRlb0ZpeGVkUmF0aW8pO1xuICB9XG5cbiAgcmV0dXJuIHsgcGFkZGluZywgcmF0aW8gfTtcbn1cblxuLy8gUm91bmQgYW4gYXNwZWN0IHJhdGlvIHRvIGNsb3Nlc3Qgc3RhbmRhcmQgcmF0aW9cbmV4cG9ydCBmdW5jdGlvbiByb3VuZEFzcGVjdFJhdGlvKHgsIHksIHRvbGVyYW5jZSA9IDAuMDUpIHtcbiAgY29uc3QgcmF0aW8gPSB4IC8geTtcbiAgY29uc3QgY2xvc2VzdFJhdGlvID0gY2xvc2VzdChPYmplY3Qua2V5cyhzdGFuZGFyZFJhdGlvcyksIHJhdGlvKTtcblxuICAvLyBDaGVjayBtYXRjaCBpcyB3aXRoaW4gdG9sZXJhbmNlXG4gIGlmIChNYXRoLmFicyhjbG9zZXN0UmF0aW8gLSByYXRpbykgPD0gdG9sZXJhbmNlKSB7XG4gICAgcmV0dXJuIHN0YW5kYXJkUmF0aW9zW2Nsb3Nlc3RSYXRpb107XG4gIH1cblxuICAvLyBObyBtYXRjaFxuICByZXR1cm4gW3gsIHldO1xufVxuXG4vLyBHZXQgdGhlIHNpemUgb2YgdGhlIHZpZXdwb3J0XG4vLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMjQ4MDgxL2hvdy10by1nZXQtdGhlLWJyb3dzZXItdmlld3BvcnQtZGltZW5zaW9uc1xuZXhwb3J0IGZ1bmN0aW9uIGdldFZpZXdwb3J0U2l6ZSgpIHtcbiAgY29uc3Qgd2lkdGggPSBNYXRoLm1heChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggfHwgMCwgd2luZG93LmlubmVyV2lkdGggfHwgMCk7XG4gIGNvbnN0IGhlaWdodCA9IE1hdGgubWF4KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgfHwgMCwgd2luZG93LmlubmVySGVpZ2h0IHx8IDApO1xuICByZXR1cm4gW3dpZHRoLCBoZWlnaHRdO1xufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgSFRNTDUgaGVscGVyc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IHN1cHBvcnQgZnJvbSAnLi9zdXBwb3J0JztcbmltcG9ydCB7IHJlbW92ZUVsZW1lbnQgfSBmcm9tICcuL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IHRyaWdnZXJFdmVudCB9IGZyb20gJy4vdXRpbHMvZXZlbnRzJztcbmltcG9ydCBpcyBmcm9tICcuL3V0aWxzL2lzJztcbmltcG9ydCB7IHNpbGVuY2VQcm9taXNlIH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7IHNldEFzcGVjdFJhdGlvIH0gZnJvbSAnLi91dGlscy9zdHlsZSc7XG5cbmNvbnN0IGh0bWw1ID0ge1xuICBnZXRTb3VyY2VzKCkge1xuICAgIGlmICghdGhpcy5pc0hUTUw1KSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgY29uc3Qgc291cmNlcyA9IEFycmF5LmZyb20odGhpcy5tZWRpYS5xdWVyeVNlbGVjdG9yQWxsKCdzb3VyY2UnKSk7XG5cbiAgICAvLyBGaWx0ZXIgb3V0IHVuc3VwcG9ydGVkIHNvdXJjZXMgKGlmIHR5cGUgaXMgc3BlY2lmaWVkKVxuICAgIHJldHVybiBzb3VyY2VzLmZpbHRlcigoc291cmNlKSA9PiB7XG4gICAgICBjb25zdCB0eXBlID0gc291cmNlLmdldEF0dHJpYnV0ZSgndHlwZScpO1xuXG4gICAgICBpZiAoaXMuZW1wdHkodHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzdXBwb3J0Lm1pbWUuY2FsbCh0aGlzLCB0eXBlKTtcbiAgICB9KTtcbiAgfSxcblxuICAvLyBHZXQgcXVhbGl0eSBsZXZlbHNcbiAgZ2V0UXVhbGl0eU9wdGlvbnMoKSB7XG4gICAgLy8gV2hldGhlciB3ZSdyZSBmb3JjaW5nIGFsbCBvcHRpb25zIChlLmcuIGZvciBzdHJlYW1pbmcpXG4gICAgaWYgKHRoaXMuY29uZmlnLnF1YWxpdHkuZm9yY2VkKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb25maWcucXVhbGl0eS5vcHRpb25zO1xuICAgIH1cblxuICAgIC8vIEdldCBzaXplcyBmcm9tIDxzb3VyY2U+IGVsZW1lbnRzXG4gICAgcmV0dXJuIGh0bWw1LmdldFNvdXJjZXNcbiAgICAgIC5jYWxsKHRoaXMpXG4gICAgICAubWFwKChzb3VyY2UpID0+IE51bWJlcihzb3VyY2UuZ2V0QXR0cmlidXRlKCdzaXplJykpKVxuICAgICAgLmZpbHRlcihCb29sZWFuKTtcbiAgfSxcblxuICBzZXR1cCgpIHtcbiAgICBpZiAoIXRoaXMuaXNIVE1MNSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHBsYXllciA9IHRoaXM7XG5cbiAgICAvLyBTZXQgc3BlZWQgb3B0aW9ucyBmcm9tIGNvbmZpZ1xuICAgIHBsYXllci5vcHRpb25zLnNwZWVkID0gcGxheWVyLmNvbmZpZy5zcGVlZC5vcHRpb25zO1xuXG4gICAgLy8gU2V0IGFzcGVjdCByYXRpbyBpZiBmaXhlZFxuICAgIGlmICghaXMuZW1wdHkodGhpcy5jb25maWcucmF0aW8pKSB7XG4gICAgICBzZXRBc3BlY3RSYXRpby5jYWxsKHBsYXllcik7XG4gICAgfVxuXG4gICAgLy8gUXVhbGl0eVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdxdWFsaXR5Jywge1xuICAgICAgZ2V0KCkge1xuICAgICAgICAvLyBHZXQgc291cmNlc1xuICAgICAgICBjb25zdCBzb3VyY2VzID0gaHRtbDUuZ2V0U291cmNlcy5jYWxsKHBsYXllcik7XG4gICAgICAgIGNvbnN0IHNvdXJjZSA9IHNvdXJjZXMuZmluZCgocykgPT4gcy5nZXRBdHRyaWJ1dGUoJ3NyYycpID09PSBwbGF5ZXIuc291cmNlKTtcblxuICAgICAgICAvLyBSZXR1cm4gc2l6ZSwgaWYgbWF0Y2ggaXMgZm91bmRcbiAgICAgICAgcmV0dXJuIHNvdXJjZSAmJiBOdW1iZXIoc291cmNlLmdldEF0dHJpYnV0ZSgnc2l6ZScpKTtcbiAgICAgIH0sXG4gICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgaWYgKHBsYXllci5xdWFsaXR5ID09PSBpbnB1dCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHdlJ3JlIHVzaW5nIGFuIGV4dGVybmFsIGhhbmRsZXIuLi5cbiAgICAgICAgaWYgKHBsYXllci5jb25maWcucXVhbGl0eS5mb3JjZWQgJiYgaXMuZnVuY3Rpb24ocGxheWVyLmNvbmZpZy5xdWFsaXR5Lm9uQ2hhbmdlKSkge1xuICAgICAgICAgIHBsYXllci5jb25maWcucXVhbGl0eS5vbkNoYW5nZShpbnB1dCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gR2V0IHNvdXJjZXNcbiAgICAgICAgICBjb25zdCBzb3VyY2VzID0gaHRtbDUuZ2V0U291cmNlcy5jYWxsKHBsYXllcik7XG4gICAgICAgICAgLy8gR2V0IGZpcnN0IG1hdGNoIGZvciByZXF1ZXN0ZWQgc2l6ZVxuICAgICAgICAgIGNvbnN0IHNvdXJjZSA9IHNvdXJjZXMuZmluZCgocykgPT4gTnVtYmVyKHMuZ2V0QXR0cmlidXRlKCdzaXplJykpID09PSBpbnB1dCk7XG5cbiAgICAgICAgICAvLyBObyBtYXRjaGluZyBzb3VyY2UgZm91bmRcbiAgICAgICAgICBpZiAoIXNvdXJjZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEdldCBjdXJyZW50IHN0YXRlXG4gICAgICAgICAgY29uc3QgeyBjdXJyZW50VGltZSwgcGF1c2VkLCBwcmVsb2FkLCByZWFkeVN0YXRlLCBwbGF5YmFja1JhdGUgfSA9IHBsYXllci5tZWRpYTtcblxuICAgICAgICAgIC8vIFNldCBuZXcgc291cmNlXG4gICAgICAgICAgcGxheWVyLm1lZGlhLnNyYyA9IHNvdXJjZS5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuXG4gICAgICAgICAgLy8gUHJldmVudCBsb2FkaW5nIGlmIHByZWxvYWQ9XCJub25lXCIgYW5kIHRoZSBjdXJyZW50IHNvdXJjZSBpc24ndCBsb2FkZWQgKCMxMDQ0KVxuICAgICAgICAgIGlmIChwcmVsb2FkICE9PSAnbm9uZScgfHwgcmVhZHlTdGF0ZSkge1xuICAgICAgICAgICAgLy8gUmVzdG9yZSB0aW1lXG4gICAgICAgICAgICBwbGF5ZXIub25jZSgnbG9hZGVkbWV0YWRhdGEnLCAoKSA9PiB7XG4gICAgICAgICAgICAgIHBsYXllci5zcGVlZCA9IHBsYXliYWNrUmF0ZTtcbiAgICAgICAgICAgICAgcGxheWVyLmN1cnJlbnRUaW1lID0gY3VycmVudFRpbWU7XG5cbiAgICAgICAgICAgICAgLy8gUmVzdW1lIHBsYXlpbmdcbiAgICAgICAgICAgICAgaWYgKCFwYXVzZWQpIHtcbiAgICAgICAgICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIucGxheSgpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIExvYWQgbmV3IHNvdXJjZVxuICAgICAgICAgICAgcGxheWVyLm1lZGlhLmxvYWQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcmlnZ2VyIGNoYW5nZSBldmVudFxuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3F1YWxpdHljaGFuZ2UnLCBmYWxzZSwge1xuICAgICAgICAgIHF1YWxpdHk6IGlucHV0LFxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0sXG5cbiAgLy8gQ2FuY2VsIGN1cnJlbnQgbmV0d29yayByZXF1ZXN0c1xuICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzE3NFxuICBjYW5jZWxSZXF1ZXN0cygpIHtcbiAgICBpZiAoIXRoaXMuaXNIVE1MNSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFJlbW92ZSBjaGlsZCBzb3VyY2VzXG4gICAgcmVtb3ZlRWxlbWVudChodG1sNS5nZXRTb3VyY2VzLmNhbGwodGhpcykpO1xuXG4gICAgLy8gU2V0IGJsYW5rIHZpZGVvIHNyYyBhdHRyaWJ1dGVcbiAgICAvLyBUaGlzIGlzIHRvIHByZXZlbnQgYSBNRURJQV9FUlJfU1JDX05PVF9TVVBQT1JURUQgZXJyb3JcbiAgICAvLyBJbmZvOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzMyMjMxNTc5L2hvdy10by1wcm9wZXJseS1kaXNwb3NlLW9mLWFuLWh0bWw1LXZpZGVvLWFuZC1jbG9zZS1zb2NrZXQtb3ItY29ubmVjdGlvblxuICAgIHRoaXMubWVkaWEuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLmNvbmZpZy5ibGFua1ZpZGVvKTtcblxuICAgIC8vIExvYWQgdGhlIG5ldyBlbXB0eSBzb3VyY2VcbiAgICAvLyBUaGlzIHdpbGwgY2FuY2VsIGV4aXN0aW5nIHJlcXVlc3RzXG4gICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy8xNzRcbiAgICB0aGlzLm1lZGlhLmxvYWQoKTtcblxuICAgIC8vIERlYnVnZ2luZ1xuICAgIHRoaXMuZGVidWcubG9nKCdDYW5jZWxsZWQgbmV0d29yayByZXF1ZXN0cycpO1xuICB9LFxufTtcblxuZXhwb3J0IGRlZmF1bHQgaHRtbDU7XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU3RyaW5nIHV0aWxzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgaXMgZnJvbSAnLi9pcyc7XG5cbi8vIEdlbmVyYXRlIGEgcmFuZG9tIElEXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVJZChwcmVmaXgpIHtcbiAgcmV0dXJuIGAke3ByZWZpeH0tJHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCl9YDtcbn1cblxuLy8gRm9ybWF0IHN0cmluZ1xuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdChpbnB1dCwgLi4uYXJncykge1xuICBpZiAoaXMuZW1wdHkoaW5wdXQpKSByZXR1cm4gaW5wdXQ7XG5cbiAgcmV0dXJuIGlucHV0LnRvU3RyaW5nKCkucmVwbGFjZSgveyhcXGQrKX0vZywgKG1hdGNoLCBpKSA9PiBhcmdzW2ldLnRvU3RyaW5nKCkpO1xufVxuXG4vLyBHZXQgcGVyY2VudGFnZVxuZXhwb3J0IGZ1bmN0aW9uIGdldFBlcmNlbnRhZ2UoY3VycmVudCwgbWF4KSB7XG4gIGlmIChjdXJyZW50ID09PSAwIHx8IG1heCA9PT0gMCB8fCBOdW1iZXIuaXNOYU4oY3VycmVudCkgfHwgTnVtYmVyLmlzTmFOKG1heCkpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIHJldHVybiAoKGN1cnJlbnQgLyBtYXgpICogMTAwKS50b0ZpeGVkKDIpO1xufVxuXG4vLyBSZXBsYWNlIGFsbCBvY2N1cnJlbmNlcyBvZiBhIHN0cmluZyBpbiBhIHN0cmluZ1xuZXhwb3J0IGNvbnN0IHJlcGxhY2VBbGwgPSAoaW5wdXQgPSAnJywgZmluZCA9ICcnLCByZXBsYWNlID0gJycpID0+XG4gIGlucHV0LnJlcGxhY2UobmV3IFJlZ0V4cChmaW5kLnRvU3RyaW5nKCkucmVwbGFjZSgvKFsuKis/Xj0hOiR7fSgpfFtcXF0vXFxcXF0pL2csICdcXFxcJDEnKSwgJ2cnKSwgcmVwbGFjZS50b1N0cmluZygpKTtcblxuLy8gQ29udmVydCB0byB0aXRsZSBjYXNlXG5leHBvcnQgY29uc3QgdG9UaXRsZUNhc2UgPSAoaW5wdXQgPSAnJykgPT5cbiAgaW5wdXQudG9TdHJpbmcoKS5yZXBsYWNlKC9cXHdcXFMqL2csICh0ZXh0KSA9PiB0ZXh0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGV4dC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpKTtcblxuLy8gQ29udmVydCBzdHJpbmcgdG8gcGFzY2FsQ2FzZVxuZXhwb3J0IGZ1bmN0aW9uIHRvUGFzY2FsQ2FzZShpbnB1dCA9ICcnKSB7XG4gIGxldCBzdHJpbmcgPSBpbnB1dC50b1N0cmluZygpO1xuXG4gIC8vIENvbnZlcnQga2ViYWIgY2FzZVxuICBzdHJpbmcgPSByZXBsYWNlQWxsKHN0cmluZywgJy0nLCAnICcpO1xuXG4gIC8vIENvbnZlcnQgc25ha2UgY2FzZVxuICBzdHJpbmcgPSByZXBsYWNlQWxsKHN0cmluZywgJ18nLCAnICcpO1xuXG4gIC8vIENvbnZlcnQgdG8gdGl0bGUgY2FzZVxuICBzdHJpbmcgPSB0b1RpdGxlQ2FzZShzdHJpbmcpO1xuXG4gIC8vIENvbnZlcnQgdG8gcGFzY2FsIGNhc2VcbiAgcmV0dXJuIHJlcGxhY2VBbGwoc3RyaW5nLCAnICcsICcnKTtcbn1cblxuLy8gQ29udmVydCBzdHJpbmcgdG8gcGFzY2FsQ2FzZVxuZXhwb3J0IGZ1bmN0aW9uIHRvQ2FtZWxDYXNlKGlucHV0ID0gJycpIHtcbiAgbGV0IHN0cmluZyA9IGlucHV0LnRvU3RyaW5nKCk7XG5cbiAgLy8gQ29udmVydCB0byBwYXNjYWwgY2FzZVxuICBzdHJpbmcgPSB0b1Bhc2NhbENhc2Uoc3RyaW5nKTtcblxuICAvLyBDb252ZXJ0IGZpcnN0IGNoYXJhY3RlciB0byBsb3dlcmNhc2VcbiAgcmV0dXJuIHN0cmluZy5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIHN0cmluZy5zbGljZSgxKTtcbn1cblxuLy8gUmVtb3ZlIEhUTUwgZnJvbSBhIHN0cmluZ1xuZXhwb3J0IGZ1bmN0aW9uIHN0cmlwSFRNTChzb3VyY2UpIHtcbiAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gIGVsZW1lbnQuaW5uZXJIVE1MID0gc291cmNlO1xuICByZXR1cm4gZnJhZ21lbnQuZmlyc3RDaGlsZC5pbm5lclRleHQ7XG59XG5cbi8vIExpa2Ugb3V0ZXJIVE1MLCBidXQgYWxzbyB3b3JrcyBmb3IgRG9jdW1lbnRGcmFnbWVudFxuZXhwb3J0IGZ1bmN0aW9uIGdldEhUTUwoZWxlbWVudCkge1xuICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHdyYXBwZXIuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gIHJldHVybiB3cmFwcGVyLmlubmVySFRNTDtcbn1cbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIGludGVybmF0aW9uYWxpemF0aW9uXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgaXMgZnJvbSAnLi9pcyc7XG5pbXBvcnQgeyBnZXREZWVwIH0gZnJvbSAnLi9vYmplY3RzJztcbmltcG9ydCB7IHJlcGxhY2VBbGwgfSBmcm9tICcuL3N0cmluZ3MnO1xuXG4vLyBTa2lwIGkxOG4gZm9yIGFiYnJldmlhdGlvbnMgYW5kIGJyYW5kIG5hbWVzXG5jb25zdCByZXNvdXJjZXMgPSB7XG4gIHBpcDogJ1BJUCcsXG4gIGFpcnBsYXk6ICdBaXJQbGF5JyxcbiAgaHRtbDU6ICdIVE1MNScsXG4gIHZpbWVvOiAnVmltZW8nLFxuICB5b3V0dWJlOiAnWW91VHViZScsXG59O1xuXG5jb25zdCBpMThuID0ge1xuICBnZXQoa2V5ID0gJycsIGNvbmZpZyA9IHt9KSB7XG4gICAgaWYgKGlzLmVtcHR5KGtleSkgfHwgaXMuZW1wdHkoY29uZmlnKSkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIGxldCBzdHJpbmcgPSBnZXREZWVwKGNvbmZpZy5pMThuLCBrZXkpO1xuXG4gICAgaWYgKGlzLmVtcHR5KHN0cmluZykpIHtcbiAgICAgIGlmIChPYmplY3Qua2V5cyhyZXNvdXJjZXMpLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgcmV0dXJuIHJlc291cmNlc1trZXldO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgY29uc3QgcmVwbGFjZSA9IHtcbiAgICAgICd7c2Vla3RpbWV9JzogY29uZmlnLnNlZWtUaW1lLFxuICAgICAgJ3t0aXRsZX0nOiBjb25maWcudGl0bGUsXG4gICAgfTtcblxuICAgIE9iamVjdC5lbnRyaWVzKHJlcGxhY2UpLmZvckVhY2goKFtrLCB2XSkgPT4ge1xuICAgICAgc3RyaW5nID0gcmVwbGFjZUFsbChzdHJpbmcsIGssIHYpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0cmluZztcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGkxOG47XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUGx5ciBzdG9yYWdlXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgaXMgZnJvbSAnLi91dGlscy9pcyc7XG5pbXBvcnQgeyBleHRlbmQgfSBmcm9tICcuL3V0aWxzL29iamVjdHMnO1xuXG5jbGFzcyBTdG9yYWdlIHtcbiAgY29uc3RydWN0b3IocGxheWVyKSB7XG4gICAgdGhpcy5lbmFibGVkID0gcGxheWVyLmNvbmZpZy5zdG9yYWdlLmVuYWJsZWQ7XG4gICAgdGhpcy5rZXkgPSBwbGF5ZXIuY29uZmlnLnN0b3JhZ2Uua2V5O1xuICB9XG5cbiAgLy8gQ2hlY2sgZm9yIGFjdHVhbCBzdXBwb3J0IChzZWUgaWYgd2UgY2FuIHVzZSBpdClcbiAgc3RhdGljIGdldCBzdXBwb3J0ZWQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghKCdsb2NhbFN0b3JhZ2UnIGluIHdpbmRvdykpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0ZXN0ID0gJ19fX3Rlc3QnO1xuXG4gICAgICAvLyBUcnkgdG8gdXNlIGl0IChpdCBtaWdodCBiZSBkaXNhYmxlZCwgZS5nLiB1c2VyIGlzIGluIHByaXZhdGUgbW9kZSlcbiAgICAgIC8vIHNlZTogaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzEzMVxuICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKHRlc3QsIHRlc3QpO1xuICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRlc3QpO1xuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChfKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgZ2V0ID0gKGtleSkgPT4ge1xuICAgIGlmICghU3RvcmFnZS5zdXBwb3J0ZWQgfHwgIXRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3Qgc3RvcmUgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5rZXkpO1xuXG4gICAgaWYgKGlzLmVtcHR5KHN0b3JlKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QganNvbiA9IEpTT04ucGFyc2Uoc3RvcmUpO1xuXG4gICAgcmV0dXJuIGlzLnN0cmluZyhrZXkpICYmIGtleS5sZW5ndGggPyBqc29uW2tleV0gOiBqc29uO1xuICB9O1xuXG4gIHNldCA9IChvYmplY3QpID0+IHtcbiAgICAvLyBCYWlsIGlmIHdlIGRvbid0IGhhdmUgbG9jYWxTdG9yYWdlIHN1cHBvcnQgb3IgaXQncyBkaXNhYmxlZFxuICAgIGlmICghU3RvcmFnZS5zdXBwb3J0ZWQgfHwgIXRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENhbiBvbmx5IHN0b3JlIG9iamVjdHN0XG4gICAgaWYgKCFpcy5vYmplY3Qob2JqZWN0KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdldCBjdXJyZW50IHN0b3JhZ2VcbiAgICBsZXQgc3RvcmFnZSA9IHRoaXMuZ2V0KCk7XG5cbiAgICAvLyBEZWZhdWx0IHRvIGVtcHR5IG9iamVjdFxuICAgIGlmIChpcy5lbXB0eShzdG9yYWdlKSkge1xuICAgICAgc3RvcmFnZSA9IHt9O1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB0aGUgd29ya2luZyBjb3B5IG9mIHRoZSB2YWx1ZXNcbiAgICBleHRlbmQoc3RvcmFnZSwgb2JqZWN0KTtcblxuICAgIC8vIFVwZGF0ZSBzdG9yYWdlXG4gICAgdHJ5IHtcbiAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLmtleSwgSlNPTi5zdHJpbmdpZnkoc3RvcmFnZSkpO1xuICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgIC8vIERvIG5vdGhpbmdcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IFN0b3JhZ2U7XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRmV0Y2ggd3JhcHBlclxuLy8gVXNpbmcgWEhSIHRvIGF2b2lkIGlzc3VlcyB3aXRoIG9sZGVyIGJyb3dzZXJzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBmZXRjaCh1cmwsIHJlc3BvbnNlVHlwZSA9ICd0ZXh0Jykge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICAgIC8vIENoZWNrIGZvciBDT1JTIHN1cHBvcnRcbiAgICAgIGlmICghKCd3aXRoQ3JlZGVudGlhbHMnIGluIHJlcXVlc3QpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xuICAgICAgICBpZiAocmVzcG9uc2VUeXBlID09PSAndGV4dCcpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzb2x2ZShKU09OLnBhcnNlKHJlcXVlc3QucmVzcG9uc2VUZXh0KSk7XG4gICAgICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUocmVxdWVzdC5yZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVxdWVzdC5zdGF0dXMpO1xuICAgICAgfSk7XG5cbiAgICAgIHJlcXVlc3Qub3BlbignR0VUJywgdXJsLCB0cnVlKTtcblxuICAgICAgLy8gU2V0IHRoZSByZXF1aXJlZCByZXNwb25zZSB0eXBlXG4gICAgICByZXF1ZXN0LnJlc3BvbnNlVHlwZSA9IHJlc3BvbnNlVHlwZTtcblxuICAgICAgcmVxdWVzdC5zZW5kKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJlamVjdChlcnJvcik7XG4gICAgfVxuICB9KTtcbn1cbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBTcHJpdGUgbG9hZGVyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgU3RvcmFnZSBmcm9tICcuLi9zdG9yYWdlJztcbmltcG9ydCBmZXRjaCBmcm9tICcuL2ZldGNoJztcbmltcG9ydCBpcyBmcm9tICcuL2lzJztcblxuLy8gTG9hZCBhbiBleHRlcm5hbCBTVkcgc3ByaXRlXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBsb2FkU3ByaXRlKHVybCwgaWQpIHtcbiAgaWYgKCFpcy5zdHJpbmcodXJsKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHByZWZpeCA9ICdjYWNoZSc7XG4gIGNvbnN0IGhhc0lkID0gaXMuc3RyaW5nKGlkKTtcbiAgbGV0IGlzQ2FjaGVkID0gZmFsc2U7XG4gIGNvbnN0IGV4aXN0cyA9ICgpID0+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKSAhPT0gbnVsbDtcblxuICBjb25zdCB1cGRhdGUgPSAoY29udGFpbmVyLCBkYXRhKSA9PiB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgY29udGFpbmVyLmlubmVySFRNTCA9IGRhdGE7XG5cbiAgICAvLyBDaGVjayBhZ2FpbiBpbmNhc2Ugb2YgcmFjZSBjb25kaXRpb25cbiAgICBpZiAoaGFzSWQgJiYgZXhpc3RzKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBJbmplY3QgdGhlIFNWRyB0byB0aGUgYm9keVxuICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmJlZ2luJywgY29udGFpbmVyKTtcbiAgfTtcblxuICAvLyBPbmx5IGxvYWQgb25jZSBpZiBJRCBzZXRcbiAgaWYgKCFoYXNJZCB8fCAhZXhpc3RzKCkpIHtcbiAgICBjb25zdCB1c2VTdG9yYWdlID0gU3RvcmFnZS5zdXBwb3J0ZWQ7XG4gICAgLy8gQ3JlYXRlIGNvbnRhaW5lclxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcblxuICAgIGlmIChoYXNJZCkge1xuICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnaWQnLCBpZCk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaW4gY2FjaGVcbiAgICBpZiAodXNlU3RvcmFnZSkge1xuICAgICAgY29uc3QgY2FjaGVkID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGAke3ByZWZpeH0tJHtpZH1gKTtcbiAgICAgIGlzQ2FjaGVkID0gY2FjaGVkICE9PSBudWxsO1xuXG4gICAgICBpZiAoaXNDYWNoZWQpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoY2FjaGVkKTtcbiAgICAgICAgdXBkYXRlKGNvbnRhaW5lciwgZGF0YS5jb250ZW50KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIHNwcml0ZVxuICAgIGZldGNoKHVybClcbiAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgaWYgKGlzLmVtcHR5KHJlc3VsdCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodXNlU3RvcmFnZSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXG4gICAgICAgICAgICAgIGAke3ByZWZpeH0tJHtpZH1gLFxuICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgY29udGVudDogcmVzdWx0LFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICAgICAgLy8gRG8gbm90aGluZ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHVwZGF0ZShjb250YWluZXIsIHJlc3VsdCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKCgpID0+IHt9KTtcbiAgfVxufVxuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRpbWUgdXRpbHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBpcyBmcm9tICcuL2lzJztcblxuLy8gVGltZSBoZWxwZXJzXG5leHBvcnQgY29uc3QgZ2V0SG91cnMgPSAodmFsdWUpID0+IE1hdGgudHJ1bmMoKHZhbHVlIC8gNjAgLyA2MCkgJSA2MCwgMTApO1xuZXhwb3J0IGNvbnN0IGdldE1pbnV0ZXMgPSAodmFsdWUpID0+IE1hdGgudHJ1bmMoKHZhbHVlIC8gNjApICUgNjAsIDEwKTtcbmV4cG9ydCBjb25zdCBnZXRTZWNvbmRzID0gKHZhbHVlKSA9PiBNYXRoLnRydW5jKHZhbHVlICUgNjAsIDEwKTtcblxuLy8gRm9ybWF0IHRpbWUgdG8gVUkgZnJpZW5kbHkgc3RyaW5nXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0VGltZSh0aW1lID0gMCwgZGlzcGxheUhvdXJzID0gZmFsc2UsIGludmVydGVkID0gZmFsc2UpIHtcbiAgLy8gQmFpbCBpZiB0aGUgdmFsdWUgaXNuJ3QgYSBudW1iZXJcbiAgaWYgKCFpcy5udW1iZXIodGltZSkpIHtcbiAgICByZXR1cm4gZm9ybWF0VGltZSh1bmRlZmluZWQsIGRpc3BsYXlIb3VycywgaW52ZXJ0ZWQpO1xuICB9XG5cbiAgLy8gRm9ybWF0IHRpbWUgY29tcG9uZW50IHRvIGFkZCBsZWFkaW5nIHplcm9cbiAgY29uc3QgZm9ybWF0ID0gKHZhbHVlKSA9PiBgMCR7dmFsdWV9YC5zbGljZSgtMik7XG4gIC8vIEJyZWFrZG93biB0byBob3VycywgbWlucywgc2Vjc1xuICBsZXQgaG91cnMgPSBnZXRIb3Vycyh0aW1lKTtcbiAgY29uc3QgbWlucyA9IGdldE1pbnV0ZXModGltZSk7XG4gIGNvbnN0IHNlY3MgPSBnZXRTZWNvbmRzKHRpbWUpO1xuXG4gIC8vIERvIHdlIG5lZWQgdG8gZGlzcGxheSBob3Vycz9cbiAgaWYgKGRpc3BsYXlIb3VycyB8fCBob3VycyA+IDApIHtcbiAgICBob3VycyA9IGAke2hvdXJzfTpgO1xuICB9IGVsc2Uge1xuICAgIGhvdXJzID0gJyc7XG4gIH1cblxuICAvLyBSZW5kZXJcbiAgcmV0dXJuIGAke2ludmVydGVkICYmIHRpbWUgPiAwID8gJy0nIDogJyd9JHtob3Vyc30ke2Zvcm1hdChtaW5zKX06JHtmb3JtYXQoc2Vjcyl9YDtcbn1cbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIGNvbnRyb2xzXG4vLyBUT0RPOiBUaGlzIG5lZWRzIHRvIGJlIHNwbGl0IGludG8gc21hbGxlciBmaWxlcyBhbmQgY2xlYW5lZCB1cFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IFJhbmdlVG91Y2ggZnJvbSAncmFuZ2V0b3VjaCc7XG5cbmltcG9ydCBjYXB0aW9ucyBmcm9tICcuL2NhcHRpb25zJztcbmltcG9ydCBodG1sNSBmcm9tICcuL2h0bWw1JztcbmltcG9ydCBzdXBwb3J0IGZyb20gJy4vc3VwcG9ydCc7XG5pbXBvcnQgeyByZXBhaW50LCB0cmFuc2l0aW9uRW5kRXZlbnQgfSBmcm9tICcuL3V0aWxzL2FuaW1hdGlvbic7XG5pbXBvcnQgeyBkZWR1cGUgfSBmcm9tICcuL3V0aWxzL2FycmF5cyc7XG5pbXBvcnQgYnJvd3NlciBmcm9tICcuL3V0aWxzL2Jyb3dzZXInO1xuaW1wb3J0IHtcbiAgY3JlYXRlRWxlbWVudCxcbiAgZW1wdHlFbGVtZW50LFxuICBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yLFxuICBnZXRFbGVtZW50LFxuICBnZXRFbGVtZW50cyxcbiAgaGFzQ2xhc3MsXG4gIG1hdGNoZXMsXG4gIHJlbW92ZUVsZW1lbnQsXG4gIHNldEF0dHJpYnV0ZXMsXG4gIHNldEZvY3VzLFxuICB0b2dnbGVDbGFzcyxcbiAgdG9nZ2xlSGlkZGVuLFxufSBmcm9tICcuL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IG9mZiwgb24gfSBmcm9tICcuL3V0aWxzL2V2ZW50cyc7XG5pbXBvcnQgaTE4biBmcm9tICcuL3V0aWxzL2kxOG4nO1xuaW1wb3J0IGlzIGZyb20gJy4vdXRpbHMvaXMnO1xuaW1wb3J0IGxvYWRTcHJpdGUgZnJvbSAnLi91dGlscy9sb2FkLXNwcml0ZSc7XG5pbXBvcnQgeyBleHRlbmQgfSBmcm9tICcuL3V0aWxzL29iamVjdHMnO1xuaW1wb3J0IHsgZ2V0UGVyY2VudGFnZSwgcmVwbGFjZUFsbCwgdG9DYW1lbENhc2UsIHRvVGl0bGVDYXNlIH0gZnJvbSAnLi91dGlscy9zdHJpbmdzJztcbmltcG9ydCB7IGZvcm1hdFRpbWUsIGdldEhvdXJzIH0gZnJvbSAnLi91dGlscy90aW1lJztcblxuLy8gVE9ETzogRG9uJ3QgZXhwb3J0IGEgbWFzc2l2ZSBvYmplY3QgLSBicmVhayBkb3duIGFuZCBjcmVhdGUgY2xhc3NcbmNvbnN0IGNvbnRyb2xzID0ge1xuICAvLyBHZXQgaWNvbiBVUkxcbiAgZ2V0SWNvblVybCgpIHtcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHRoaXMuY29uZmlnLmljb25VcmwsIHdpbmRvdy5sb2NhdGlvbik7XG4gICAgY29uc3QgaG9zdCA9IHdpbmRvdy5sb2NhdGlvbi5ob3N0ID8gd2luZG93LmxvY2F0aW9uLmhvc3QgOiB3aW5kb3cudG9wLmxvY2F0aW9uLmhvc3Q7XG4gICAgY29uc3QgY29ycyA9IHVybC5ob3N0ICE9PSBob3N0IHx8IChicm93c2VyLmlzSUUgJiYgIXdpbmRvdy5zdmc0ZXZlcnlib2R5KTtcblxuICAgIHJldHVybiB7XG4gICAgICB1cmw6IHRoaXMuY29uZmlnLmljb25VcmwsXG4gICAgICBjb3JzLFxuICAgIH07XG4gIH0sXG5cbiAgLy8gRmluZCB0aGUgVUkgY29udHJvbHNcbiAgZmluZEVsZW1lbnRzKCkge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xzID0gZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jb250cm9scy53cmFwcGVyKTtcblxuICAgICAgLy8gQnV0dG9uc1xuICAgICAgdGhpcy5lbGVtZW50cy5idXR0b25zID0ge1xuICAgICAgICBwbGF5OiBnZXRFbGVtZW50cy5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnBsYXkpLFxuICAgICAgICBwYXVzZTogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnBhdXNlKSxcbiAgICAgICAgcmVzdGFydDogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnJlc3RhcnQpLFxuICAgICAgICByZXdpbmQ6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5yZXdpbmQpLFxuICAgICAgICBmYXN0Rm9yd2FyZDogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLmZhc3RGb3J3YXJkKSxcbiAgICAgICAgbXV0ZTogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLm11dGUpLFxuICAgICAgICBwaXA6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9ucy5waXApLFxuICAgICAgICBhaXJwbGF5OiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuYWlycGxheSksXG4gICAgICAgIHNldHRpbmdzOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmJ1dHRvbnMuc2V0dGluZ3MpLFxuICAgICAgICBjYXB0aW9uczogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLmNhcHRpb25zKSxcbiAgICAgICAgZnVsbHNjcmVlbjogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLmZ1bGxzY3JlZW4pLFxuICAgICAgfTtcblxuICAgICAgLy8gUHJvZ3Jlc3NcbiAgICAgIHRoaXMuZWxlbWVudHMucHJvZ3Jlc3MgPSBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLnByb2dyZXNzKTtcblxuICAgICAgLy8gSW5wdXRzXG4gICAgICB0aGlzLmVsZW1lbnRzLmlucHV0cyA9IHtcbiAgICAgICAgc2VlazogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5pbnB1dHMuc2VlayksXG4gICAgICAgIHZvbHVtZTogZ2V0RWxlbWVudC5jYWxsKHRoaXMsIHRoaXMuY29uZmlnLnNlbGVjdG9ycy5pbnB1dHMudm9sdW1lKSxcbiAgICAgIH07XG5cbiAgICAgIC8vIERpc3BsYXlcbiAgICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheSA9IHtcbiAgICAgICAgYnVmZmVyOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmRpc3BsYXkuYnVmZmVyKSxcbiAgICAgICAgY3VycmVudFRpbWU6IGdldEVsZW1lbnQuY2FsbCh0aGlzLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuZGlzcGxheS5jdXJyZW50VGltZSksXG4gICAgICAgIGR1cmF0aW9uOiBnZXRFbGVtZW50LmNhbGwodGhpcywgdGhpcy5jb25maWcuc2VsZWN0b3JzLmRpc3BsYXkuZHVyYXRpb24pLFxuICAgICAgfTtcblxuICAgICAgLy8gU2VlayB0b29sdGlwXG4gICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLnByb2dyZXNzKSkge1xuICAgICAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXAgPSB0aGlzLmVsZW1lbnRzLnByb2dyZXNzLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcH1gKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIExvZyBpdFxuICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdJdCBsb29rcyBsaWtlIHRoZXJlIGlzIGEgcHJvYmxlbSB3aXRoIHlvdXIgY3VzdG9tIGNvbnRyb2xzIEhUTUwnLCBlcnJvcik7XG5cbiAgICAgIC8vIFJlc3RvcmUgbmF0aXZlIHZpZGVvIGNvbnRyb2xzXG4gICAgICB0aGlzLnRvZ2dsZU5hdGl2ZUNvbnRyb2xzKHRydWUpO1xuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9LFxuXG4gIC8vIENyZWF0ZSA8c3ZnPiBpY29uXG4gIGNyZWF0ZUljb24odHlwZSwgYXR0cmlidXRlcykge1xuICAgIGNvbnN0IG5hbWVzcGFjZSA9ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc7XG4gICAgY29uc3QgaWNvblVybCA9IGNvbnRyb2xzLmdldEljb25VcmwuY2FsbCh0aGlzKTtcbiAgICBjb25zdCBpY29uUGF0aCA9IGAkeyFpY29uVXJsLmNvcnMgPyBpY29uVXJsLnVybCA6ICcnfSMke3RoaXMuY29uZmlnLmljb25QcmVmaXh9YDtcbiAgICAvLyBDcmVhdGUgPHN2Zz5cbiAgICBjb25zdCBpY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKG5hbWVzcGFjZSwgJ3N2ZycpO1xuICAgIHNldEF0dHJpYnV0ZXMoXG4gICAgICBpY29uLFxuICAgICAgZXh0ZW5kKGF0dHJpYnV0ZXMsIHtcbiAgICAgICAgJ2FyaWEtaGlkZGVuJzogJ3RydWUnLFxuICAgICAgICBmb2N1c2FibGU6ICdmYWxzZScsXG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSA8dXNlPiB0byByZWZlcmVuY2Ugc3ByaXRlXG4gICAgY29uc3QgdXNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKG5hbWVzcGFjZSwgJ3VzZScpO1xuICAgIGNvbnN0IHBhdGggPSBgJHtpY29uUGF0aH0tJHt0eXBlfWA7XG5cbiAgICAvLyBTZXQgYGhyZWZgIGF0dHJpYnV0ZXNcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvNDYwXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvU1ZHL0F0dHJpYnV0ZS94bGluazpocmVmXG4gICAgaWYgKCdocmVmJyBpbiB1c2UpIHtcbiAgICAgIHVzZS5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsICdocmVmJywgcGF0aCk7XG4gICAgfVxuXG4gICAgLy8gQWx3YXlzIHNldCB0aGUgb2xkZXIgYXR0cmlidXRlIGV2ZW4gdGhvdWdoIGl0J3MgXCJkZXByZWNhdGVkXCIgKGl0J2xsIGJlIGFyb3VuZCBmb3IgYWdlcylcbiAgICB1c2Uuc2V0QXR0cmlidXRlTlMoJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnLCAneGxpbms6aHJlZicsIHBhdGgpO1xuXG4gICAgLy8gQWRkIDx1c2U+IHRvIDxzdmc+XG4gICAgaWNvbi5hcHBlbmRDaGlsZCh1c2UpO1xuXG4gICAgcmV0dXJuIGljb247XG4gIH0sXG5cbiAgLy8gQ3JlYXRlIGhpZGRlbiB0ZXh0IGxhYmVsXG4gIGNyZWF0ZUxhYmVsKGtleSwgYXR0ciA9IHt9KSB7XG4gICAgY29uc3QgdGV4dCA9IGkxOG4uZ2V0KGtleSwgdGhpcy5jb25maWcpO1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB7IC4uLmF0dHIsIGNsYXNzOiBbYXR0ci5jbGFzcywgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRkZW5dLmZpbHRlcihCb29sZWFuKS5qb2luKCcgJykgfTtcblxuICAgIHJldHVybiBjcmVhdGVFbGVtZW50KCdzcGFuJywgYXR0cmlidXRlcywgdGV4dCk7XG4gIH0sXG5cbiAgLy8gQ3JlYXRlIGEgYmFkZ2VcbiAgY3JlYXRlQmFkZ2UodGV4dCkge1xuICAgIGlmIChpcy5lbXB0eSh0ZXh0KSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgYmFkZ2UgPSBjcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMubWVudS52YWx1ZSxcbiAgICB9KTtcblxuICAgIGJhZGdlLmFwcGVuZENoaWxkKFxuICAgICAgY3JlYXRlRWxlbWVudChcbiAgICAgICAgJ3NwYW4nLFxuICAgICAgICB7XG4gICAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMubWVudS5iYWRnZSxcbiAgICAgICAgfSxcbiAgICAgICAgdGV4dCxcbiAgICAgICksXG4gICAgKTtcblxuICAgIHJldHVybiBiYWRnZTtcbiAgfSxcblxuICAvLyBDcmVhdGUgYSA8YnV0dG9uPlxuICBjcmVhdGVCdXR0b24oYnV0dG9uVHlwZSwgYXR0cikge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBleHRlbmQoe30sIGF0dHIpO1xuICAgIGxldCB0eXBlID0gdG9DYW1lbENhc2UoYnV0dG9uVHlwZSk7XG5cbiAgICBjb25zdCBwcm9wcyA9IHtcbiAgICAgIGVsZW1lbnQ6ICdidXR0b24nLFxuICAgICAgdG9nZ2xlOiBmYWxzZSxcbiAgICAgIGxhYmVsOiBudWxsLFxuICAgICAgaWNvbjogbnVsbCxcbiAgICAgIGxhYmVsUHJlc3NlZDogbnVsbCxcbiAgICAgIGljb25QcmVzc2VkOiBudWxsLFxuICAgIH07XG5cbiAgICBbJ2VsZW1lbnQnLCAnaWNvbicsICdsYWJlbCddLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgaWYgKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgcHJvcHNba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIERlZmF1bHQgdG8gJ2J1dHRvbicgdHlwZSB0byBwcmV2ZW50IGZvcm0gc3VibWlzc2lvblxuICAgIGlmIChwcm9wcy5lbGVtZW50ID09PSAnYnV0dG9uJyAmJiAhT2JqZWN0LmtleXMoYXR0cmlidXRlcykuaW5jbHVkZXMoJ3R5cGUnKSkge1xuICAgICAgYXR0cmlidXRlcy50eXBlID0gJ2J1dHRvbic7XG4gICAgfVxuXG4gICAgLy8gU2V0IGNsYXNzIG5hbWVcbiAgICBpZiAoT2JqZWN0LmtleXMoYXR0cmlidXRlcykuaW5jbHVkZXMoJ2NsYXNzJykpIHtcbiAgICAgIGlmICghYXR0cmlidXRlcy5jbGFzcy5zcGxpdCgnICcpLnNvbWUoKGMpID0+IGMgPT09IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbCkpIHtcbiAgICAgICAgZXh0ZW5kKGF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICBjbGFzczogYCR7YXR0cmlidXRlcy5jbGFzc30gJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9YCxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGF0dHJpYnV0ZXMuY2xhc3MgPSB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2w7XG4gICAgfVxuXG4gICAgLy8gTGFyZ2UgcGxheSBidXR0b25cbiAgICBzd2l0Y2ggKGJ1dHRvblR5cGUpIHtcbiAgICAgIGNhc2UgJ3BsYXknOlxuICAgICAgICBwcm9wcy50b2dnbGUgPSB0cnVlO1xuICAgICAgICBwcm9wcy5sYWJlbCA9ICdwbGF5JztcbiAgICAgICAgcHJvcHMubGFiZWxQcmVzc2VkID0gJ3BhdXNlJztcbiAgICAgICAgcHJvcHMuaWNvbiA9ICdwbGF5JztcbiAgICAgICAgcHJvcHMuaWNvblByZXNzZWQgPSAncGF1c2UnO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnbXV0ZSc6XG4gICAgICAgIHByb3BzLnRvZ2dsZSA9IHRydWU7XG4gICAgICAgIHByb3BzLmxhYmVsID0gJ211dGUnO1xuICAgICAgICBwcm9wcy5sYWJlbFByZXNzZWQgPSAndW5tdXRlJztcbiAgICAgICAgcHJvcHMuaWNvbiA9ICd2b2x1bWUnO1xuICAgICAgICBwcm9wcy5pY29uUHJlc3NlZCA9ICdtdXRlZCc7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdjYXB0aW9ucyc6XG4gICAgICAgIHByb3BzLnRvZ2dsZSA9IHRydWU7XG4gICAgICAgIHByb3BzLmxhYmVsID0gJ2VuYWJsZUNhcHRpb25zJztcbiAgICAgICAgcHJvcHMubGFiZWxQcmVzc2VkID0gJ2Rpc2FibGVDYXB0aW9ucyc7XG4gICAgICAgIHByb3BzLmljb24gPSAnY2FwdGlvbnMtb2ZmJztcbiAgICAgICAgcHJvcHMuaWNvblByZXNzZWQgPSAnY2FwdGlvbnMtb24nO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnZnVsbHNjcmVlbic6XG4gICAgICAgIHByb3BzLnRvZ2dsZSA9IHRydWU7XG4gICAgICAgIHByb3BzLmxhYmVsID0gJ2VudGVyRnVsbHNjcmVlbic7XG4gICAgICAgIHByb3BzLmxhYmVsUHJlc3NlZCA9ICdleGl0RnVsbHNjcmVlbic7XG4gICAgICAgIHByb3BzLmljb24gPSAnZW50ZXItZnVsbHNjcmVlbic7XG4gICAgICAgIHByb3BzLmljb25QcmVzc2VkID0gJ2V4aXQtZnVsbHNjcmVlbic7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdwbGF5LWxhcmdlJzpcbiAgICAgICAgYXR0cmlidXRlcy5jbGFzcyArPSBgICR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sfS0tb3ZlcmxhaWRgO1xuICAgICAgICB0eXBlID0gJ3BsYXknO1xuICAgICAgICBwcm9wcy5sYWJlbCA9ICdwbGF5JztcbiAgICAgICAgcHJvcHMuaWNvbiA9ICdwbGF5JztcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGlmIChpcy5lbXB0eShwcm9wcy5sYWJlbCkpIHtcbiAgICAgICAgICBwcm9wcy5sYWJlbCA9IHR5cGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzLmVtcHR5KHByb3BzLmljb24pKSB7XG4gICAgICAgICAgcHJvcHMuaWNvbiA9IGJ1dHRvblR5cGU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBidXR0b24gPSBjcmVhdGVFbGVtZW50KHByb3BzLmVsZW1lbnQpO1xuXG4gICAgLy8gU2V0dXAgdG9nZ2xlIGljb24gYW5kIGxhYmVsc1xuICAgIGlmIChwcm9wcy50b2dnbGUpIHtcbiAgICAgIC8vIEljb25cbiAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChcbiAgICAgICAgY29udHJvbHMuY3JlYXRlSWNvbi5jYWxsKHRoaXMsIHByb3BzLmljb25QcmVzc2VkLCB7XG4gICAgICAgICAgY2xhc3M6ICdpY29uLS1wcmVzc2VkJyxcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKFxuICAgICAgICBjb250cm9scy5jcmVhdGVJY29uLmNhbGwodGhpcywgcHJvcHMuaWNvbiwge1xuICAgICAgICAgIGNsYXNzOiAnaWNvbi0tbm90LXByZXNzZWQnLFxuICAgICAgICB9KSxcbiAgICAgICk7XG5cbiAgICAgIC8vIExhYmVsL1Rvb2x0aXBcbiAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChcbiAgICAgICAgY29udHJvbHMuY3JlYXRlTGFiZWwuY2FsbCh0aGlzLCBwcm9wcy5sYWJlbFByZXNzZWQsIHtcbiAgICAgICAgICBjbGFzczogJ2xhYmVsLS1wcmVzc2VkJyxcbiAgICAgICAgfSksXG4gICAgICApO1xuICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKFxuICAgICAgICBjb250cm9scy5jcmVhdGVMYWJlbC5jYWxsKHRoaXMsIHByb3BzLmxhYmVsLCB7XG4gICAgICAgICAgY2xhc3M6ICdsYWJlbC0tbm90LXByZXNzZWQnLFxuICAgICAgICB9KSxcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChjb250cm9scy5jcmVhdGVJY29uLmNhbGwodGhpcywgcHJvcHMuaWNvbikpO1xuICAgICAgYnV0dG9uLmFwcGVuZENoaWxkKGNvbnRyb2xzLmNyZWF0ZUxhYmVsLmNhbGwodGhpcywgcHJvcHMubGFiZWwpKTtcbiAgICB9XG5cbiAgICAvLyBNZXJnZSBhbmQgc2V0IGF0dHJpYnV0ZXNcbiAgICBleHRlbmQoYXR0cmlidXRlcywgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuYnV0dG9uc1t0eXBlXSwgYXR0cmlidXRlcykpO1xuICAgIHNldEF0dHJpYnV0ZXMoYnV0dG9uLCBhdHRyaWJ1dGVzKTtcblxuICAgIC8vIFdlIGhhdmUgbXVsdGlwbGUgcGxheSBidXR0b25zXG4gICAgaWYgKHR5cGUgPT09ICdwbGF5Jykge1xuICAgICAgaWYgKCFpcy5hcnJheSh0aGlzLmVsZW1lbnRzLmJ1dHRvbnNbdHlwZV0pKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudHMuYnV0dG9uc1t0eXBlXSA9IFtdO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnNbdHlwZV0ucHVzaChidXR0b24pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnNbdHlwZV0gPSBidXR0b247XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1dHRvbjtcbiAgfSxcblxuICAvLyBDcmVhdGUgYW4gPGlucHV0IHR5cGU9J3JhbmdlJz5cbiAgY3JlYXRlUmFuZ2UodHlwZSwgYXR0cmlidXRlcykge1xuICAgIC8vIFNlZWsgaW5wdXRcbiAgICBjb25zdCBpbnB1dCA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAnaW5wdXQnLFxuICAgICAgZXh0ZW5kKFxuICAgICAgICBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5pbnB1dHNbdHlwZV0pLFxuICAgICAgICB7XG4gICAgICAgICAgdHlwZTogJ3JhbmdlJyxcbiAgICAgICAgICBtaW46IDAsXG4gICAgICAgICAgbWF4OiAxMDAsXG4gICAgICAgICAgc3RlcDogMC4wMSxcbiAgICAgICAgICB2YWx1ZTogMCxcbiAgICAgICAgICBhdXRvY29tcGxldGU6ICdvZmYnLFxuICAgICAgICAgIC8vIEExMXkgZml4ZXMgZm9yIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy85MDVcbiAgICAgICAgICByb2xlOiAnc2xpZGVyJyxcbiAgICAgICAgICAnYXJpYS1sYWJlbCc6IGkxOG4uZ2V0KHR5cGUsIHRoaXMuY29uZmlnKSxcbiAgICAgICAgICAnYXJpYS12YWx1ZW1pbic6IDAsXG4gICAgICAgICAgJ2FyaWEtdmFsdWVtYXgnOiAxMDAsXG4gICAgICAgICAgJ2FyaWEtdmFsdWVub3cnOiAwLFxuICAgICAgICB9LFxuICAgICAgICBhdHRyaWJ1dGVzLFxuICAgICAgKSxcbiAgICApO1xuXG4gICAgdGhpcy5lbGVtZW50cy5pbnB1dHNbdHlwZV0gPSBpbnB1dDtcblxuICAgIC8vIFNldCB0aGUgZmlsbCBmb3Igd2Via2l0IG5vd1xuICAgIGNvbnRyb2xzLnVwZGF0ZVJhbmdlRmlsbC5jYWxsKHRoaXMsIGlucHV0KTtcblxuICAgIC8vIEltcHJvdmUgc3VwcG9ydCBvbiB0b3VjaCBkZXZpY2VzXG4gICAgUmFuZ2VUb3VjaC5zZXR1cChpbnB1dCk7XG5cbiAgICByZXR1cm4gaW5wdXQ7XG4gIH0sXG5cbiAgLy8gQ3JlYXRlIGEgPHByb2dyZXNzPlxuICBjcmVhdGVQcm9ncmVzcyh0eXBlLCBhdHRyaWJ1dGVzKSB7XG4gICAgY29uc3QgcHJvZ3Jlc3MgPSBjcmVhdGVFbGVtZW50KFxuICAgICAgJ3Byb2dyZXNzJyxcbiAgICAgIGV4dGVuZChcbiAgICAgICAgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuZGlzcGxheVt0eXBlXSksXG4gICAgICAgIHtcbiAgICAgICAgICBtaW46IDAsXG4gICAgICAgICAgbWF4OiAxMDAsXG4gICAgICAgICAgdmFsdWU6IDAsXG4gICAgICAgICAgcm9sZTogJ3Byb2dyZXNzYmFyJyxcbiAgICAgICAgICAnYXJpYS1oaWRkZW4nOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBhdHRyaWJ1dGVzLFxuICAgICAgKSxcbiAgICApO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBsYWJlbCBpbnNpZGVcbiAgICBpZiAodHlwZSAhPT0gJ3ZvbHVtZScpIHtcbiAgICAgIHByb2dyZXNzLmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCBudWxsLCAnMCcpKTtcblxuICAgICAgY29uc3Qgc3VmZml4S2V5ID0ge1xuICAgICAgICBwbGF5ZWQ6ICdwbGF5ZWQnLFxuICAgICAgICBidWZmZXI6ICdidWZmZXJlZCcsXG4gICAgICB9W3R5cGVdO1xuICAgICAgY29uc3Qgc3VmZml4ID0gc3VmZml4S2V5ID8gaTE4bi5nZXQoc3VmZml4S2V5LCB0aGlzLmNvbmZpZykgOiAnJztcblxuICAgICAgcHJvZ3Jlc3MuaW5uZXJUZXh0ID0gYCUgJHtzdWZmaXgudG9Mb3dlckNhc2UoKX1gO1xuICAgIH1cblxuICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheVt0eXBlXSA9IHByb2dyZXNzO1xuXG4gICAgcmV0dXJuIHByb2dyZXNzO1xuICB9LFxuXG4gIC8vIENyZWF0ZSB0aW1lIGRpc3BsYXlcbiAgY3JlYXRlVGltZSh0eXBlLCBhdHRycykge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5kaXNwbGF5W3R5cGVdLCBhdHRycyk7XG5cbiAgICBjb25zdCBjb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFxuICAgICAgJ2RpdicsXG4gICAgICBleHRlbmQoYXR0cmlidXRlcywge1xuICAgICAgICBjbGFzczogYCR7YXR0cmlidXRlcy5jbGFzcyA/IGF0dHJpYnV0ZXMuY2xhc3MgOiAnJ30gJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmRpc3BsYXkudGltZX0gYC50cmltKCksXG4gICAgICAgICdhcmlhLWxhYmVsJzogaTE4bi5nZXQodHlwZSwgdGhpcy5jb25maWcpLFxuICAgICAgfSksXG4gICAgICAnMDA6MDAnLFxuICAgICk7XG5cbiAgICAvLyBSZWZlcmVuY2UgZm9yIHVwZGF0ZXNcbiAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXlbdHlwZV0gPSBjb250YWluZXI7XG5cbiAgICByZXR1cm4gY29udGFpbmVyO1xuICB9LFxuXG4gIC8vIEJpbmQga2V5Ym9hcmQgc2hvcnRjdXRzIGZvciBhIG1lbnUgaXRlbVxuICAvLyBXZSBoYXZlIHRvIGJpbmQgdG8ga2V5dXAgb3RoZXJ3aXNlIEZpcmVmb3ggdHJpZ2dlcnMgYSBjbGljayB3aGVuIGEga2V5ZG93biBldmVudCBoYW5kbGVyIHNoaWZ0cyBmb2N1c1xuICAvLyBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xMjIwMTQzXG4gIGJpbmRNZW51SXRlbVNob3J0Y3V0cyhtZW51SXRlbSwgdHlwZSkge1xuICAgIC8vIE5hdmlnYXRlIHRocm91Z2ggbWVudXMgdmlhIGFycm93IGtleXMgYW5kIHNwYWNlXG4gICAgb24uY2FsbChcbiAgICAgIHRoaXMsXG4gICAgICBtZW51SXRlbSxcbiAgICAgICdrZXlkb3duIGtleXVwJyxcbiAgICAgIChldmVudCkgPT4ge1xuICAgICAgICAvLyBXZSBvbmx5IGNhcmUgYWJvdXQgc3BhY2UgYW5kIOKshu+4jyDirIfvuI/vuI8g4p6h77iPXG4gICAgICAgIGlmICghWydTcGFjZScsICdBcnJvd1VwJywgJ0Fycm93RG93bicsICdBcnJvd1JpZ2h0J10uaW5jbHVkZXMoZXZlbnQua2V5KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFByZXZlbnQgcGxheSAvIHNlZWtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgLy8gV2UncmUganVzdCBoZXJlIHRvIHByZXZlbnQgdGhlIGtleWRvd24gYnViYmxpbmdcbiAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdrZXlkb3duJykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzUmFkaW9CdXR0b24gPSBtYXRjaGVzKG1lbnVJdGVtLCAnW3JvbGU9XCJtZW51aXRlbXJhZGlvXCJdJyk7XG5cbiAgICAgICAgLy8gU2hvdyB0aGUgcmVzcGVjdGl2ZSBtZW51XG4gICAgICAgIGlmICghaXNSYWRpb0J1dHRvbiAmJiBbJ1NwYWNlJywgJ0Fycm93UmlnaHQnXS5pbmNsdWRlcyhldmVudC5rZXkpKSB7XG4gICAgICAgICAgY29udHJvbHMuc2hvd01lbnVQYW5lbC5jYWxsKHRoaXMsIHR5cGUsIHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxldCB0YXJnZXQ7XG5cbiAgICAgICAgICBpZiAoZXZlbnQua2V5ICE9PSAnU3BhY2UnKSB7XG4gICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnQXJyb3dEb3duJyB8fCAoaXNSYWRpb0J1dHRvbiAmJiBldmVudC5rZXkgPT09ICdBcnJvd1JpZ2h0JykpIHtcbiAgICAgICAgICAgICAgdGFyZ2V0ID0gbWVudUl0ZW0ubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgICAgICAgICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gbWVudUl0ZW0ucGFyZW50Tm9kZS5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGFyZ2V0ID0gbWVudUl0ZW0ucHJldmlvdXNFbGVtZW50U2libGluZztcblxuICAgICAgICAgICAgICBpZiAoIWlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgIHRhcmdldCA9IG1lbnVJdGVtLnBhcmVudE5vZGUubGFzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZXRGb2N1cy5jYWxsKHRoaXMsIHRhcmdldCwgdHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZmFsc2UsXG4gICAgKTtcblxuICAgIC8vIEVudGVyIHdpbGwgZmlyZSBhIGBjbGlja2AgZXZlbnQgYnV0IHdlIHN0aWxsIG5lZWQgdG8gbWFuYWdlIGZvY3VzXG4gICAgLy8gU28gd2UgYmluZCB0byBrZXl1cCB3aGljaCBmaXJlcyBhZnRlciBhbmQgc2V0IGZvY3VzIGhlcmVcbiAgICBvbi5jYWxsKHRoaXMsIG1lbnVJdGVtLCAna2V5dXAnLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChldmVudC5rZXkgIT09ICdSZXR1cm4nKSByZXR1cm47XG5cbiAgICAgIGNvbnRyb2xzLmZvY3VzRmlyc3RNZW51SXRlbS5jYWxsKHRoaXMsIG51bGwsIHRydWUpO1xuICAgIH0pO1xuICB9LFxuXG4gIC8vIENyZWF0ZSBhIHNldHRpbmdzIG1lbnUgaXRlbVxuICBjcmVhdGVNZW51SXRlbSh7IHZhbHVlLCBsaXN0LCB0eXBlLCB0aXRsZSwgYmFkZ2UgPSBudWxsLCBjaGVja2VkID0gZmFsc2UgfSkge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5pbnB1dHNbdHlwZV0pO1xuXG4gICAgY29uc3QgbWVudUl0ZW0gPSBjcmVhdGVFbGVtZW50KFxuICAgICAgJ2J1dHRvbicsXG4gICAgICBleHRlbmQoYXR0cmlidXRlcywge1xuICAgICAgICB0eXBlOiAnYnV0dG9uJyxcbiAgICAgICAgcm9sZTogJ21lbnVpdGVtcmFkaW8nLFxuICAgICAgICBjbGFzczogYCR7dGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sfSAke2F0dHJpYnV0ZXMuY2xhc3MgPyBhdHRyaWJ1dGVzLmNsYXNzIDogJyd9YC50cmltKCksXG4gICAgICAgICdhcmlhLWNoZWNrZWQnOiBjaGVja2VkLFxuICAgICAgICB2YWx1ZSxcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICBjb25zdCBmbGV4ID0gY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuXG4gICAgLy8gV2UgaGF2ZSB0byBzZXQgYXMgSFRNTCBpbmNhc2Ugb2Ygc3BlY2lhbCBjaGFyYWN0ZXJzXG4gICAgZmxleC5pbm5lckhUTUwgPSB0aXRsZTtcblxuICAgIGlmIChpcy5lbGVtZW50KGJhZGdlKSkge1xuICAgICAgZmxleC5hcHBlbmRDaGlsZChiYWRnZSk7XG4gICAgfVxuXG4gICAgbWVudUl0ZW0uYXBwZW5kQ2hpbGQoZmxleCk7XG5cbiAgICAvLyBSZXBsaWNhdGUgcmFkaW8gYnV0dG9uIGJlaGF2aW9yXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG1lbnVJdGVtLCAnY2hlY2tlZCcsIHtcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBnZXQoKSB7XG4gICAgICAgIHJldHVybiBtZW51SXRlbS5nZXRBdHRyaWJ1dGUoJ2FyaWEtY2hlY2tlZCcpID09PSAndHJ1ZSc7XG4gICAgICB9LFxuICAgICAgc2V0KGNoZWNrKSB7XG4gICAgICAgIC8vIEVuc3VyZSBleGNsdXNpdml0eVxuICAgICAgICBpZiAoY2hlY2spIHtcbiAgICAgICAgICBBcnJheS5mcm9tKG1lbnVJdGVtLnBhcmVudE5vZGUuY2hpbGRyZW4pXG4gICAgICAgICAgICAuZmlsdGVyKChub2RlKSA9PiBtYXRjaGVzKG5vZGUsICdbcm9sZT1cIm1lbnVpdGVtcmFkaW9cIl0nKSlcbiAgICAgICAgICAgIC5mb3JFYWNoKChub2RlKSA9PiBub2RlLnNldEF0dHJpYnV0ZSgnYXJpYS1jaGVja2VkJywgJ2ZhbHNlJykpO1xuICAgICAgICB9XG5cbiAgICAgICAgbWVudUl0ZW0uc2V0QXR0cmlidXRlKCdhcmlhLWNoZWNrZWQnLCBjaGVjayA/ICd0cnVlJyA6ICdmYWxzZScpO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHRoaXMubGlzdGVuZXJzLmJpbmQoXG4gICAgICBtZW51SXRlbSxcbiAgICAgICdjbGljayBrZXl1cCcsXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKGlzLmtleWJvYXJkRXZlbnQoZXZlbnQpICYmIGV2ZW50LmtleSAhPT0gJ1NwYWNlJykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIG1lbnVJdGVtLmNoZWNrZWQgPSB0cnVlO1xuXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgIGNhc2UgJ2xhbmd1YWdlJzpcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFRyYWNrID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAncXVhbGl0eSc6XG4gICAgICAgICAgICB0aGlzLnF1YWxpdHkgPSB2YWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAnc3BlZWQnOlxuICAgICAgICAgICAgdGhpcy5zcGVlZCA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBjb250cm9scy5zaG93TWVudVBhbmVsLmNhbGwodGhpcywgJ2hvbWUnLCBpcy5rZXlib2FyZEV2ZW50KGV2ZW50KSk7XG4gICAgICB9LFxuICAgICAgdHlwZSxcbiAgICAgIGZhbHNlLFxuICAgICk7XG5cbiAgICBjb250cm9scy5iaW5kTWVudUl0ZW1TaG9ydGN1dHMuY2FsbCh0aGlzLCBtZW51SXRlbSwgdHlwZSk7XG5cbiAgICBsaXN0LmFwcGVuZENoaWxkKG1lbnVJdGVtKTtcbiAgfSxcblxuICAvLyBGb3JtYXQgYSB0aW1lIGZvciBkaXNwbGF5XG4gIGZvcm1hdFRpbWUodGltZSA9IDAsIGludmVydGVkID0gZmFsc2UpIHtcbiAgICAvLyBCYWlsIGlmIHRoZSB2YWx1ZSBpc24ndCBhIG51bWJlclxuICAgIGlmICghaXMubnVtYmVyKHRpbWUpKSB7XG4gICAgICByZXR1cm4gdGltZTtcbiAgICB9XG5cbiAgICAvLyBBbHdheXMgZGlzcGxheSBob3VycyBpZiBkdXJhdGlvbiBpcyBvdmVyIGFuIGhvdXJcbiAgICBjb25zdCBmb3JjZUhvdXJzID0gZ2V0SG91cnModGhpcy5kdXJhdGlvbikgPiAwO1xuXG4gICAgcmV0dXJuIGZvcm1hdFRpbWUodGltZSwgZm9yY2VIb3VycywgaW52ZXJ0ZWQpO1xuICB9LFxuXG4gIC8vIFVwZGF0ZSB0aGUgZGlzcGxheWVkIHRpbWVcbiAgdXBkYXRlVGltZURpc3BsYXkodGFyZ2V0ID0gbnVsbCwgdGltZSA9IDAsIGludmVydGVkID0gZmFsc2UpIHtcbiAgICAvLyBCYWlsIGlmIHRoZXJlJ3Mgbm8gZWxlbWVudCB0byBkaXNwbGF5IG9yIHRoZSB2YWx1ZSBpc24ndCBhIG51bWJlclxuICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpIHx8ICFpcy5udW1iZXIodGltZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICB0YXJnZXQuaW5uZXJUZXh0ID0gY29udHJvbHMuZm9ybWF0VGltZSh0aW1lLCBpbnZlcnRlZCk7XG4gIH0sXG5cbiAgLy8gVXBkYXRlIHZvbHVtZSBVSSBhbmQgc3RvcmFnZVxuICB1cGRhdGVWb2x1bWUoKSB7XG4gICAgaWYgKCF0aGlzLnN1cHBvcnRlZC51aSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSByYW5nZVxuICAgIGlmIChpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuaW5wdXRzLnZvbHVtZSkpIHtcbiAgICAgIGNvbnRyb2xzLnNldFJhbmdlLmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5pbnB1dHMudm9sdW1lLCB0aGlzLm11dGVkID8gMCA6IHRoaXMudm9sdW1lKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgbXV0ZSBzdGF0ZVxuICAgIGlmIChpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuYnV0dG9ucy5tdXRlKSkge1xuICAgICAgdGhpcy5lbGVtZW50cy5idXR0b25zLm11dGUucHJlc3NlZCA9IHRoaXMubXV0ZWQgfHwgdGhpcy52b2x1bWUgPT09IDA7XG4gICAgfVxuICB9LFxuXG4gIC8vIFVwZGF0ZSBzZWVrIHZhbHVlIGFuZCBsb3dlciBmaWxsXG4gIHNldFJhbmdlKHRhcmdldCwgdmFsdWUgPSAwKSB7XG4gICAgaWYgKCFpcy5lbGVtZW50KHRhcmdldCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcbiAgICB0YXJnZXQudmFsdWUgPSB2YWx1ZTtcblxuICAgIC8vIFdlYmtpdCByYW5nZSBmaWxsXG4gICAgY29udHJvbHMudXBkYXRlUmFuZ2VGaWxsLmNhbGwodGhpcywgdGFyZ2V0KTtcbiAgfSxcblxuICAvLyBVcGRhdGUgPHByb2dyZXNzPiBlbGVtZW50c1xuICB1cGRhdGVQcm9ncmVzcyhldmVudCkge1xuICAgIGlmICghdGhpcy5zdXBwb3J0ZWQudWkgfHwgIWlzLmV2ZW50KGV2ZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCB2YWx1ZSA9IDA7XG5cbiAgICBjb25zdCBzZXRQcm9ncmVzcyA9ICh0YXJnZXQsIGlucHV0KSA9PiB7XG4gICAgICBjb25zdCB2YWwgPSBpcy5udW1iZXIoaW5wdXQpID8gaW5wdXQgOiAwO1xuICAgICAgY29uc3QgcHJvZ3Jlc3MgPSBpcy5lbGVtZW50KHRhcmdldCkgPyB0YXJnZXQgOiB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuYnVmZmVyO1xuXG4gICAgICAvLyBVcGRhdGUgdmFsdWUgYW5kIGxhYmVsXG4gICAgICBpZiAoaXMuZWxlbWVudChwcm9ncmVzcykpIHtcbiAgICAgICAgcHJvZ3Jlc3MudmFsdWUgPSB2YWw7XG5cbiAgICAgICAgLy8gVXBkYXRlIHRleHQgbGFiZWwgaW5zaWRlXG4gICAgICAgIGNvbnN0IGxhYmVsID0gcHJvZ3Jlc3MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NwYW4nKVswXTtcbiAgICAgICAgaWYgKGlzLmVsZW1lbnQobGFiZWwpKSB7XG4gICAgICAgICAgbGFiZWwuY2hpbGROb2Rlc1swXS5ub2RlVmFsdWUgPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKGV2ZW50KSB7XG4gICAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcbiAgICAgICAgLy8gVmlkZW8gcGxheWluZ1xuICAgICAgICBjYXNlICd0aW1ldXBkYXRlJzpcbiAgICAgICAgY2FzZSAnc2Vla2luZyc6XG4gICAgICAgIGNhc2UgJ3NlZWtlZCc6XG4gICAgICAgICAgdmFsdWUgPSBnZXRQZXJjZW50YWdlKHRoaXMuY3VycmVudFRpbWUsIHRoaXMuZHVyYXRpb24pO1xuXG4gICAgICAgICAgLy8gU2V0IHNlZWsgcmFuZ2UgdmFsdWUgb25seSBpZiBpdCdzIGEgJ25hdHVyYWwnIHRpbWUgZXZlbnRcbiAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ3RpbWV1cGRhdGUnKSB7XG4gICAgICAgICAgICBjb250cm9scy5zZXRSYW5nZS5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuaW5wdXRzLnNlZWssIHZhbHVlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICAvLyBDaGVjayBidWZmZXIgc3RhdHVzXG4gICAgICAgIGNhc2UgJ3BsYXlpbmcnOlxuICAgICAgICBjYXNlICdwcm9ncmVzcyc6XG4gICAgICAgICAgc2V0UHJvZ3Jlc3ModGhpcy5lbGVtZW50cy5kaXNwbGF5LmJ1ZmZlciwgdGhpcy5idWZmZXJlZCAqIDEwMCk7XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICAvLyBXZWJraXQgcG9seWZpbGwgZm9yIGxvd2VyIGZpbGwgcmFuZ2VcbiAgdXBkYXRlUmFuZ2VGaWxsKHRhcmdldCkge1xuICAgIC8vIEdldCByYW5nZSBmcm9tIGV2ZW50IGlmIGV2ZW50IHBhc3NlZFxuICAgIGNvbnN0IHJhbmdlID0gaXMuZXZlbnQodGFyZ2V0KSA/IHRhcmdldC50YXJnZXQgOiB0YXJnZXQ7XG5cbiAgICAvLyBOZWVkcyB0byBiZSBhIHZhbGlkIDxpbnB1dCB0eXBlPSdyYW5nZSc+XG4gICAgaWYgKCFpcy5lbGVtZW50KHJhbmdlKSB8fCByYW5nZS5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSAhPT0gJ3JhbmdlJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFNldCBhcmlhIHZhbHVlcyBmb3IgaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzkwNVxuICAgIGlmIChtYXRjaGVzKHJhbmdlLCB0aGlzLmNvbmZpZy5zZWxlY3RvcnMuaW5wdXRzLnNlZWspKSB7XG4gICAgICByYW5nZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCB0aGlzLmN1cnJlbnRUaW1lKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gY29udHJvbHMuZm9ybWF0VGltZSh0aGlzLmN1cnJlbnRUaW1lKTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gY29udHJvbHMuZm9ybWF0VGltZSh0aGlzLmR1cmF0aW9uKTtcbiAgICAgIGNvbnN0IGZvcm1hdCA9IGkxOG4uZ2V0KCdzZWVrTGFiZWwnLCB0aGlzLmNvbmZpZyk7XG4gICAgICByYW5nZS5zZXRBdHRyaWJ1dGUoXG4gICAgICAgICdhcmlhLXZhbHVldGV4dCcsXG4gICAgICAgIGZvcm1hdC5yZXBsYWNlKCd7Y3VycmVudFRpbWV9JywgY3VycmVudFRpbWUpLnJlcGxhY2UoJ3tkdXJhdGlvbn0nLCBkdXJhdGlvbiksXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAobWF0Y2hlcyhyYW5nZSwgdGhpcy5jb25maWcuc2VsZWN0b3JzLmlucHV0cy52b2x1bWUpKSB7XG4gICAgICBjb25zdCBwZXJjZW50ID0gcmFuZ2UudmFsdWUgKiAxMDA7XG4gICAgICByYW5nZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCBwZXJjZW50KTtcbiAgICAgIHJhbmdlLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZXRleHQnLCBgJHtwZXJjZW50LnRvRml4ZWQoMSl9JWApO1xuICAgIH0gZWxzZSB7XG4gICAgICByYW5nZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCByYW5nZS52YWx1ZSk7XG4gICAgfVxuXG4gICAgLy8gV2ViS2l0IG9ubHlcbiAgICBpZiAoIWJyb3dzZXIuaXNXZWJraXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZXQgQ1NTIGN1c3RvbSBwcm9wZXJ0eVxuICAgIHJhbmdlLnN0eWxlLnNldFByb3BlcnR5KCctLXZhbHVlJywgYCR7KHJhbmdlLnZhbHVlIC8gcmFuZ2UubWF4KSAqIDEwMH0lYCk7XG4gIH0sXG5cbiAgLy8gVXBkYXRlIGhvdmVyIHRvb2x0aXAgZm9yIHNlZWtpbmdcbiAgdXBkYXRlU2Vla1Rvb2x0aXAoZXZlbnQpIHtcbiAgICAvLyBCYWlsIGlmIHNldHRpbmcgbm90IHRydWVcbiAgICBpZiAoXG4gICAgICAhdGhpcy5jb25maWcudG9vbHRpcHMuc2VlayB8fFxuICAgICAgIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5pbnB1dHMuc2VlaykgfHxcbiAgICAgICFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuZGlzcGxheS5zZWVrVG9vbHRpcCkgfHxcbiAgICAgIHRoaXMuZHVyYXRpb24gPT09IDBcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB0aXBFbGVtZW50ID0gdGhpcy5lbGVtZW50cy5kaXNwbGF5LnNlZWtUb29sdGlwO1xuICAgIGNvbnN0IHZpc2libGUgPSBgJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnRvb2x0aXB9LS12aXNpYmxlYDtcbiAgICBjb25zdCB0b2dnbGUgPSAoc2hvdykgPT4gdG9nZ2xlQ2xhc3ModGlwRWxlbWVudCwgdmlzaWJsZSwgc2hvdyk7XG5cbiAgICAvLyBIaWRlIG9uIHRvdWNoXG4gICAgaWYgKHRoaXMudG91Y2gpIHtcbiAgICAgIHRvZ2dsZShmYWxzZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRGV0ZXJtaW5lIHBlcmNlbnRhZ2UsIGlmIGFscmVhZHkgdmlzaWJsZVxuICAgIGxldCBwZXJjZW50ID0gMDtcbiAgICBjb25zdCBjbGllbnRSZWN0ID0gdGhpcy5lbGVtZW50cy5wcm9ncmVzcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIGlmIChpcy5ldmVudChldmVudCkpIHtcbiAgICAgIHBlcmNlbnQgPSAoMTAwIC8gY2xpZW50UmVjdC53aWR0aCkgKiAoZXZlbnQucGFnZVggLSBjbGllbnRSZWN0LmxlZnQpO1xuICAgIH0gZWxzZSBpZiAoaGFzQ2xhc3ModGlwRWxlbWVudCwgdmlzaWJsZSkpIHtcbiAgICAgIHBlcmNlbnQgPSBwYXJzZUZsb2F0KHRpcEVsZW1lbnQuc3R5bGUubGVmdCwgMTApO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gU2V0IGJvdW5kc1xuICAgIGlmIChwZXJjZW50IDwgMCkge1xuICAgICAgcGVyY2VudCA9IDA7XG4gICAgfSBlbHNlIGlmIChwZXJjZW50ID4gMTAwKSB7XG4gICAgICBwZXJjZW50ID0gMTAwO1xuICAgIH1cblxuICAgIGNvbnN0IHRpbWUgPSAodGhpcy5kdXJhdGlvbiAvIDEwMCkgKiBwZXJjZW50O1xuXG4gICAgLy8gRGlzcGxheSB0aGUgdGltZSBhIGNsaWNrIHdvdWxkIHNlZWsgdG9cbiAgICB0aXBFbGVtZW50LmlubmVyVGV4dCA9IGNvbnRyb2xzLmZvcm1hdFRpbWUodGltZSk7XG5cbiAgICAvLyBHZXQgbWFya2VyIHBvaW50IGZvciB0aW1lXG4gICAgY29uc3QgcG9pbnQgPSB0aGlzLmNvbmZpZy5tYXJrZXJzPy5wb2ludHM/LmZpbmQoKHsgdGltZTogdCB9KSA9PiB0ID09PSBNYXRoLnJvdW5kKHRpbWUpKTtcblxuICAgIC8vIEFwcGVuZCB0aGUgcG9pbnQgbGFiZWwgdG8gdGhlIHRvb2x0aXBcbiAgICBpZiAocG9pbnQpIHtcbiAgICAgIHRpcEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJywgYCR7cG9pbnQubGFiZWx9PGJyPmApO1xuICAgIH1cblxuICAgIC8vIFNldCBwb3NpdGlvblxuICAgIHRpcEVsZW1lbnQuc3R5bGUubGVmdCA9IGAke3BlcmNlbnR9JWA7XG5cbiAgICAvLyBTaG93L2hpZGUgdGhlIHRvb2x0aXBcbiAgICAvLyBJZiB0aGUgZXZlbnQgaXMgYSBtb3VlcyBpbi9vdXQgYW5kIHBlcmNlbnRhZ2UgaXMgaW5zaWRlIGJvdW5kc1xuICAgIGlmIChpcy5ldmVudChldmVudCkgJiYgWydtb3VzZWVudGVyJywgJ21vdXNlbGVhdmUnXS5pbmNsdWRlcyhldmVudC50eXBlKSkge1xuICAgICAgdG9nZ2xlKGV2ZW50LnR5cGUgPT09ICdtb3VzZWVudGVyJyk7XG4gICAgfVxuICB9LFxuXG4gIC8vIEhhbmRsZSB0aW1lIGNoYW5nZSBldmVudFxuICB0aW1lVXBkYXRlKGV2ZW50KSB7XG4gICAgLy8gT25seSBpbnZlcnQgaWYgb25seSBvbmUgdGltZSBlbGVtZW50IGlzIGRpc3BsYXllZCBhbmQgdXNlZCBmb3IgYm90aCBkdXJhdGlvbiBhbmQgY3VycmVudFRpbWVcbiAgICBjb25zdCBpbnZlcnQgPSAhaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmRpc3BsYXkuZHVyYXRpb24pICYmIHRoaXMuY29uZmlnLmludmVydFRpbWU7XG5cbiAgICAvLyBEdXJhdGlvblxuICAgIGNvbnRyb2xzLnVwZGF0ZVRpbWVEaXNwbGF5LmNhbGwoXG4gICAgICB0aGlzLFxuICAgICAgdGhpcy5lbGVtZW50cy5kaXNwbGF5LmN1cnJlbnRUaW1lLFxuICAgICAgaW52ZXJ0ID8gdGhpcy5kdXJhdGlvbiAtIHRoaXMuY3VycmVudFRpbWUgOiB0aGlzLmN1cnJlbnRUaW1lLFxuICAgICAgaW52ZXJ0LFxuICAgICk7XG5cbiAgICAvLyBJZ25vcmUgdXBkYXRlcyB3aGlsZSBzZWVraW5nXG4gICAgaWYgKGV2ZW50ICYmIGV2ZW50LnR5cGUgPT09ICd0aW1ldXBkYXRlJyAmJiB0aGlzLm1lZGlhLnNlZWtpbmcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBQbGF5aW5nIHByb2dyZXNzXG4gICAgY29udHJvbHMudXBkYXRlUHJvZ3Jlc3MuY2FsbCh0aGlzLCBldmVudCk7XG4gIH0sXG5cbiAgLy8gU2hvdyB0aGUgZHVyYXRpb24gb24gbWV0YWRhdGFsb2FkZWQgb3IgZHVyYXRpb25jaGFuZ2UgZXZlbnRzXG4gIGR1cmF0aW9uVXBkYXRlKCkge1xuICAgIC8vIEJhaWwgaWYgbm8gVUkgb3IgZHVyYXRpb25jaGFuZ2UgZXZlbnQgdHJpZ2dlcmVkIGFmdGVyIHBsYXlpbmcvc2VlayB3aGVuIGludmVydFRpbWUgaXMgZmFsc2VcbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpIHx8ICghdGhpcy5jb25maWcuaW52ZXJ0VGltZSAmJiB0aGlzLmN1cnJlbnRUaW1lKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIElmIGR1cmF0aW9uIGlzIHRoZSAyKiozMiAoc2hha2EpLCBJbmZpbml0eSAoSExTKSwgREFTSC1JRiAoTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgfHwgTnVtYmVyLk1BWF9WQUxVRSkgaW5kaWNhdGluZyBsaXZlIHdlIGhpZGUgdGhlIGN1cnJlbnRUaW1lIGFuZCBwcm9ncmVzc2Jhci5cbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdmlkZW8tZGV2L2hscy5qcy9ibG9iLzU4MjBkMjlkM2M0YzhhNDZlOGI3NWYxZTNhZmEzZTY4YzFhOWEyZGIvc3JjL2NvbnRyb2xsZXIvYnVmZmVyLWNvbnRyb2xsZXIuanMjTDQxNVxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvc2hha2EtcGxheWVyL2Jsb2IvNGQ4ODkwNTQ2MzFmNGUxY2YwZmJkODBkZGQyYjcxODg3YzAyZTIzMi9saWIvbWVkaWEvc3RyZWFtaW5nX2VuZ2luZS5qcyNMMTA2MlxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9EYXNoLUluZHVzdHJ5LUZvcnVtL2Rhc2guanMvYmxvYi82OTg1OWY1MWI5Njk2NDViMjM0NjY2ODAwZDRjYjU5NmQ4OWM2MDJkL3NyYy9kYXNoL21vZGVscy9EYXNoTWFuaWZlc3RNb2RlbC5qcyNMMzM4XG4gICAgaWYgKHRoaXMuZHVyYXRpb24gPj0gMiAqKiAzMikge1xuICAgICAgdG9nZ2xlSGlkZGVuKHRoaXMuZWxlbWVudHMuZGlzcGxheS5jdXJyZW50VGltZSwgdHJ1ZSk7XG4gICAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5wcm9ncmVzcywgdHJ1ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIEFSSUEgdmFsdWVzXG4gICAgaWYgKGlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5pbnB1dHMuc2VlaykpIHtcbiAgICAgIHRoaXMuZWxlbWVudHMuaW5wdXRzLnNlZWsuc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWF4JywgdGhpcy5kdXJhdGlvbik7XG4gICAgfVxuXG4gICAgLy8gSWYgdGhlcmUncyBhIHNwb3QgdG8gZGlzcGxheSBkdXJhdGlvblxuICAgIGNvbnN0IGhhc0R1cmF0aW9uID0gaXMuZWxlbWVudCh0aGlzLmVsZW1lbnRzLmRpc3BsYXkuZHVyYXRpb24pO1xuXG4gICAgLy8gSWYgdGhlcmUncyBvbmx5IG9uZSB0aW1lIGRpc3BsYXksIGRpc3BsYXkgZHVyYXRpb24gdGhlcmVcbiAgICBpZiAoIWhhc0R1cmF0aW9uICYmIHRoaXMuY29uZmlnLmRpc3BsYXlEdXJhdGlvbiAmJiB0aGlzLnBhdXNlZCkge1xuICAgICAgY29udHJvbHMudXBkYXRlVGltZURpc3BsYXkuY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuY3VycmVudFRpbWUsIHRoaXMuZHVyYXRpb24pO1xuICAgIH1cblxuICAgIC8vIElmIHRoZXJlJ3MgYSBkdXJhdGlvbiBlbGVtZW50LCB1cGRhdGUgY29udGVudFxuICAgIGlmIChoYXNEdXJhdGlvbikge1xuICAgICAgY29udHJvbHMudXBkYXRlVGltZURpc3BsYXkuY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuZHVyYXRpb24sIHRoaXMuZHVyYXRpb24pO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmNvbmZpZy5tYXJrZXJzLmVuYWJsZWQpIHtcbiAgICAgIGNvbnRyb2xzLnNldE1hcmtlcnMuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgdGhlIHRvb2x0aXAgKGlmIHZpc2libGUpXG4gICAgY29udHJvbHMudXBkYXRlU2Vla1Rvb2x0aXAuY2FsbCh0aGlzKTtcbiAgfSxcblxuICAvLyBIaWRlL3Nob3cgYSB0YWJcbiAgdG9nZ2xlTWVudUJ1dHRvbihzZXR0aW5nLCB0b2dnbGUpIHtcbiAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5zZXR0aW5ncy5idXR0b25zW3NldHRpbmddLCAhdG9nZ2xlKTtcbiAgfSxcblxuICAvLyBVcGRhdGUgdGhlIHNlbGVjdGVkIHNldHRpbmdcbiAgdXBkYXRlU2V0dGluZyhzZXR0aW5nLCBjb250YWluZXIsIGlucHV0KSB7XG4gICAgY29uc3QgcGFuZSA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzW3NldHRpbmddO1xuICAgIGxldCB2YWx1ZSA9IG51bGw7XG4gICAgbGV0IGxpc3QgPSBjb250YWluZXI7XG5cbiAgICBpZiAoc2V0dGluZyA9PT0gJ2NhcHRpb25zJykge1xuICAgICAgdmFsdWUgPSB0aGlzLmN1cnJlbnRUcmFjaztcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsdWUgPSAhaXMuZW1wdHkoaW5wdXQpID8gaW5wdXQgOiB0aGlzW3NldHRpbmddO1xuXG4gICAgICAvLyBHZXQgZGVmYXVsdFxuICAgICAgaWYgKGlzLmVtcHR5KHZhbHVlKSkge1xuICAgICAgICB2YWx1ZSA9IHRoaXMuY29uZmlnW3NldHRpbmddLmRlZmF1bHQ7XG4gICAgICB9XG5cbiAgICAgIC8vIFVuc3VwcG9ydGVkIHZhbHVlXG4gICAgICBpZiAoIWlzLmVtcHR5KHRoaXMub3B0aW9uc1tzZXR0aW5nXSkgJiYgIXRoaXMub3B0aW9uc1tzZXR0aW5nXS5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKGBVbnN1cHBvcnRlZCB2YWx1ZSBvZiAnJHt2YWx1ZX0nIGZvciAke3NldHRpbmd9YCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gRGlzYWJsZWQgdmFsdWVcbiAgICAgIGlmICghdGhpcy5jb25maWdbc2V0dGluZ10ub3B0aW9ucy5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKGBEaXNhYmxlZCB2YWx1ZSBvZiAnJHt2YWx1ZX0nIGZvciAke3NldHRpbmd9YCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIGxpc3QgaWYgd2UgbmVlZCB0b1xuICAgIGlmICghaXMuZWxlbWVudChsaXN0KSkge1xuICAgICAgbGlzdCA9IHBhbmUgJiYgcGFuZS5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cIm1lbnVcIl0nKTtcbiAgICB9XG5cbiAgICAvLyBJZiB0aGVyZSdzIG5vIGxpc3QgaXQgbWVhbnMgaXQncyBub3QgYmVlbiByZW5kZXJlZC4uLlxuICAgIGlmICghaXMuZWxlbWVudChsaXN0KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB0aGUgbGFiZWxcbiAgICBjb25zdCBsYWJlbCA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MuYnV0dG9uc1tzZXR0aW5nXS5xdWVyeVNlbGVjdG9yKGAuJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLm1lbnUudmFsdWV9YCk7XG4gICAgbGFiZWwuaW5uZXJIVE1MID0gY29udHJvbHMuZ2V0TGFiZWwuY2FsbCh0aGlzLCBzZXR0aW5nLCB2YWx1ZSk7XG5cbiAgICAvLyBGaW5kIHRoZSByYWRpbyBvcHRpb24gYW5kIGNoZWNrIGl0XG4gICAgY29uc3QgdGFyZ2V0ID0gbGlzdCAmJiBsaXN0LnF1ZXJ5U2VsZWN0b3IoYFt2YWx1ZT1cIiR7dmFsdWV9XCJdYCk7XG5cbiAgICBpZiAoaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICB0YXJnZXQuY2hlY2tlZCA9IHRydWU7XG4gICAgfVxuICB9LFxuXG4gIC8vIFRyYW5zbGF0ZSBhIHZhbHVlIGludG8gYSBuaWNlIGxhYmVsXG4gIGdldExhYmVsKHNldHRpbmcsIHZhbHVlKSB7XG4gICAgc3dpdGNoIChzZXR0aW5nKSB7XG4gICAgICBjYXNlICdzcGVlZCc6XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gMSA/IGkxOG4uZ2V0KCdub3JtYWwnLCB0aGlzLmNvbmZpZykgOiBgJHt2YWx1ZX0mdGltZXM7YDtcblxuICAgICAgY2FzZSAncXVhbGl0eSc6XG4gICAgICAgIGlmIChpcy5udW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgY29uc3QgbGFiZWwgPSBpMThuLmdldChgcXVhbGl0eUxhYmVsLiR7dmFsdWV9YCwgdGhpcy5jb25maWcpO1xuXG4gICAgICAgICAgaWYgKCFsYWJlbC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBgJHt2YWx1ZX1wYDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gbGFiZWw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdG9UaXRsZUNhc2UodmFsdWUpO1xuXG4gICAgICBjYXNlICdjYXB0aW9ucyc6XG4gICAgICAgIHJldHVybiBjYXB0aW9ucy5nZXRMYWJlbC5jYWxsKHRoaXMpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH0sXG5cbiAgLy8gU2V0IHRoZSBxdWFsaXR5IG1lbnVcbiAgc2V0UXVhbGl0eU1lbnUob3B0aW9ucykge1xuICAgIC8vIE1lbnUgcmVxdWlyZWRcbiAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMucXVhbGl0eSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB0eXBlID0gJ3F1YWxpdHknO1xuICAgIGNvbnN0IGxpc3QgPSB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5xdWFsaXR5LnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpO1xuXG4gICAgLy8gU2V0IG9wdGlvbnMgaWYgcGFzc2VkIGFuZCBmaWx0ZXIgYmFzZWQgb24gdW5pcXVlbmVzcyBhbmQgY29uZmlnXG4gICAgaWYgKGlzLmFycmF5KG9wdGlvbnMpKSB7XG4gICAgICB0aGlzLm9wdGlvbnMucXVhbGl0eSA9IGRlZHVwZShvcHRpb25zKS5maWx0ZXIoKHF1YWxpdHkpID0+IHRoaXMuY29uZmlnLnF1YWxpdHkub3B0aW9ucy5pbmNsdWRlcyhxdWFsaXR5KSk7XG4gICAgfVxuXG4gICAgLy8gVG9nZ2xlIHRoZSBwYW5lIGFuZCB0YWJcbiAgICBjb25zdCB0b2dnbGUgPSAhaXMuZW1wdHkodGhpcy5vcHRpb25zLnF1YWxpdHkpICYmIHRoaXMub3B0aW9ucy5xdWFsaXR5Lmxlbmd0aCA+IDE7XG4gICAgY29udHJvbHMudG9nZ2xlTWVudUJ1dHRvbi5jYWxsKHRoaXMsIHR5cGUsIHRvZ2dsZSk7XG5cbiAgICAvLyBFbXB0eSB0aGUgbWVudVxuICAgIGVtcHR5RWxlbWVudChsaXN0KTtcblxuICAgIC8vIENoZWNrIGlmIHdlIG5lZWQgdG8gdG9nZ2xlIHRoZSBwYXJlbnRcbiAgICBjb250cm9scy5jaGVja01lbnUuY2FsbCh0aGlzKTtcblxuICAgIC8vIElmIHdlJ3JlIGhpZGluZywgbm90aGluZyBtb3JlIHRvIGRvXG4gICAgaWYgKCF0b2dnbGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIGJhZGdlIEhUTUwgZm9yIEhELCA0SyBldGNcbiAgICBjb25zdCBnZXRCYWRnZSA9IChxdWFsaXR5KSA9PiB7XG4gICAgICBjb25zdCBsYWJlbCA9IGkxOG4uZ2V0KGBxdWFsaXR5QmFkZ2UuJHtxdWFsaXR5fWAsIHRoaXMuY29uZmlnKTtcblxuICAgICAgaWYgKCFsYWJlbC5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb250cm9scy5jcmVhdGVCYWRnZS5jYWxsKHRoaXMsIGxhYmVsKTtcbiAgICB9O1xuXG4gICAgLy8gU29ydCBvcHRpb25zIGJ5IHRoZSBjb25maWcgYW5kIHRoZW4gcmVuZGVyIG9wdGlvbnNcbiAgICB0aGlzLm9wdGlvbnMucXVhbGl0eVxuICAgICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgY29uc3Qgc29ydGluZyA9IHRoaXMuY29uZmlnLnF1YWxpdHkub3B0aW9ucztcbiAgICAgICAgcmV0dXJuIHNvcnRpbmcuaW5kZXhPZihhKSA+IHNvcnRpbmcuaW5kZXhPZihiKSA/IDEgOiAtMTtcbiAgICAgIH0pXG4gICAgICAuZm9yRWFjaCgocXVhbGl0eSkgPT4ge1xuICAgICAgICBjb250cm9scy5jcmVhdGVNZW51SXRlbS5jYWxsKHRoaXMsIHtcbiAgICAgICAgICB2YWx1ZTogcXVhbGl0eSxcbiAgICAgICAgICBsaXN0LFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgdGl0bGU6IGNvbnRyb2xzLmdldExhYmVsLmNhbGwodGhpcywgJ3F1YWxpdHknLCBxdWFsaXR5KSxcbiAgICAgICAgICBiYWRnZTogZ2V0QmFkZ2UocXVhbGl0eSksXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwodGhpcywgdHlwZSwgbGlzdCk7XG4gIH0sXG5cbiAgLy8gU2V0IHRoZSBsb29waW5nIG9wdGlvbnNcbiAgLyogc2V0TG9vcE1lbnUoKSB7XG4gICAgICAgIC8vIE1lbnUgcmVxdWlyZWRcbiAgICAgICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLmxvb3ApKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBvcHRpb25zID0gWydzdGFydCcsICdlbmQnLCAnYWxsJywgJ3Jlc2V0J107XG4gICAgICAgIGNvbnN0IGxpc3QgPSB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5sb29wLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpO1xuXG4gICAgICAgIC8vIFNob3cgdGhlIHBhbmUgYW5kIHRhYlxuICAgICAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5zZXR0aW5ncy5idXR0b25zLmxvb3AsIGZhbHNlKTtcbiAgICAgICAgdG9nZ2xlSGlkZGVuKHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLmxvb3AsIGZhbHNlKTtcblxuICAgICAgICAvLyBUb2dnbGUgdGhlIHBhbmUgYW5kIHRhYlxuICAgICAgICBjb25zdCB0b2dnbGUgPSAhaXMuZW1wdHkodGhpcy5sb29wLm9wdGlvbnMpO1xuICAgICAgICBjb250cm9scy50b2dnbGVNZW51QnV0dG9uLmNhbGwodGhpcywgJ2xvb3AnLCB0b2dnbGUpO1xuXG4gICAgICAgIC8vIEVtcHR5IHRoZSBtZW51XG4gICAgICAgIGVtcHR5RWxlbWVudChsaXN0KTtcblxuICAgICAgICBvcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBjcmVhdGVFbGVtZW50KCdsaScpO1xuXG4gICAgICAgICAgICBjb25zdCBidXR0b24gPSBjcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAgICdidXR0b24nLFxuICAgICAgICAgICAgICAgIGV4dGVuZChnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLmxvb3ApLCB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICAgICAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sLFxuICAgICAgICAgICAgICAgICAgICAnZGF0YS1wbHlyLWxvb3AtYWN0aW9uJzogb3B0aW9uLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGkxOG4uZ2V0KG9wdGlvbiwgdGhpcy5jb25maWcpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBpZiAoWydzdGFydCcsICdlbmQnXS5pbmNsdWRlcyhvcHRpb24pKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYmFkZ2UgPSBjb250cm9scy5jcmVhdGVCYWRnZS5jYWxsKHRoaXMsICcwMDowMCcpO1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5hcHBlbmRDaGlsZChiYWRnZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICAgICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoaXRlbSk7XG4gICAgICAgIH0pO1xuICAgIH0sICovXG5cbiAgLy8gR2V0IGN1cnJlbnQgc2VsZWN0ZWQgY2FwdGlvbiBsYW5ndWFnZVxuICAvLyBUT0RPOiByZXdvcmsgdGhpcyB0byB1c2VyIHRoZSBnZXR0ZXIgaW4gdGhlIEFQST9cblxuICAvLyBTZXQgYSBsaXN0IG9mIGF2YWlsYWJsZSBjYXB0aW9ucyBsYW5ndWFnZXNcbiAgc2V0Q2FwdGlvbnNNZW51KCkge1xuICAgIC8vIE1lbnUgcmVxdWlyZWRcbiAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMuY2FwdGlvbnMpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVE9ETzogQ2FwdGlvbnMgb3IgbGFuZ3VhZ2U/IEN1cnJlbnRseSBpdCdzIG1peGVkXG4gICAgY29uc3QgdHlwZSA9ICdjYXB0aW9ucyc7XG4gICAgY29uc3QgbGlzdCA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLmNhcHRpb25zLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwibWVudVwiXScpO1xuICAgIGNvbnN0IHRyYWNrcyA9IGNhcHRpb25zLmdldFRyYWNrcy5jYWxsKHRoaXMpO1xuICAgIGNvbnN0IHRvZ2dsZSA9IEJvb2xlYW4odHJhY2tzLmxlbmd0aCk7XG5cbiAgICAvLyBUb2dnbGUgdGhlIHBhbmUgYW5kIHRhYlxuICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnVCdXR0b24uY2FsbCh0aGlzLCB0eXBlLCB0b2dnbGUpO1xuXG4gICAgLy8gRW1wdHkgdGhlIG1lbnVcbiAgICBlbXB0eUVsZW1lbnQobGlzdCk7XG5cbiAgICAvLyBDaGVjayBpZiB3ZSBuZWVkIHRvIHRvZ2dsZSB0aGUgcGFyZW50XG4gICAgY29udHJvbHMuY2hlY2tNZW51LmNhbGwodGhpcyk7XG5cbiAgICAvLyBJZiB0aGVyZSdzIG5vIGNhcHRpb25zLCBiYWlsXG4gICAgaWYgKCF0b2dnbGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBHZW5lcmF0ZSBvcHRpb25zIGRhdGFcbiAgICBjb25zdCBvcHRpb25zID0gdHJhY2tzLm1hcCgodHJhY2ssIHZhbHVlKSA9PiAoe1xuICAgICAgdmFsdWUsXG4gICAgICBjaGVja2VkOiB0aGlzLmNhcHRpb25zLnRvZ2dsZWQgJiYgdGhpcy5jdXJyZW50VHJhY2sgPT09IHZhbHVlLFxuICAgICAgdGl0bGU6IGNhcHRpb25zLmdldExhYmVsLmNhbGwodGhpcywgdHJhY2spLFxuICAgICAgYmFkZ2U6IHRyYWNrLmxhbmd1YWdlICYmIGNvbnRyb2xzLmNyZWF0ZUJhZGdlLmNhbGwodGhpcywgdHJhY2subGFuZ3VhZ2UudG9VcHBlckNhc2UoKSksXG4gICAgICBsaXN0LFxuICAgICAgdHlwZTogJ2xhbmd1YWdlJyxcbiAgICB9KSk7XG5cbiAgICAvLyBBZGQgdGhlIFwiRGlzYWJsZWRcIiBvcHRpb24gdG8gdHVybiBvZmYgY2FwdGlvbnNcbiAgICBvcHRpb25zLnVuc2hpZnQoe1xuICAgICAgdmFsdWU6IC0xLFxuICAgICAgY2hlY2tlZDogIXRoaXMuY2FwdGlvbnMudG9nZ2xlZCxcbiAgICAgIHRpdGxlOiBpMThuLmdldCgnZGlzYWJsZWQnLCB0aGlzLmNvbmZpZyksXG4gICAgICBsaXN0LFxuICAgICAgdHlwZTogJ2xhbmd1YWdlJyxcbiAgICB9KTtcblxuICAgIC8vIEdlbmVyYXRlIG9wdGlvbnNcbiAgICBvcHRpb25zLmZvckVhY2goY29udHJvbHMuY3JlYXRlTWVudUl0ZW0uYmluZCh0aGlzKSk7XG5cbiAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwodGhpcywgdHlwZSwgbGlzdCk7XG4gIH0sXG5cbiAgLy8gU2V0IGEgbGlzdCBvZiBhdmFpbGFibGUgY2FwdGlvbnMgbGFuZ3VhZ2VzXG4gIHNldFNwZWVkTWVudSgpIHtcbiAgICAvLyBNZW51IHJlcXVpcmVkXG4gICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucGFuZWxzLnNwZWVkKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHR5cGUgPSAnc3BlZWQnO1xuICAgIGNvbnN0IGxpc3QgPSB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscy5zcGVlZC5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cIm1lbnVcIl0nKTtcblxuICAgIC8vIEZpbHRlciBvdXQgaW52YWxpZCBzcGVlZHNcbiAgICB0aGlzLm9wdGlvbnMuc3BlZWQgPSB0aGlzLm9wdGlvbnMuc3BlZWQuZmlsdGVyKChvKSA9PiBvID49IHRoaXMubWluaW11bVNwZWVkICYmIG8gPD0gdGhpcy5tYXhpbXVtU3BlZWQpO1xuXG4gICAgLy8gVG9nZ2xlIHRoZSBwYW5lIGFuZCB0YWJcbiAgICBjb25zdCB0b2dnbGUgPSAhaXMuZW1wdHkodGhpcy5vcHRpb25zLnNwZWVkKSAmJiB0aGlzLm9wdGlvbnMuc3BlZWQubGVuZ3RoID4gMTtcbiAgICBjb250cm9scy50b2dnbGVNZW51QnV0dG9uLmNhbGwodGhpcywgdHlwZSwgdG9nZ2xlKTtcblxuICAgIC8vIEVtcHR5IHRoZSBtZW51XG4gICAgZW1wdHlFbGVtZW50KGxpc3QpO1xuXG4gICAgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byB0b2dnbGUgdGhlIHBhcmVudFxuICAgIGNvbnRyb2xzLmNoZWNrTWVudS5jYWxsKHRoaXMpO1xuXG4gICAgLy8gSWYgd2UncmUgaGlkaW5nLCBub3RoaW5nIG1vcmUgdG8gZG9cbiAgICBpZiAoIXRvZ2dsZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBpdGVtc1xuICAgIHRoaXMub3B0aW9ucy5zcGVlZC5mb3JFYWNoKChzcGVlZCkgPT4ge1xuICAgICAgY29udHJvbHMuY3JlYXRlTWVudUl0ZW0uY2FsbCh0aGlzLCB7XG4gICAgICAgIHZhbHVlOiBzcGVlZCxcbiAgICAgICAgbGlzdCxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgdGl0bGU6IGNvbnRyb2xzLmdldExhYmVsLmNhbGwodGhpcywgJ3NwZWVkJywgc3BlZWQpLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwodGhpcywgdHlwZSwgbGlzdCk7XG4gIH0sXG5cbiAgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byBoaWRlL3Nob3cgdGhlIHNldHRpbmdzIG1lbnVcbiAgY2hlY2tNZW51KCkge1xuICAgIGNvbnN0IHsgYnV0dG9ucyB9ID0gdGhpcy5lbGVtZW50cy5zZXR0aW5ncztcbiAgICBjb25zdCB2aXNpYmxlID0gIWlzLmVtcHR5KGJ1dHRvbnMpICYmIE9iamVjdC52YWx1ZXMoYnV0dG9ucykuc29tZSgoYnV0dG9uKSA9PiAhYnV0dG9uLmhpZGRlbik7XG5cbiAgICB0b2dnbGVIaWRkZW4odGhpcy5lbGVtZW50cy5zZXR0aW5ncy5tZW51LCAhdmlzaWJsZSk7XG4gIH0sXG5cbiAgLy8gRm9jdXMgdGhlIGZpcnN0IG1lbnUgaXRlbSBpbiBhIGdpdmVuIChvciB2aXNpYmxlKSBtZW51XG4gIGZvY3VzRmlyc3RNZW51SXRlbShwYW5lLCB0YWJGb2N1cyA9IGZhbHNlKSB7XG4gICAgaWYgKHRoaXMuZWxlbWVudHMuc2V0dGluZ3MucG9wdXAuaGlkZGVuKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IHRhcmdldCA9IHBhbmU7XG5cbiAgICBpZiAoIWlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgdGFyZ2V0ID0gT2JqZWN0LnZhbHVlcyh0aGlzLmVsZW1lbnRzLnNldHRpbmdzLnBhbmVscykuZmluZCgocCkgPT4gIXAuaGlkZGVuKTtcbiAgICB9XG5cbiAgICBjb25zdCBmaXJzdEl0ZW0gPSB0YXJnZXQucXVlcnlTZWxlY3RvcignW3JvbGVePVwibWVudWl0ZW1cIl0nKTtcblxuICAgIHNldEZvY3VzLmNhbGwodGhpcywgZmlyc3RJdGVtLCB0YWJGb2N1cyk7XG4gIH0sXG5cbiAgLy8gU2hvdy9oaWRlIG1lbnVcbiAgdG9nZ2xlTWVudShpbnB1dCkge1xuICAgIGNvbnN0IHsgcG9wdXAgfSA9IHRoaXMuZWxlbWVudHMuc2V0dGluZ3M7XG4gICAgY29uc3QgYnV0dG9uID0gdGhpcy5lbGVtZW50cy5idXR0b25zLnNldHRpbmdzO1xuXG4gICAgLy8gTWVudSBhbmQgYnV0dG9uIGFyZSByZXF1aXJlZFxuICAgIGlmICghaXMuZWxlbWVudChwb3B1cCkgfHwgIWlzLmVsZW1lbnQoYnV0dG9uKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFRydWUgdG9nZ2xlIGJ5IGRlZmF1bHRcbiAgICBjb25zdCB7IGhpZGRlbiB9ID0gcG9wdXA7XG4gICAgbGV0IHNob3cgPSBoaWRkZW47XG5cbiAgICBpZiAoaXMuYm9vbGVhbihpbnB1dCkpIHtcbiAgICAgIHNob3cgPSBpbnB1dDtcbiAgICB9IGVsc2UgaWYgKGlzLmtleWJvYXJkRXZlbnQoaW5wdXQpICYmIGlucHV0LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHNob3cgPSBmYWxzZTtcbiAgICB9IGVsc2UgaWYgKGlzLmV2ZW50KGlucHV0KSkge1xuICAgICAgLy8gSWYgUGx5ciBpcyBpbiBhIHNoYWRvd0RPTSwgdGhlIGV2ZW50IHRhcmdldCBpcyBzZXQgdG8gdGhlIGNvbXBvbmVudCwgaW5zdGVhZCBvZiB0aGVcbiAgICAgIC8vIEVsZW1lbnQgaW4gdGhlIHNoYWRvd0RPTS4gVGhlIHBhdGgsIGlmIGF2YWlsYWJsZSwgaXMgY29tcGxldGUuXG4gICAgICBjb25zdCB0YXJnZXQgPSBpcy5mdW5jdGlvbihpbnB1dC5jb21wb3NlZFBhdGgpID8gaW5wdXQuY29tcG9zZWRQYXRoKClbMF0gOiBpbnB1dC50YXJnZXQ7XG4gICAgICBjb25zdCBpc01lbnVJdGVtID0gcG9wdXAuY29udGFpbnModGFyZ2V0KTtcblxuICAgICAgLy8gSWYgdGhlIGNsaWNrIHdhcyBpbnNpZGUgdGhlIG1lbnUgb3IgaWYgdGhlIGNsaWNrXG4gICAgICAvLyB3YXNuJ3QgdGhlIGJ1dHRvbiBvciBtZW51IGl0ZW0gYW5kIHdlJ3JlIHRyeWluZyB0b1xuICAgICAgLy8gc2hvdyB0aGUgbWVudSAoYSBkb2MgY2xpY2sgc2hvdWxkbid0IHNob3cgdGhlIG1lbnUpXG4gICAgICBpZiAoaXNNZW51SXRlbSB8fCAoIWlzTWVudUl0ZW0gJiYgaW5wdXQudGFyZ2V0ICE9PSBidXR0b24gJiYgc2hvdykpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFNldCBidXR0b24gYXR0cmlidXRlc1xuICAgIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBzaG93KTtcblxuICAgIC8vIFNob3cgdGhlIGFjdHVhbCBwb3B1cFxuICAgIHRvZ2dsZUhpZGRlbihwb3B1cCwgIXNob3cpO1xuXG4gICAgLy8gQWRkIGNsYXNzIGhvb2tcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5tZW51Lm9wZW4sIHNob3cpO1xuXG4gICAgLy8gRm9jdXMgdGhlIGZpcnN0IGl0ZW0gaWYga2V5IGludGVyYWN0aW9uXG4gICAgaWYgKHNob3cgJiYgaXMua2V5Ym9hcmRFdmVudChpbnB1dCkpIHtcbiAgICAgIGNvbnRyb2xzLmZvY3VzRmlyc3RNZW51SXRlbS5jYWxsKHRoaXMsIG51bGwsIHRydWUpO1xuICAgIH0gZWxzZSBpZiAoIXNob3cgJiYgIWhpZGRlbikge1xuICAgICAgLy8gSWYgY2xvc2luZywgcmUtZm9jdXMgdGhlIGJ1dHRvblxuICAgICAgc2V0Rm9jdXMuY2FsbCh0aGlzLCBidXR0b24sIGlzLmtleWJvYXJkRXZlbnQoaW5wdXQpKTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gR2V0IHRoZSBuYXR1cmFsIHNpemUgb2YgYSBtZW51IHBhbmVsXG4gIGdldE1lbnVTaXplKHRhYikge1xuICAgIGNvbnN0IGNsb25lID0gdGFiLmNsb25lTm9kZSh0cnVlKTtcbiAgICBjbG9uZS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgY2xvbmUuc3R5bGUub3BhY2l0eSA9IDA7XG4gICAgY2xvbmUucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcblxuICAgIC8vIEFwcGVuZCB0byBwYXJlbnQgc28gd2UgZ2V0IHRoZSBcInJlYWxcIiBzaXplXG4gICAgdGFiLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoY2xvbmUpO1xuXG4gICAgLy8gR2V0IHRoZSBzaXplcyBiZWZvcmUgd2UgcmVtb3ZlXG4gICAgY29uc3Qgd2lkdGggPSBjbG9uZS5zY3JvbGxXaWR0aDtcbiAgICBjb25zdCBoZWlnaHQgPSBjbG9uZS5zY3JvbGxIZWlnaHQ7XG5cbiAgICAvLyBSZW1vdmUgZnJvbSB0aGUgRE9NXG4gICAgcmVtb3ZlRWxlbWVudChjbG9uZSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgd2lkdGgsXG4gICAgICBoZWlnaHQsXG4gICAgfTtcbiAgfSxcblxuICAvLyBTaG93IGEgcGFuZWwgaW4gdGhlIG1lbnVcbiAgc2hvd01lbnVQYW5lbCh0eXBlID0gJycsIHRhYkZvY3VzID0gZmFsc2UpIHtcbiAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKGAjcGx5ci1zZXR0aW5ncy0ke3RoaXMuaWR9LSR7dHlwZX1gKTtcblxuICAgIC8vIE5vdGhpbmcgdG8gc2hvdywgYmFpbFxuICAgIGlmICghaXMuZWxlbWVudCh0YXJnZXQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gSGlkZSBhbGwgb3RoZXIgcGFuZWxzXG4gICAgY29uc3QgY29udGFpbmVyID0gdGFyZ2V0LnBhcmVudE5vZGU7XG4gICAgY29uc3QgY3VycmVudCA9IEFycmF5LmZyb20oY29udGFpbmVyLmNoaWxkcmVuKS5maW5kKChub2RlKSA9PiAhbm9kZS5oaWRkZW4pO1xuXG4gICAgLy8gSWYgd2UgY2FuIGRvIGZhbmN5IGFuaW1hdGlvbnMsIHdlJ2xsIGFuaW1hdGUgdGhlIGhlaWdodC93aWR0aFxuICAgIGlmIChzdXBwb3J0LnRyYW5zaXRpb25zICYmICFzdXBwb3J0LnJlZHVjZWRNb3Rpb24pIHtcbiAgICAgIC8vIFNldCB0aGUgY3VycmVudCB3aWR0aCBhcyBhIGJhc2VcbiAgICAgIGNvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke2N1cnJlbnQuc2Nyb2xsV2lkdGh9cHhgO1xuICAgICAgY29udGFpbmVyLnN0eWxlLmhlaWdodCA9IGAke2N1cnJlbnQuc2Nyb2xsSGVpZ2h0fXB4YDtcblxuICAgICAgLy8gR2V0IHBvdGVudGlhbCBzaXplc1xuICAgICAgY29uc3Qgc2l6ZSA9IGNvbnRyb2xzLmdldE1lbnVTaXplLmNhbGwodGhpcywgdGFyZ2V0KTtcblxuICAgICAgLy8gUmVzdG9yZSBhdXRvIGhlaWdodC93aWR0aFxuICAgICAgY29uc3QgcmVzdG9yZSA9IChldmVudCkgPT4ge1xuICAgICAgICAvLyBXZSdyZSBvbmx5IGJvdGhlcmVkIGFib3V0IGhlaWdodCBhbmQgd2lkdGggb24gdGhlIGNvbnRhaW5lclxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ICE9PSBjb250YWluZXIgfHwgIVsnd2lkdGgnLCAnaGVpZ2h0J10uaW5jbHVkZXMoZXZlbnQucHJvcGVydHlOYW1lKSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJldmVydCBiYWNrIHRvIGF1dG9cbiAgICAgICAgY29udGFpbmVyLnN0eWxlLndpZHRoID0gJyc7XG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSAnJztcblxuICAgICAgICAvLyBPbmx5IGxpc3RlbiBvbmNlXG4gICAgICAgIG9mZi5jYWxsKHRoaXMsIGNvbnRhaW5lciwgdHJhbnNpdGlvbkVuZEV2ZW50LCByZXN0b3JlKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIExpc3RlbiBmb3IgdGhlIHRyYW5zaXRpb24gZmluaXNoaW5nIGFuZCByZXN0b3JlIGF1dG8gaGVpZ2h0L3dpZHRoXG4gICAgICBvbi5jYWxsKHRoaXMsIGNvbnRhaW5lciwgdHJhbnNpdGlvbkVuZEV2ZW50LCByZXN0b3JlKTtcblxuICAgICAgLy8gU2V0IGRpbWVuc2lvbnMgdG8gdGFyZ2V0XG4gICAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSBgJHtzaXplLndpZHRofXB4YDtcbiAgICAgIGNvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBgJHtzaXplLmhlaWdodH1weGA7XG4gICAgfVxuXG4gICAgLy8gU2V0IGF0dHJpYnV0ZXMgb24gY3VycmVudCB0YWJcbiAgICB0b2dnbGVIaWRkZW4oY3VycmVudCwgdHJ1ZSk7XG5cbiAgICAvLyBTZXQgYXR0cmlidXRlcyBvbiB0YXJnZXRcbiAgICB0b2dnbGVIaWRkZW4odGFyZ2V0LCBmYWxzZSk7XG5cbiAgICAvLyBGb2N1cyB0aGUgZmlyc3QgaXRlbVxuICAgIGNvbnRyb2xzLmZvY3VzRmlyc3RNZW51SXRlbS5jYWxsKHRoaXMsIHRhcmdldCwgdGFiRm9jdXMpO1xuICB9LFxuXG4gIC8vIFNldCB0aGUgZG93bmxvYWQgVVJMXG4gIHNldERvd25sb2FkVXJsKCkge1xuICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMuZWxlbWVudHMuYnV0dG9ucy5kb3dubG9hZDtcblxuICAgIC8vIEJhaWwgaWYgbm8gYnV0dG9uXG4gICAgaWYgKCFpcy5lbGVtZW50KGJ1dHRvbikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBTZXQgYXR0cmlidXRlXG4gICAgYnV0dG9uLnNldEF0dHJpYnV0ZSgnaHJlZicsIHRoaXMuZG93bmxvYWQpO1xuICB9LFxuXG4gIC8vIEJ1aWxkIHRoZSBkZWZhdWx0IEhUTUxcbiAgY3JlYXRlKGRhdGEpIHtcbiAgICBjb25zdCB7XG4gICAgICBiaW5kTWVudUl0ZW1TaG9ydGN1dHMsXG4gICAgICBjcmVhdGVCdXR0b24sXG4gICAgICBjcmVhdGVQcm9ncmVzcyxcbiAgICAgIGNyZWF0ZVJhbmdlLFxuICAgICAgY3JlYXRlVGltZSxcbiAgICAgIHNldFF1YWxpdHlNZW51LFxuICAgICAgc2V0U3BlZWRNZW51LFxuICAgICAgc2hvd01lbnVQYW5lbCxcbiAgICB9ID0gY29udHJvbHM7XG4gICAgdGhpcy5lbGVtZW50cy5jb250cm9scyA9IG51bGw7XG5cbiAgICAvLyBMYXJnZXIgb3ZlcmxhaWQgcGxheSBidXR0b25cbiAgICBpZiAoaXMuYXJyYXkodGhpcy5jb25maWcuY29udHJvbHMpICYmIHRoaXMuY29uZmlnLmNvbnRyb2xzLmluY2x1ZGVzKCdwbGF5LWxhcmdlJykpIHtcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdwbGF5LWxhcmdlJykpO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSB0aGUgY29udGFpbmVyXG4gICAgY29uc3QgY29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2JywgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY29udHJvbHMud3JhcHBlcikpO1xuICAgIHRoaXMuZWxlbWVudHMuY29udHJvbHMgPSBjb250YWluZXI7XG5cbiAgICAvLyBEZWZhdWx0IGl0ZW0gYXR0cmlidXRlc1xuICAgIGNvbnN0IGRlZmF1bHRBdHRyaWJ1dGVzID0geyBjbGFzczogJ3BseXJfX2NvbnRyb2xzX19pdGVtJyB9O1xuXG4gICAgLy8gTG9vcCB0aHJvdWdoIGNvbnRyb2xzIGluIG9yZGVyXG4gICAgZGVkdXBlKGlzLmFycmF5KHRoaXMuY29uZmlnLmNvbnRyb2xzKSA/IHRoaXMuY29uZmlnLmNvbnRyb2xzIDogW10pLmZvckVhY2goKGNvbnRyb2wpID0+IHtcbiAgICAgIC8vIFJlc3RhcnQgYnV0dG9uXG4gICAgICBpZiAoY29udHJvbCA9PT0gJ3Jlc3RhcnQnKSB7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAncmVzdGFydCcsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJld2luZCBidXR0b25cbiAgICAgIGlmIChjb250cm9sID09PSAncmV3aW5kJykge1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ3Jld2luZCcsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFBsYXkvUGF1c2UgYnV0dG9uXG4gICAgICBpZiAoY29udHJvbCA9PT0gJ3BsYXknKSB7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAncGxheScsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEZhc3QgZm9yd2FyZCBidXR0b25cbiAgICAgIGlmIChjb250cm9sID09PSAnZmFzdC1mb3J3YXJkJykge1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ2Zhc3QtZm9yd2FyZCcsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFByb2dyZXNzXG4gICAgICBpZiAoY29udHJvbCA9PT0gJ3Byb2dyZXNzJykge1xuICAgICAgICBjb25zdCBwcm9ncmVzc0NvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICBjbGFzczogYCR7ZGVmYXVsdEF0dHJpYnV0ZXMuY2xhc3N9IHBseXJfX3Byb2dyZXNzX19jb250YWluZXJgLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBwcm9ncmVzcyA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIGdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IodGhpcy5jb25maWcuc2VsZWN0b3JzLnByb2dyZXNzKSk7XG5cbiAgICAgICAgLy8gU2VlayByYW5nZSBzbGlkZXJcbiAgICAgICAgcHJvZ3Jlc3MuYXBwZW5kQ2hpbGQoXG4gICAgICAgICAgY3JlYXRlUmFuZ2UuY2FsbCh0aGlzLCAnc2VlaycsIHtcbiAgICAgICAgICAgIGlkOiBgcGx5ci1zZWVrLSR7ZGF0YS5pZH1gLFxuICAgICAgICAgIH0pLFxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEJ1ZmZlciBwcm9ncmVzc1xuICAgICAgICBwcm9ncmVzcy5hcHBlbmRDaGlsZChjcmVhdGVQcm9ncmVzcy5jYWxsKHRoaXMsICdidWZmZXInKSk7XG5cbiAgICAgICAgLy8gVE9ETzogQWRkIGxvb3AgZGlzcGxheSBpbmRpY2F0b3JcblxuICAgICAgICAvLyBTZWVrIHRvb2x0aXBcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLnRvb2x0aXBzLnNlZWspIHtcbiAgICAgICAgICBjb25zdCB0b29sdGlwID0gY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICdzcGFuJyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgY2xhc3M6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnMDA6MDAnLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBwcm9ncmVzcy5hcHBlbmRDaGlsZCh0b29sdGlwKTtcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXAgPSB0b29sdGlwO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lbGVtZW50cy5wcm9ncmVzcyA9IHByb2dyZXNzO1xuICAgICAgICBwcm9ncmVzc0NvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLnByb2dyZXNzKTtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHByb2dyZXNzQ29udGFpbmVyKTtcbiAgICAgIH1cblxuICAgICAgLy8gTWVkaWEgY3VycmVudCB0aW1lIGRpc3BsYXlcbiAgICAgIGlmIChjb250cm9sID09PSAnY3VycmVudC10aW1lJykge1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlVGltZS5jYWxsKHRoaXMsICdjdXJyZW50VGltZScsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIE1lZGlhIGR1cmF0aW9uIGRpc3BsYXlcbiAgICAgIGlmIChjb250cm9sID09PSAnZHVyYXRpb24nKSB7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVUaW1lLmNhbGwodGhpcywgJ2R1cmF0aW9uJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gVm9sdW1lIGNvbnRyb2xzXG4gICAgICBpZiAoY29udHJvbCA9PT0gJ211dGUnIHx8IGNvbnRyb2wgPT09ICd2b2x1bWUnKSB7XG4gICAgICAgIGxldCB7IHZvbHVtZSB9ID0gdGhpcy5lbGVtZW50cztcblxuICAgICAgICAvLyBDcmVhdGUgdGhlIHZvbHVtZSBjb250YWluZXIgaWYgbmVlZGVkXG4gICAgICAgIGlmICghaXMuZWxlbWVudCh2b2x1bWUpIHx8ICFjb250YWluZXIuY29udGFpbnModm9sdW1lKSkge1xuICAgICAgICAgIHZvbHVtZSA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgIGV4dGVuZCh7fSwgZGVmYXVsdEF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgICAgY2xhc3M6IGAke2RlZmF1bHRBdHRyaWJ1dGVzLmNsYXNzfSBwbHlyX192b2x1bWVgLnRyaW0oKSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLnZvbHVtZSA9IHZvbHVtZTtcblxuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh2b2x1bWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVG9nZ2xlIG11dGUgYnV0dG9uXG4gICAgICAgIGlmIChjb250cm9sID09PSAnbXV0ZScpIHtcbiAgICAgICAgICB2b2x1bWUuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ211dGUnKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBWb2x1bWUgcmFuZ2UgY29udHJvbFxuICAgICAgICAvLyBJZ25vcmVkIG9uIGlPUyBhcyBpdCdzIGhhbmRsZWQgZ2xvYmFsbHlcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2xpYnJhcnkvc2FmYXJpL2RvY3VtZW50YXRpb24vQXVkaW9WaWRlby9Db25jZXB0dWFsL1VzaW5nX0hUTUw1X0F1ZGlvX1ZpZGVvL0RldmljZS1TcGVjaWZpY0NvbnNpZGVyYXRpb25zL0RldmljZS1TcGVjaWZpY0NvbnNpZGVyYXRpb25zLmh0bWxcbiAgICAgICAgaWYgKGNvbnRyb2wgPT09ICd2b2x1bWUnICYmICFicm93c2VyLmlzSW9zKSB7XG4gICAgICAgICAgLy8gU2V0IHRoZSBhdHRyaWJ1dGVzXG4gICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHtcbiAgICAgICAgICAgIG1heDogMSxcbiAgICAgICAgICAgIHN0ZXA6IDAuMDUsXG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5jb25maWcudm9sdW1lLFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvLyBDcmVhdGUgdGhlIHZvbHVtZSByYW5nZSBzbGlkZXJcbiAgICAgICAgICB2b2x1bWUuYXBwZW5kQ2hpbGQoXG4gICAgICAgICAgICBjcmVhdGVSYW5nZS5jYWxsKFxuICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAndm9sdW1lJyxcbiAgICAgICAgICAgICAgZXh0ZW5kKGF0dHJpYnV0ZXMsIHtcbiAgICAgICAgICAgICAgICBpZDogYHBseXItdm9sdW1lLSR7ZGF0YS5pZH1gLFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBUb2dnbGUgY2FwdGlvbnMgYnV0dG9uXG4gICAgICBpZiAoY29udHJvbCA9PT0gJ2NhcHRpb25zJykge1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9uLmNhbGwodGhpcywgJ2NhcHRpb25zJywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gU2V0dGluZ3MgYnV0dG9uIC8gbWVudVxuICAgICAgaWYgKGNvbnRyb2wgPT09ICdzZXR0aW5ncycgJiYgIWlzLmVtcHR5KHRoaXMuY29uZmlnLnNldHRpbmdzKSkge1xuICAgICAgICBjb25zdCB3cmFwcGVyID0gY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICBleHRlbmQoe30sIGRlZmF1bHRBdHRyaWJ1dGVzLCB7XG4gICAgICAgICAgICBjbGFzczogYCR7ZGVmYXVsdEF0dHJpYnV0ZXMuY2xhc3N9IHBseXJfX21lbnVgLnRyaW0oKSxcbiAgICAgICAgICAgIGhpZGRlbjogJycsXG4gICAgICAgICAgfSksXG4gICAgICAgICk7XG5cbiAgICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChcbiAgICAgICAgICBjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAnc2V0dGluZ3MnLCB7XG4gICAgICAgICAgICAnYXJpYS1oYXNwb3B1cCc6IHRydWUsXG4gICAgICAgICAgICAnYXJpYS1jb250cm9scyc6IGBwbHlyLXNldHRpbmdzLSR7ZGF0YS5pZH1gLFxuICAgICAgICAgICAgJ2FyaWEtZXhwYW5kZWQnOiBmYWxzZSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBwb3B1cCA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICBjbGFzczogJ3BseXJfX21lbnVfX2NvbnRhaW5lcicsXG4gICAgICAgICAgaWQ6IGBwbHlyLXNldHRpbmdzLSR7ZGF0YS5pZH1gLFxuICAgICAgICAgIGhpZGRlbjogJycsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGlubmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cbiAgICAgICAgY29uc3QgaG9tZSA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICBpZDogYHBseXItc2V0dGluZ3MtJHtkYXRhLmlkfS1ob21lYCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBtZW51XG4gICAgICAgIGNvbnN0IG1lbnUgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgcm9sZTogJ21lbnUnLFxuICAgICAgICB9KTtcblxuICAgICAgICBob21lLmFwcGVuZENoaWxkKG1lbnUpO1xuICAgICAgICBpbm5lci5hcHBlbmRDaGlsZChob21lKTtcbiAgICAgICAgdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHMuaG9tZSA9IGhvbWU7XG5cbiAgICAgICAgLy8gQnVpbGQgdGhlIG1lbnUgaXRlbXNcbiAgICAgICAgdGhpcy5jb25maWcuc2V0dGluZ3MuZm9yRWFjaCgodHlwZSkgPT4ge1xuICAgICAgICAgIC8vIFRPRE86IGJ1bmRsZSB0aGlzIHdpdGggdGhlIGNyZWF0ZU1lbnVJdGVtIGhlbHBlciBhbmQgYmluZGluZ3NcbiAgICAgICAgICBjb25zdCBtZW51SXRlbSA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAnYnV0dG9uJyxcbiAgICAgICAgICAgIGV4dGVuZChnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5idXR0b25zLnNldHRpbmdzKSwge1xuICAgICAgICAgICAgICB0eXBlOiAnYnV0dG9uJyxcbiAgICAgICAgICAgICAgY2xhc3M6IGAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbH0gJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9LS1mb3J3YXJkYCxcbiAgICAgICAgICAgICAgcm9sZTogJ21lbnVpdGVtJyxcbiAgICAgICAgICAgICAgJ2FyaWEtaGFzcG9wdXAnOiB0cnVlLFxuICAgICAgICAgICAgICBoaWRkZW46ICcnLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIC8vIEJpbmQgbWVudSBzaG9ydGN1dHMgZm9yIGtleWJvYXJkIHVzZXJzXG4gICAgICAgICAgYmluZE1lbnVJdGVtU2hvcnRjdXRzLmNhbGwodGhpcywgbWVudUl0ZW0sIHR5cGUpO1xuXG4gICAgICAgICAgLy8gU2hvdyBtZW51IG9uIGNsaWNrXG4gICAgICAgICAgb24uY2FsbCh0aGlzLCBtZW51SXRlbSwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgc2hvd01lbnVQYW5lbC5jYWxsKHRoaXMsIHR5cGUsIGZhbHNlKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNvbnN0IGZsZXggPSBjcmVhdGVFbGVtZW50KCdzcGFuJywgbnVsbCwgaTE4bi5nZXQodHlwZSwgdGhpcy5jb25maWcpKTtcblxuICAgICAgICAgIGNvbnN0IHZhbHVlID0gY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLm1lbnUudmFsdWUsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBTcGVlZCBjb250YWlucyBIVE1MIGVudGl0aWVzXG4gICAgICAgICAgdmFsdWUuaW5uZXJIVE1MID0gZGF0YVt0eXBlXTtcblxuICAgICAgICAgIGZsZXguYXBwZW5kQ2hpbGQodmFsdWUpO1xuICAgICAgICAgIG1lbnVJdGVtLmFwcGVuZENoaWxkKGZsZXgpO1xuICAgICAgICAgIG1lbnUuYXBwZW5kQ2hpbGQobWVudUl0ZW0pO1xuXG4gICAgICAgICAgLy8gQnVpbGQgdGhlIHBhbmVzXG4gICAgICAgICAgY29uc3QgcGFuZSA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgIGlkOiBgcGx5ci1zZXR0aW5ncy0ke2RhdGEuaWR9LSR7dHlwZX1gLFxuICAgICAgICAgICAgaGlkZGVuOiAnJyxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIEJhY2sgYnV0dG9uXG4gICAgICAgICAgY29uc3QgYmFja0J1dHRvbiA9IGNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicsIHtcbiAgICAgICAgICAgIHR5cGU6ICdidXR0b24nLFxuICAgICAgICAgICAgY2xhc3M6IGAke3RoaXMuY29uZmlnLmNsYXNzTmFtZXMuY29udHJvbH0gJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNvbnRyb2x9LS1iYWNrYCxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIFZpc2libGUgbGFiZWxcbiAgICAgICAgICBiYWNrQnV0dG9uLmFwcGVuZENoaWxkKFxuICAgICAgICAgICAgY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgJ3NwYW4nLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJ2FyaWEtaGlkZGVuJzogdHJ1ZSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaTE4bi5nZXQodHlwZSwgdGhpcy5jb25maWcpLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgLy8gU2NyZWVuIHJlYWRlciBsYWJlbFxuICAgICAgICAgIGJhY2tCdXR0b24uYXBwZW5kQ2hpbGQoXG4gICAgICAgICAgICBjcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAnc3BhbicsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRkZW4sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGkxOG4uZ2V0KCdtZW51QmFjaycsIHRoaXMuY29uZmlnKSxcbiAgICAgICAgICAgICksXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIC8vIEdvIGJhY2sgdmlhIGtleWJvYXJkXG4gICAgICAgICAgb24uY2FsbChcbiAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICBwYW5lLFxuICAgICAgICAgICAgJ2tleWRvd24nLFxuICAgICAgICAgICAgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgIGlmIChldmVudC5rZXkgIT09ICdBcnJvd0xlZnQnKSByZXR1cm47XG5cbiAgICAgICAgICAgICAgLy8gUHJldmVudCBzZWVrXG4gICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICAgIC8vIFNob3cgdGhlIHJlc3BlY3RpdmUgbWVudVxuICAgICAgICAgICAgICBzaG93TWVudVBhbmVsLmNhbGwodGhpcywgJ2hvbWUnLCB0cnVlKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgLy8gR28gYmFjayB2aWEgYnV0dG9uIGNsaWNrXG4gICAgICAgICAgb24uY2FsbCh0aGlzLCBiYWNrQnV0dG9uLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBzaG93TWVudVBhbmVsLmNhbGwodGhpcywgJ2hvbWUnLCBmYWxzZSk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBBZGQgdG8gcGFuZVxuICAgICAgICAgIHBhbmUuYXBwZW5kQ2hpbGQoYmFja0J1dHRvbik7XG5cbiAgICAgICAgICAvLyBNZW51XG4gICAgICAgICAgcGFuZS5hcHBlbmRDaGlsZChcbiAgICAgICAgICAgIGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgICAgICAgcm9sZTogJ21lbnUnLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIGlubmVyLmFwcGVuZENoaWxkKHBhbmUpO1xuXG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5idXR0b25zW3R5cGVdID0gbWVudUl0ZW07XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wYW5lbHNbdHlwZV0gPSBwYW5lO1xuICAgICAgICB9KTtcblxuICAgICAgICBwb3B1cC5hcHBlbmRDaGlsZChpbm5lcik7XG4gICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQocG9wdXApO1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQod3JhcHBlcik7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50cy5zZXR0aW5ncy5wb3B1cCA9IHBvcHVwO1xuICAgICAgICB0aGlzLmVsZW1lbnRzLnNldHRpbmdzLm1lbnUgPSB3cmFwcGVyO1xuICAgICAgfVxuXG4gICAgICAvLyBQaWN0dXJlIGluIHBpY3R1cmUgYnV0dG9uXG4gICAgICBpZiAoY29udHJvbCA9PT0gJ3BpcCcgJiYgc3VwcG9ydC5waXApIHtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdwaXAnLCBkZWZhdWx0QXR0cmlidXRlcykpO1xuICAgICAgfVxuXG4gICAgICAvLyBBaXJwbGF5IGJ1dHRvblxuICAgICAgaWYgKGNvbnRyb2wgPT09ICdhaXJwbGF5JyAmJiBzdXBwb3J0LmFpcnBsYXkpIHtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdhaXJwbGF5JywgZGVmYXVsdEF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gRG93bmxvYWQgYnV0dG9uXG4gICAgICBpZiAoY29udHJvbCA9PT0gJ2Rvd25sb2FkJykge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gZXh0ZW5kKHt9LCBkZWZhdWx0QXR0cmlidXRlcywge1xuICAgICAgICAgIGVsZW1lbnQ6ICdhJyxcbiAgICAgICAgICBocmVmOiB0aGlzLmRvd25sb2FkLFxuICAgICAgICAgIHRhcmdldDogJ19ibGFuaycsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFNldCBkb3dubG9hZCBhdHRyaWJ1dGUgZm9yIEhUTUw1IG9ubHlcbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIGF0dHJpYnV0ZXMuZG93bmxvYWQgPSAnJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHsgZG93bmxvYWQgfSA9IHRoaXMuY29uZmlnLnVybHM7XG5cbiAgICAgICAgaWYgKCFpcy51cmwoZG93bmxvYWQpICYmIHRoaXMuaXNFbWJlZCkge1xuICAgICAgICAgIGV4dGVuZChhdHRyaWJ1dGVzLCB7XG4gICAgICAgICAgICBpY29uOiBgbG9nby0ke3RoaXMucHJvdmlkZXJ9YCxcbiAgICAgICAgICAgIGxhYmVsOiB0aGlzLnByb3ZpZGVyLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUJ1dHRvbi5jYWxsKHRoaXMsICdkb3dubG9hZCcsIGF0dHJpYnV0ZXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gVG9nZ2xlIGZ1bGxzY3JlZW4gYnV0dG9uXG4gICAgICBpZiAoY29udHJvbCA9PT0gJ2Z1bGxzY3JlZW4nKSB7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b24uY2FsbCh0aGlzLCAnZnVsbHNjcmVlbicsIGRlZmF1bHRBdHRyaWJ1dGVzKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBTZXQgYXZhaWxhYmxlIHF1YWxpdHkgbGV2ZWxzXG4gICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgc2V0UXVhbGl0eU1lbnUuY2FsbCh0aGlzLCBodG1sNS5nZXRRdWFsaXR5T3B0aW9ucy5jYWxsKHRoaXMpKTtcbiAgICB9XG5cbiAgICBzZXRTcGVlZE1lbnUuY2FsbCh0aGlzKTtcblxuICAgIHJldHVybiBjb250YWluZXI7XG4gIH0sXG5cbiAgLy8gSW5zZXJ0IGNvbnRyb2xzXG4gIGluamVjdCgpIHtcbiAgICAvLyBTcHJpdGVcbiAgICBpZiAodGhpcy5jb25maWcubG9hZFNwcml0ZSkge1xuICAgICAgY29uc3QgaWNvbiA9IGNvbnRyb2xzLmdldEljb25VcmwuY2FsbCh0aGlzKTtcblxuICAgICAgLy8gT25seSBsb2FkIGV4dGVybmFsIHNwcml0ZSB1c2luZyBBSkFYXG4gICAgICBpZiAoaWNvbi5jb3JzKSB7XG4gICAgICAgIGxvYWRTcHJpdGUoaWNvbi51cmwsICdzcHJpdGUtcGx5cicpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhIHVuaXF1ZSBJRFxuICAgIHRoaXMuaWQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMCk7XG5cbiAgICAvLyBOdWxsIGJ5IGRlZmF1bHRcbiAgICBsZXQgY29udGFpbmVyID0gbnVsbDtcbiAgICB0aGlzLmVsZW1lbnRzLmNvbnRyb2xzID0gbnVsbDtcblxuICAgIC8vIFNldCB0ZW1wbGF0ZSBwcm9wZXJ0aWVzXG4gICAgY29uc3QgcHJvcHMgPSB7XG4gICAgICBpZDogdGhpcy5pZCxcbiAgICAgIHNlZWt0aW1lOiB0aGlzLmNvbmZpZy5zZWVrVGltZSxcbiAgICAgIHRpdGxlOiB0aGlzLmNvbmZpZy50aXRsZSxcbiAgICB9O1xuICAgIGxldCB1cGRhdGUgPSB0cnVlO1xuXG4gICAgLy8gSWYgZnVuY3Rpb24sIHJ1biBpdCBhbmQgdXNlIG91dHB1dFxuICAgIGlmIChpcy5mdW5jdGlvbih0aGlzLmNvbmZpZy5jb250cm9scykpIHtcbiAgICAgIHRoaXMuY29uZmlnLmNvbnRyb2xzID0gdGhpcy5jb25maWcuY29udHJvbHMuY2FsbCh0aGlzLCBwcm9wcyk7XG4gICAgfVxuXG4gICAgLy8gQ29udmVydCBmYWxzeSBjb250cm9scyB0byBlbXB0eSBhcnJheSAocHJpbWFyaWx5IGZvciBlbXB0eSBzdHJpbmdzKVxuICAgIGlmICghdGhpcy5jb25maWcuY29udHJvbHMpIHtcbiAgICAgIHRoaXMuY29uZmlnLmNvbnRyb2xzID0gW107XG4gICAgfVxuXG4gICAgaWYgKGlzLmVsZW1lbnQodGhpcy5jb25maWcuY29udHJvbHMpIHx8IGlzLnN0cmluZyh0aGlzLmNvbmZpZy5jb250cm9scykpIHtcbiAgICAgIC8vIEhUTUxFbGVtZW50IG9yIE5vbi1lbXB0eSBzdHJpbmcgcGFzc2VkIGFzIHRoZSBvcHRpb25cbiAgICAgIGNvbnRhaW5lciA9IHRoaXMuY29uZmlnLmNvbnRyb2xzO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDcmVhdGUgY29udHJvbHNcbiAgICAgIGNvbnRhaW5lciA9IGNvbnRyb2xzLmNyZWF0ZS5jYWxsKHRoaXMsIHtcbiAgICAgICAgaWQ6IHRoaXMuaWQsXG4gICAgICAgIHNlZWt0aW1lOiB0aGlzLmNvbmZpZy5zZWVrVGltZSxcbiAgICAgICAgc3BlZWQ6IHRoaXMuc3BlZWQsXG4gICAgICAgIHF1YWxpdHk6IHRoaXMucXVhbGl0eSxcbiAgICAgICAgY2FwdGlvbnM6IGNhcHRpb25zLmdldExhYmVsLmNhbGwodGhpcyksXG4gICAgICAgIC8vIFRPRE86IExvb3BpbmdcbiAgICAgICAgLy8gbG9vcDogJ05vbmUnLFxuICAgICAgfSk7XG4gICAgICB1cGRhdGUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBSZXBsYWNlIHByb3BzIHdpdGggdGhlaXIgdmFsdWVcbiAgICBjb25zdCByZXBsYWNlID0gKGlucHV0KSA9PiB7XG4gICAgICBsZXQgcmVzdWx0ID0gaW5wdXQ7XG5cbiAgICAgIE9iamVjdC5lbnRyaWVzKHByb3BzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgICAgcmVzdWx0ID0gcmVwbGFjZUFsbChyZXN1bHQsIGB7JHtrZXl9fWAsIHZhbHVlKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICAvLyBVcGRhdGUgbWFya3VwXG4gICAgaWYgKHVwZGF0ZSkge1xuICAgICAgaWYgKGlzLnN0cmluZyh0aGlzLmNvbmZpZy5jb250cm9scykpIHtcbiAgICAgICAgY29udGFpbmVyID0gcmVwbGFjZShjb250YWluZXIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENvbnRyb2xzIGNvbnRhaW5lclxuICAgIGxldCB0YXJnZXQ7XG5cbiAgICAvLyBJbmplY3QgdG8gY3VzdG9tIGxvY2F0aW9uXG4gICAgaWYgKGlzLnN0cmluZyh0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY29udHJvbHMuY29udGFpbmVyKSkge1xuICAgICAgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY29udHJvbHMuY29udGFpbmVyKTtcbiAgICB9XG5cbiAgICAvLyBJbmplY3QgaW50byB0aGUgY29udGFpbmVyIGJ5IGRlZmF1bHRcbiAgICBpZiAoIWlzLmVsZW1lbnQodGFyZ2V0KSkge1xuICAgICAgdGFyZ2V0ID0gdGhpcy5lbGVtZW50cy5jb250YWluZXI7XG4gICAgfVxuXG4gICAgLy8gSW5qZWN0IGNvbnRyb2xzIEhUTUwgKG5lZWRzIHRvIGJlIGJlZm9yZSBjYXB0aW9ucywgaGVuY2UgXCJhZnRlcmJlZ2luXCIpXG4gICAgY29uc3QgaW5zZXJ0TWV0aG9kID0gaXMuZWxlbWVudChjb250YWluZXIpID8gJ2luc2VydEFkamFjZW50RWxlbWVudCcgOiAnaW5zZXJ0QWRqYWNlbnRIVE1MJztcbiAgICB0YXJnZXRbaW5zZXJ0TWV0aG9kXSgnYWZ0ZXJiZWdpbicsIGNvbnRhaW5lcik7XG5cbiAgICAvLyBGaW5kIHRoZSBlbGVtZW50cyBpZiBuZWVkIGJlXG4gICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY29udHJvbHMpKSB7XG4gICAgICBjb250cm9scy5maW5kRWxlbWVudHMuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBBZGQgcHJlc3NlZCBwcm9wZXJ0eSB0byBidXR0b25zXG4gICAgaWYgKCFpcy5lbXB0eSh0aGlzLmVsZW1lbnRzLmJ1dHRvbnMpKSB7XG4gICAgICBjb25zdCBhZGRQcm9wZXJ0eSA9IChidXR0b24pID0+IHtcbiAgICAgICAgY29uc3QgY2xhc3NOYW1lID0gdGhpcy5jb25maWcuY2xhc3NOYW1lcy5jb250cm9sUHJlc3NlZDtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGJ1dHRvbiwgJ3ByZXNzZWQnLCB7XG4gICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gaGFzQ2xhc3MoYnV0dG9uLCBjbGFzc05hbWUpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgc2V0KHByZXNzZWQgPSBmYWxzZSkge1xuICAgICAgICAgICAgdG9nZ2xlQ2xhc3MoYnV0dG9uLCBjbGFzc05hbWUsIHByZXNzZWQpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgLy8gVG9nZ2xlIGNsYXNzbmFtZSB3aGVuIHByZXNzZWQgcHJvcGVydHkgaXMgc2V0XG4gICAgICBPYmplY3QudmFsdWVzKHRoaXMuZWxlbWVudHMuYnV0dG9ucylcbiAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gICAgICAgICAgaWYgKGlzLmFycmF5KGJ1dHRvbikgfHwgaXMubm9kZUxpc3QoYnV0dG9uKSkge1xuICAgICAgICAgICAgQXJyYXkuZnJvbShidXR0b24pLmZpbHRlcihCb29sZWFuKS5mb3JFYWNoKGFkZFByb3BlcnR5KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWRkUHJvcGVydHkoYnV0dG9uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEVkZ2Ugc29tZXRpbWVzIGRvZXNuJ3QgZmluaXNoIHRoZSBwYWludCBzbyBmb3JjZSBhIHJlcGFpbnRcbiAgICBpZiAoYnJvd3Nlci5pc0VkZ2UpIHtcbiAgICAgIHJlcGFpbnQodGFyZ2V0KTtcbiAgICB9XG5cbiAgICAvLyBTZXR1cCB0b29sdGlwc1xuICAgIGlmICh0aGlzLmNvbmZpZy50b29sdGlwcy5jb250cm9scykge1xuICAgICAgY29uc3QgeyBjbGFzc05hbWVzLCBzZWxlY3RvcnMgfSA9IHRoaXMuY29uZmlnO1xuICAgICAgY29uc3Qgc2VsZWN0b3IgPSBgJHtzZWxlY3RvcnMuY29udHJvbHMud3JhcHBlcn0gJHtzZWxlY3RvcnMubGFiZWxzfSAuJHtjbGFzc05hbWVzLmhpZGRlbn1gO1xuICAgICAgY29uc3QgbGFiZWxzID0gZ2V0RWxlbWVudHMuY2FsbCh0aGlzLCBzZWxlY3Rvcik7XG5cbiAgICAgIEFycmF5LmZyb20obGFiZWxzKS5mb3JFYWNoKChsYWJlbCkgPT4ge1xuICAgICAgICB0b2dnbGVDbGFzcyhsYWJlbCwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRkZW4sIGZhbHNlKTtcbiAgICAgICAgdG9nZ2xlQ2xhc3MobGFiZWwsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMudG9vbHRpcCwgdHJ1ZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gU2V0IG1lZGlhIG1ldGFkYXRhXG4gIHNldE1lZGlhTWV0YWRhdGEoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICgnbWVkaWFTZXNzaW9uJyBpbiBuYXZpZ2F0b3IpIHtcbiAgICAgICAgbmF2aWdhdG9yLm1lZGlhU2Vzc2lvbi5tZXRhZGF0YSA9IG5ldyB3aW5kb3cuTWVkaWFNZXRhZGF0YSh7XG4gICAgICAgICAgdGl0bGU6IHRoaXMuY29uZmlnLm1lZGlhTWV0YWRhdGEudGl0bGUsXG4gICAgICAgICAgYXJ0aXN0OiB0aGlzLmNvbmZpZy5tZWRpYU1ldGFkYXRhLmFydGlzdCxcbiAgICAgICAgICBhbGJ1bTogdGhpcy5jb25maWcubWVkaWFNZXRhZGF0YS5hbGJ1bSxcbiAgICAgICAgICBhcnR3b3JrOiB0aGlzLmNvbmZpZy5tZWRpYU1ldGFkYXRhLmFydHdvcmssXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgIC8vIERvIG5vdGhpbmdcbiAgICB9XG4gIH0sXG5cbiAgLy8gQWRkIG1hcmtlcnNcbiAgc2V0TWFya2VycygpIHtcbiAgICBpZiAoIXRoaXMuZHVyYXRpb24gfHwgdGhpcy5lbGVtZW50cy5tYXJrZXJzKSByZXR1cm47XG5cbiAgICAvLyBHZXQgdmFsaWQgcG9pbnRzXG4gICAgY29uc3QgcG9pbnRzID0gdGhpcy5jb25maWcubWFya2Vycz8ucG9pbnRzPy5maWx0ZXIoKHsgdGltZSB9KSA9PiB0aW1lID4gMCAmJiB0aW1lIDwgdGhpcy5kdXJhdGlvbik7XG4gICAgaWYgKCFwb2ludHM/Lmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgY29uc3QgY29udGFpbmVyRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgY29uc3QgcG9pbnRzRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgbGV0IHRpcEVsZW1lbnQgPSBudWxsO1xuICAgIGNvbnN0IHRpcFZpc2libGUgPSBgJHt0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnRvb2x0aXB9LS12aXNpYmxlYDtcbiAgICBjb25zdCB0b2dnbGVUaXAgPSAoc2hvdykgPT4gdG9nZ2xlQ2xhc3ModGlwRWxlbWVudCwgdGlwVmlzaWJsZSwgc2hvdyk7XG5cbiAgICAvLyBJbmplY3QgbWFya2VycyB0byBwcm9ncmVzcyBjb250YWluZXJcbiAgICBwb2ludHMuZm9yRWFjaCgocG9pbnQpID0+IHtcbiAgICAgIGNvbnN0IG1hcmtlckVsZW1lbnQgPSBjcmVhdGVFbGVtZW50KFxuICAgICAgICAnc3BhbicsXG4gICAgICAgIHtcbiAgICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5tYXJrZXIsXG4gICAgICAgIH0sXG4gICAgICAgICcnLFxuICAgICAgKTtcblxuICAgICAgY29uc3QgbGVmdCA9IGAkeyhwb2ludC50aW1lIC8gdGhpcy5kdXJhdGlvbikgKiAxMDB9JWA7XG5cbiAgICAgIGlmICh0aXBFbGVtZW50KSB7XG4gICAgICAgIC8vIFNob3cgb24gaG92ZXJcbiAgICAgICAgbWFya2VyRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4ge1xuICAgICAgICAgIGlmIChwb2ludC5sYWJlbCkgcmV0dXJuO1xuICAgICAgICAgIHRpcEVsZW1lbnQuc3R5bGUubGVmdCA9IGxlZnQ7XG4gICAgICAgICAgdGlwRWxlbWVudC5pbm5lckhUTUwgPSBwb2ludC5sYWJlbDtcbiAgICAgICAgICB0b2dnbGVUaXAodHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEhpZGUgb24gbGVhdmVcbiAgICAgICAgbWFya2VyRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xuICAgICAgICAgIHRvZ2dsZVRpcChmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBtYXJrZXJFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICB0aGlzLmN1cnJlbnRUaW1lID0gcG9pbnQudGltZTtcbiAgICAgIH0pO1xuXG4gICAgICBtYXJrZXJFbGVtZW50LnN0eWxlLmxlZnQgPSBsZWZ0O1xuICAgICAgcG9pbnRzRnJhZ21lbnQuYXBwZW5kQ2hpbGQobWFya2VyRWxlbWVudCk7XG4gICAgfSk7XG5cbiAgICBjb250YWluZXJGcmFnbWVudC5hcHBlbmRDaGlsZChwb2ludHNGcmFnbWVudCk7XG5cbiAgICAvLyBJbmplY3QgYSB0b29sdGlwIGlmIG5lZWRlZFxuICAgIGlmICghdGhpcy5jb25maWcudG9vbHRpcHMuc2Vlaykge1xuICAgICAgdGlwRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICdzcGFuJyxcbiAgICAgICAge1xuICAgICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnRvb2x0aXAsXG4gICAgICAgIH0sXG4gICAgICAgICcnLFxuICAgICAgKTtcblxuICAgICAgY29udGFpbmVyRnJhZ21lbnQuYXBwZW5kQ2hpbGQodGlwRWxlbWVudCk7XG4gICAgfVxuXG4gICAgdGhpcy5lbGVtZW50cy5tYXJrZXJzID0ge1xuICAgICAgcG9pbnRzOiBwb2ludHNGcmFnbWVudCxcbiAgICAgIHRpcDogdGlwRWxlbWVudCxcbiAgICB9O1xuXG4gICAgdGhpcy5lbGVtZW50cy5wcm9ncmVzcy5hcHBlbmRDaGlsZChjb250YWluZXJGcmFnbWVudCk7XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb250cm9scztcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBVUkwgdXRpbHNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBpcyBmcm9tICcuL2lzJztcblxuLyoqXG4gKiBQYXJzZSBhIHN0cmluZyB0byBhIFVSTCBvYmplY3RcbiAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCAtIHRoZSBVUkwgdG8gYmUgcGFyc2VkXG4gKiBAcGFyYW0ge0Jvb2xlYW59IHNhZmUgLSBmYWlsc2FmZSBwYXJzaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVybChpbnB1dCwgc2FmZSA9IHRydWUpIHtcbiAgbGV0IHVybCA9IGlucHV0O1xuXG4gIGlmIChzYWZlKSB7XG4gICAgY29uc3QgcGFyc2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgIHBhcnNlci5ocmVmID0gdXJsO1xuICAgIHVybCA9IHBhcnNlci5ocmVmO1xuICB9XG5cbiAgdHJ5IHtcbiAgICByZXR1cm4gbmV3IFVSTCh1cmwpO1xuICB9IGNhdGNoIChfKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8gQ29udmVydCBvYmplY3QgdG8gVVJMU2VhcmNoUGFyYW1zXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRVcmxQYXJhbXMoaW5wdXQpIHtcbiAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuXG4gIGlmIChpcy5vYmplY3QoaW5wdXQpKSB7XG4gICAgT2JqZWN0LmVudHJpZXMoaW5wdXQpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgcGFyYW1zLnNldChrZXksIHZhbHVlKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBwYXJhbXM7XG59XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUGx5ciBDYXB0aW9uc1xuLy8gVE9ETzogQ3JlYXRlIGFzIGNsYXNzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgY29udHJvbHMgZnJvbSAnLi9jb250cm9scyc7XG5pbXBvcnQgc3VwcG9ydCBmcm9tICcuL3N1cHBvcnQnO1xuaW1wb3J0IHsgZGVkdXBlIH0gZnJvbSAnLi91dGlscy9hcnJheXMnO1xuaW1wb3J0IGJyb3dzZXIgZnJvbSAnLi91dGlscy9icm93c2VyJztcbmltcG9ydCB7XG4gIGNyZWF0ZUVsZW1lbnQsXG4gIGVtcHR5RWxlbWVudCxcbiAgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3RvcixcbiAgaW5zZXJ0QWZ0ZXIsXG4gIHJlbW92ZUVsZW1lbnQsXG4gIHRvZ2dsZUNsYXNzLFxufSBmcm9tICcuL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IG9uLCB0cmlnZ2VyRXZlbnQgfSBmcm9tICcuL3V0aWxzL2V2ZW50cyc7XG5pbXBvcnQgZmV0Y2ggZnJvbSAnLi91dGlscy9mZXRjaCc7XG5pbXBvcnQgaTE4biBmcm9tICcuL3V0aWxzL2kxOG4nO1xuaW1wb3J0IGlzIGZyb20gJy4vdXRpbHMvaXMnO1xuaW1wb3J0IHsgZ2V0SFRNTCB9IGZyb20gJy4vdXRpbHMvc3RyaW5ncyc7XG5pbXBvcnQgeyBwYXJzZVVybCB9IGZyb20gJy4vdXRpbHMvdXJscyc7XG5cbmNvbnN0IGNhcHRpb25zID0ge1xuICAvLyBTZXR1cCBjYXB0aW9uc1xuICBzZXR1cCgpIHtcbiAgICAvLyBSZXF1aXJlcyBVSSBzdXBwb3J0XG4gICAgaWYgKCF0aGlzLnN1cHBvcnRlZC51aSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIE9ubHkgVmltZW8gYW5kIEhUTUw1IHZpZGVvIHN1cHBvcnRlZCBhdCB0aGlzIHBvaW50XG4gICAgaWYgKCF0aGlzLmlzVmlkZW8gfHwgdGhpcy5pc1lvdVR1YmUgfHwgKHRoaXMuaXNIVE1MNSAmJiAhc3VwcG9ydC50ZXh0VHJhY2tzKSkge1xuICAgICAgLy8gQ2xlYXIgbWVudSBhbmQgaGlkZVxuICAgICAgaWYgKFxuICAgICAgICBpcy5hcnJheSh0aGlzLmNvbmZpZy5jb250cm9scykgJiZcbiAgICAgICAgdGhpcy5jb25maWcuY29udHJvbHMuaW5jbHVkZXMoJ3NldHRpbmdzJykgJiZcbiAgICAgICAgdGhpcy5jb25maWcuc2V0dGluZ3MuaW5jbHVkZXMoJ2NhcHRpb25zJylcbiAgICAgICkge1xuICAgICAgICBjb250cm9scy5zZXRDYXB0aW9uc01lbnUuY2FsbCh0aGlzKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEluamVjdCB0aGUgY29udGFpbmVyXG4gICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY2FwdGlvbnMpKSB7XG4gICAgICB0aGlzLmVsZW1lbnRzLmNhcHRpb25zID0gY3JlYXRlRWxlbWVudCgnZGl2JywgZ2V0QXR0cmlidXRlc0Zyb21TZWxlY3Rvcih0aGlzLmNvbmZpZy5zZWxlY3RvcnMuY2FwdGlvbnMpKTtcblxuICAgICAgaW5zZXJ0QWZ0ZXIodGhpcy5lbGVtZW50cy5jYXB0aW9ucywgdGhpcy5lbGVtZW50cy53cmFwcGVyKTtcbiAgICB9XG5cbiAgICAvLyBGaXggSUUgY2FwdGlvbnMgaWYgQ09SUyBpcyB1c2VkXG4gICAgLy8gRmV0Y2ggY2FwdGlvbnMgYW5kIGluamVjdCBhcyBibG9icyBpbnN0ZWFkIChkYXRhIFVSSXMgbm90IHN1cHBvcnRlZCEpXG4gICAgaWYgKGJyb3dzZXIuaXNJRSAmJiB3aW5kb3cuVVJMKSB7XG4gICAgICBjb25zdCBlbGVtZW50cyA9IHRoaXMubWVkaWEucXVlcnlTZWxlY3RvckFsbCgndHJhY2snKTtcblxuICAgICAgQXJyYXkuZnJvbShlbGVtZW50cykuZm9yRWFjaCgodHJhY2spID0+IHtcbiAgICAgICAgY29uc3Qgc3JjID0gdHJhY2suZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICAgICAgY29uc3QgdXJsID0gcGFyc2VVcmwoc3JjKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgdXJsICE9PSBudWxsICYmXG4gICAgICAgICAgdXJsLmhvc3RuYW1lICE9PSB3aW5kb3cubG9jYXRpb24uaHJlZi5ob3N0bmFtZSAmJlxuICAgICAgICAgIFsnaHR0cDonLCAnaHR0cHM6J10uaW5jbHVkZXModXJsLnByb3RvY29sKVxuICAgICAgICApIHtcbiAgICAgICAgICBmZXRjaChzcmMsICdibG9iJylcbiAgICAgICAgICAgIC50aGVuKChibG9iKSA9PiB7XG4gICAgICAgICAgICAgIHRyYWNrLnNldEF0dHJpYnV0ZSgnc3JjJywgd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYikpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgICAgIHJlbW92ZUVsZW1lbnQodHJhY2spO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEdldCBhbmQgc2V0IGluaXRpYWwgZGF0YVxuICAgIC8vIFRoZSBcInByZWZlcnJlZFwiIG9wdGlvbnMgYXJlIG5vdCByZWFsaXplZCB1bmxlc3MgLyB1bnRpbCB0aGUgd2FudGVkIGxhbmd1YWdlIGhhcyBhIG1hdGNoXG4gICAgLy8gKiBsYW5ndWFnZXM6IEFycmF5IG9mIHVzZXIncyBicm93c2VyIGxhbmd1YWdlcy5cbiAgICAvLyAqIGxhbmd1YWdlOiAgVGhlIGxhbmd1YWdlIHByZWZlcnJlZCBieSB1c2VyIHNldHRpbmdzIG9yIGNvbmZpZ1xuICAgIC8vICogYWN0aXZlOiAgICBUaGUgc3RhdGUgcHJlZmVycmVkIGJ5IHVzZXIgc2V0dGluZ3Mgb3IgY29uZmlnXG4gICAgLy8gKiB0b2dnbGVkOiAgIFRoZSByZWFsIGNhcHRpb25zIHN0YXRlXG5cbiAgICBjb25zdCBicm93c2VyTGFuZ3VhZ2VzID0gbmF2aWdhdG9yLmxhbmd1YWdlcyB8fCBbbmF2aWdhdG9yLmxhbmd1YWdlIHx8IG5hdmlnYXRvci51c2VyTGFuZ3VhZ2UgfHwgJ2VuJ107XG4gICAgY29uc3QgbGFuZ3VhZ2VzID0gZGVkdXBlKGJyb3dzZXJMYW5ndWFnZXMubWFwKChsYW5ndWFnZSkgPT4gbGFuZ3VhZ2Uuc3BsaXQoJy0nKVswXSkpO1xuICAgIGxldCBsYW5ndWFnZSA9ICh0aGlzLnN0b3JhZ2UuZ2V0KCdsYW5ndWFnZScpIHx8IHRoaXMuY29uZmlnLmNhcHRpb25zLmxhbmd1YWdlIHx8ICdhdXRvJykudG9Mb3dlckNhc2UoKTtcblxuICAgIC8vIFVzZSBmaXJzdCBicm93c2VyIGxhbmd1YWdlIHdoZW4gbGFuZ3VhZ2UgaXMgJ2F1dG8nXG4gICAgaWYgKGxhbmd1YWdlID09PSAnYXV0bycpIHtcbiAgICAgIFtsYW5ndWFnZV0gPSBsYW5ndWFnZXM7XG4gICAgfVxuXG4gICAgbGV0IGFjdGl2ZSA9IHRoaXMuc3RvcmFnZS5nZXQoJ2NhcHRpb25zJyk7XG4gICAgaWYgKCFpcy5ib29sZWFuKGFjdGl2ZSkpIHtcbiAgICAgICh7IGFjdGl2ZSB9ID0gdGhpcy5jb25maWcuY2FwdGlvbnMpO1xuICAgIH1cblxuICAgIE9iamVjdC5hc3NpZ24odGhpcy5jYXB0aW9ucywge1xuICAgICAgdG9nZ2xlZDogZmFsc2UsXG4gICAgICBhY3RpdmUsXG4gICAgICBsYW5ndWFnZSxcbiAgICAgIGxhbmd1YWdlcyxcbiAgICB9KTtcblxuICAgIC8vIFdhdGNoIGNoYW5nZXMgdG8gdGV4dFRyYWNrcyBhbmQgdXBkYXRlIGNhcHRpb25zIG1lbnVcbiAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICBjb25zdCB0cmFja0V2ZW50cyA9IHRoaXMuY29uZmlnLmNhcHRpb25zLnVwZGF0ZSA/ICdhZGR0cmFjayByZW1vdmV0cmFjaycgOiAncmVtb3ZldHJhY2snO1xuICAgICAgb24uY2FsbCh0aGlzLCB0aGlzLm1lZGlhLnRleHRUcmFja3MsIHRyYWNrRXZlbnRzLCBjYXB0aW9ucy51cGRhdGUuYmluZCh0aGlzKSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIGF2YWlsYWJsZSBsYW5ndWFnZXMgaW4gbGlzdCBuZXh0IHRpY2sgKHRoZSBldmVudCBtdXN0IG5vdCBiZSB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBsaXN0ZW5lcnMpXG4gICAgc2V0VGltZW91dChjYXB0aW9ucy51cGRhdGUuYmluZCh0aGlzKSwgMCk7XG4gIH0sXG5cbiAgLy8gVXBkYXRlIGF2YWlsYWJsZSBsYW5ndWFnZSBvcHRpb25zIGluIHNldHRpbmdzIGJhc2VkIG9uIHRyYWNrc1xuICB1cGRhdGUoKSB7XG4gICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcywgdHJ1ZSk7XG4gICAgLy8gR2V0IHRoZSB3YW50ZWQgbGFuZ3VhZ2VcbiAgICBjb25zdCB7IGFjdGl2ZSwgbGFuZ3VhZ2UsIG1ldGEsIGN1cnJlbnRUcmFja05vZGUgfSA9IHRoaXMuY2FwdGlvbnM7XG4gICAgY29uc3QgbGFuZ3VhZ2VFeGlzdHMgPSBCb29sZWFuKHRyYWNrcy5maW5kKCh0cmFjaykgPT4gdHJhY2subGFuZ3VhZ2UgPT09IGxhbmd1YWdlKSk7XG5cbiAgICAvLyBIYW5kbGUgdHJhY2tzIChhZGQgZXZlbnQgbGlzdGVuZXIgYW5kIFwicHNldWRvXCItZGVmYXVsdClcbiAgICBpZiAodGhpcy5pc0hUTUw1ICYmIHRoaXMuaXNWaWRlbykge1xuICAgICAgdHJhY2tzXG4gICAgICAgIC5maWx0ZXIoKHRyYWNrKSA9PiAhbWV0YS5nZXQodHJhY2spKVxuICAgICAgICAuZm9yRWFjaCgodHJhY2spID0+IHtcbiAgICAgICAgICB0aGlzLmRlYnVnLmxvZygnVHJhY2sgYWRkZWQnLCB0cmFjayk7XG5cbiAgICAgICAgICAvLyBBdHRlbXB0IHRvIHN0b3JlIGlmIHRoZSBvcmlnaW5hbCBkb20gZWxlbWVudCB3YXMgXCJkZWZhdWx0XCJcbiAgICAgICAgICBtZXRhLnNldCh0cmFjaywge1xuICAgICAgICAgICAgZGVmYXVsdDogdHJhY2subW9kZSA9PT0gJ3Nob3dpbmcnLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gVHVybiBvZmYgbmF0aXZlIGNhcHRpb24gcmVuZGVyaW5nIHRvIGF2b2lkIGRvdWJsZSBjYXB0aW9uc1xuICAgICAgICAgIC8vIE5vdGU6IG1vZGU9J2hpZGRlbicgZm9yY2VzIGEgdHJhY2sgdG8gZG93bmxvYWQuIFRvIGVuc3VyZSBldmVyeSB0cmFja1xuICAgICAgICAgIC8vIGlzbid0IGRvd25sb2FkZWQgYXQgb25jZSwgb25seSAnc2hvd2luZycgdHJhY2tzIHNob3VsZCBiZSByZWFzc2lnbmVkXG4gICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICAgICAgaWYgKHRyYWNrLm1vZGUgPT09ICdzaG93aW5nJykge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICAgICAgICB0cmFjay5tb2RlID0gJ2hpZGRlbic7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVyIGZvciBjdWUgY2hhbmdlc1xuICAgICAgICAgIG9uLmNhbGwodGhpcywgdHJhY2ssICdjdWVjaGFuZ2UnLCAoKSA9PiBjYXB0aW9ucy51cGRhdGVDdWVzLmNhbGwodGhpcykpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgbGFuZ3VhZ2UgZmlyc3QgdGltZSBpdCBtYXRjaGVzLCBvciBpZiB0aGUgcHJldmlvdXMgbWF0Y2hpbmcgdHJhY2sgd2FzIHJlbW92ZWRcbiAgICBpZiAoKGxhbmd1YWdlRXhpc3RzICYmIHRoaXMubGFuZ3VhZ2UgIT09IGxhbmd1YWdlKSB8fCAhdHJhY2tzLmluY2x1ZGVzKGN1cnJlbnRUcmFja05vZGUpKSB7XG4gICAgICBjYXB0aW9ucy5zZXRMYW5ndWFnZS5jYWxsKHRoaXMsIGxhbmd1YWdlKTtcbiAgICAgIGNhcHRpb25zLnRvZ2dsZS5jYWxsKHRoaXMsIGFjdGl2ZSAmJiBsYW5ndWFnZUV4aXN0cyk7XG4gICAgfVxuXG4gICAgLy8gRW5hYmxlIG9yIGRpc2FibGUgY2FwdGlvbnMgYmFzZWQgb24gdHJhY2sgbGVuZ3RoXG4gICAgaWYgKHRoaXMuZWxlbWVudHMpIHtcbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNhcHRpb25zLmVuYWJsZWQsICFpcy5lbXB0eSh0cmFja3MpKTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgYXZhaWxhYmxlIGxhbmd1YWdlcyBpbiBsaXN0XG4gICAgaWYgKFxuICAgICAgaXMuYXJyYXkodGhpcy5jb25maWcuY29udHJvbHMpICYmXG4gICAgICB0aGlzLmNvbmZpZy5jb250cm9scy5pbmNsdWRlcygnc2V0dGluZ3MnKSAmJlxuICAgICAgdGhpcy5jb25maWcuc2V0dGluZ3MuaW5jbHVkZXMoJ2NhcHRpb25zJylcbiAgICApIHtcbiAgICAgIGNvbnRyb2xzLnNldENhcHRpb25zTWVudS5jYWxsKHRoaXMpO1xuICAgIH1cbiAgfSxcblxuICAvLyBUb2dnbGUgY2FwdGlvbnMgZGlzcGxheVxuICAvLyBVc2VkIGludGVybmFsbHkgZm9yIHRoZSB0b2dnbGVDYXB0aW9ucyBtZXRob2QsIHdpdGggdGhlIHBhc3NpdmUgb3B0aW9uIGZvcmNlZCB0byBmYWxzZVxuICB0b2dnbGUoaW5wdXQsIHBhc3NpdmUgPSB0cnVlKSB7XG4gICAgLy8gSWYgdGhlcmUncyBubyBmdWxsIHN1cHBvcnRcbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgeyB0b2dnbGVkIH0gPSB0aGlzLmNhcHRpb25zOyAvLyBDdXJyZW50IHN0YXRlXG4gICAgY29uc3QgYWN0aXZlQ2xhc3MgPSB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmNhcHRpb25zLmFjdGl2ZTtcbiAgICAvLyBHZXQgdGhlIG5leHQgc3RhdGVcbiAgICAvLyBJZiB0aGUgbWV0aG9kIGlzIGNhbGxlZCB3aXRob3V0IHBhcmFtZXRlciwgdG9nZ2xlIGJhc2VkIG9uIGN1cnJlbnQgdmFsdWVcbiAgICBjb25zdCBhY3RpdmUgPSBpcy5udWxsT3JVbmRlZmluZWQoaW5wdXQpID8gIXRvZ2dsZWQgOiBpbnB1dDtcblxuICAgIC8vIFVwZGF0ZSBzdGF0ZSBhbmQgdHJpZ2dlciBldmVudFxuICAgIGlmIChhY3RpdmUgIT09IHRvZ2dsZWQpIHtcbiAgICAgIC8vIFdoZW4gcGFzc2l2ZSwgZG9uJ3Qgb3ZlcnJpZGUgdXNlciBwcmVmZXJlbmNlc1xuICAgICAgaWYgKCFwYXNzaXZlKSB7XG4gICAgICAgIHRoaXMuY2FwdGlvbnMuYWN0aXZlID0gYWN0aXZlO1xuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0KHsgY2FwdGlvbnM6IGFjdGl2ZSB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gRm9yY2UgbGFuZ3VhZ2UgaWYgdGhlIGNhbGwgaXNuJ3QgcGFzc2l2ZSBhbmQgdGhlcmUgaXMgbm8gbWF0Y2hpbmcgbGFuZ3VhZ2UgdG8gdG9nZ2xlIHRvXG4gICAgICBpZiAoIXRoaXMubGFuZ3VhZ2UgJiYgYWN0aXZlICYmICFwYXNzaXZlKSB7XG4gICAgICAgIGNvbnN0IHRyYWNrcyA9IGNhcHRpb25zLmdldFRyYWNrcy5jYWxsKHRoaXMpO1xuICAgICAgICBjb25zdCB0cmFjayA9IGNhcHRpb25zLmZpbmRUcmFjay5jYWxsKHRoaXMsIFt0aGlzLmNhcHRpb25zLmxhbmd1YWdlLCAuLi50aGlzLmNhcHRpb25zLmxhbmd1YWdlc10sIHRydWUpO1xuXG4gICAgICAgIC8vIE92ZXJyaWRlIHVzZXIgcHJlZmVyZW5jZXMgdG8gYXZvaWQgc3dpdGNoaW5nIGxhbmd1YWdlcyBpZiBhIG1hdGNoaW5nIHRyYWNrIGlzIGFkZGVkXG4gICAgICAgIHRoaXMuY2FwdGlvbnMubGFuZ3VhZ2UgPSB0cmFjay5sYW5ndWFnZTtcblxuICAgICAgICAvLyBTZXQgY2FwdGlvbiwgYnV0IGRvbid0IHN0b3JlIGluIGxvY2FsU3RvcmFnZSBhcyB1c2VyIHByZWZlcmVuY2VcbiAgICAgICAgY2FwdGlvbnMuc2V0LmNhbGwodGhpcywgdHJhY2tzLmluZGV4T2YodHJhY2spKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBUb2dnbGUgYnV0dG9uIGlmIGl0J3MgZW5hYmxlZFxuICAgICAgaWYgKHRoaXMuZWxlbWVudHMuYnV0dG9ucy5jYXB0aW9ucykge1xuICAgICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnMuY2FwdGlvbnMucHJlc3NlZCA9IGFjdGl2ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIGNsYXNzIGhvb2tcbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCBhY3RpdmVDbGFzcywgYWN0aXZlKTtcblxuICAgICAgdGhpcy5jYXB0aW9ucy50b2dnbGVkID0gYWN0aXZlO1xuXG4gICAgICAvLyBVcGRhdGUgc2V0dGluZ3MgbWVudVxuICAgICAgY29udHJvbHMudXBkYXRlU2V0dGluZy5jYWxsKHRoaXMsICdjYXB0aW9ucycpO1xuXG4gICAgICAvLyBUcmlnZ2VyIGV2ZW50IChub3QgdXNlZCBpbnRlcm5hbGx5KVxuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcywgdGhpcy5tZWRpYSwgYWN0aXZlID8gJ2NhcHRpb25zZW5hYmxlZCcgOiAnY2FwdGlvbnNkaXNhYmxlZCcpO1xuICAgIH1cblxuICAgIC8vIFdhaXQgZm9yIHRoZSBjYWxsIHN0YWNrIHRvIGNsZWFyIGJlZm9yZSBzZXR0aW5nIG1vZGU9J2hpZGRlbidcbiAgICAvLyBvbiB0aGUgYWN0aXZlIHRyYWNrIC0gZm9yY2luZyB0aGUgYnJvd3NlciB0byBkb3dubG9hZCBpdFxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgaWYgKGFjdGl2ZSAmJiB0aGlzLmNhcHRpb25zLnRvZ2dsZWQpIHtcbiAgICAgICAgdGhpcy5jYXB0aW9ucy5jdXJyZW50VHJhY2tOb2RlLm1vZGUgPSAnaGlkZGVuJztcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICAvLyBTZXQgY2FwdGlvbnMgYnkgdHJhY2sgaW5kZXhcbiAgLy8gVXNlZCBpbnRlcm5hbGx5IGZvciB0aGUgY3VycmVudFRyYWNrIHNldHRlciB3aXRoIHRoZSBwYXNzaXZlIG9wdGlvbiBmb3JjZWQgdG8gZmFsc2VcbiAgc2V0KGluZGV4LCBwYXNzaXZlID0gdHJ1ZSkge1xuICAgIGNvbnN0IHRyYWNrcyA9IGNhcHRpb25zLmdldFRyYWNrcy5jYWxsKHRoaXMpO1xuXG4gICAgLy8gRGlzYWJsZSBjYXB0aW9ucyBpZiBzZXR0aW5nIHRvIC0xXG4gICAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgICAgY2FwdGlvbnMudG9nZ2xlLmNhbGwodGhpcywgZmFsc2UsIHBhc3NpdmUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghaXMubnVtYmVyKGluZGV4KSkge1xuICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdJbnZhbGlkIGNhcHRpb24gYXJndW1lbnQnLCBpbmRleCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCEoaW5kZXggaW4gdHJhY2tzKSkge1xuICAgICAgdGhpcy5kZWJ1Zy53YXJuKCdUcmFjayBub3QgZm91bmQnLCBpbmRleCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY2FwdGlvbnMuY3VycmVudFRyYWNrICE9PSBpbmRleCkge1xuICAgICAgdGhpcy5jYXB0aW9ucy5jdXJyZW50VHJhY2sgPSBpbmRleDtcbiAgICAgIGNvbnN0IHRyYWNrID0gdHJhY2tzW2luZGV4XTtcbiAgICAgIGNvbnN0IHsgbGFuZ3VhZ2UgfSA9IHRyYWNrIHx8IHt9O1xuXG4gICAgICAvLyBTdG9yZSByZWZlcmVuY2UgdG8gbm9kZSBmb3IgaW52YWxpZGF0aW9uIG9uIHJlbW92ZVxuICAgICAgdGhpcy5jYXB0aW9ucy5jdXJyZW50VHJhY2tOb2RlID0gdHJhY2s7XG5cbiAgICAgIC8vIFVwZGF0ZSBzZXR0aW5ncyBtZW51XG4gICAgICBjb250cm9scy51cGRhdGVTZXR0aW5nLmNhbGwodGhpcywgJ2NhcHRpb25zJyk7XG5cbiAgICAgIC8vIFdoZW4gcGFzc2l2ZSwgZG9uJ3Qgb3ZlcnJpZGUgdXNlciBwcmVmZXJlbmNlc1xuICAgICAgaWYgKCFwYXNzaXZlKSB7XG4gICAgICAgIHRoaXMuY2FwdGlvbnMubGFuZ3VhZ2UgPSBsYW5ndWFnZTtcbiAgICAgICAgdGhpcy5zdG9yYWdlLnNldCh7IGxhbmd1YWdlIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBIYW5kbGUgVmltZW8gY2FwdGlvbnNcbiAgICAgIGlmICh0aGlzLmlzVmltZW8pIHtcbiAgICAgICAgdGhpcy5lbWJlZC5lbmFibGVUZXh0VHJhY2sobGFuZ3VhZ2UpO1xuICAgICAgfVxuXG4gICAgICAvLyBUcmlnZ2VyIGV2ZW50XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCAnbGFuZ3VhZ2VjaGFuZ2UnKTtcbiAgICB9XG5cbiAgICAvLyBTaG93IGNhcHRpb25zXG4gICAgY2FwdGlvbnMudG9nZ2xlLmNhbGwodGhpcywgdHJ1ZSwgcGFzc2l2ZSk7XG5cbiAgICBpZiAodGhpcy5pc0hUTUw1ICYmIHRoaXMuaXNWaWRlbykge1xuICAgICAgLy8gSWYgd2UgY2hhbmdlIHRoZSBhY3RpdmUgdHJhY2sgd2hpbGUgYSBjdWUgaXMgYWxyZWFkeSBkaXNwbGF5ZWQgd2UgbmVlZCB0byB1cGRhdGUgaXRcbiAgICAgIGNhcHRpb25zLnVwZGF0ZUN1ZXMuY2FsbCh0aGlzKTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gU2V0IGNhcHRpb25zIGJ5IGxhbmd1YWdlXG4gIC8vIFVzZWQgaW50ZXJuYWxseSBmb3IgdGhlIGxhbmd1YWdlIHNldHRlciB3aXRoIHRoZSBwYXNzaXZlIG9wdGlvbiBmb3JjZWQgdG8gZmFsc2VcbiAgc2V0TGFuZ3VhZ2UoaW5wdXQsIHBhc3NpdmUgPSB0cnVlKSB7XG4gICAgaWYgKCFpcy5zdHJpbmcoaW5wdXQpKSB7XG4gICAgICB0aGlzLmRlYnVnLndhcm4oJ0ludmFsaWQgbGFuZ3VhZ2UgYXJndW1lbnQnLCBpbnB1dCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIE5vcm1hbGl6ZVxuICAgIGNvbnN0IGxhbmd1YWdlID0gaW5wdXQudG9Mb3dlckNhc2UoKTtcbiAgICB0aGlzLmNhcHRpb25zLmxhbmd1YWdlID0gbGFuZ3VhZ2U7XG5cbiAgICAvLyBTZXQgY3VycmVudFRyYWNrXG4gICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcyk7XG4gICAgY29uc3QgdHJhY2sgPSBjYXB0aW9ucy5maW5kVHJhY2suY2FsbCh0aGlzLCBbbGFuZ3VhZ2VdKTtcbiAgICBjYXB0aW9ucy5zZXQuY2FsbCh0aGlzLCB0cmFja3MuaW5kZXhPZih0cmFjayksIHBhc3NpdmUpO1xuICB9LFxuXG4gIC8vIEdldCBjdXJyZW50IHZhbGlkIGNhcHRpb24gdHJhY2tzXG4gIC8vIElmIHVwZGF0ZSBpcyBmYWxzZSBpdCB3aWxsIGFsc28gaWdub3JlIHRyYWNrcyB3aXRob3V0IG1ldGFkYXRhXG4gIC8vIFRoaXMgaXMgdXNlZCB0byBcImZyZWV6ZVwiIHRoZSBsYW5ndWFnZSBvcHRpb25zIHdoZW4gY2FwdGlvbnMudXBkYXRlIGlzIGZhbHNlXG4gIGdldFRyYWNrcyh1cGRhdGUgPSBmYWxzZSkge1xuICAgIC8vIEhhbmRsZSBtZWRpYSBvciB0ZXh0VHJhY2tzIG1pc3Npbmcgb3IgbnVsbFxuICAgIGNvbnN0IHRyYWNrcyA9IEFycmF5LmZyb20oKHRoaXMubWVkaWEgfHwge30pLnRleHRUcmFja3MgfHwgW10pO1xuICAgIC8vIEZvciBIVE1MNSwgdXNlIGNhY2hlIGluc3RlYWQgb2YgY3VycmVudCB0cmFja3Mgd2hlbiBpdCBleGlzdHMgKGlmIGNhcHRpb25zLnVwZGF0ZSBpcyBmYWxzZSlcbiAgICAvLyBGaWx0ZXIgb3V0IHJlbW92ZWQgdHJhY2tzIGFuZCB0cmFja3MgdGhhdCBhcmVuJ3QgY2FwdGlvbnMvc3VidGl0bGVzIChmb3IgZXhhbXBsZSBtZXRhZGF0YSlcbiAgICByZXR1cm4gdHJhY2tzXG4gICAgICAuZmlsdGVyKCh0cmFjaykgPT4gIXRoaXMuaXNIVE1MNSB8fCB1cGRhdGUgfHwgdGhpcy5jYXB0aW9ucy5tZXRhLmhhcyh0cmFjaykpXG4gICAgICAuZmlsdGVyKCh0cmFjaykgPT4gWydjYXB0aW9ucycsICdzdWJ0aXRsZXMnXS5pbmNsdWRlcyh0cmFjay5raW5kKSk7XG4gIH0sXG5cbiAgLy8gTWF0Y2ggdHJhY2tzIGJhc2VkIG9uIGxhbmd1YWdlcyBhbmQgZ2V0IHRoZSBmaXJzdFxuICBmaW5kVHJhY2sobGFuZ3VhZ2VzLCBmb3JjZSA9IGZhbHNlKSB7XG4gICAgY29uc3QgdHJhY2tzID0gY2FwdGlvbnMuZ2V0VHJhY2tzLmNhbGwodGhpcyk7XG4gICAgY29uc3Qgc29ydElzRGVmYXVsdCA9ICh0cmFjaykgPT4gTnVtYmVyKCh0aGlzLmNhcHRpb25zLm1ldGEuZ2V0KHRyYWNrKSB8fCB7fSkuZGVmYXVsdCk7XG4gICAgY29uc3Qgc29ydGVkID0gQXJyYXkuZnJvbSh0cmFja3MpLnNvcnQoKGEsIGIpID0+IHNvcnRJc0RlZmF1bHQoYikgLSBzb3J0SXNEZWZhdWx0KGEpKTtcbiAgICBsZXQgdHJhY2s7XG5cbiAgICBsYW5ndWFnZXMuZXZlcnkoKGxhbmd1YWdlKSA9PiB7XG4gICAgICB0cmFjayA9IHNvcnRlZC5maW5kKCh0KSA9PiB0Lmxhbmd1YWdlID09PSBsYW5ndWFnZSk7XG4gICAgICByZXR1cm4gIXRyYWNrOyAvLyBCcmVhayBpdGVyYXRpb24gaWYgdGhlcmUgaXMgYSBtYXRjaFxuICAgIH0pO1xuXG4gICAgLy8gSWYgbm8gbWF0Y2ggaXMgZm91bmQgYnV0IGlzIHJlcXVpcmVkLCBnZXQgZmlyc3RcbiAgICByZXR1cm4gdHJhY2sgfHwgKGZvcmNlID8gc29ydGVkWzBdIDogdW5kZWZpbmVkKTtcbiAgfSxcblxuICAvLyBHZXQgdGhlIGN1cnJlbnQgdHJhY2tcbiAgZ2V0Q3VycmVudFRyYWNrKCkge1xuICAgIHJldHVybiBjYXB0aW9ucy5nZXRUcmFja3MuY2FsbCh0aGlzKVt0aGlzLmN1cnJlbnRUcmFja107XG4gIH0sXG5cbiAgLy8gR2V0IFVJIGxhYmVsIGZvciB0cmFja1xuICBnZXRMYWJlbCh0cmFjaykge1xuICAgIGxldCBjdXJyZW50VHJhY2sgPSB0cmFjaztcblxuICAgIGlmICghaXMudHJhY2soY3VycmVudFRyYWNrKSAmJiBzdXBwb3J0LnRleHRUcmFja3MgJiYgdGhpcy5jYXB0aW9ucy50b2dnbGVkKSB7XG4gICAgICBjdXJyZW50VHJhY2sgPSBjYXB0aW9ucy5nZXRDdXJyZW50VHJhY2suY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBpZiAoaXMudHJhY2soY3VycmVudFRyYWNrKSkge1xuICAgICAgaWYgKCFpcy5lbXB0eShjdXJyZW50VHJhY2subGFiZWwpKSB7XG4gICAgICAgIHJldHVybiBjdXJyZW50VHJhY2subGFiZWw7XG4gICAgICB9XG5cbiAgICAgIGlmICghaXMuZW1wdHkoY3VycmVudFRyYWNrLmxhbmd1YWdlKSkge1xuICAgICAgICByZXR1cm4gdHJhY2subGFuZ3VhZ2UudG9VcHBlckNhc2UoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGkxOG4uZ2V0KCdlbmFibGVkJywgdGhpcy5jb25maWcpO1xuICAgIH1cblxuICAgIHJldHVybiBpMThuLmdldCgnZGlzYWJsZWQnLCB0aGlzLmNvbmZpZyk7XG4gIH0sXG5cbiAgLy8gVXBkYXRlIGNhcHRpb25zIHVzaW5nIGN1cnJlbnQgdHJhY2sncyBhY3RpdmUgY3Vlc1xuICAvLyBBbHNvIG9wdGlvbmFsIGFycmF5IGFyZ3VtZW50IGluIGNhc2UgdGhlcmUgaXNuJ3QgYW55IHRyYWNrIChleDogdmltZW8pXG4gIHVwZGF0ZUN1ZXMoaW5wdXQpIHtcbiAgICAvLyBSZXF1aXJlcyBVSVxuICAgIGlmICghdGhpcy5zdXBwb3J0ZWQudWkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIWlzLmVsZW1lbnQodGhpcy5lbGVtZW50cy5jYXB0aW9ucykpIHtcbiAgICAgIHRoaXMuZGVidWcud2FybignTm8gY2FwdGlvbnMgZWxlbWVudCB0byByZW5kZXIgdG8nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBPbmx5IGFjY2VwdCBhcnJheSBvciBlbXB0eSBpbnB1dFxuICAgIGlmICghaXMubnVsbE9yVW5kZWZpbmVkKGlucHV0KSAmJiAhQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcbiAgICAgIHRoaXMuZGVidWcud2FybigndXBkYXRlQ3VlczogSW52YWxpZCBpbnB1dCcsIGlucHV0KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgY3VlcyA9IGlucHV0O1xuXG4gICAgLy8gR2V0IGN1ZXMgZnJvbSB0cmFja1xuICAgIGlmICghY3Vlcykge1xuICAgICAgY29uc3QgdHJhY2sgPSBjYXB0aW9ucy5nZXRDdXJyZW50VHJhY2suY2FsbCh0aGlzKTtcblxuICAgICAgY3VlcyA9IEFycmF5LmZyb20oKHRyYWNrIHx8IHt9KS5hY3RpdmVDdWVzIHx8IFtdKVxuICAgICAgICAubWFwKChjdWUpID0+IGN1ZS5nZXRDdWVBc0hUTUwoKSlcbiAgICAgICAgLm1hcChnZXRIVE1MKTtcbiAgICB9XG5cbiAgICAvLyBTZXQgbmV3IGNhcHRpb24gdGV4dFxuICAgIGNvbnN0IGNvbnRlbnQgPSBjdWVzLm1hcCgoY3VlVGV4dCkgPT4gY3VlVGV4dC50cmltKCkpLmpvaW4oJ1xcbicpO1xuICAgIGNvbnN0IGNoYW5nZWQgPSBjb250ZW50ICE9PSB0aGlzLmVsZW1lbnRzLmNhcHRpb25zLmlubmVySFRNTDtcblxuICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAvLyBFbXB0eSB0aGUgY29udGFpbmVyIGFuZCBjcmVhdGUgYSBuZXcgY2hpbGQgZWxlbWVudFxuICAgICAgZW1wdHlFbGVtZW50KHRoaXMuZWxlbWVudHMuY2FwdGlvbnMpO1xuICAgICAgY29uc3QgY2FwdGlvbiA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCBnZXRBdHRyaWJ1dGVzRnJvbVNlbGVjdG9yKHRoaXMuY29uZmlnLnNlbGVjdG9ycy5jYXB0aW9uKSk7XG4gICAgICBjYXB0aW9uLmlubmVySFRNTCA9IGNvbnRlbnQ7XG4gICAgICB0aGlzLmVsZW1lbnRzLmNhcHRpb25zLmFwcGVuZENoaWxkKGNhcHRpb24pO1xuXG4gICAgICAvLyBUcmlnZ2VyIGV2ZW50XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCAnY3VlY2hhbmdlJyk7XG4gICAgfVxuICB9LFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2FwdGlvbnM7XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUGx5ciBkZWZhdWx0IGNvbmZpZ1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuY29uc3QgZGVmYXVsdHMgPSB7XG4gIC8vIERpc2FibGVcbiAgZW5hYmxlZDogdHJ1ZSxcblxuICAvLyBDdXN0b20gbWVkaWEgdGl0bGVcbiAgdGl0bGU6ICcnLFxuXG4gIC8vIExvZ2dpbmcgdG8gY29uc29sZVxuICBkZWJ1ZzogZmFsc2UsXG5cbiAgLy8gQXV0byBwbGF5IChpZiBzdXBwb3J0ZWQpXG4gIGF1dG9wbGF5OiBmYWxzZSxcblxuICAvLyBPbmx5IGFsbG93IG9uZSBtZWRpYSBwbGF5aW5nIGF0IG9uY2UgKHZpbWVvIG9ubHkpXG4gIGF1dG9wYXVzZTogdHJ1ZSxcblxuICAvLyBBbGxvdyBpbmxpbmUgcGxheWJhY2sgb24gaU9TICh0aGlzIGVmZmVjdHMgWW91VHViZS9WaW1lbyAtIEhUTUw1IHJlcXVpcmVzIHRoZSBhdHRyaWJ1dGUgcHJlc2VudClcbiAgLy8gVE9ETzogUmVtb3ZlIGlvc05hdGl2ZSBmdWxsc2NyZWVuIG9wdGlvbiBpbiBmYXZvdXIgb2YgdGhpcyAobG9naWMgbmVlZHMgd29yaylcbiAgcGxheXNpbmxpbmU6IHRydWUsXG5cbiAgLy8gRGVmYXVsdCB0aW1lIHRvIHNraXAgd2hlbiByZXdpbmQvZmFzdCBmb3J3YXJkXG4gIHNlZWtUaW1lOiAxMCxcblxuICAvLyBEZWZhdWx0IHZvbHVtZVxuICB2b2x1bWU6IDEsXG4gIG11dGVkOiBmYWxzZSxcblxuICAvLyBQYXNzIGEgY3VzdG9tIGR1cmF0aW9uXG4gIGR1cmF0aW9uOiBudWxsLFxuXG4gIC8vIERpc3BsYXkgdGhlIG1lZGlhIGR1cmF0aW9uIG9uIGxvYWQgaW4gdGhlIGN1cnJlbnQgdGltZSBwb3NpdGlvblxuICAvLyBJZiB5b3UgaGF2ZSBvcHRlZCB0byBkaXNwbGF5IGJvdGggZHVyYXRpb24gYW5kIGN1cnJlbnRUaW1lLCB0aGlzIGlzIGlnbm9yZWRcbiAgZGlzcGxheUR1cmF0aW9uOiB0cnVlLFxuXG4gIC8vIEludmVydCB0aGUgY3VycmVudCB0aW1lIHRvIGJlIGEgY291bnRkb3duXG4gIGludmVydFRpbWU6IHRydWUsXG5cbiAgLy8gQ2xpY2tpbmcgdGhlIGN1cnJlbnRUaW1lIGludmVydHMgaXQncyB2YWx1ZSB0byBzaG93IHRpbWUgbGVmdCByYXRoZXIgdGhhbiBlbGFwc2VkXG4gIHRvZ2dsZUludmVydDogdHJ1ZSxcblxuICAvLyBGb3JjZSBhbiBhc3BlY3QgcmF0aW9cbiAgLy8gVGhlIGZvcm1hdCBtdXN0IGJlIGAndzpoJ2AgKGUuZy4gYCcxNjo5J2ApXG4gIHJhdGlvOiBudWxsLFxuXG4gIC8vIENsaWNrIHZpZGVvIGNvbnRhaW5lciB0byBwbGF5L3BhdXNlXG4gIGNsaWNrVG9QbGF5OiB0cnVlLFxuXG4gIC8vIEF1dG8gaGlkZSB0aGUgY29udHJvbHNcbiAgaGlkZUNvbnRyb2xzOiB0cnVlLFxuXG4gIC8vIFJlc2V0IHRvIHN0YXJ0IHdoZW4gcGxheWJhY2sgZW5kZWRcbiAgcmVzZXRPbkVuZDogZmFsc2UsXG5cbiAgLy8gRGlzYWJsZSB0aGUgc3RhbmRhcmQgY29udGV4dCBtZW51XG4gIGRpc2FibGVDb250ZXh0TWVudTogdHJ1ZSxcblxuICAvLyBTcHJpdGUgKGZvciBpY29ucylcbiAgbG9hZFNwcml0ZTogdHJ1ZSxcbiAgaWNvblByZWZpeDogJ3BseXInLFxuICBpY29uVXJsOiAnaHR0cHM6Ly9jZG4ucGx5ci5pby8zLjcuMi9wbHlyLnN2ZycsXG5cbiAgLy8gQmxhbmsgdmlkZW8gKHVzZWQgdG8gcHJldmVudCBlcnJvcnMgb24gc291cmNlIGNoYW5nZSlcbiAgYmxhbmtWaWRlbzogJ2h0dHBzOi8vY2RuLnBseXIuaW8vc3RhdGljL2JsYW5rLm1wNCcsXG5cbiAgLy8gUXVhbGl0eSBkZWZhdWx0XG4gIHF1YWxpdHk6IHtcbiAgICBkZWZhdWx0OiA1NzYsXG4gICAgLy8gVGhlIG9wdGlvbnMgdG8gZGlzcGxheSBpbiB0aGUgVUksIGlmIGF2YWlsYWJsZSBmb3IgdGhlIHNvdXJjZSBtZWRpYVxuICAgIG9wdGlvbnM6IFs0MzIwLCAyODgwLCAyMTYwLCAxNDQwLCAxMDgwLCA3MjAsIDU3NiwgNDgwLCAzNjAsIDI0MF0sXG4gICAgZm9yY2VkOiBmYWxzZSxcbiAgICBvbkNoYW5nZTogbnVsbCxcbiAgfSxcblxuICAvLyBTZXQgbG9vcHNcbiAgbG9vcDoge1xuICAgIGFjdGl2ZTogZmFsc2UsXG4gICAgLy8gc3RhcnQ6IG51bGwsXG4gICAgLy8gZW5kOiBudWxsLFxuICB9LFxuXG4gIC8vIFNwZWVkIGRlZmF1bHQgYW5kIG9wdGlvbnMgdG8gZGlzcGxheVxuICBzcGVlZDoge1xuICAgIHNlbGVjdGVkOiAxLFxuICAgIC8vIFRoZSBvcHRpb25zIHRvIGRpc3BsYXkgaW4gdGhlIFVJLCBpZiBhdmFpbGFibGUgZm9yIHRoZSBzb3VyY2UgbWVkaWEgKGUuZy4gVmltZW8gYW5kIFlvdVR1YmUgb25seSBzdXBwb3J0IDAuNXgtNHgpXG4gICAgb3B0aW9uczogWzAuNSwgMC43NSwgMSwgMS4yNSwgMS41LCAxLjc1LCAyLCA0XSxcbiAgfSxcblxuICAvLyBLZXlib2FyZCBzaG9ydGN1dCBzZXR0aW5nc1xuICBrZXlib2FyZDoge1xuICAgIGZvY3VzZWQ6IHRydWUsXG4gICAgZ2xvYmFsOiBmYWxzZSxcbiAgfSxcblxuICAvLyBEaXNwbGF5IHRvb2x0aXBzXG4gIHRvb2x0aXBzOiB7XG4gICAgY29udHJvbHM6IGZhbHNlLFxuICAgIHNlZWs6IHRydWUsXG4gIH0sXG5cbiAgLy8gQ2FwdGlvbnMgc2V0dGluZ3NcbiAgY2FwdGlvbnM6IHtcbiAgICBhY3RpdmU6IGZhbHNlLFxuICAgIGxhbmd1YWdlOiAnYXV0bycsXG4gICAgLy8gTGlzdGVuIHRvIG5ldyB0cmFja3MgYWRkZWQgYWZ0ZXIgUGx5ciBpcyBpbml0aWFsaXplZC5cbiAgICAvLyBUaGlzIGlzIG5lZWRlZCBmb3Igc3RyZWFtaW5nIGNhcHRpb25zLCBidXQgbWF5IHJlc3VsdCBpbiB1bnNlbGVjdGFibGUgb3B0aW9uc1xuICAgIHVwZGF0ZTogZmFsc2UsXG4gIH0sXG5cbiAgLy8gRnVsbHNjcmVlbiBzZXR0aW5nc1xuICBmdWxsc2NyZWVuOiB7XG4gICAgZW5hYmxlZDogdHJ1ZSwgLy8gQWxsb3cgZnVsbHNjcmVlbj9cbiAgICBmYWxsYmFjazogdHJ1ZSwgLy8gRmFsbGJhY2sgdXNpbmcgZnVsbCB2aWV3cG9ydC93aW5kb3dcbiAgICBpb3NOYXRpdmU6IGZhbHNlLCAvLyBVc2UgdGhlIG5hdGl2ZSBmdWxsc2NyZWVuIGluIGlPUyAoZGlzYWJsZXMgY3VzdG9tIGNvbnRyb2xzKVxuICAgIC8vIFNlbGVjdG9yIGZvciB0aGUgZnVsbHNjcmVlbiBjb250YWluZXIgc28gY29udGV4dHVhbCAvIG5vbi1wbGF5ZXIgY29udGVudCBjYW4gcmVtYWluIHZpc2libGUgaW4gZnVsbHNjcmVlbiBtb2RlXG4gICAgLy8gTm9uLWFuY2VzdG9ycyBvZiB0aGUgcGxheWVyIGVsZW1lbnQgd2lsbCBiZSBpZ25vcmVkXG4gICAgLy8gY29udGFpbmVyOiBudWxsLCAvLyBkZWZhdWx0cyB0byB0aGUgcGxheWVyIGVsZW1lbnRcbiAgfSxcblxuICAvLyBMb2NhbCBzdG9yYWdlXG4gIHN0b3JhZ2U6IHtcbiAgICBlbmFibGVkOiB0cnVlLFxuICAgIGtleTogJ3BseXInLFxuICB9LFxuXG4gIC8vIERlZmF1bHQgY29udHJvbHNcbiAgY29udHJvbHM6IFtcbiAgICAncGxheS1sYXJnZScsXG4gICAgLy8gJ3Jlc3RhcnQnLFxuICAgIC8vICdyZXdpbmQnLFxuICAgICdwbGF5JyxcbiAgICAvLyAnZmFzdC1mb3J3YXJkJyxcbiAgICAncHJvZ3Jlc3MnLFxuICAgICdjdXJyZW50LXRpbWUnLFxuICAgIC8vICdkdXJhdGlvbicsXG4gICAgJ211dGUnLFxuICAgICd2b2x1bWUnLFxuICAgICdjYXB0aW9ucycsXG4gICAgJ3NldHRpbmdzJyxcbiAgICAncGlwJyxcbiAgICAnYWlycGxheScsXG4gICAgLy8gJ2Rvd25sb2FkJyxcbiAgICAnZnVsbHNjcmVlbicsXG4gIF0sXG4gIHNldHRpbmdzOiBbJ2NhcHRpb25zJywgJ3F1YWxpdHknLCAnc3BlZWQnXSxcblxuICAvLyBMb2NhbGlzYXRpb25cbiAgaTE4bjoge1xuICAgIHJlc3RhcnQ6ICdSZXN0YXJ0JyxcbiAgICByZXdpbmQ6ICdSZXdpbmQge3NlZWt0aW1lfXMnLFxuICAgIHBsYXk6ICdQbGF5JyxcbiAgICBwYXVzZTogJ1BhdXNlJyxcbiAgICBmYXN0Rm9yd2FyZDogJ0ZvcndhcmQge3NlZWt0aW1lfXMnLFxuICAgIHNlZWs6ICdTZWVrJyxcbiAgICBzZWVrTGFiZWw6ICd7Y3VycmVudFRpbWV9IG9mIHtkdXJhdGlvbn0nLFxuICAgIHBsYXllZDogJ1BsYXllZCcsXG4gICAgYnVmZmVyZWQ6ICdCdWZmZXJlZCcsXG4gICAgY3VycmVudFRpbWU6ICdDdXJyZW50IHRpbWUnLFxuICAgIGR1cmF0aW9uOiAnRHVyYXRpb24nLFxuICAgIHZvbHVtZTogJ1ZvbHVtZScsXG4gICAgbXV0ZTogJ011dGUnLFxuICAgIHVubXV0ZTogJ1VubXV0ZScsXG4gICAgZW5hYmxlQ2FwdGlvbnM6ICdFbmFibGUgY2FwdGlvbnMnLFxuICAgIGRpc2FibGVDYXB0aW9uczogJ0Rpc2FibGUgY2FwdGlvbnMnLFxuICAgIGRvd25sb2FkOiAnRG93bmxvYWQnLFxuICAgIGVudGVyRnVsbHNjcmVlbjogJ0VudGVyIGZ1bGxzY3JlZW4nLFxuICAgIGV4aXRGdWxsc2NyZWVuOiAnRXhpdCBmdWxsc2NyZWVuJyxcbiAgICBmcmFtZVRpdGxlOiAnUGxheWVyIGZvciB7dGl0bGV9JyxcbiAgICBjYXB0aW9uczogJ0NhcHRpb25zJyxcbiAgICBzZXR0aW5nczogJ1NldHRpbmdzJyxcbiAgICBwaXA6ICdQSVAnLFxuICAgIG1lbnVCYWNrOiAnR28gYmFjayB0byBwcmV2aW91cyBtZW51JyxcbiAgICBzcGVlZDogJ1NwZWVkJyxcbiAgICBub3JtYWw6ICdOb3JtYWwnLFxuICAgIHF1YWxpdHk6ICdRdWFsaXR5JyxcbiAgICBsb29wOiAnTG9vcCcsXG4gICAgc3RhcnQ6ICdTdGFydCcsXG4gICAgZW5kOiAnRW5kJyxcbiAgICBhbGw6ICdBbGwnLFxuICAgIHJlc2V0OiAnUmVzZXQnLFxuICAgIGRpc2FibGVkOiAnRGlzYWJsZWQnLFxuICAgIGVuYWJsZWQ6ICdFbmFibGVkJyxcbiAgICBhZHZlcnRpc2VtZW50OiAnQWQnLFxuICAgIHF1YWxpdHlCYWRnZToge1xuICAgICAgMjE2MDogJzRLJyxcbiAgICAgIDE0NDA6ICdIRCcsXG4gICAgICAxMDgwOiAnSEQnLFxuICAgICAgNzIwOiAnSEQnLFxuICAgICAgNTc2OiAnU0QnLFxuICAgICAgNDgwOiAnU0QnLFxuICAgIH0sXG4gIH0sXG5cbiAgLy8gVVJMc1xuICB1cmxzOiB7XG4gICAgZG93bmxvYWQ6IG51bGwsXG4gICAgdmltZW86IHtcbiAgICAgIHNkazogJ2h0dHBzOi8vcGxheWVyLnZpbWVvLmNvbS9hcGkvcGxheWVyLmpzJyxcbiAgICAgIGlmcmFtZTogJ2h0dHBzOi8vcGxheWVyLnZpbWVvLmNvbS92aWRlby97MH0/ezF9JyxcbiAgICAgIGFwaTogJ2h0dHBzOi8vdmltZW8uY29tL2FwaS9vZW1iZWQuanNvbj91cmw9ezB9JyxcbiAgICB9LFxuICAgIHlvdXR1YmU6IHtcbiAgICAgIHNkazogJ2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2lmcmFtZV9hcGknLFxuICAgICAgYXBpOiAnaHR0cHM6Ly9ub2VtYmVkLmNvbS9lbWJlZD91cmw9aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj17MH0nLFxuICAgIH0sXG4gICAgZ29vZ2xlSU1BOiB7XG4gICAgICBzZGs6ICdodHRwczovL2ltYXNkay5nb29nbGVhcGlzLmNvbS9qcy9zZGtsb2FkZXIvaW1hMy5qcycsXG4gICAgfSxcbiAgfSxcblxuICAvLyBDdXN0b20gY29udHJvbCBsaXN0ZW5lcnNcbiAgbGlzdGVuZXJzOiB7XG4gICAgc2VlazogbnVsbCxcbiAgICBwbGF5OiBudWxsLFxuICAgIHBhdXNlOiBudWxsLFxuICAgIHJlc3RhcnQ6IG51bGwsXG4gICAgcmV3aW5kOiBudWxsLFxuICAgIGZhc3RGb3J3YXJkOiBudWxsLFxuICAgIG11dGU6IG51bGwsXG4gICAgdm9sdW1lOiBudWxsLFxuICAgIGNhcHRpb25zOiBudWxsLFxuICAgIGRvd25sb2FkOiBudWxsLFxuICAgIGZ1bGxzY3JlZW46IG51bGwsXG4gICAgcGlwOiBudWxsLFxuICAgIGFpcnBsYXk6IG51bGwsXG4gICAgc3BlZWQ6IG51bGwsXG4gICAgcXVhbGl0eTogbnVsbCxcbiAgICBsb29wOiBudWxsLFxuICAgIGxhbmd1YWdlOiBudWxsLFxuICB9LFxuXG4gIC8vIEV2ZW50cyB0byB3YXRjaCBhbmQgYnViYmxlXG4gIGV2ZW50czogW1xuICAgIC8vIEV2ZW50cyB0byB3YXRjaCBvbiBIVE1MNSBtZWRpYSBlbGVtZW50cyBhbmQgYnViYmxlXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vZG9jcy9XZWIvR3VpZGUvRXZlbnRzL01lZGlhX2V2ZW50c1xuICAgICdlbmRlZCcsXG4gICAgJ3Byb2dyZXNzJyxcbiAgICAnc3RhbGxlZCcsXG4gICAgJ3BsYXlpbmcnLFxuICAgICd3YWl0aW5nJyxcbiAgICAnY2FucGxheScsXG4gICAgJ2NhbnBsYXl0aHJvdWdoJyxcbiAgICAnbG9hZHN0YXJ0JyxcbiAgICAnbG9hZGVkZGF0YScsXG4gICAgJ2xvYWRlZG1ldGFkYXRhJyxcbiAgICAndGltZXVwZGF0ZScsXG4gICAgJ3ZvbHVtZWNoYW5nZScsXG4gICAgJ3BsYXknLFxuICAgICdwYXVzZScsXG4gICAgJ2Vycm9yJyxcbiAgICAnc2Vla2luZycsXG4gICAgJ3NlZWtlZCcsXG4gICAgJ2VtcHRpZWQnLFxuICAgICdyYXRlY2hhbmdlJyxcbiAgICAnY3VlY2hhbmdlJyxcblxuICAgIC8vIEN1c3RvbSBldmVudHNcbiAgICAnZG93bmxvYWQnLFxuICAgICdlbnRlcmZ1bGxzY3JlZW4nLFxuICAgICdleGl0ZnVsbHNjcmVlbicsXG4gICAgJ2NhcHRpb25zZW5hYmxlZCcsXG4gICAgJ2NhcHRpb25zZGlzYWJsZWQnLFxuICAgICdsYW5ndWFnZWNoYW5nZScsXG4gICAgJ2NvbnRyb2xzaGlkZGVuJyxcbiAgICAnY29udHJvbHNzaG93bicsXG4gICAgJ3JlYWR5JyxcblxuICAgIC8vIFlvdVR1YmVcbiAgICAnc3RhdGVjaGFuZ2UnLFxuXG4gICAgLy8gUXVhbGl0eVxuICAgICdxdWFsaXR5Y2hhbmdlJyxcblxuICAgIC8vIEFkc1xuICAgICdhZHNsb2FkZWQnLFxuICAgICdhZHNjb250ZW50cGF1c2UnLFxuICAgICdhZHNjb250ZW50cmVzdW1lJyxcbiAgICAnYWRzdGFydGVkJyxcbiAgICAnYWRzbWlkcG9pbnQnLFxuICAgICdhZHNjb21wbGV0ZScsXG4gICAgJ2Fkc2FsbGNvbXBsZXRlJyxcbiAgICAnYWRzaW1wcmVzc2lvbicsXG4gICAgJ2Fkc2NsaWNrJyxcbiAgXSxcblxuICAvLyBTZWxlY3RvcnNcbiAgLy8gQ2hhbmdlIHRoZXNlIHRvIG1hdGNoIHlvdXIgdGVtcGxhdGUgaWYgdXNpbmcgY3VzdG9tIEhUTUxcbiAgc2VsZWN0b3JzOiB7XG4gICAgZWRpdGFibGU6ICdpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCwgW2NvbnRlbnRlZGl0YWJsZV0nLFxuICAgIGNvbnRhaW5lcjogJy5wbHlyJyxcbiAgICBjb250cm9sczoge1xuICAgICAgY29udGFpbmVyOiBudWxsLFxuICAgICAgd3JhcHBlcjogJy5wbHlyX19jb250cm9scycsXG4gICAgfSxcbiAgICBsYWJlbHM6ICdbZGF0YS1wbHlyXScsXG4gICAgYnV0dG9uczoge1xuICAgICAgcGxheTogJ1tkYXRhLXBseXI9XCJwbGF5XCJdJyxcbiAgICAgIHBhdXNlOiAnW2RhdGEtcGx5cj1cInBhdXNlXCJdJyxcbiAgICAgIHJlc3RhcnQ6ICdbZGF0YS1wbHlyPVwicmVzdGFydFwiXScsXG4gICAgICByZXdpbmQ6ICdbZGF0YS1wbHlyPVwicmV3aW5kXCJdJyxcbiAgICAgIGZhc3RGb3J3YXJkOiAnW2RhdGEtcGx5cj1cImZhc3QtZm9yd2FyZFwiXScsXG4gICAgICBtdXRlOiAnW2RhdGEtcGx5cj1cIm11dGVcIl0nLFxuICAgICAgY2FwdGlvbnM6ICdbZGF0YS1wbHlyPVwiY2FwdGlvbnNcIl0nLFxuICAgICAgZG93bmxvYWQ6ICdbZGF0YS1wbHlyPVwiZG93bmxvYWRcIl0nLFxuICAgICAgZnVsbHNjcmVlbjogJ1tkYXRhLXBseXI9XCJmdWxsc2NyZWVuXCJdJyxcbiAgICAgIHBpcDogJ1tkYXRhLXBseXI9XCJwaXBcIl0nLFxuICAgICAgYWlycGxheTogJ1tkYXRhLXBseXI9XCJhaXJwbGF5XCJdJyxcbiAgICAgIHNldHRpbmdzOiAnW2RhdGEtcGx5cj1cInNldHRpbmdzXCJdJyxcbiAgICAgIGxvb3A6ICdbZGF0YS1wbHlyPVwibG9vcFwiXScsXG4gICAgfSxcbiAgICBpbnB1dHM6IHtcbiAgICAgIHNlZWs6ICdbZGF0YS1wbHlyPVwic2Vla1wiXScsXG4gICAgICB2b2x1bWU6ICdbZGF0YS1wbHlyPVwidm9sdW1lXCJdJyxcbiAgICAgIHNwZWVkOiAnW2RhdGEtcGx5cj1cInNwZWVkXCJdJyxcbiAgICAgIGxhbmd1YWdlOiAnW2RhdGEtcGx5cj1cImxhbmd1YWdlXCJdJyxcbiAgICAgIHF1YWxpdHk6ICdbZGF0YS1wbHlyPVwicXVhbGl0eVwiXScsXG4gICAgfSxcbiAgICBkaXNwbGF5OiB7XG4gICAgICBjdXJyZW50VGltZTogJy5wbHlyX190aW1lLS1jdXJyZW50JyxcbiAgICAgIGR1cmF0aW9uOiAnLnBseXJfX3RpbWUtLWR1cmF0aW9uJyxcbiAgICAgIGJ1ZmZlcjogJy5wbHlyX19wcm9ncmVzc19fYnVmZmVyJyxcbiAgICAgIGxvb3A6ICcucGx5cl9fcHJvZ3Jlc3NfX2xvb3AnLCAvLyBVc2VkIGxhdGVyXG4gICAgICB2b2x1bWU6ICcucGx5cl9fdm9sdW1lLS1kaXNwbGF5JyxcbiAgICB9LFxuICAgIHByb2dyZXNzOiAnLnBseXJfX3Byb2dyZXNzJyxcbiAgICBjYXB0aW9uczogJy5wbHlyX19jYXB0aW9ucycsXG4gICAgY2FwdGlvbjogJy5wbHlyX19jYXB0aW9uJyxcbiAgfSxcblxuICAvLyBDbGFzcyBob29rcyBhZGRlZCB0byB0aGUgcGxheWVyIGluIGRpZmZlcmVudCBzdGF0ZXNcbiAgY2xhc3NOYW1lczoge1xuICAgIHR5cGU6ICdwbHlyLS17MH0nLFxuICAgIHByb3ZpZGVyOiAncGx5ci0tezB9JyxcbiAgICB2aWRlbzogJ3BseXJfX3ZpZGVvLXdyYXBwZXInLFxuICAgIGVtYmVkOiAncGx5cl9fdmlkZW8tZW1iZWQnLFxuICAgIHZpZGVvRml4ZWRSYXRpbzogJ3BseXJfX3ZpZGVvLXdyYXBwZXItLWZpeGVkLXJhdGlvJyxcbiAgICBlbWJlZENvbnRhaW5lcjogJ3BseXJfX3ZpZGVvLWVtYmVkX19jb250YWluZXInLFxuICAgIHBvc3RlcjogJ3BseXJfX3Bvc3RlcicsXG4gICAgcG9zdGVyRW5hYmxlZDogJ3BseXJfX3Bvc3Rlci1lbmFibGVkJyxcbiAgICBhZHM6ICdwbHlyX19hZHMnLFxuICAgIGNvbnRyb2w6ICdwbHlyX19jb250cm9sJyxcbiAgICBjb250cm9sUHJlc3NlZDogJ3BseXJfX2NvbnRyb2wtLXByZXNzZWQnLFxuICAgIHBsYXlpbmc6ICdwbHlyLS1wbGF5aW5nJyxcbiAgICBwYXVzZWQ6ICdwbHlyLS1wYXVzZWQnLFxuICAgIHN0b3BwZWQ6ICdwbHlyLS1zdG9wcGVkJyxcbiAgICBsb2FkaW5nOiAncGx5ci0tbG9hZGluZycsXG4gICAgaG92ZXI6ICdwbHlyLS1ob3ZlcicsXG4gICAgdG9vbHRpcDogJ3BseXJfX3Rvb2x0aXAnLFxuICAgIGN1ZXM6ICdwbHlyX19jdWVzJyxcbiAgICBtYXJrZXI6ICdwbHlyX19wcm9ncmVzc19fbWFya2VyJyxcbiAgICBoaWRkZW46ICdwbHlyX19zci1vbmx5JyxcbiAgICBoaWRlQ29udHJvbHM6ICdwbHlyLS1oaWRlLWNvbnRyb2xzJyxcbiAgICBpc0lvczogJ3BseXItLWlzLWlvcycsXG4gICAgaXNUb3VjaDogJ3BseXItLWlzLXRvdWNoJyxcbiAgICB1aVN1cHBvcnRlZDogJ3BseXItLWZ1bGwtdWknLFxuICAgIG5vVHJhbnNpdGlvbjogJ3BseXItLW5vLXRyYW5zaXRpb24nLFxuICAgIGRpc3BsYXk6IHtcbiAgICAgIHRpbWU6ICdwbHlyX190aW1lJyxcbiAgICB9LFxuICAgIG1lbnU6IHtcbiAgICAgIHZhbHVlOiAncGx5cl9fbWVudV9fdmFsdWUnLFxuICAgICAgYmFkZ2U6ICdwbHlyX19iYWRnZScsXG4gICAgICBvcGVuOiAncGx5ci0tbWVudS1vcGVuJyxcbiAgICB9LFxuICAgIGNhcHRpb25zOiB7XG4gICAgICBlbmFibGVkOiAncGx5ci0tY2FwdGlvbnMtZW5hYmxlZCcsXG4gICAgICBhY3RpdmU6ICdwbHlyLS1jYXB0aW9ucy1hY3RpdmUnLFxuICAgIH0sXG4gICAgZnVsbHNjcmVlbjoge1xuICAgICAgZW5hYmxlZDogJ3BseXItLWZ1bGxzY3JlZW4tZW5hYmxlZCcsXG4gICAgICBmYWxsYmFjazogJ3BseXItLWZ1bGxzY3JlZW4tZmFsbGJhY2snLFxuICAgIH0sXG4gICAgcGlwOiB7XG4gICAgICBzdXBwb3J0ZWQ6ICdwbHlyLS1waXAtc3VwcG9ydGVkJyxcbiAgICAgIGFjdGl2ZTogJ3BseXItLXBpcC1hY3RpdmUnLFxuICAgIH0sXG4gICAgYWlycGxheToge1xuICAgICAgc3VwcG9ydGVkOiAncGx5ci0tYWlycGxheS1zdXBwb3J0ZWQnLFxuICAgICAgYWN0aXZlOiAncGx5ci0tYWlycGxheS1hY3RpdmUnLFxuICAgIH0sXG4gICAgdGFiRm9jdXM6ICdwbHlyX190YWItZm9jdXMnLFxuICAgIHByZXZpZXdUaHVtYm5haWxzOiB7XG4gICAgICAvLyBUb29sdGlwIHRodW1ic1xuICAgICAgdGh1bWJDb250YWluZXI6ICdwbHlyX19wcmV2aWV3LXRodW1iJyxcbiAgICAgIHRodW1iQ29udGFpbmVyU2hvd246ICdwbHlyX19wcmV2aWV3LXRodW1iLS1pcy1zaG93bicsXG4gICAgICBpbWFnZUNvbnRhaW5lcjogJ3BseXJfX3ByZXZpZXctdGh1bWJfX2ltYWdlLWNvbnRhaW5lcicsXG4gICAgICB0aW1lQ29udGFpbmVyOiAncGx5cl9fcHJldmlldy10aHVtYl9fdGltZS1jb250YWluZXInLFxuICAgICAgLy8gU2NydWJiaW5nXG4gICAgICBzY3J1YmJpbmdDb250YWluZXI6ICdwbHlyX19wcmV2aWV3LXNjcnViYmluZycsXG4gICAgICBzY3J1YmJpbmdDb250YWluZXJTaG93bjogJ3BseXJfX3ByZXZpZXctc2NydWJiaW5nLS1pcy1zaG93bicsXG4gICAgfSxcbiAgfSxcblxuICAvLyBFbWJlZCBhdHRyaWJ1dGVzXG4gIGF0dHJpYnV0ZXM6IHtcbiAgICBlbWJlZDoge1xuICAgICAgcHJvdmlkZXI6ICdkYXRhLXBseXItcHJvdmlkZXInLFxuICAgICAgaWQ6ICdkYXRhLXBseXItZW1iZWQtaWQnLFxuICAgICAgaGFzaDogJ2RhdGEtcGx5ci1lbWJlZC1oYXNoJyxcbiAgICB9LFxuICB9LFxuXG4gIC8vIEFkdmVydGlzZW1lbnRzIHBsdWdpblxuICAvLyBSZWdpc3RlciBmb3IgYW4gYWNjb3VudCBoZXJlOiBodHRwOi8vdmkuYWkvcHVibGlzaGVyLXZpZGVvLW1vbmV0aXphdGlvbi8/YWlkPXBseXJpb1xuICBhZHM6IHtcbiAgICBlbmFibGVkOiBmYWxzZSxcbiAgICBwdWJsaXNoZXJJZDogJycsXG4gICAgdGFnVXJsOiAnJyxcbiAgfSxcblxuICAvLyBQcmV2aWV3IFRodW1ibmFpbHMgcGx1Z2luXG4gIHByZXZpZXdUaHVtYm5haWxzOiB7XG4gICAgZW5hYmxlZDogZmFsc2UsXG4gICAgc3JjOiAnJyxcbiAgfSxcblxuICAvLyBWaW1lbyBwbHVnaW5cbiAgdmltZW86IHtcbiAgICBieWxpbmU6IGZhbHNlLFxuICAgIHBvcnRyYWl0OiBmYWxzZSxcbiAgICB0aXRsZTogZmFsc2UsXG4gICAgc3BlZWQ6IHRydWUsXG4gICAgdHJhbnNwYXJlbnQ6IGZhbHNlLFxuICAgIC8vIEN1c3RvbSBzZXR0aW5ncyBmcm9tIFBseXJcbiAgICBjdXN0b21Db250cm9sczogdHJ1ZSxcbiAgICByZWZlcnJlclBvbGljeTogbnVsbCwgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxJRnJhbWVFbGVtZW50L3JlZmVycmVyUG9saWN5XG4gICAgLy8gV2hldGhlciB0aGUgb3duZXIgb2YgdGhlIHZpZGVvIGhhcyBhIFBybyBvciBCdXNpbmVzcyBhY2NvdW50XG4gICAgLy8gKHdoaWNoIGFsbG93cyB1cyB0byBwcm9wZXJseSBoaWRlIGNvbnRyb2xzIHdpdGhvdXQgQ1NTIGhhY2tzLCBldGMpXG4gICAgcHJlbWl1bTogZmFsc2UsXG4gIH0sXG5cbiAgLy8gWW91VHViZSBwbHVnaW5cbiAgeW91dHViZToge1xuICAgIHJlbDogMCwgLy8gTm8gcmVsYXRlZCB2aWRzXG4gICAgc2hvd2luZm86IDAsIC8vIEhpZGUgaW5mb1xuICAgIGl2X2xvYWRfcG9saWN5OiAzLCAvLyBIaWRlIGFubm90YXRpb25zXG4gICAgbW9kZXN0YnJhbmRpbmc6IDEsIC8vIEhpZGUgbG9nb3MgYXMgbXVjaCBhcyBwb3NzaWJsZSAodGhleSBzdGlsbCBzaG93IG9uZSBpbiB0aGUgY29ybmVyIHdoZW4gcGF1c2VkKVxuICAgIC8vIEN1c3RvbSBzZXR0aW5ncyBmcm9tIFBseXJcbiAgICBjdXN0b21Db250cm9sczogdHJ1ZSxcbiAgICBub0Nvb2tpZTogZmFsc2UsIC8vIFdoZXRoZXIgdG8gdXNlIGFuIGFsdGVybmF0aXZlIHZlcnNpb24gb2YgWW91VHViZSB3aXRob3V0IGNvb2tpZXNcbiAgfSxcblxuICAvLyBNZWRpYSBNZXRhZGF0YVxuICBtZWRpYU1ldGFkYXRhOiB7XG4gICAgdGl0bGU6ICcnLFxuICAgIGFydGlzdDogJycsXG4gICAgYWxidW06ICcnLFxuICAgIGFydHdvcms6IFtdLFxuICB9LFxuXG4gIC8vIE1hcmtlcnNcbiAgbWFya2Vyczoge1xuICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgIHBvaW50czogW10sXG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBkZWZhdWx0cztcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIHN0YXRlc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IHBpcCA9IHtcbiAgYWN0aXZlOiAncGljdHVyZS1pbi1waWN0dXJlJyxcbiAgaW5hY3RpdmU6ICdpbmxpbmUnLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgeyBwaXAgfTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIHN1cHBvcnRlZCB0eXBlcyBhbmQgcHJvdmlkZXJzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgcHJvdmlkZXJzID0ge1xuICBodG1sNTogJ2h0bWw1JyxcbiAgeW91dHViZTogJ3lvdXR1YmUnLFxuICB2aW1lbzogJ3ZpbWVvJyxcbn07XG5cbmV4cG9ydCBjb25zdCB0eXBlcyA9IHtcbiAgYXVkaW86ICdhdWRpbycsXG4gIHZpZGVvOiAndmlkZW8nLFxufTtcblxuLyoqXG4gKiBHZXQgcHJvdmlkZXIgYnkgVVJMXG4gKiBAcGFyYW0ge1N0cmluZ30gdXJsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcm92aWRlckJ5VXJsKHVybCkge1xuICAvLyBZb3VUdWJlXG4gIGlmICgvXihodHRwcz86XFwvXFwvKT8od3d3XFwuKT8oeW91dHViZVxcLmNvbXx5b3V0dWJlLW5vY29va2llXFwuY29tfHlvdXR1XFwuP2JlKVxcLy4rJC8udGVzdCh1cmwpKSB7XG4gICAgcmV0dXJuIHByb3ZpZGVycy55b3V0dWJlO1xuICB9XG5cbiAgLy8gVmltZW9cbiAgaWYgKC9eaHR0cHM/OlxcL1xcL3BsYXllci52aW1lby5jb21cXC92aWRlb1xcL1xcZHswLDl9KD89XFxifFxcLykvLnRlc3QodXJsKSkge1xuICAgIHJldHVybiBwcm92aWRlcnMudmltZW87XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgeyBwcm92aWRlcnMsIHR5cGVzIH07XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ29uc29sZSB3cmFwcGVyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBub29wID0gKCkgPT4ge307XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbnNvbGUge1xuICBjb25zdHJ1Y3RvcihlbmFibGVkID0gZmFsc2UpIHtcbiAgICB0aGlzLmVuYWJsZWQgPSB3aW5kb3cuY29uc29sZSAmJiBlbmFibGVkO1xuXG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5sb2coJ0RlYnVnZ2luZyBlbmFibGVkJyk7XG4gICAgfVxuICB9XG5cbiAgZ2V0IGxvZygpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIHJldHVybiB0aGlzLmVuYWJsZWQgPyBGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5jYWxsKGNvbnNvbGUubG9nLCBjb25zb2xlKSA6IG5vb3A7XG4gIH1cblxuICBnZXQgd2FybigpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIHJldHVybiB0aGlzLmVuYWJsZWQgPyBGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5jYWxsKGNvbnNvbGUud2FybiwgY29uc29sZSkgOiBub29wO1xuICB9XG5cbiAgZ2V0IGVycm9yKCkge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgcmV0dXJuIHRoaXMuZW5hYmxlZCA/IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmNhbGwoY29uc29sZS5lcnJvciwgY29uc29sZSkgOiBub29wO1xuICB9XG59XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRnVsbHNjcmVlbiB3cmFwcGVyXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvRnVsbHNjcmVlbl9BUEkjcHJlZml4aW5nXG4vLyBodHRwczovL3dlYmtpdC5vcmcvYmxvZy83OTI5L2Rlc2lnbmluZy13ZWJzaXRlcy1mb3ItaXBob25lLXgvXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgYnJvd3NlciBmcm9tICcuL3V0aWxzL2Jyb3dzZXInO1xuaW1wb3J0IHsgY2xvc2VzdCwgZ2V0RWxlbWVudHMsIGhhc0NsYXNzLCB0b2dnbGVDbGFzcyB9IGZyb20gJy4vdXRpbHMvZWxlbWVudHMnO1xuaW1wb3J0IHsgb24sIHRyaWdnZXJFdmVudCB9IGZyb20gJy4vdXRpbHMvZXZlbnRzJztcbmltcG9ydCBpcyBmcm9tICcuL3V0aWxzL2lzJztcbmltcG9ydCB7IHNpbGVuY2VQcm9taXNlIH0gZnJvbSAnLi91dGlscy9wcm9taXNlJztcblxuY2xhc3MgRnVsbHNjcmVlbiB7XG4gIGNvbnN0cnVjdG9yKHBsYXllcikge1xuICAgIC8vIEtlZXAgcmVmZXJlbmNlIHRvIHBhcmVudFxuICAgIHRoaXMucGxheWVyID0gcGxheWVyO1xuXG4gICAgLy8gR2V0IHByZWZpeFxuICAgIHRoaXMucHJlZml4ID0gRnVsbHNjcmVlbi5wcmVmaXg7XG4gICAgdGhpcy5wcm9wZXJ0eSA9IEZ1bGxzY3JlZW4ucHJvcGVydHk7XG5cbiAgICAvLyBTY3JvbGwgcG9zaXRpb25cbiAgICB0aGlzLnNjcm9sbFBvc2l0aW9uID0geyB4OiAwLCB5OiAwIH07XG5cbiAgICAvLyBGb3JjZSB0aGUgdXNlIG9mICdmdWxsIHdpbmRvdy9icm93c2VyJyByYXRoZXIgdGhhbiBmdWxsc2NyZWVuXG4gICAgdGhpcy5mb3JjZUZhbGxiYWNrID0gcGxheWVyLmNvbmZpZy5mdWxsc2NyZWVuLmZhbGxiYWNrID09PSAnZm9yY2UnO1xuXG4gICAgLy8gR2V0IHRoZSBmdWxsc2NyZWVuIGVsZW1lbnRcbiAgICAvLyBDaGVja3MgY29udGFpbmVyIGlzIGFuIGFuY2VzdG9yLCBkZWZhdWx0cyB0byBudWxsXG4gICAgdGhpcy5wbGF5ZXIuZWxlbWVudHMuZnVsbHNjcmVlbiA9XG4gICAgICBwbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uY29udGFpbmVyICYmIGNsb3Nlc3QodGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyLCBwbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uY29udGFpbmVyKTtcblxuICAgIC8vIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVyc1xuICAgIC8vIEhhbmRsZSBldmVudCAoaW5jYXNlIHVzZXIgcHJlc3NlcyBlc2NhcGUgZXRjKVxuICAgIG9uLmNhbGwoXG4gICAgICB0aGlzLnBsYXllcixcbiAgICAgIGRvY3VtZW50LFxuICAgICAgdGhpcy5wcmVmaXggPT09ICdtcycgPyAnTVNGdWxsc2NyZWVuQ2hhbmdlJyA6IGAke3RoaXMucHJlZml4fWZ1bGxzY3JlZW5jaGFuZ2VgLFxuICAgICAgKCkgPT4ge1xuICAgICAgICAvLyBUT0RPOiBGaWx0ZXIgZm9yIHRhcmdldD8/XG4gICAgICAgIHRoaXMub25DaGFuZ2UoKTtcbiAgICAgIH0sXG4gICAgKTtcblxuICAgIC8vIEZ1bGxzY3JlZW4gdG9nZ2xlIG9uIGRvdWJsZSBjbGlja1xuICAgIG9uLmNhbGwodGhpcy5wbGF5ZXIsIHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lciwgJ2RibGNsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAvLyBJZ25vcmUgZG91YmxlIGNsaWNrIGluIGNvbnRyb2xzXG4gICAgICBpZiAoaXMuZWxlbWVudCh0aGlzLnBsYXllci5lbGVtZW50cy5jb250cm9scykgJiYgdGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udHJvbHMuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMucGxheWVyLmxpc3RlbmVycy5wcm94eShldmVudCwgdGhpcy50b2dnbGUsICdmdWxsc2NyZWVuJyk7XG4gICAgfSk7XG5cbiAgICAvLyBUYXAgZm9jdXMgd2hlbiBpbiBmdWxsc2NyZWVuXG4gICAgb24uY2FsbCh0aGlzLCB0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXIsICdrZXlkb3duJywgKGV2ZW50KSA9PiB0aGlzLnRyYXBGb2N1cyhldmVudCkpO1xuXG4gICAgLy8gVXBkYXRlIHRoZSBVSVxuICAgIHRoaXMudXBkYXRlKCk7XG5cbiAgICAvLyB0aGlzLnRvZ2dsZSA9IHRoaXMudG9nZ2xlLmJpbmQodGhpcyk7XG4gIH1cblxuICAvLyBEZXRlcm1pbmUgaWYgbmF0aXZlIHN1cHBvcnRlZFxuICBzdGF0aWMgZ2V0IG5hdGl2ZSgpIHtcbiAgICByZXR1cm4gISEoXG4gICAgICBkb2N1bWVudC5mdWxsc2NyZWVuRW5hYmxlZCB8fFxuICAgICAgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVuYWJsZWQgfHxcbiAgICAgIGRvY3VtZW50Lm1vekZ1bGxTY3JlZW5FbmFibGVkIHx8XG4gICAgICBkb2N1bWVudC5tc0Z1bGxzY3JlZW5FbmFibGVkXG4gICAgKTtcbiAgfVxuXG4gIC8vIElmIHdlJ3JlIGFjdHVhbGx5IHVzaW5nIG5hdGl2ZVxuICBnZXQgdXNpbmdOYXRpdmUoKSB7XG4gICAgcmV0dXJuIEZ1bGxzY3JlZW4ubmF0aXZlICYmICF0aGlzLmZvcmNlRmFsbGJhY2s7XG4gIH1cblxuICAvLyBHZXQgdGhlIHByZWZpeCBmb3IgaGFuZGxlcnNcbiAgc3RhdGljIGdldCBwcmVmaXgoKSB7XG4gICAgLy8gTm8gcHJlZml4XG4gICAgaWYgKGlzLmZ1bmN0aW9uKGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKSkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGZvciBmdWxsc2NyZWVuIHN1cHBvcnQgYnkgdmVuZG9yIHByZWZpeFxuICAgIGxldCB2YWx1ZSA9ICcnO1xuICAgIGNvbnN0IHByZWZpeGVzID0gWyd3ZWJraXQnLCAnbW96JywgJ21zJ107XG5cbiAgICBwcmVmaXhlcy5zb21lKChwcmUpID0+IHtcbiAgICAgIGlmIChpcy5mdW5jdGlvbihkb2N1bWVudFtgJHtwcmV9RXhpdEZ1bGxzY3JlZW5gXSkgfHwgaXMuZnVuY3Rpb24oZG9jdW1lbnRbYCR7cHJlfUNhbmNlbEZ1bGxTY3JlZW5gXSkpIHtcbiAgICAgICAgdmFsdWUgPSBwcmU7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICBzdGF0aWMgZ2V0IHByb3BlcnR5KCkge1xuICAgIHJldHVybiB0aGlzLnByZWZpeCA9PT0gJ21veicgPyAnRnVsbFNjcmVlbicgOiAnRnVsbHNjcmVlbic7XG4gIH1cblxuICAvLyBEZXRlcm1pbmUgaWYgZnVsbHNjcmVlbiBpcyBlbmFibGVkXG4gIGdldCBlbmFibGVkKCkge1xuICAgIHJldHVybiAoXG4gICAgICAoRnVsbHNjcmVlbi5uYXRpdmUgfHwgdGhpcy5wbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uZmFsbGJhY2spICYmXG4gICAgICB0aGlzLnBsYXllci5jb25maWcuZnVsbHNjcmVlbi5lbmFibGVkICYmXG4gICAgICB0aGlzLnBsYXllci5zdXBwb3J0ZWQudWkgJiZcbiAgICAgIHRoaXMucGxheWVyLmlzVmlkZW9cbiAgICApO1xuICB9XG5cbiAgLy8gR2V0IGFjdGl2ZSBzdGF0ZVxuICBnZXQgYWN0aXZlKCkge1xuICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2sgdXNpbmcgY2xhc3NuYW1lXG4gICAgaWYgKCFGdWxsc2NyZWVuLm5hdGl2ZSB8fCB0aGlzLmZvcmNlRmFsbGJhY2spIHtcbiAgICAgIHJldHVybiBoYXNDbGFzcyh0aGlzLnRhcmdldCwgdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMuZnVsbHNjcmVlbi5mYWxsYmFjayk7XG4gICAgfVxuXG4gICAgY29uc3QgZWxlbWVudCA9ICF0aGlzLnByZWZpeFxuICAgICAgPyB0aGlzLnRhcmdldC5nZXRSb290Tm9kZSgpLmZ1bGxzY3JlZW5FbGVtZW50XG4gICAgICA6IHRoaXMudGFyZ2V0LmdldFJvb3ROb2RlKClbYCR7dGhpcy5wcmVmaXh9JHt0aGlzLnByb3BlcnR5fUVsZW1lbnRgXTtcblxuICAgIHJldHVybiBlbGVtZW50ICYmIGVsZW1lbnQuc2hhZG93Um9vdCA/IGVsZW1lbnQgPT09IHRoaXMudGFyZ2V0LmdldFJvb3ROb2RlKCkuaG9zdCA6IGVsZW1lbnQgPT09IHRoaXMudGFyZ2V0O1xuICB9XG5cbiAgLy8gR2V0IHRhcmdldCBlbGVtZW50XG4gIGdldCB0YXJnZXQoKSB7XG4gICAgcmV0dXJuIGJyb3dzZXIuaXNJb3MgJiYgdGhpcy5wbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uaW9zTmF0aXZlXG4gICAgICA/IHRoaXMucGxheWVyLm1lZGlhXG4gICAgICA6IHRoaXMucGxheWVyLmVsZW1lbnRzLmZ1bGxzY3JlZW4gfHwgdGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyO1xuICB9XG5cbiAgb25DaGFuZ2UgPSAoKSA9PiB7XG4gICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgdG9nZ2xlIGJ1dHRvblxuICAgIGNvbnN0IGJ1dHRvbiA9IHRoaXMucGxheWVyLmVsZW1lbnRzLmJ1dHRvbnMuZnVsbHNjcmVlbjtcbiAgICBpZiAoaXMuZWxlbWVudChidXR0b24pKSB7XG4gICAgICBidXR0b24ucHJlc3NlZCA9IHRoaXMuYWN0aXZlO1xuICAgIH1cblxuICAgIC8vIEFsd2F5cyB0cmlnZ2VyIGV2ZW50cyBvbiB0aGUgcGx5ciAvIG1lZGlhIGVsZW1lbnQgKG5vdCBhIGZ1bGxzY3JlZW4gY29udGFpbmVyKSBhbmQgbGV0IHRoZW0gYnViYmxlIHVwXG4gICAgY29uc3QgdGFyZ2V0ID0gdGhpcy50YXJnZXQgPT09IHRoaXMucGxheWVyLm1lZGlhID8gdGhpcy50YXJnZXQgOiB0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXI7XG4gICAgLy8gVHJpZ2dlciBhbiBldmVudFxuICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMucGxheWVyLCB0YXJnZXQsIHRoaXMuYWN0aXZlID8gJ2VudGVyZnVsbHNjcmVlbicgOiAnZXhpdGZ1bGxzY3JlZW4nLCB0cnVlKTtcbiAgfTtcblxuICB0b2dnbGVGYWxsYmFjayA9ICh0b2dnbGUgPSBmYWxzZSkgPT4ge1xuICAgIC8vIFN0b3JlIG9yIHJlc3RvcmUgc2Nyb2xsIHBvc2l0aW9uXG4gICAgaWYgKHRvZ2dsZSkge1xuICAgICAgdGhpcy5zY3JvbGxQb3NpdGlvbiA9IHtcbiAgICAgICAgeDogd2luZG93LnNjcm9sbFggfHwgMCxcbiAgICAgICAgeTogd2luZG93LnNjcm9sbFkgfHwgMCxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbmRvdy5zY3JvbGxUbyh0aGlzLnNjcm9sbFBvc2l0aW9uLngsIHRoaXMuc2Nyb2xsUG9zaXRpb24ueSk7XG4gICAgfVxuXG4gICAgLy8gVG9nZ2xlIHNjcm9sbFxuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSB0b2dnbGUgPyAnaGlkZGVuJyA6ICcnO1xuXG4gICAgLy8gVG9nZ2xlIGNsYXNzIGhvb2tcbiAgICB0b2dnbGVDbGFzcyh0aGlzLnRhcmdldCwgdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMuZnVsbHNjcmVlbi5mYWxsYmFjaywgdG9nZ2xlKTtcblxuICAgIC8vIEZvcmNlIGZ1bGwgdmlld3BvcnQgb24gaVBob25lIFgrXG4gICAgaWYgKGJyb3dzZXIuaXNJb3MpIHtcbiAgICAgIGxldCB2aWV3cG9ydCA9IGRvY3VtZW50LmhlYWQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPVwidmlld3BvcnRcIl0nKTtcbiAgICAgIGNvbnN0IHByb3BlcnR5ID0gJ3ZpZXdwb3J0LWZpdD1jb3Zlcic7XG5cbiAgICAgIC8vIEluamVjdCB0aGUgdmlld3BvcnQgbWV0YSBpZiByZXF1aXJlZFxuICAgICAgaWYgKCF2aWV3cG9ydCkge1xuICAgICAgICB2aWV3cG9ydCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ21ldGEnKTtcbiAgICAgICAgdmlld3BvcnQuc2V0QXR0cmlidXRlKCduYW1lJywgJ3ZpZXdwb3J0Jyk7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoZSBwcm9wZXJ0eSBhbHJlYWR5IGV4aXN0c1xuICAgICAgY29uc3QgaGFzUHJvcGVydHkgPSBpcy5zdHJpbmcodmlld3BvcnQuY29udGVudCkgJiYgdmlld3BvcnQuY29udGVudC5pbmNsdWRlcyhwcm9wZXJ0eSk7XG5cbiAgICAgIGlmICh0b2dnbGUpIHtcbiAgICAgICAgdGhpcy5jbGVhbnVwVmlld3BvcnQgPSAhaGFzUHJvcGVydHk7XG5cbiAgICAgICAgaWYgKCFoYXNQcm9wZXJ0eSkge1xuICAgICAgICAgIHZpZXdwb3J0LmNvbnRlbnQgKz0gYCwke3Byb3BlcnR5fWA7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodGhpcy5jbGVhbnVwVmlld3BvcnQpIHtcbiAgICAgICAgdmlld3BvcnQuY29udGVudCA9IHZpZXdwb3J0LmNvbnRlbnRcbiAgICAgICAgICAuc3BsaXQoJywnKVxuICAgICAgICAgIC5maWx0ZXIoKHBhcnQpID0+IHBhcnQudHJpbSgpICE9PSBwcm9wZXJ0eSlcbiAgICAgICAgICAuam9pbignLCcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFRvZ2dsZSBidXR0b24gYW5kIGZpcmUgZXZlbnRzXG4gICAgdGhpcy5vbkNoYW5nZSgpO1xuICB9O1xuXG4gIC8vIFRyYXAgZm9jdXMgaW5zaWRlIGNvbnRhaW5lclxuICB0cmFwRm9jdXMgPSAoZXZlbnQpID0+IHtcbiAgICAvLyBCYWlsIGlmIGlPUywgbm90IGFjdGl2ZSwgbm90IHRoZSB0YWIga2V5XG4gICAgaWYgKGJyb3dzZXIuaXNJb3MgfHwgIXRoaXMuYWN0aXZlIHx8IGV2ZW50LmtleSAhPT0gJ1RhYicpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgZm9jdXNlZCBlbGVtZW50XG4gICAgY29uc3QgZm9jdXNlZCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG4gICAgY29uc3QgZm9jdXNhYmxlID0gZ2V0RWxlbWVudHMuY2FsbCh0aGlzLnBsYXllciwgJ2FbaHJlZl0sIGJ1dHRvbjpub3QoOmRpc2FibGVkKSwgaW5wdXQ6bm90KDpkaXNhYmxlZCksIFt0YWJpbmRleF0nKTtcbiAgICBjb25zdCBbZmlyc3RdID0gZm9jdXNhYmxlO1xuICAgIGNvbnN0IGxhc3QgPSBmb2N1c2FibGVbZm9jdXNhYmxlLmxlbmd0aCAtIDFdO1xuXG4gICAgaWYgKGZvY3VzZWQgPT09IGxhc3QgJiYgIWV2ZW50LnNoaWZ0S2V5KSB7XG4gICAgICAvLyBNb3ZlIGZvY3VzIHRvIGZpcnN0IGVsZW1lbnQgdGhhdCBjYW4gYmUgdGFiYmVkIGlmIFNoaWZ0IGlzbid0IHVzZWRcbiAgICAgIGZpcnN0LmZvY3VzKCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0gZWxzZSBpZiAoZm9jdXNlZCA9PT0gZmlyc3QgJiYgZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgIC8vIE1vdmUgZm9jdXMgdG8gbGFzdCBlbGVtZW50IHRoYXQgY2FuIGJlIHRhYmJlZCBpZiBTaGlmdCBpcyB1c2VkXG4gICAgICBsYXN0LmZvY3VzKCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfTtcblxuICAvLyBVcGRhdGUgVUlcbiAgdXBkYXRlID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcbiAgICAgIGxldCBtb2RlO1xuXG4gICAgICBpZiAodGhpcy5mb3JjZUZhbGxiYWNrKSB7XG4gICAgICAgIG1vZGUgPSAnRmFsbGJhY2sgKGZvcmNlZCknO1xuICAgICAgfSBlbHNlIGlmIChGdWxsc2NyZWVuLm5hdGl2ZSkge1xuICAgICAgICBtb2RlID0gJ05hdGl2ZSc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtb2RlID0gJ0ZhbGxiYWNrJztcbiAgICAgIH1cblxuICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGAke21vZGV9IGZ1bGxzY3JlZW4gZW5hYmxlZGApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coJ0Z1bGxzY3JlZW4gbm90IHN1cHBvcnRlZCBhbmQgZmFsbGJhY2sgZGlzYWJsZWQnKTtcbiAgICB9XG5cbiAgICAvLyBBZGQgc3R5bGluZyBob29rIHRvIHNob3cgYnV0dG9uXG4gICAgdG9nZ2xlQ2xhc3ModGhpcy5wbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5mdWxsc2NyZWVuLmVuYWJsZWQsIHRoaXMuZW5hYmxlZCk7XG4gIH07XG5cbiAgLy8gTWFrZSBhbiBlbGVtZW50IGZ1bGxzY3JlZW5cbiAgZW50ZXIgPSAoKSA9PiB7XG4gICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBpT1MgbmF0aXZlIGZ1bGxzY3JlZW4gZG9lc24ndCBuZWVkIHRoZSByZXF1ZXN0IHN0ZXBcbiAgICBpZiAoYnJvd3Nlci5pc0lvcyAmJiB0aGlzLnBsYXllci5jb25maWcuZnVsbHNjcmVlbi5pb3NOYXRpdmUpIHtcbiAgICAgIGlmICh0aGlzLnBsYXllci5pc1ZpbWVvKSB7XG4gICAgICAgIHRoaXMucGxheWVyLmVtYmVkLnJlcXVlc3RGdWxsc2NyZWVuKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnRhcmdldC53ZWJraXRFbnRlckZ1bGxzY3JlZW4oKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKCFGdWxsc2NyZWVuLm5hdGl2ZSB8fCB0aGlzLmZvcmNlRmFsbGJhY2spIHtcbiAgICAgIHRoaXMudG9nZ2xlRmFsbGJhY2sodHJ1ZSk7XG4gICAgfSBlbHNlIGlmICghdGhpcy5wcmVmaXgpIHtcbiAgICAgIHRoaXMudGFyZ2V0LnJlcXVlc3RGdWxsc2NyZWVuKHsgbmF2aWdhdGlvblVJOiAnaGlkZScgfSk7XG4gICAgfSBlbHNlIGlmICghaXMuZW1wdHkodGhpcy5wcmVmaXgpKSB7XG4gICAgICB0aGlzLnRhcmdldFtgJHt0aGlzLnByZWZpeH1SZXF1ZXN0JHt0aGlzLnByb3BlcnR5fWBdKCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIEJhaWwgZnJvbSBmdWxsc2NyZWVuXG4gIGV4aXQgPSAoKSA9PiB7XG4gICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBpT1MgbmF0aXZlIGZ1bGxzY3JlZW5cbiAgICBpZiAoYnJvd3Nlci5pc0lvcyAmJiB0aGlzLnBsYXllci5jb25maWcuZnVsbHNjcmVlbi5pb3NOYXRpdmUpIHtcbiAgICAgIHRoaXMudGFyZ2V0LndlYmtpdEV4aXRGdWxsc2NyZWVuKCk7XG4gICAgICBzaWxlbmNlUHJvbWlzZSh0aGlzLnBsYXllci5wbGF5KCkpO1xuICAgIH0gZWxzZSBpZiAoIUZ1bGxzY3JlZW4ubmF0aXZlIHx8IHRoaXMuZm9yY2VGYWxsYmFjaykge1xuICAgICAgdGhpcy50b2dnbGVGYWxsYmFjayhmYWxzZSk7XG4gICAgfSBlbHNlIGlmICghdGhpcy5wcmVmaXgpIHtcbiAgICAgIChkb2N1bWVudC5jYW5jZWxGdWxsU2NyZWVuIHx8IGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKS5jYWxsKGRvY3VtZW50KTtcbiAgICB9IGVsc2UgaWYgKCFpcy5lbXB0eSh0aGlzLnByZWZpeCkpIHtcbiAgICAgIGNvbnN0IGFjdGlvbiA9IHRoaXMucHJlZml4ID09PSAnbW96JyA/ICdDYW5jZWwnIDogJ0V4aXQnO1xuICAgICAgZG9jdW1lbnRbYCR7dGhpcy5wcmVmaXh9JHthY3Rpb259JHt0aGlzLnByb3BlcnR5fWBdKCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIFRvZ2dsZSBzdGF0ZVxuICB0b2dnbGUgPSAoKSA9PiB7XG4gICAgaWYgKCF0aGlzLmFjdGl2ZSkge1xuICAgICAgdGhpcy5lbnRlcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmV4aXQoKTtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZ1bGxzY3JlZW47XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gTG9hZCBpbWFnZSBhdm9pZGluZyB4aHIvZmV0Y2ggQ09SUyBpc3N1ZXNcbi8vIFNlcnZlciBzdGF0dXMgY2FuJ3QgYmUgb2J0YWluZWQgdGhpcyB3YXkgdW5mb3J0dW5hdGVseSwgc28gdGhpcyB1c2VzIFwibmF0dXJhbFdpZHRoXCIgdG8gZGV0ZXJtaW5lIGlmIHRoZSBpbWFnZSBoYXMgbG9hZGVkXG4vLyBCeSBkZWZhdWx0IGl0IGNoZWNrcyBpZiBpdCBpcyBhdCBsZWFzdCAxcHgsIGJ1dCB5b3UgY2FuIGFkZCBhIHNlY29uZCBhcmd1bWVudCB0byBjaGFuZ2UgdGhpc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbG9hZEltYWdlKHNyYywgbWluV2lkdGggPSAxKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3QgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcblxuICAgIGNvbnN0IGhhbmRsZXIgPSAoKSA9PiB7XG4gICAgICBkZWxldGUgaW1hZ2Uub25sb2FkO1xuICAgICAgZGVsZXRlIGltYWdlLm9uZXJyb3I7XG4gICAgICAoaW1hZ2UubmF0dXJhbFdpZHRoID49IG1pbldpZHRoID8gcmVzb2x2ZSA6IHJlamVjdCkoaW1hZ2UpO1xuICAgIH07XG5cbiAgICBPYmplY3QuYXNzaWduKGltYWdlLCB7IG9ubG9hZDogaGFuZGxlciwgb25lcnJvcjogaGFuZGxlciwgc3JjIH0pO1xuICB9KTtcbn1cbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIFVJXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgY2FwdGlvbnMgZnJvbSAnLi9jYXB0aW9ucyc7XG5pbXBvcnQgY29udHJvbHMgZnJvbSAnLi9jb250cm9scyc7XG5pbXBvcnQgc3VwcG9ydCBmcm9tICcuL3N1cHBvcnQnO1xuaW1wb3J0IGJyb3dzZXIgZnJvbSAnLi91dGlscy9icm93c2VyJztcbmltcG9ydCB7IGdldEVsZW1lbnQsIHRvZ2dsZUNsYXNzIH0gZnJvbSAnLi91dGlscy9lbGVtZW50cyc7XG5pbXBvcnQgeyByZWFkeSwgdHJpZ2dlckV2ZW50IH0gZnJvbSAnLi91dGlscy9ldmVudHMnO1xuaW1wb3J0IGkxOG4gZnJvbSAnLi91dGlscy9pMThuJztcbmltcG9ydCBpcyBmcm9tICcuL3V0aWxzL2lzJztcbmltcG9ydCBsb2FkSW1hZ2UgZnJvbSAnLi91dGlscy9sb2FkLWltYWdlJztcblxuY29uc3QgdWkgPSB7XG4gIGFkZFN0eWxlSG9vaygpIHtcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuc2VsZWN0b3JzLmNvbnRhaW5lci5yZXBsYWNlKCcuJywgJycpLCB0cnVlKTtcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy51aVN1cHBvcnRlZCwgdGhpcy5zdXBwb3J0ZWQudWkpO1xuICB9LFxuXG4gIC8vIFRvZ2dsZSBuYXRpdmUgSFRNTDUgbWVkaWEgY29udHJvbHNcbiAgdG9nZ2xlTmF0aXZlQ29udHJvbHModG9nZ2xlID0gZmFsc2UpIHtcbiAgICBpZiAodG9nZ2xlICYmIHRoaXMuaXNIVE1MNSkge1xuICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ2NvbnRyb2xzJywgJycpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1lZGlhLnJlbW92ZUF0dHJpYnV0ZSgnY29udHJvbHMnKTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gU2V0dXAgdGhlIFVJXG4gIGJ1aWxkKCkge1xuICAgIC8vIFJlLWF0dGFjaCBtZWRpYSBlbGVtZW50IGxpc3RlbmVyc1xuICAgIC8vIFRPRE86IFVzZSBldmVudCBidWJibGluZz9cbiAgICB0aGlzLmxpc3RlbmVycy5tZWRpYSgpO1xuXG4gICAgLy8gRG9uJ3Qgc2V0dXAgaW50ZXJmYWNlIGlmIG5vIHN1cHBvcnRcbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLnVpKSB7XG4gICAgICB0aGlzLmRlYnVnLndhcm4oYEJhc2ljIHN1cHBvcnQgb25seSBmb3IgJHt0aGlzLnByb3ZpZGVyfSAke3RoaXMudHlwZX1gKTtcblxuICAgICAgLy8gUmVzdG9yZSBuYXRpdmUgY29udHJvbHNcbiAgICAgIHVpLnRvZ2dsZU5hdGl2ZUNvbnRyb2xzLmNhbGwodGhpcywgdHJ1ZSk7XG5cbiAgICAgIC8vIEJhaWxcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBJbmplY3QgY3VzdG9tIGNvbnRyb2xzIGlmIG5vdCBwcmVzZW50XG4gICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY29udHJvbHMpKSB7XG4gICAgICAvLyBJbmplY3QgY3VzdG9tIGNvbnRyb2xzXG4gICAgICBjb250cm9scy5pbmplY3QuY2FsbCh0aGlzKTtcblxuICAgICAgLy8gUmUtYXR0YWNoIGNvbnRyb2wgbGlzdGVuZXJzXG4gICAgICB0aGlzLmxpc3RlbmVycy5jb250cm9scygpO1xuICAgIH1cblxuICAgIC8vIFJlbW92ZSBuYXRpdmUgY29udHJvbHNcbiAgICB1aS50b2dnbGVOYXRpdmVDb250cm9scy5jYWxsKHRoaXMpO1xuXG4gICAgLy8gU2V0dXAgY2FwdGlvbnMgZm9yIEhUTUw1XG4gICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgY2FwdGlvbnMuc2V0dXAuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBSZXNldCB2b2x1bWVcbiAgICB0aGlzLnZvbHVtZSA9IG51bGw7XG5cbiAgICAvLyBSZXNldCBtdXRlIHN0YXRlXG4gICAgdGhpcy5tdXRlZCA9IG51bGw7XG5cbiAgICAvLyBSZXNldCBsb29wIHN0YXRlXG4gICAgdGhpcy5sb29wID0gbnVsbDtcblxuICAgIC8vIFJlc2V0IHF1YWxpdHkgc2V0dGluZ1xuICAgIHRoaXMucXVhbGl0eSA9IG51bGw7XG5cbiAgICAvLyBSZXNldCBzcGVlZFxuICAgIHRoaXMuc3BlZWQgPSBudWxsO1xuXG4gICAgLy8gUmVzZXQgdm9sdW1lIGRpc3BsYXlcbiAgICBjb250cm9scy51cGRhdGVWb2x1bWUuY2FsbCh0aGlzKTtcblxuICAgIC8vIFJlc2V0IHRpbWUgZGlzcGxheVxuICAgIGNvbnRyb2xzLnRpbWVVcGRhdGUuY2FsbCh0aGlzKTtcblxuICAgIC8vIFJlc2V0IGR1cmF0aW9uIGRpc3BsYXlcbiAgICBjb250cm9scy5kdXJhdGlvblVwZGF0ZS5jYWxsKHRoaXMpO1xuXG4gICAgLy8gVXBkYXRlIHRoZSBVSVxuICAgIHVpLmNoZWNrUGxheWluZy5jYWxsKHRoaXMpO1xuXG4gICAgLy8gQ2hlY2sgZm9yIHBpY3R1cmUtaW4tcGljdHVyZSBzdXBwb3J0XG4gICAgdG9nZ2xlQ2xhc3MoXG4gICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcixcbiAgICAgIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMucGlwLnN1cHBvcnRlZCxcbiAgICAgIHN1cHBvcnQucGlwICYmIHRoaXMuaXNIVE1MNSAmJiB0aGlzLmlzVmlkZW8sXG4gICAgKTtcblxuICAgIC8vIENoZWNrIGZvciBhaXJwbGF5IHN1cHBvcnRcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5haXJwbGF5LnN1cHBvcnRlZCwgc3VwcG9ydC5haXJwbGF5ICYmIHRoaXMuaXNIVE1MNSk7XG5cbiAgICAvLyBBZGQgaU9TIGNsYXNzXG4gICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaXNJb3MsIGJyb3dzZXIuaXNJb3MpO1xuXG4gICAgLy8gQWRkIHRvdWNoIGNsYXNzXG4gICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaXNUb3VjaCwgdGhpcy50b3VjaCk7XG5cbiAgICAvLyBSZWFkeSBmb3IgQVBJIGNhbGxzXG4gICAgdGhpcy5yZWFkeSA9IHRydWU7XG5cbiAgICAvLyBSZWFkeSBldmVudCBhdCBlbmQgb2YgZXhlY3V0aW9uIHN0YWNrXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCAncmVhZHknKTtcbiAgICB9LCAwKTtcblxuICAgIC8vIFNldCB0aGUgdGl0bGVcbiAgICB1aS5zZXRUaXRsZS5jYWxsKHRoaXMpO1xuXG4gICAgLy8gQXNzdXJlIHRoZSBwb3N0ZXIgaW1hZ2UgaXMgc2V0LCBpZiB0aGUgcHJvcGVydHkgd2FzIGFkZGVkIGJlZm9yZSB0aGUgZWxlbWVudCB3YXMgY3JlYXRlZFxuICAgIGlmICh0aGlzLnBvc3Rlcikge1xuICAgICAgdWkuc2V0UG9zdGVyLmNhbGwodGhpcywgdGhpcy5wb3N0ZXIsIGZhbHNlKS5jYXRjaCgoKSA9PiB7fSk7XG4gICAgfVxuXG4gICAgLy8gTWFudWFsbHkgc2V0IHRoZSBkdXJhdGlvbiBpZiB1c2VyIGhhcyBvdmVycmlkZGVuIGl0LlxuICAgIC8vIFRoZSBldmVudCBsaXN0ZW5lcnMgZm9yIGl0IGRvZXNuJ3QgZ2V0IGNhbGxlZCBpZiBwcmVsb2FkIGlzIGRpc2FibGVkICgjNzAxKVxuICAgIGlmICh0aGlzLmNvbmZpZy5kdXJhdGlvbikge1xuICAgICAgY29udHJvbHMuZHVyYXRpb25VcGRhdGUuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBNZWRpYSBtZXRhZGF0YVxuICAgIGlmICh0aGlzLmNvbmZpZy5tZWRpYU1ldGFkYXRhKSB7XG4gICAgICBjb250cm9scy5zZXRNZWRpYU1ldGFkYXRhLmNhbGwodGhpcyk7XG4gICAgfVxuICB9LFxuXG4gIC8vIFNldHVwIGFyaWEgYXR0cmlidXRlIGZvciBwbGF5IGFuZCBpZnJhbWUgdGl0bGVcbiAgc2V0VGl0bGUoKSB7XG4gICAgLy8gRmluZCB0aGUgY3VycmVudCB0ZXh0XG4gICAgbGV0IGxhYmVsID0gaTE4bi5nZXQoJ3BsYXknLCB0aGlzLmNvbmZpZyk7XG5cbiAgICAvLyBJZiB0aGVyZSdzIGEgbWVkaWEgdGl0bGUgc2V0LCB1c2UgdGhhdCBmb3IgdGhlIGxhYmVsXG4gICAgaWYgKGlzLnN0cmluZyh0aGlzLmNvbmZpZy50aXRsZSkgJiYgIWlzLmVtcHR5KHRoaXMuY29uZmlnLnRpdGxlKSkge1xuICAgICAgbGFiZWwgKz0gYCwgJHt0aGlzLmNvbmZpZy50aXRsZX1gO1xuICAgIH1cblxuICAgIC8vIElmIHRoZXJlJ3MgYSBwbGF5IGJ1dHRvbiwgc2V0IGxhYmVsXG4gICAgQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnRzLmJ1dHRvbnMucGxheSB8fCBbXSkuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gICAgICBidXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgbGFiZWwpO1xuICAgIH0pO1xuXG4gICAgLy8gU2V0IGlmcmFtZSB0aXRsZVxuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy8xMjRcbiAgICBpZiAodGhpcy5pc0VtYmVkKSB7XG4gICAgICBjb25zdCBpZnJhbWUgPSBnZXRFbGVtZW50LmNhbGwodGhpcywgJ2lmcmFtZScpO1xuXG4gICAgICBpZiAoIWlzLmVsZW1lbnQoaWZyYW1lKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIERlZmF1bHQgdG8gbWVkaWEgdHlwZVxuICAgICAgY29uc3QgdGl0bGUgPSAhaXMuZW1wdHkodGhpcy5jb25maWcudGl0bGUpID8gdGhpcy5jb25maWcudGl0bGUgOiAndmlkZW8nO1xuICAgICAgY29uc3QgZm9ybWF0ID0gaTE4bi5nZXQoJ2ZyYW1lVGl0bGUnLCB0aGlzLmNvbmZpZyk7XG5cbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZm9ybWF0LnJlcGxhY2UoJ3t0aXRsZX0nLCB0aXRsZSkpO1xuICAgIH1cbiAgfSxcblxuICAvLyBUb2dnbGUgcG9zdGVyXG4gIHRvZ2dsZVBvc3RlcihlbmFibGUpIHtcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5wb3N0ZXJFbmFibGVkLCBlbmFibGUpO1xuICB9LFxuXG4gIC8vIFNldCB0aGUgcG9zdGVyIGltYWdlIChhc3luYylcbiAgLy8gVXNlZCBpbnRlcm5hbGx5IGZvciB0aGUgcG9zdGVyIHNldHRlciwgd2l0aCB0aGUgcGFzc2l2ZSBvcHRpb24gZm9yY2VkIHRvIGZhbHNlXG4gIHNldFBvc3Rlcihwb3N0ZXIsIHBhc3NpdmUgPSB0cnVlKSB7XG4gICAgLy8gRG9uJ3Qgb3ZlcnJpZGUgaWYgY2FsbCBpcyBwYXNzaXZlXG4gICAgaWYgKHBhc3NpdmUgJiYgdGhpcy5wb3N0ZXIpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1Bvc3RlciBhbHJlYWR5IHNldCcpKTtcbiAgICB9XG5cbiAgICAvLyBTZXQgcHJvcGVydHkgc3luY2hyb25vdXNseSB0byByZXNwZWN0IHRoZSBjYWxsIG9yZGVyXG4gICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ2RhdGEtcG9zdGVyJywgcG9zdGVyKTtcblxuICAgIC8vIFNob3cgdGhlIHBvc3RlclxuICAgIHRoaXMuZWxlbWVudHMucG9zdGVyLnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7XG5cbiAgICAvLyBXYWl0IHVudGlsIHVpIGlzIHJlYWR5XG4gICAgcmV0dXJuIChcbiAgICAgIHJlYWR5XG4gICAgICAgIC5jYWxsKHRoaXMpXG4gICAgICAgIC8vIExvYWQgaW1hZ2VcbiAgICAgICAgLnRoZW4oKCkgPT4gbG9hZEltYWdlKHBvc3RlcikpXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAvLyBIaWRlIHBvc3RlciBvbiBlcnJvciB1bmxlc3MgaXQncyBiZWVuIHNldCBieSBhbm90aGVyIGNhbGxcbiAgICAgICAgICBpZiAocG9zdGVyID09PSB0aGlzLnBvc3Rlcikge1xuICAgICAgICAgICAgdWkudG9nZ2xlUG9zdGVyLmNhbGwodGhpcywgZmFsc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBSZXRocm93XG4gICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAvLyBQcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xuICAgICAgICAgIGlmIChwb3N0ZXIgIT09IHRoaXMucG9zdGVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFBvc3RlciBjYW5jZWxsZWQgYnkgbGF0ZXIgY2FsbCB0byBzZXRQb3N0ZXInKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZWxlbWVudHMucG9zdGVyLnN0eWxlLCB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6IGB1cmwoJyR7cG9zdGVyfScpYCxcbiAgICAgICAgICAgIC8vIFJlc2V0IGJhY2tncm91bmRTaXplIGFzIHdlbGwgKHNpbmNlIGl0IGNhbiBiZSBzZXQgdG8gXCJjb3ZlclwiIGZvciBwYWRkZWQgdGh1bWJuYWlscyBmb3IgeW91dHViZSlcbiAgICAgICAgICAgIGJhY2tncm91bmRTaXplOiAnJyxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHVpLnRvZ2dsZVBvc3Rlci5jYWxsKHRoaXMsIHRydWUpO1xuXG4gICAgICAgICAgcmV0dXJuIHBvc3RlcjtcbiAgICAgICAgfSlcbiAgICApO1xuICB9LFxuXG4gIC8vIENoZWNrIHBsYXlpbmcgc3RhdGVcbiAgY2hlY2tQbGF5aW5nKGV2ZW50KSB7XG4gICAgLy8gQ2xhc3MgaG9va3NcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5wbGF5aW5nLCB0aGlzLnBsYXlpbmcpO1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnBhdXNlZCwgdGhpcy5wYXVzZWQpO1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnN0b3BwZWQsIHRoaXMuc3RvcHBlZCk7XG5cbiAgICAvLyBTZXQgc3RhdGVcbiAgICBBcnJheS5mcm9tKHRoaXMuZWxlbWVudHMuYnV0dG9ucy5wbGF5IHx8IFtdKS5mb3JFYWNoKCh0YXJnZXQpID0+IHtcbiAgICAgIE9iamVjdC5hc3NpZ24odGFyZ2V0LCB7IHByZXNzZWQ6IHRoaXMucGxheWluZyB9KTtcbiAgICAgIHRhcmdldC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBpMThuLmdldCh0aGlzLnBsYXlpbmcgPyAncGF1c2UnIDogJ3BsYXknLCB0aGlzLmNvbmZpZykpO1xuICAgIH0pO1xuXG4gICAgLy8gT25seSB1cGRhdGUgY29udHJvbHMgb24gbm9uIHRpbWV1cGRhdGUgZXZlbnRzXG4gICAgaWYgKGlzLmV2ZW50KGV2ZW50KSAmJiBldmVudC50eXBlID09PSAndGltZXVwZGF0ZScpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBUb2dnbGUgY29udHJvbHNcbiAgICB1aS50b2dnbGVDb250cm9scy5jYWxsKHRoaXMpO1xuICB9LFxuXG4gIC8vIENoZWNrIGlmIG1lZGlhIGlzIGxvYWRpbmdcbiAgY2hlY2tMb2FkaW5nKGV2ZW50KSB7XG4gICAgdGhpcy5sb2FkaW5nID0gWydzdGFsbGVkJywgJ3dhaXRpbmcnXS5pbmNsdWRlcyhldmVudC50eXBlKTtcblxuICAgIC8vIENsZWFyIHRpbWVyXG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmxvYWRpbmcpO1xuXG4gICAgLy8gVGltZXIgdG8gcHJldmVudCBmbGlja2VyIHdoZW4gc2Vla2luZ1xuICAgIHRoaXMudGltZXJzLmxvYWRpbmcgPSBzZXRUaW1lb3V0KFxuICAgICAgKCkgPT4ge1xuICAgICAgICAvLyBVcGRhdGUgcHJvZ3Jlc3MgYmFyIGxvYWRpbmcgY2xhc3Mgc3RhdGVcbiAgICAgICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMubG9hZGluZywgdGhpcy5sb2FkaW5nKTtcblxuICAgICAgICAvLyBVcGRhdGUgY29udHJvbHMgdmlzaWJpbGl0eVxuICAgICAgICB1aS50b2dnbGVDb250cm9scy5jYWxsKHRoaXMpO1xuICAgICAgfSxcbiAgICAgIHRoaXMubG9hZGluZyA/IDI1MCA6IDAsXG4gICAgKTtcbiAgfSxcblxuICAvLyBUb2dnbGUgY29udHJvbHMgYmFzZWQgb24gc3RhdGUgYW5kIGBmb3JjZWAgYXJndW1lbnRcbiAgdG9nZ2xlQ29udHJvbHMoZm9yY2UpIHtcbiAgICBjb25zdCB7IGNvbnRyb2xzOiBjb250cm9sc0VsZW1lbnQgfSA9IHRoaXMuZWxlbWVudHM7XG5cbiAgICBpZiAoY29udHJvbHNFbGVtZW50ICYmIHRoaXMuY29uZmlnLmhpZGVDb250cm9scykge1xuICAgICAgLy8gRG9uJ3QgaGlkZSBjb250cm9scyBpZiBhIHRvdWNoLWRldmljZSB1c2VyIHJlY2VudGx5IHNlZWtlZC4gKE11c3QgYmUgbGltaXRlZCB0byB0b3VjaCBkZXZpY2VzLCBvciBpdCBvY2Nhc2lvbmFsbHkgcHJldmVudHMgZGVza3RvcCBjb250cm9scyBmcm9tIGhpZGluZy4pXG4gICAgICBjb25zdCByZWNlbnRUb3VjaFNlZWsgPSB0aGlzLnRvdWNoICYmIHRoaXMubGFzdFNlZWtUaW1lICsgMjAwMCA+IERhdGUubm93KCk7XG5cbiAgICAgIC8vIFNob3cgY29udHJvbHMgaWYgZm9yY2UsIGxvYWRpbmcsIHBhdXNlZCwgYnV0dG9uIGludGVyYWN0aW9uLCBvciByZWNlbnQgc2Vlaywgb3RoZXJ3aXNlIGhpZGVcbiAgICAgIHRoaXMudG9nZ2xlQ29udHJvbHMoXG4gICAgICAgIEJvb2xlYW4oXG4gICAgICAgICAgZm9yY2UgfHwgdGhpcy5sb2FkaW5nIHx8IHRoaXMucGF1c2VkIHx8IGNvbnRyb2xzRWxlbWVudC5wcmVzc2VkIHx8IGNvbnRyb2xzRWxlbWVudC5ob3ZlciB8fCByZWNlbnRUb3VjaFNlZWssXG4gICAgICAgICksXG4gICAgICApO1xuICAgIH1cbiAgfSxcblxuICAvLyBNaWdyYXRlIGFueSBjdXN0b20gcHJvcGVydGllcyBmcm9tIHRoZSBtZWRpYSB0byB0aGUgcGFyZW50XG4gIG1pZ3JhdGVTdHlsZXMoKSB7XG4gICAgLy8gTG9vcCB0aHJvdWdoIHZhbHVlcyAoYXMgdGhleSBhcmUgdGhlIGtleXMgd2hlbiB0aGUgb2JqZWN0IGlzIHNwcmVhZCDwn6SUKVxuICAgIE9iamVjdC52YWx1ZXMoeyAuLi50aGlzLm1lZGlhLnN0eWxlIH0pXG4gICAgICAvLyBXZSdyZSBvbmx5IGZ1c3NlZCBhYm91dCBQbHlyIHNwZWNpZmljIHByb3BlcnRpZXNcbiAgICAgIC5maWx0ZXIoKGtleSkgPT4gIWlzLmVtcHR5KGtleSkgJiYgaXMuc3RyaW5nKGtleSkgJiYga2V5LnN0YXJ0c1dpdGgoJy0tcGx5cicpKVxuICAgICAgLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAvLyBTZXQgb24gdGhlIGNvbnRhaW5lclxuICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHRoaXMubWVkaWEuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShrZXkpKTtcblxuICAgICAgICAvLyBDbGVhbiB1cCBmcm9tIG1lZGlhIGVsZW1lbnRcbiAgICAgICAgdGhpcy5tZWRpYS5zdHlsZS5yZW1vdmVQcm9wZXJ0eShrZXkpO1xuICAgICAgfSk7XG5cbiAgICAvLyBSZW1vdmUgYXR0cmlidXRlIGlmIGVtcHR5XG4gICAgaWYgKGlzLmVtcHR5KHRoaXMubWVkaWEuc3R5bGUpKSB7XG4gICAgICB0aGlzLm1lZGlhLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICB9XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCB1aTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIEV2ZW50IExpc3RlbmVyc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IGNvbnRyb2xzIGZyb20gJy4vY29udHJvbHMnO1xuaW1wb3J0IHVpIGZyb20gJy4vdWknO1xuaW1wb3J0IHsgcmVwYWludCB9IGZyb20gJy4vdXRpbHMvYW5pbWF0aW9uJztcbmltcG9ydCBicm93c2VyIGZyb20gJy4vdXRpbHMvYnJvd3Nlcic7XG5pbXBvcnQgeyBnZXRFbGVtZW50LCBnZXRFbGVtZW50cywgbWF0Y2hlcywgdG9nZ2xlQ2xhc3MgfSBmcm9tICcuL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IG9mZiwgb24sIG9uY2UsIHRvZ2dsZUxpc3RlbmVyLCB0cmlnZ2VyRXZlbnQgfSBmcm9tICcuL3V0aWxzL2V2ZW50cyc7XG5pbXBvcnQgaXMgZnJvbSAnLi91dGlscy9pcyc7XG5pbXBvcnQgeyBzaWxlbmNlUHJvbWlzZSB9IGZyb20gJy4vdXRpbHMvcHJvbWlzZSc7XG5pbXBvcnQgeyBnZXRBc3BlY3RSYXRpbywgZ2V0Vmlld3BvcnRTaXplLCBzdXBwb3J0c0NTUyB9IGZyb20gJy4vdXRpbHMvc3R5bGUnO1xuXG5jbGFzcyBMaXN0ZW5lcnMge1xuICBjb25zdHJ1Y3RvcihwbGF5ZXIpIHtcbiAgICB0aGlzLnBsYXllciA9IHBsYXllcjtcbiAgICB0aGlzLmxhc3RLZXkgPSBudWxsO1xuICAgIHRoaXMuZm9jdXNUaW1lciA9IG51bGw7XG4gICAgdGhpcy5sYXN0S2V5RG93biA9IG51bGw7XG5cbiAgICB0aGlzLmhhbmRsZUtleSA9IHRoaXMuaGFuZGxlS2V5LmJpbmQodGhpcyk7XG4gICAgdGhpcy50b2dnbGVNZW51ID0gdGhpcy50b2dnbGVNZW51LmJpbmQodGhpcyk7XG4gICAgdGhpcy5zZXRUYWJGb2N1cyA9IHRoaXMuc2V0VGFiRm9jdXMuYmluZCh0aGlzKTtcbiAgICB0aGlzLmZpcnN0VG91Y2ggPSB0aGlzLmZpcnN0VG91Y2guYmluZCh0aGlzKTtcbiAgfVxuXG4gIC8vIEhhbmRsZSBrZXkgcHJlc3Nlc1xuICBoYW5kbGVLZXkoZXZlbnQpIHtcbiAgICBjb25zdCB7IHBsYXllciB9ID0gdGhpcztcbiAgICBjb25zdCB7IGVsZW1lbnRzIH0gPSBwbGF5ZXI7XG4gICAgY29uc3QgeyBrZXksIHR5cGUsIGFsdEtleSwgY3RybEtleSwgbWV0YUtleSwgc2hpZnRLZXkgfSA9IGV2ZW50O1xuICAgIGNvbnN0IHByZXNzZWQgPSB0eXBlID09PSAna2V5ZG93bic7XG4gICAgY29uc3QgcmVwZWF0ID0gcHJlc3NlZCAmJiBrZXkgPT09IHRoaXMubGFzdEtleTtcblxuICAgIC8vIEJhaWwgaWYgYSBtb2RpZmllciBrZXkgaXMgc2V0XG4gICAgaWYgKGFsdEtleSB8fCBjdHJsS2V5IHx8IG1ldGFLZXkgfHwgc2hpZnRLZXkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgZXZlbnQgaXMgYnViYmxlZCBmcm9tIHRoZSBtZWRpYSBlbGVtZW50XG4gICAgLy8gRmlyZWZveCBkb2Vzbid0IGdldCB0aGUga2V5IGZvciB3aGF0ZXZlciByZWFzb25cbiAgICBpZiAoIWtleSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFNlZWsgYnkgaW5jcmVtZW50XG4gICAgY29uc3Qgc2Vla0J5SW5jcmVtZW50ID0gKGluY3JlbWVudCkgPT4ge1xuICAgICAgLy8gRGl2aWRlIHRoZSBtYXggZHVyYXRpb24gaW50byAxMHRoJ3MgYW5kIHRpbWVzIGJ5IHRoZSBudW1iZXIgdmFsdWVcbiAgICAgIHBsYXllci5jdXJyZW50VGltZSA9IChwbGF5ZXIuZHVyYXRpb24gLyAxMCkgKiBpbmNyZW1lbnQ7XG4gICAgfTtcblxuICAgIC8vIEhhbmRsZSB0aGUga2V5IG9uIGtleWRvd25cbiAgICAvLyBSZXNldCBvbiBrZXl1cFxuICAgIGlmIChwcmVzc2VkKSB7XG4gICAgICAvLyBDaGVjayBmb2N1c2VkIGVsZW1lbnRcbiAgICAgIC8vIGFuZCBpZiB0aGUgZm9jdXNlZCBlbGVtZW50IGlzIG5vdCBlZGl0YWJsZSAoZS5nLiB0ZXh0IGlucHV0KVxuICAgICAgLy8gYW5kIGFueSB0aGF0IGFjY2VwdCBrZXkgaW5wdXQgaHR0cDovL3dlYmFpbS5vcmcvdGVjaG5pcXVlcy9rZXlib2FyZC9cbiAgICAgIGNvbnN0IGZvY3VzZWQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgICAgaWYgKGlzLmVsZW1lbnQoZm9jdXNlZCkpIHtcbiAgICAgICAgY29uc3QgeyBlZGl0YWJsZSB9ID0gcGxheWVyLmNvbmZpZy5zZWxlY3RvcnM7XG4gICAgICAgIGNvbnN0IHsgc2VlayB9ID0gZWxlbWVudHMuaW5wdXRzO1xuXG4gICAgICAgIGlmIChmb2N1c2VkICE9PSBzZWVrICYmIG1hdGNoZXMoZm9jdXNlZCwgZWRpdGFibGUpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ1NwYWNlJyAmJiBtYXRjaGVzKGZvY3VzZWQsICdidXR0b24sIFtyb2xlXj1cIm1lbnVpdGVtXCJdJykpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gV2hpY2gga2V5cyBzaG91bGQgd2UgcHJldmVudCBkZWZhdWx0XG4gICAgICBjb25zdCBwcmV2ZW50RGVmYXVsdCA9IFtcbiAgICAgICAgJ1NwYWNlJyxcbiAgICAgICAgJ0Fycm93TGVmdCcsXG4gICAgICAgICdBcnJvd1VwJyxcbiAgICAgICAgJ0Fycm93UmlnaHQnLFxuICAgICAgICAnQXJyb3dEb3duJyxcblxuICAgICAgICAnMCcsXG4gICAgICAgICcxJyxcbiAgICAgICAgJzInLFxuICAgICAgICAnMycsXG4gICAgICAgICc0JyxcbiAgICAgICAgJzUnLFxuICAgICAgICAnNicsXG4gICAgICAgICc3JyxcbiAgICAgICAgJzgnLFxuICAgICAgICAnOScsXG5cbiAgICAgICAgJ2MnLFxuICAgICAgICAnZicsXG4gICAgICAgICdrJyxcbiAgICAgICAgJ2wnLFxuICAgICAgICAnbScsXG4gICAgICBdO1xuXG4gICAgICAvLyBJZiB0aGUga2V5IGlzIGZvdW5kIHByZXZlbnQgZGVmYXVsdCAoZS5nLiBwcmV2ZW50IHNjcm9sbGluZyBmb3IgYXJyb3dzKVxuICAgICAgaWYgKHByZXZlbnREZWZhdWx0LmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB9XG5cbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgIGNhc2UgJzAnOlxuICAgICAgICBjYXNlICcxJzpcbiAgICAgICAgY2FzZSAnMic6XG4gICAgICAgIGNhc2UgJzMnOlxuICAgICAgICBjYXNlICc0JzpcbiAgICAgICAgY2FzZSAnNSc6XG4gICAgICAgIGNhc2UgJzYnOlxuICAgICAgICBjYXNlICc3JzpcbiAgICAgICAgY2FzZSAnOCc6XG4gICAgICAgIGNhc2UgJzknOlxuICAgICAgICAgIGlmICghcmVwZWF0KSB7XG4gICAgICAgICAgICBzZWVrQnlJbmNyZW1lbnQocGFyc2VJbnQoa2V5LCAxMCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdTcGFjZSc6XG4gICAgICAgIGNhc2UgJ2snOlxuICAgICAgICAgIGlmICghcmVwZWF0KSB7XG4gICAgICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIudG9nZ2xlUGxheSgpKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgcGxheWVyLmluY3JlYXNlVm9sdW1lKDAuMSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgICBwbGF5ZXIuZGVjcmVhc2VWb2x1bWUoMC4xKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdtJzpcbiAgICAgICAgICBpZiAoIXJlcGVhdCkge1xuICAgICAgICAgICAgcGxheWVyLm11dGVkID0gIXBsYXllci5tdXRlZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnQXJyb3dSaWdodCc6XG4gICAgICAgICAgcGxheWVyLmZvcndhcmQoKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdBcnJvd0xlZnQnOlxuICAgICAgICAgIHBsYXllci5yZXdpbmQoKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdmJzpcbiAgICAgICAgICBwbGF5ZXIuZnVsbHNjcmVlbi50b2dnbGUoKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdjJzpcbiAgICAgICAgICBpZiAoIXJlcGVhdCkge1xuICAgICAgICAgICAgcGxheWVyLnRvZ2dsZUNhcHRpb25zKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2wnOlxuICAgICAgICAgIHBsYXllci5sb29wID0gIXBsYXllci5sb29wO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIC8vIEVzY2FwZSBpcyBoYW5kbGUgbmF0aXZlbHkgd2hlbiBpbiBmdWxsIHNjcmVlblxuICAgICAgLy8gU28gd2Ugb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IG5vbiBuYXRpdmVcbiAgICAgIGlmIChrZXkgPT09ICdFc2NhcGUnICYmICFwbGF5ZXIuZnVsbHNjcmVlbi51c2luZ05hdGl2ZSAmJiBwbGF5ZXIuZnVsbHNjcmVlbi5hY3RpdmUpIHtcbiAgICAgICAgcGxheWVyLmZ1bGxzY3JlZW4udG9nZ2xlKCk7XG4gICAgICB9XG5cbiAgICAgIC8vIFN0b3JlIGxhc3Qga2V5IGZvciBuZXh0IGN5Y2xlXG4gICAgICB0aGlzLmxhc3RLZXkgPSBrZXk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubGFzdEtleSA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgLy8gVG9nZ2xlIG1lbnVcbiAgdG9nZ2xlTWVudShldmVudCkge1xuICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnUuY2FsbCh0aGlzLnBsYXllciwgZXZlbnQpO1xuICB9XG5cbiAgLy8gRGV2aWNlIGlzIHRvdWNoIGVuYWJsZWRcbiAgZmlyc3RUb3VjaCA9ICgpID0+IHtcbiAgICBjb25zdCB7IHBsYXllciB9ID0gdGhpcztcbiAgICBjb25zdCB7IGVsZW1lbnRzIH0gPSBwbGF5ZXI7XG5cbiAgICBwbGF5ZXIudG91Y2ggPSB0cnVlO1xuXG4gICAgLy8gQWRkIHRvdWNoIGNsYXNzXG4gICAgdG9nZ2xlQ2xhc3MoZWxlbWVudHMuY29udGFpbmVyLCBwbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMuaXNUb3VjaCwgdHJ1ZSk7XG4gIH07XG5cbiAgc2V0VGFiRm9jdXMgPSAoZXZlbnQpID0+IHtcbiAgICBjb25zdCB7IHBsYXllciB9ID0gdGhpcztcbiAgICBjb25zdCB7IGVsZW1lbnRzIH0gPSBwbGF5ZXI7XG4gICAgY29uc3QgeyBrZXksIHR5cGUsIHRpbWVTdGFtcCB9ID0gZXZlbnQ7XG5cbiAgICBjbGVhclRpbWVvdXQodGhpcy5mb2N1c1RpbWVyKTtcblxuICAgIC8vIElnbm9yZSBhbnkga2V5IG90aGVyIHRoYW4gdGFiXG4gICAgaWYgKHR5cGUgPT09ICdrZXlkb3duJyAmJiBrZXkgIT09ICdUYWInKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gU3RvcmUgcmVmZXJlbmNlIHRvIGV2ZW50IHRpbWVTdGFtcFxuICAgIGlmICh0eXBlID09PSAna2V5ZG93bicpIHtcbiAgICAgIHRoaXMubGFzdEtleURvd24gPSB0aW1lU3RhbXA7XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIGN1cnJlbnQgY2xhc3Nlc1xuICAgIGNvbnN0IHJlbW92ZUN1cnJlbnQgPSAoKSA9PiB7XG4gICAgICBjb25zdCBjbGFzc05hbWUgPSBwbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMudGFiRm9jdXM7XG4gICAgICBjb25zdCBjdXJyZW50ID0gZ2V0RWxlbWVudHMuY2FsbChwbGF5ZXIsIGAuJHtjbGFzc05hbWV9YCk7XG4gICAgICB0b2dnbGVDbGFzcyhjdXJyZW50LCBjbGFzc05hbWUsIGZhbHNlKTtcbiAgICB9O1xuXG4gICAgLy8gRGV0ZXJtaW5lIGlmIGEga2V5IHdhcyBwcmVzc2VkIHRvIHRyaWdnZXIgdGhpcyBldmVudFxuICAgIGNvbnN0IHdhc0tleURvd24gPSB0aW1lU3RhbXAgLSB0aGlzLmxhc3RLZXlEb3duIDw9IDIwO1xuXG4gICAgLy8gSWdub3JlIGZvY3VzIGV2ZW50cyBpZiBhIGtleSB3YXMgcHJlc3NlZCBwcmlvclxuICAgIGlmICh0eXBlID09PSAnZm9jdXMnICYmICF3YXNLZXlEb3duKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIGFsbCBjdXJyZW50XG4gICAgcmVtb3ZlQ3VycmVudCgpO1xuXG4gICAgLy8gRGVsYXkgdGhlIGFkZGluZyBvZiBjbGFzc25hbWUgdW50aWwgdGhlIGZvY3VzIGhhcyBjaGFuZ2VkXG4gICAgLy8gVGhpcyBldmVudCBmaXJlcyBiZWZvcmUgdGhlIGZvY3VzaW4gZXZlbnRcbiAgICBpZiAodHlwZSAhPT0gJ2ZvY3Vzb3V0Jykge1xuICAgICAgdGhpcy5mb2N1c1RpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNvbnN0IGZvY3VzZWQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXG4gICAgICAgIC8vIElnbm9yZSBpZiBjdXJyZW50IGZvY3VzIGVsZW1lbnQgaXNuJ3QgaW5zaWRlIHRoZSBwbGF5ZXJcbiAgICAgICAgaWYgKCFlbGVtZW50cy5jb250YWluZXIuY29udGFpbnMoZm9jdXNlZCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0b2dnbGVDbGFzcyhkb2N1bWVudC5hY3RpdmVFbGVtZW50LCBwbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMudGFiRm9jdXMsIHRydWUpO1xuICAgICAgfSwgMTApO1xuICAgIH1cbiAgfTtcblxuICAvLyBHbG9iYWwgd2luZG93ICYgZG9jdW1lbnQgbGlzdGVuZXJzXG4gIGdsb2JhbCA9ICh0b2dnbGUgPSB0cnVlKSA9PiB7XG4gICAgY29uc3QgeyBwbGF5ZXIgfSA9IHRoaXM7XG5cbiAgICAvLyBLZXlib2FyZCBzaG9ydGN1dHNcbiAgICBpZiAocGxheWVyLmNvbmZpZy5rZXlib2FyZC5nbG9iYWwpIHtcbiAgICAgIHRvZ2dsZUxpc3RlbmVyLmNhbGwocGxheWVyLCB3aW5kb3csICdrZXlkb3duIGtleXVwJywgdGhpcy5oYW5kbGVLZXksIHRvZ2dsZSwgZmFsc2UpO1xuICAgIH1cblxuICAgIC8vIENsaWNrIGFueXdoZXJlIGNsb3NlcyBtZW51XG4gICAgdG9nZ2xlTGlzdGVuZXIuY2FsbChwbGF5ZXIsIGRvY3VtZW50LmJvZHksICdjbGljaycsIHRoaXMudG9nZ2xlTWVudSwgdG9nZ2xlKTtcblxuICAgIC8vIERldGVjdCB0b3VjaCBieSBldmVudHNcbiAgICBvbmNlLmNhbGwocGxheWVyLCBkb2N1bWVudC5ib2R5LCAndG91Y2hzdGFydCcsIHRoaXMuZmlyc3RUb3VjaCk7XG5cbiAgICAvLyBUYWIgZm9jdXMgZGV0ZWN0aW9uXG4gICAgdG9nZ2xlTGlzdGVuZXIuY2FsbChwbGF5ZXIsIGRvY3VtZW50LmJvZHksICdrZXlkb3duIGZvY3VzIGJsdXIgZm9jdXNvdXQnLCB0aGlzLnNldFRhYkZvY3VzLCB0b2dnbGUsIGZhbHNlLCB0cnVlKTtcbiAgfTtcblxuICAvLyBDb250YWluZXIgbGlzdGVuZXJzXG4gIGNvbnRhaW5lciA9ICgpID0+IHtcbiAgICBjb25zdCB7IHBsYXllciB9ID0gdGhpcztcbiAgICBjb25zdCB7IGNvbmZpZywgZWxlbWVudHMsIHRpbWVycyB9ID0gcGxheWVyO1xuXG4gICAgLy8gS2V5Ym9hcmQgc2hvcnRjdXRzXG4gICAgaWYgKCFjb25maWcua2V5Ym9hcmQuZ2xvYmFsICYmIGNvbmZpZy5rZXlib2FyZC5mb2N1c2VkKSB7XG4gICAgICBvbi5jYWxsKHBsYXllciwgZWxlbWVudHMuY29udGFpbmVyLCAna2V5ZG93biBrZXl1cCcsIHRoaXMuaGFuZGxlS2V5LCBmYWxzZSk7XG4gICAgfVxuXG4gICAgLy8gVG9nZ2xlIGNvbnRyb2xzIG9uIG1vdXNlIGV2ZW50cyBhbmQgZW50ZXJpbmcgZnVsbHNjcmVlblxuICAgIG9uLmNhbGwoXG4gICAgICBwbGF5ZXIsXG4gICAgICBlbGVtZW50cy5jb250YWluZXIsXG4gICAgICAnbW91c2Vtb3ZlIG1vdXNlbGVhdmUgdG91Y2hzdGFydCB0b3VjaG1vdmUgZW50ZXJmdWxsc2NyZWVuIGV4aXRmdWxsc2NyZWVuJyxcbiAgICAgIChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IGNvbnRyb2xzOiBjb250cm9sc0VsZW1lbnQgfSA9IGVsZW1lbnRzO1xuXG4gICAgICAgIC8vIFJlbW92ZSBidXR0b24gc3RhdGVzIGZvciBmdWxsc2NyZWVuXG4gICAgICAgIGlmIChjb250cm9sc0VsZW1lbnQgJiYgZXZlbnQudHlwZSA9PT0gJ2VudGVyZnVsbHNjcmVlbicpIHtcbiAgICAgICAgICBjb250cm9sc0VsZW1lbnQucHJlc3NlZCA9IGZhbHNlO1xuICAgICAgICAgIGNvbnRyb2xzRWxlbWVudC5ob3ZlciA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2hvdywgdGhlbiBoaWRlIGFmdGVyIGEgdGltZW91dCB1bmxlc3MgYW5vdGhlciBjb250cm9sIGV2ZW50IG9jY3Vyc1xuICAgICAgICBjb25zdCBzaG93ID0gWyd0b3VjaHN0YXJ0JywgJ3RvdWNobW92ZScsICdtb3VzZW1vdmUnXS5pbmNsdWRlcyhldmVudC50eXBlKTtcbiAgICAgICAgbGV0IGRlbGF5ID0gMDtcblxuICAgICAgICBpZiAoc2hvdykge1xuICAgICAgICAgIHVpLnRvZ2dsZUNvbnRyb2xzLmNhbGwocGxheWVyLCB0cnVlKTtcbiAgICAgICAgICAvLyBVc2UgbG9uZ2VyIHRpbWVvdXQgZm9yIHRvdWNoIGRldmljZXNcbiAgICAgICAgICBkZWxheSA9IHBsYXllci50b3VjaCA/IDMwMDAgOiAyMDAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2xlYXIgdGltZXJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVycy5jb250cm9scyk7XG5cbiAgICAgICAgLy8gU2V0IG5ldyB0aW1lciB0byBwcmV2ZW50IGZsaWNrZXIgd2hlbiBzZWVraW5nXG4gICAgICAgIHRpbWVycy5jb250cm9scyA9IHNldFRpbWVvdXQoKCkgPT4gdWkudG9nZ2xlQ29udHJvbHMuY2FsbChwbGF5ZXIsIGZhbHNlKSwgZGVsYXkpO1xuICAgICAgfSxcbiAgICApO1xuXG4gICAgLy8gU2V0IGEgZ3V0dGVyIGZvciBWaW1lb1xuICAgIGNvbnN0IHNldEd1dHRlciA9ICgpID0+IHtcbiAgICAgIGlmICghcGxheWVyLmlzVmltZW8gfHwgcGxheWVyLmNvbmZpZy52aW1lby5wcmVtaXVtKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdGFyZ2V0ID0gZWxlbWVudHMud3JhcHBlcjtcbiAgICAgIGNvbnN0IHsgYWN0aXZlIH0gPSBwbGF5ZXIuZnVsbHNjcmVlbjtcbiAgICAgIGNvbnN0IFt2aWRlb1dpZHRoLCB2aWRlb0hlaWdodF0gPSBnZXRBc3BlY3RSYXRpby5jYWxsKHBsYXllcik7XG4gICAgICBjb25zdCB1c2VOYXRpdmVBc3BlY3RSYXRpbyA9IHN1cHBvcnRzQ1NTKGBhc3BlY3QtcmF0aW86ICR7dmlkZW9XaWR0aH0gLyAke3ZpZGVvSGVpZ2h0fWApO1xuXG4gICAgICAvLyBJZiBub3QgYWN0aXZlLCByZW1vdmUgc3R5bGVzXG4gICAgICBpZiAoIWFjdGl2ZSkge1xuICAgICAgICBpZiAodXNlTmF0aXZlQXNwZWN0UmF0aW8pIHtcbiAgICAgICAgICB0YXJnZXQuc3R5bGUud2lkdGggPSBudWxsO1xuICAgICAgICAgIHRhcmdldC5zdHlsZS5oZWlnaHQgPSBudWxsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRhcmdldC5zdHlsZS5tYXhXaWR0aCA9IG51bGw7XG4gICAgICAgICAgdGFyZ2V0LnN0eWxlLm1hcmdpbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBEZXRlcm1pbmUgd2hpY2ggZGltZW5zaW9uIHdpbGwgb3ZlcmZsb3cgYW5kIGNvbnN0cmFpbiB2aWV3XG4gICAgICBjb25zdCBbdmlld3BvcnRXaWR0aCwgdmlld3BvcnRIZWlnaHRdID0gZ2V0Vmlld3BvcnRTaXplKCk7XG4gICAgICBjb25zdCBvdmVyZmxvdyA9IHZpZXdwb3J0V2lkdGggLyB2aWV3cG9ydEhlaWdodCA+IHZpZGVvV2lkdGggLyB2aWRlb0hlaWdodDtcblxuICAgICAgaWYgKHVzZU5hdGl2ZUFzcGVjdFJhdGlvKSB7XG4gICAgICAgIHRhcmdldC5zdHlsZS53aWR0aCA9IG92ZXJmbG93ID8gJ2F1dG8nIDogJzEwMCUnO1xuICAgICAgICB0YXJnZXQuc3R5bGUuaGVpZ2h0ID0gb3ZlcmZsb3cgPyAnMTAwJScgOiAnYXV0byc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0YXJnZXQuc3R5bGUubWF4V2lkdGggPSBvdmVyZmxvdyA/IGAkeyh2aWV3cG9ydEhlaWdodCAvIHZpZGVvSGVpZ2h0KSAqIHZpZGVvV2lkdGh9cHhgIDogbnVsbDtcbiAgICAgICAgdGFyZ2V0LnN0eWxlLm1hcmdpbiA9IG92ZXJmbG93ID8gJzAgYXV0bycgOiBudWxsO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBIYW5kbGUgcmVzaXppbmdcbiAgICBjb25zdCByZXNpemVkID0gKCkgPT4ge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVycy5yZXNpemVkKTtcbiAgICAgIHRpbWVycy5yZXNpemVkID0gc2V0VGltZW91dChzZXRHdXR0ZXIsIDUwKTtcbiAgICB9O1xuXG4gICAgb24uY2FsbChwbGF5ZXIsIGVsZW1lbnRzLmNvbnRhaW5lciwgJ2VudGVyZnVsbHNjcmVlbiBleGl0ZnVsbHNjcmVlbicsIChldmVudCkgPT4ge1xuICAgICAgY29uc3QgeyB0YXJnZXQgfSA9IHBsYXllci5mdWxsc2NyZWVuO1xuXG4gICAgICAvLyBJZ25vcmUgZXZlbnRzIG5vdCBmcm9tIHRhcmdldFxuICAgICAgaWYgKHRhcmdldCAhPT0gZWxlbWVudHMuY29udGFpbmVyKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgaXQncyBub3QgYW4gZW1iZWQgYW5kIG5vIHJhdGlvIHNwZWNpZmllZFxuICAgICAgaWYgKCFwbGF5ZXIuaXNFbWJlZCAmJiBpcy5lbXB0eShwbGF5ZXIuY29uZmlnLnJhdGlvKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFNldCBWaW1lbyBndXR0ZXJcbiAgICAgIHNldEd1dHRlcigpO1xuXG4gICAgICAvLyBXYXRjaCBmb3IgcmVzaXplc1xuICAgICAgY29uc3QgbWV0aG9kID0gZXZlbnQudHlwZSA9PT0gJ2VudGVyZnVsbHNjcmVlbicgPyBvbiA6IG9mZjtcbiAgICAgIG1ldGhvZC5jYWxsKHBsYXllciwgd2luZG93LCAncmVzaXplJywgcmVzaXplZCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gTGlzdGVuIGZvciBtZWRpYSBldmVudHNcbiAgbWVkaWEgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBwbGF5ZXIgfSA9IHRoaXM7XG4gICAgY29uc3QgeyBlbGVtZW50cyB9ID0gcGxheWVyO1xuXG4gICAgLy8gVGltZSBjaGFuZ2Ugb24gbWVkaWFcbiAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZSBzZWVraW5nIHNlZWtlZCcsIChldmVudCkgPT4gY29udHJvbHMudGltZVVwZGF0ZS5jYWxsKHBsYXllciwgZXZlbnQpKTtcblxuICAgIC8vIERpc3BsYXkgZHVyYXRpb25cbiAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UgbG9hZGVkZGF0YSBsb2FkZWRtZXRhZGF0YScsIChldmVudCkgPT5cbiAgICAgIGNvbnRyb2xzLmR1cmF0aW9uVXBkYXRlLmNhbGwocGxheWVyLCBldmVudCksXG4gICAgKTtcblxuICAgIC8vIEhhbmRsZSB0aGUgbWVkaWEgZmluaXNoaW5nXG4gICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2VuZGVkJywgKCkgPT4ge1xuICAgICAgLy8gU2hvdyBwb3N0ZXIgb24gZW5kXG4gICAgICBpZiAocGxheWVyLmlzSFRNTDUgJiYgcGxheWVyLmlzVmlkZW8gJiYgcGxheWVyLmNvbmZpZy5yZXNldE9uRW5kKSB7XG4gICAgICAgIC8vIFJlc3RhcnRcbiAgICAgICAgcGxheWVyLnJlc3RhcnQoKTtcblxuICAgICAgICAvLyBDYWxsIHBhdXNlIG90aGVyd2lzZSBJRTExIHdpbGwgc3RhcnQgcGxheWluZyB0aGUgdmlkZW8gYWdhaW5cbiAgICAgICAgcGxheWVyLnBhdXNlKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBDaGVjayBmb3IgYnVmZmVyIHByb2dyZXNzXG4gICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3Byb2dyZXNzIHBsYXlpbmcgc2Vla2luZyBzZWVrZWQnLCAoZXZlbnQpID0+XG4gICAgICBjb250cm9scy51cGRhdGVQcm9ncmVzcy5jYWxsKHBsYXllciwgZXZlbnQpLFxuICAgICk7XG5cbiAgICAvLyBIYW5kbGUgdm9sdW1lIGNoYW5nZXNcbiAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndm9sdW1lY2hhbmdlJywgKGV2ZW50KSA9PiBjb250cm9scy51cGRhdGVWb2x1bWUuY2FsbChwbGF5ZXIsIGV2ZW50KSk7XG5cbiAgICAvLyBIYW5kbGUgcGxheS9wYXVzZVxuICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdwbGF5aW5nIHBsYXkgcGF1c2UgZW5kZWQgZW1wdGllZCB0aW1ldXBkYXRlJywgKGV2ZW50KSA9PlxuICAgICAgdWkuY2hlY2tQbGF5aW5nLmNhbGwocGxheWVyLCBldmVudCksXG4gICAgKTtcblxuICAgIC8vIExvYWRpbmcgc3RhdGVcbiAgICBvbi5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnd2FpdGluZyBjYW5wbGF5IHNlZWtlZCBwbGF5aW5nJywgKGV2ZW50KSA9PiB1aS5jaGVja0xvYWRpbmcuY2FsbChwbGF5ZXIsIGV2ZW50KSk7XG5cbiAgICAvLyBDbGljayB2aWRlb1xuICAgIGlmIChwbGF5ZXIuc3VwcG9ydGVkLnVpICYmIHBsYXllci5jb25maWcuY2xpY2tUb1BsYXkgJiYgIXBsYXllci5pc0F1ZGlvKSB7XG4gICAgICAvLyBSZS1mZXRjaCB0aGUgd3JhcHBlclxuICAgICAgY29uc3Qgd3JhcHBlciA9IGdldEVsZW1lbnQuY2FsbChwbGF5ZXIsIGAuJHtwbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMudmlkZW99YCk7XG5cbiAgICAgIC8vIEJhaWwgaWYgdGhlcmUncyBubyB3cmFwcGVyICh0aGlzIHNob3VsZCBuZXZlciBoYXBwZW4pXG4gICAgICBpZiAoIWlzLmVsZW1lbnQod3JhcHBlcikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBPbiBjbGljayBwbGF5LCBwYXVzZSBvciByZXN0YXJ0XG4gICAgICBvbi5jYWxsKHBsYXllciwgZWxlbWVudHMuY29udGFpbmVyLCAnY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgdGFyZ2V0cyA9IFtlbGVtZW50cy5jb250YWluZXIsIHdyYXBwZXJdO1xuXG4gICAgICAgIC8vIElnbm9yZSBpZiBjbGljayBpZiBub3QgY29udGFpbmVyIG9yIGluIHZpZGVvIHdyYXBwZXJcbiAgICAgICAgaWYgKCF0YXJnZXRzLmluY2x1ZGVzKGV2ZW50LnRhcmdldCkgJiYgIXdyYXBwZXIuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRvdWNoIGRldmljZXMgd2lsbCBqdXN0IHNob3cgY29udHJvbHMgKGlmIGhpZGRlbilcbiAgICAgICAgaWYgKHBsYXllci50b3VjaCAmJiBwbGF5ZXIuY29uZmlnLmhpZGVDb250cm9scykge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwbGF5ZXIuZW5kZWQpIHtcbiAgICAgICAgICB0aGlzLnByb3h5KGV2ZW50LCBwbGF5ZXIucmVzdGFydCwgJ3Jlc3RhcnQnKTtcbiAgICAgICAgICB0aGlzLnByb3h5KFxuICAgICAgICAgICAgZXZlbnQsXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgIHNpbGVuY2VQcm9taXNlKHBsYXllci5wbGF5KCkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdwbGF5JyxcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMucHJveHkoXG4gICAgICAgICAgICBldmVudCxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgc2lsZW5jZVByb21pc2UocGxheWVyLnRvZ2dsZVBsYXkoKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3BsYXknLFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIERpc2FibGUgcmlnaHQgY2xpY2tcbiAgICBpZiAocGxheWVyLnN1cHBvcnRlZC51aSAmJiBwbGF5ZXIuY29uZmlnLmRpc2FibGVDb250ZXh0TWVudSkge1xuICAgICAgb24uY2FsbChcbiAgICAgICAgcGxheWVyLFxuICAgICAgICBlbGVtZW50cy53cmFwcGVyLFxuICAgICAgICAnY29udGV4dG1lbnUnLFxuICAgICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9LFxuICAgICAgICBmYWxzZSxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gVm9sdW1lIGNoYW5nZVxuICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd2b2x1bWVjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAvLyBTYXZlIHRvIHN0b3JhZ2VcbiAgICAgIHBsYXllci5zdG9yYWdlLnNldCh7XG4gICAgICAgIHZvbHVtZTogcGxheWVyLnZvbHVtZSxcbiAgICAgICAgbXV0ZWQ6IHBsYXllci5tdXRlZCxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLy8gU3BlZWQgY2hhbmdlXG4gICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3JhdGVjaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAvLyBVcGRhdGUgVUlcbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbChwbGF5ZXIsICdzcGVlZCcpO1xuXG4gICAgICAvLyBTYXZlIHRvIHN0b3JhZ2VcbiAgICAgIHBsYXllci5zdG9yYWdlLnNldCh7IHNwZWVkOiBwbGF5ZXIuc3BlZWQgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBRdWFsaXR5IGNoYW5nZVxuICAgIG9uLmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdxdWFsaXR5Y2hhbmdlJywgKGV2ZW50KSA9PiB7XG4gICAgICAvLyBVcGRhdGUgVUlcbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVNldHRpbmcuY2FsbChwbGF5ZXIsICdxdWFsaXR5JywgbnVsbCwgZXZlbnQuZGV0YWlsLnF1YWxpdHkpO1xuICAgIH0pO1xuXG4gICAgLy8gVXBkYXRlIGRvd25sb2FkIGxpbmsgd2hlbiByZWFkeSBhbmQgaWYgcXVhbGl0eSBjaGFuZ2VzXG4gICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3JlYWR5IHF1YWxpdHljaGFuZ2UnLCAoKSA9PiB7XG4gICAgICBjb250cm9scy5zZXREb3dubG9hZFVybC5jYWxsKHBsYXllcik7XG4gICAgfSk7XG5cbiAgICAvLyBQcm94eSBldmVudHMgdG8gY29udGFpbmVyXG4gICAgLy8gQnViYmxlIHVwIGtleSBldmVudHMgZm9yIEVkZ2VcbiAgICBjb25zdCBwcm94eUV2ZW50cyA9IHBsYXllci5jb25maWcuZXZlbnRzLmNvbmNhdChbJ2tleXVwJywgJ2tleWRvd24nXSkuam9pbignICcpO1xuXG4gICAgb24uY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgcHJveHlFdmVudHMsIChldmVudCkgPT4ge1xuICAgICAgbGV0IHsgZGV0YWlsID0ge30gfSA9IGV2ZW50O1xuXG4gICAgICAvLyBHZXQgZXJyb3IgZGV0YWlscyBmcm9tIG1lZGlhXG4gICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2Vycm9yJykge1xuICAgICAgICBkZXRhaWwgPSBwbGF5ZXIubWVkaWEuZXJyb3I7XG4gICAgICB9XG5cbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgZWxlbWVudHMuY29udGFpbmVyLCBldmVudC50eXBlLCB0cnVlLCBkZXRhaWwpO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIFJ1biBkZWZhdWx0IGFuZCBjdXN0b20gaGFuZGxlcnNcbiAgcHJveHkgPSAoZXZlbnQsIGRlZmF1bHRIYW5kbGVyLCBjdXN0b21IYW5kbGVyS2V5KSA9PiB7XG4gICAgY29uc3QgeyBwbGF5ZXIgfSA9IHRoaXM7XG4gICAgY29uc3QgY3VzdG9tSGFuZGxlciA9IHBsYXllci5jb25maWcubGlzdGVuZXJzW2N1c3RvbUhhbmRsZXJLZXldO1xuICAgIGNvbnN0IGhhc0N1c3RvbUhhbmRsZXIgPSBpcy5mdW5jdGlvbihjdXN0b21IYW5kbGVyKTtcbiAgICBsZXQgcmV0dXJuZWQgPSB0cnVlO1xuXG4gICAgLy8gRXhlY3V0ZSBjdXN0b20gaGFuZGxlclxuICAgIGlmIChoYXNDdXN0b21IYW5kbGVyKSB7XG4gICAgICByZXR1cm5lZCA9IGN1c3RvbUhhbmRsZXIuY2FsbChwbGF5ZXIsIGV2ZW50KTtcbiAgICB9XG5cbiAgICAvLyBPbmx5IGNhbGwgZGVmYXVsdCBoYW5kbGVyIGlmIG5vdCBwcmV2ZW50ZWQgaW4gY3VzdG9tIGhhbmRsZXJcbiAgICBpZiAocmV0dXJuZWQgIT09IGZhbHNlICYmIGlzLmZ1bmN0aW9uKGRlZmF1bHRIYW5kbGVyKSkge1xuICAgICAgZGVmYXVsdEhhbmRsZXIuY2FsbChwbGF5ZXIsIGV2ZW50KTtcbiAgICB9XG4gIH07XG5cbiAgLy8gVHJpZ2dlciBjdXN0b20gYW5kIGRlZmF1bHQgaGFuZGxlcnNcbiAgYmluZCA9IChlbGVtZW50LCB0eXBlLCBkZWZhdWx0SGFuZGxlciwgY3VzdG9tSGFuZGxlcktleSwgcGFzc2l2ZSA9IHRydWUpID0+IHtcbiAgICBjb25zdCB7IHBsYXllciB9ID0gdGhpcztcbiAgICBjb25zdCBjdXN0b21IYW5kbGVyID0gcGxheWVyLmNvbmZpZy5saXN0ZW5lcnNbY3VzdG9tSGFuZGxlcktleV07XG4gICAgY29uc3QgaGFzQ3VzdG9tSGFuZGxlciA9IGlzLmZ1bmN0aW9uKGN1c3RvbUhhbmRsZXIpO1xuXG4gICAgb24uY2FsbChcbiAgICAgIHBsYXllcixcbiAgICAgIGVsZW1lbnQsXG4gICAgICB0eXBlLFxuICAgICAgKGV2ZW50KSA9PiB0aGlzLnByb3h5KGV2ZW50LCBkZWZhdWx0SGFuZGxlciwgY3VzdG9tSGFuZGxlcktleSksXG4gICAgICBwYXNzaXZlICYmICFoYXNDdXN0b21IYW5kbGVyLFxuICAgICk7XG4gIH07XG5cbiAgLy8gTGlzdGVuIGZvciBjb250cm9sIGV2ZW50c1xuICBjb250cm9scyA9ICgpID0+IHtcbiAgICBjb25zdCB7IHBsYXllciB9ID0gdGhpcztcbiAgICBjb25zdCB7IGVsZW1lbnRzIH0gPSBwbGF5ZXI7XG4gICAgLy8gSUUgZG9lc24ndCBzdXBwb3J0IGlucHV0IGV2ZW50LCBzbyB3ZSBmYWxsYmFjayB0byBjaGFuZ2VcbiAgICBjb25zdCBpbnB1dEV2ZW50ID0gYnJvd3Nlci5pc0lFID8gJ2NoYW5nZScgOiAnaW5wdXQnO1xuXG4gICAgLy8gUGxheS9wYXVzZSB0b2dnbGVcbiAgICBpZiAoZWxlbWVudHMuYnV0dG9ucy5wbGF5KSB7XG4gICAgICBBcnJheS5mcm9tKGVsZW1lbnRzLmJ1dHRvbnMucGxheSkuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gICAgICAgIHRoaXMuYmluZChcbiAgICAgICAgICBidXR0b24sXG4gICAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICBzaWxlbmNlUHJvbWlzZShwbGF5ZXIudG9nZ2xlUGxheSgpKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgICdwbGF5JyxcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFBhdXNlXG4gICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMucmVzdGFydCwgJ2NsaWNrJywgcGxheWVyLnJlc3RhcnQsICdyZXN0YXJ0Jyk7XG5cbiAgICAvLyBSZXdpbmRcbiAgICB0aGlzLmJpbmQoXG4gICAgICBlbGVtZW50cy5idXR0b25zLnJld2luZCxcbiAgICAgICdjbGljaycsXG4gICAgICAoKSA9PiB7XG4gICAgICAgIC8vIFJlY29yZCBzZWVrIHRpbWUgc28gd2UgY2FuIHByZXZlbnQgaGlkaW5nIGNvbnRyb2xzIGZvciBhIGZldyBzZWNvbmRzIGFmdGVyIHJld2luZFxuICAgICAgICBwbGF5ZXIubGFzdFNlZWtUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgcGxheWVyLnJld2luZCgpO1xuICAgICAgfSxcbiAgICAgICdyZXdpbmQnLFxuICAgICk7XG5cbiAgICAvLyBSZXdpbmRcbiAgICB0aGlzLmJpbmQoXG4gICAgICBlbGVtZW50cy5idXR0b25zLmZhc3RGb3J3YXJkLFxuICAgICAgJ2NsaWNrJyxcbiAgICAgICgpID0+IHtcbiAgICAgICAgLy8gUmVjb3JkIHNlZWsgdGltZSBzbyB3ZSBjYW4gcHJldmVudCBoaWRpbmcgY29udHJvbHMgZm9yIGEgZmV3IHNlY29uZHMgYWZ0ZXIgZmFzdCBmb3J3YXJkXG4gICAgICAgIHBsYXllci5sYXN0U2Vla1RpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBwbGF5ZXIuZm9yd2FyZCgpO1xuICAgICAgfSxcbiAgICAgICdmYXN0Rm9yd2FyZCcsXG4gICAgKTtcblxuICAgIC8vIE11dGUgdG9nZ2xlXG4gICAgdGhpcy5iaW5kKFxuICAgICAgZWxlbWVudHMuYnV0dG9ucy5tdXRlLFxuICAgICAgJ2NsaWNrJyxcbiAgICAgICgpID0+IHtcbiAgICAgICAgcGxheWVyLm11dGVkID0gIXBsYXllci5tdXRlZDtcbiAgICAgIH0sXG4gICAgICAnbXV0ZScsXG4gICAgKTtcblxuICAgIC8vIENhcHRpb25zIHRvZ2dsZVxuICAgIHRoaXMuYmluZChlbGVtZW50cy5idXR0b25zLmNhcHRpb25zLCAnY2xpY2snLCAoKSA9PiBwbGF5ZXIudG9nZ2xlQ2FwdGlvbnMoKSk7XG5cbiAgICAvLyBEb3dubG9hZFxuICAgIHRoaXMuYmluZChcbiAgICAgIGVsZW1lbnRzLmJ1dHRvbnMuZG93bmxvYWQsXG4gICAgICAnY2xpY2snLFxuICAgICAgKCkgPT4ge1xuICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2Rvd25sb2FkJyk7XG4gICAgICB9LFxuICAgICAgJ2Rvd25sb2FkJyxcbiAgICApO1xuXG4gICAgLy8gRnVsbHNjcmVlbiB0b2dnbGVcbiAgICB0aGlzLmJpbmQoXG4gICAgICBlbGVtZW50cy5idXR0b25zLmZ1bGxzY3JlZW4sXG4gICAgICAnY2xpY2snLFxuICAgICAgKCkgPT4ge1xuICAgICAgICBwbGF5ZXIuZnVsbHNjcmVlbi50b2dnbGUoKTtcbiAgICAgIH0sXG4gICAgICAnZnVsbHNjcmVlbicsXG4gICAgKTtcblxuICAgIC8vIFBpY3R1cmUtaW4tUGljdHVyZVxuICAgIHRoaXMuYmluZChcbiAgICAgIGVsZW1lbnRzLmJ1dHRvbnMucGlwLFxuICAgICAgJ2NsaWNrJyxcbiAgICAgICgpID0+IHtcbiAgICAgICAgcGxheWVyLnBpcCA9ICd0b2dnbGUnO1xuICAgICAgfSxcbiAgICAgICdwaXAnLFxuICAgICk7XG5cbiAgICAvLyBBaXJwbGF5XG4gICAgdGhpcy5iaW5kKGVsZW1lbnRzLmJ1dHRvbnMuYWlycGxheSwgJ2NsaWNrJywgcGxheWVyLmFpcnBsYXksICdhaXJwbGF5Jyk7XG5cbiAgICAvLyBTZXR0aW5ncyBtZW51IC0gY2xpY2sgdG9nZ2xlXG4gICAgdGhpcy5iaW5kKFxuICAgICAgZWxlbWVudHMuYnV0dG9ucy5zZXR0aW5ncyxcbiAgICAgICdjbGljaycsXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgLy8gUHJldmVudCB0aGUgZG9jdW1lbnQgY2xpY2sgbGlzdGVuZXIgY2xvc2luZyB0aGUgbWVudVxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBjb250cm9scy50b2dnbGVNZW51LmNhbGwocGxheWVyLCBldmVudCk7XG4gICAgICB9LFxuICAgICAgbnVsbCxcbiAgICAgIGZhbHNlLFxuICAgICk7IC8vIENhbid0IGJlIHBhc3NpdmUgYXMgd2UncmUgcHJldmVudGluZyBkZWZhdWx0XG5cbiAgICAvLyBTZXR0aW5ncyBtZW51IC0ga2V5Ym9hcmQgdG9nZ2xlXG4gICAgLy8gV2UgaGF2ZSB0byBiaW5kIHRvIGtleXVwIG90aGVyd2lzZSBGaXJlZm94IHRyaWdnZXJzIGEgY2xpY2sgd2hlbiBhIGtleWRvd24gZXZlbnQgaGFuZGxlciBzaGlmdHMgZm9jdXNcbiAgICAvLyBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xMjIwMTQzXG4gICAgdGhpcy5iaW5kKFxuICAgICAgZWxlbWVudHMuYnV0dG9ucy5zZXR0aW5ncyxcbiAgICAgICdrZXl1cCcsXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgaWYgKCFbJ1NwYWNlJywgJ0VudGVyJ10uaW5jbHVkZXMoZXZlbnQua2V5KSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEJlY2F1c2UgcmV0dXJuIHRyaWdnZXJzIGEgY2xpY2sgYW55d2F5LCBhbGwgd2UgbmVlZCB0byBkbyBpcyBzZXQgZm9jdXNcbiAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgIGNvbnRyb2xzLmZvY3VzRmlyc3RNZW51SXRlbS5jYWxsKHBsYXllciwgbnVsbCwgdHJ1ZSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUHJldmVudCBzY3JvbGxcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAvLyBQcmV2ZW50IHBsYXlpbmcgdmlkZW8gKEZpcmVmb3gpXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIC8vIFRvZ2dsZSBtZW51XG4gICAgICAgIGNvbnRyb2xzLnRvZ2dsZU1lbnUuY2FsbChwbGF5ZXIsIGV2ZW50KTtcbiAgICAgIH0sXG4gICAgICBudWxsLFxuICAgICAgZmFsc2UsIC8vIENhbid0IGJlIHBhc3NpdmUgYXMgd2UncmUgcHJldmVudGluZyBkZWZhdWx0XG4gICAgKTtcblxuICAgIC8vIEVzY2FwZSBjbG9zZXMgbWVudVxuICAgIHRoaXMuYmluZChlbGVtZW50cy5zZXR0aW5ncy5tZW51LCAna2V5ZG93bicsIChldmVudCkgPT4ge1xuICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgY29udHJvbHMudG9nZ2xlTWVudS5jYWxsKHBsYXllciwgZXZlbnQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gU2V0IHJhbmdlIGlucHV0IGFsdGVybmF0aXZlIFwidmFsdWVcIiwgd2hpY2ggbWF0Y2hlcyB0aGUgdG9vbHRpcCB0aW1lICgjOTU0KVxuICAgIHRoaXMuYmluZChlbGVtZW50cy5pbnB1dHMuc2VlaywgJ21vdXNlZG93biBtb3VzZW1vdmUnLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHJlY3QgPSBlbGVtZW50cy5wcm9ncmVzcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIGNvbnN0IHBlcmNlbnQgPSAoMTAwIC8gcmVjdC53aWR0aCkgKiAoZXZlbnQucGFnZVggLSByZWN0LmxlZnQpO1xuICAgICAgZXZlbnQuY3VycmVudFRhcmdldC5zZXRBdHRyaWJ1dGUoJ3NlZWstdmFsdWUnLCBwZXJjZW50KTtcbiAgICB9KTtcblxuICAgIC8vIFBhdXNlIHdoaWxlIHNlZWtpbmdcbiAgICB0aGlzLmJpbmQoZWxlbWVudHMuaW5wdXRzLnNlZWssICdtb3VzZWRvd24gbW91c2V1cCBrZXlkb3duIGtleXVwIHRvdWNoc3RhcnQgdG91Y2hlbmQnLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHNlZWsgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgY29uc3QgYXR0cmlidXRlID0gJ3BsYXktb24tc2Vla2VkJztcblxuICAgICAgaWYgKGlzLmtleWJvYXJkRXZlbnQoZXZlbnQpICYmICFbJ0Fycm93TGVmdCcsICdBcnJvd1JpZ2h0J10uaW5jbHVkZXMoZXZlbnQua2V5KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFJlY29yZCBzZWVrIHRpbWUgc28gd2UgY2FuIHByZXZlbnQgaGlkaW5nIGNvbnRyb2xzIGZvciBhIGZldyBzZWNvbmRzIGFmdGVyIHNlZWtcbiAgICAgIHBsYXllci5sYXN0U2Vla1RpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAvLyBXYXMgcGxheWluZyBiZWZvcmU/XG4gICAgICBjb25zdCBwbGF5ID0gc2Vlay5oYXNBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICAgIC8vIERvbmUgc2Vla2luZ1xuICAgICAgY29uc3QgZG9uZSA9IFsnbW91c2V1cCcsICd0b3VjaGVuZCcsICdrZXl1cCddLmluY2x1ZGVzKGV2ZW50LnR5cGUpO1xuXG4gICAgICAvLyBJZiB3ZSdyZSBkb25lIHNlZWtpbmcgYW5kIGl0IHdhcyBwbGF5aW5nLCByZXN1bWUgcGxheWJhY2tcbiAgICAgIGlmIChwbGF5ICYmIGRvbmUpIHtcbiAgICAgICAgc2Vlay5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICAgICAgc2lsZW5jZVByb21pc2UocGxheWVyLnBsYXkoKSk7XG4gICAgICB9IGVsc2UgaWYgKCFkb25lICYmIHBsYXllci5wbGF5aW5nKSB7XG4gICAgICAgIHNlZWsuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZSwgJycpO1xuICAgICAgICBwbGF5ZXIucGF1c2UoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEZpeCByYW5nZSBpbnB1dHMgb24gaU9TXG4gICAgLy8gU3VwZXIgd2VpcmQgaU9TIGJ1ZyB3aGVyZSBhZnRlciB5b3UgaW50ZXJhY3Qgd2l0aCBhbiA8aW5wdXQgdHlwZT1cInJhbmdlXCI+LFxuICAgIC8vIGl0IHRha2VzIG92ZXIgZnVydGhlciBpbnRlcmFjdGlvbnMgb24gdGhlIHBhZ2UuIFRoaXMgaXMgYSBoYWNrXG4gICAgaWYgKGJyb3dzZXIuaXNJb3MpIHtcbiAgICAgIGNvbnN0IGlucHV0cyA9IGdldEVsZW1lbnRzLmNhbGwocGxheWVyLCAnaW5wdXRbdHlwZT1cInJhbmdlXCJdJyk7XG4gICAgICBBcnJheS5mcm9tKGlucHV0cykuZm9yRWFjaCgoaW5wdXQpID0+IHRoaXMuYmluZChpbnB1dCwgaW5wdXRFdmVudCwgKGV2ZW50KSA9PiByZXBhaW50KGV2ZW50LnRhcmdldCkpKTtcbiAgICB9XG5cbiAgICAvLyBTZWVrXG4gICAgdGhpcy5iaW5kKFxuICAgICAgZWxlbWVudHMuaW5wdXRzLnNlZWssXG4gICAgICBpbnB1dEV2ZW50LFxuICAgICAgKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHNlZWsgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICAvLyBJZiBpdCBleGlzdHMsIHVzZSBzZWVrLXZhbHVlIGluc3RlYWQgb2YgXCJ2YWx1ZVwiIGZvciBjb25zaXN0ZW5jeSB3aXRoIHRvb2x0aXAgdGltZSAoIzk1NClcbiAgICAgICAgbGV0IHNlZWtUbyA9IHNlZWsuZ2V0QXR0cmlidXRlKCdzZWVrLXZhbHVlJyk7XG5cbiAgICAgICAgaWYgKGlzLmVtcHR5KHNlZWtUbykpIHtcbiAgICAgICAgICBzZWVrVG8gPSBzZWVrLnZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgc2Vlay5yZW1vdmVBdHRyaWJ1dGUoJ3NlZWstdmFsdWUnKTtcblxuICAgICAgICBwbGF5ZXIuY3VycmVudFRpbWUgPSAoc2Vla1RvIC8gc2Vlay5tYXgpICogcGxheWVyLmR1cmF0aW9uO1xuICAgICAgfSxcbiAgICAgICdzZWVrJyxcbiAgICApO1xuXG4gICAgLy8gU2VlayB0b29sdGlwXG4gICAgdGhpcy5iaW5kKGVsZW1lbnRzLnByb2dyZXNzLCAnbW91c2VlbnRlciBtb3VzZWxlYXZlIG1vdXNlbW92ZScsIChldmVudCkgPT5cbiAgICAgIGNvbnRyb2xzLnVwZGF0ZVNlZWtUb29sdGlwLmNhbGwocGxheWVyLCBldmVudCksXG4gICAgKTtcblxuICAgIC8vIFByZXZpZXcgdGh1bWJuYWlscyBwbHVnaW5cbiAgICAvLyBUT0RPOiBSZWFsbHkgbmVlZCB0byB3b3JrIG9uIHNvbWUgc29ydCBvZiBwbHVnLWluIHdpZGUgZXZlbnQgYnVzIG9yIHB1Yi1zdWIgZm9yIHRoaXNcbiAgICB0aGlzLmJpbmQoZWxlbWVudHMucHJvZ3Jlc3MsICdtb3VzZW1vdmUgdG91Y2htb3ZlJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB7IHByZXZpZXdUaHVtYm5haWxzIH0gPSBwbGF5ZXI7XG5cbiAgICAgIGlmIChwcmV2aWV3VGh1bWJuYWlscyAmJiBwcmV2aWV3VGh1bWJuYWlscy5sb2FkZWQpIHtcbiAgICAgICAgcHJldmlld1RodW1ibmFpbHMuc3RhcnRNb3ZlKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEhpZGUgdGh1bWJuYWlsIHByZXZpZXcgLSBvbiBtb3VzZSBjbGljaywgbW91c2UgbGVhdmUsIGFuZCB2aWRlbyBwbGF5L3NlZWsuIEFsbCBmb3VyIGFyZSByZXF1aXJlZCwgZS5nLiwgZm9yIGJ1ZmZlcmluZ1xuICAgIHRoaXMuYmluZChlbGVtZW50cy5wcm9ncmVzcywgJ21vdXNlbGVhdmUgdG91Y2hlbmQgY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IHByZXZpZXdUaHVtYm5haWxzIH0gPSBwbGF5ZXI7XG5cbiAgICAgIGlmIChwcmV2aWV3VGh1bWJuYWlscyAmJiBwcmV2aWV3VGh1bWJuYWlscy5sb2FkZWQpIHtcbiAgICAgICAgcHJldmlld1RodW1ibmFpbHMuZW5kTW92ZShmYWxzZSwgdHJ1ZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBTaG93IHNjcnViYmluZyBwcmV2aWV3XG4gICAgdGhpcy5iaW5kKGVsZW1lbnRzLnByb2dyZXNzLCAnbW91c2Vkb3duIHRvdWNoc3RhcnQnLCAoZXZlbnQpID0+IHtcbiAgICAgIGNvbnN0IHsgcHJldmlld1RodW1ibmFpbHMgfSA9IHBsYXllcjtcblxuICAgICAgaWYgKHByZXZpZXdUaHVtYm5haWxzICYmIHByZXZpZXdUaHVtYm5haWxzLmxvYWRlZCkge1xuICAgICAgICBwcmV2aWV3VGh1bWJuYWlscy5zdGFydFNjcnViYmluZyhldmVudCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmJpbmQoZWxlbWVudHMucHJvZ3Jlc3MsICdtb3VzZXVwIHRvdWNoZW5kJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCB7IHByZXZpZXdUaHVtYm5haWxzIH0gPSBwbGF5ZXI7XG5cbiAgICAgIGlmIChwcmV2aWV3VGh1bWJuYWlscyAmJiBwcmV2aWV3VGh1bWJuYWlscy5sb2FkZWQpIHtcbiAgICAgICAgcHJldmlld1RodW1ibmFpbHMuZW5kU2NydWJiaW5nKGV2ZW50KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFBvbHlmaWxsIGZvciBsb3dlciBmaWxsIGluIDxpbnB1dCB0eXBlPVwicmFuZ2VcIj4gZm9yIHdlYmtpdFxuICAgIGlmIChicm93c2VyLmlzV2Via2l0KSB7XG4gICAgICBBcnJheS5mcm9tKGdldEVsZW1lbnRzLmNhbGwocGxheWVyLCAnaW5wdXRbdHlwZT1cInJhbmdlXCJdJykpLmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgICAgdGhpcy5iaW5kKGVsZW1lbnQsICdpbnB1dCcsIChldmVudCkgPT4gY29udHJvbHMudXBkYXRlUmFuZ2VGaWxsLmNhbGwocGxheWVyLCBldmVudC50YXJnZXQpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEN1cnJlbnQgdGltZSBpbnZlcnRcbiAgICAvLyBPbmx5IGlmIG9uZSB0aW1lIGVsZW1lbnQgaXMgdXNlZCBmb3IgYm90aCBjdXJyZW50VGltZSBhbmQgZHVyYXRpb25cbiAgICBpZiAocGxheWVyLmNvbmZpZy50b2dnbGVJbnZlcnQgJiYgIWlzLmVsZW1lbnQoZWxlbWVudHMuZGlzcGxheS5kdXJhdGlvbikpIHtcbiAgICAgIHRoaXMuYmluZChlbGVtZW50cy5kaXNwbGF5LmN1cnJlbnRUaW1lLCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIC8vIERvIG5vdGhpbmcgaWYgd2UncmUgYXQgdGhlIHN0YXJ0XG4gICAgICAgIGlmIChwbGF5ZXIuY3VycmVudFRpbWUgPT09IDApIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBwbGF5ZXIuY29uZmlnLmludmVydFRpbWUgPSAhcGxheWVyLmNvbmZpZy5pbnZlcnRUaW1lO1xuXG4gICAgICAgIGNvbnRyb2xzLnRpbWVVcGRhdGUuY2FsbChwbGF5ZXIpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gVm9sdW1lXG4gICAgdGhpcy5iaW5kKFxuICAgICAgZWxlbWVudHMuaW5wdXRzLnZvbHVtZSxcbiAgICAgIGlucHV0RXZlbnQsXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgcGxheWVyLnZvbHVtZSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgIH0sXG4gICAgICAndm9sdW1lJyxcbiAgICApO1xuXG4gICAgLy8gVXBkYXRlIGNvbnRyb2xzLmhvdmVyIHN0YXRlICh1c2VkIGZvciB1aS50b2dnbGVDb250cm9scyB0byBhdm9pZCBoaWRpbmcgd2hlbiBpbnRlcmFjdGluZylcbiAgICB0aGlzLmJpbmQoZWxlbWVudHMuY29udHJvbHMsICdtb3VzZWVudGVyIG1vdXNlbGVhdmUnLCAoZXZlbnQpID0+IHtcbiAgICAgIGVsZW1lbnRzLmNvbnRyb2xzLmhvdmVyID0gIXBsYXllci50b3VjaCAmJiBldmVudC50eXBlID09PSAnbW91c2VlbnRlcic7XG4gICAgfSk7XG5cbiAgICAvLyBBbHNvIHVwZGF0ZSBjb250cm9scy5ob3ZlciBzdGF0ZSBmb3IgYW55IG5vbi1wbGF5ZXIgY2hpbGRyZW4gb2YgZnVsbHNjcmVlbiBlbGVtZW50IChhcyBhYm92ZSlcbiAgICBpZiAoZWxlbWVudHMuZnVsbHNjcmVlbikge1xuICAgICAgQXJyYXkuZnJvbShlbGVtZW50cy5mdWxsc2NyZWVuLmNoaWxkcmVuKVxuICAgICAgICAuZmlsdGVyKChjKSA9PiAhYy5jb250YWlucyhlbGVtZW50cy5jb250YWluZXIpKVxuICAgICAgICAuZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgICAgICB0aGlzLmJpbmQoY2hpbGQsICdtb3VzZWVudGVyIG1vdXNlbGVhdmUnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChlbGVtZW50cy5jb250cm9scykge1xuICAgICAgICAgICAgICBlbGVtZW50cy5jb250cm9scy5ob3ZlciA9ICFwbGF5ZXIudG91Y2ggJiYgZXZlbnQudHlwZSA9PT0gJ21vdXNlZW50ZXInO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgY29udHJvbHMucHJlc3NlZCBzdGF0ZSAodXNlZCBmb3IgdWkudG9nZ2xlQ29udHJvbHMgdG8gYXZvaWQgaGlkaW5nIHdoZW4gaW50ZXJhY3RpbmcpXG4gICAgdGhpcy5iaW5kKGVsZW1lbnRzLmNvbnRyb2xzLCAnbW91c2Vkb3duIG1vdXNldXAgdG91Y2hzdGFydCB0b3VjaGVuZCB0b3VjaGNhbmNlbCcsIChldmVudCkgPT4ge1xuICAgICAgZWxlbWVudHMuY29udHJvbHMucHJlc3NlZCA9IFsnbW91c2Vkb3duJywgJ3RvdWNoc3RhcnQnXS5pbmNsdWRlcyhldmVudC50eXBlKTtcbiAgICB9KTtcblxuICAgIC8vIFNob3cgY29udHJvbHMgd2hlbiB0aGV5IHJlY2VpdmUgZm9jdXMgKGUuZy4sIHdoZW4gdXNpbmcga2V5Ym9hcmQgdGFiIGtleSlcbiAgICB0aGlzLmJpbmQoZWxlbWVudHMuY29udHJvbHMsICdmb2N1c2luJywgKCkgPT4ge1xuICAgICAgY29uc3QgeyBjb25maWcsIHRpbWVycyB9ID0gcGxheWVyO1xuXG4gICAgICAvLyBTa2lwIHRyYW5zaXRpb24gdG8gcHJldmVudCBmb2N1cyBmcm9tIHNjcm9sbGluZyB0aGUgcGFyZW50IGVsZW1lbnRcbiAgICAgIHRvZ2dsZUNsYXNzKGVsZW1lbnRzLmNvbnRyb2xzLCBjb25maWcuY2xhc3NOYW1lcy5ub1RyYW5zaXRpb24sIHRydWUpO1xuXG4gICAgICAvLyBUb2dnbGVcbiAgICAgIHVpLnRvZ2dsZUNvbnRyb2xzLmNhbGwocGxheWVyLCB0cnVlKTtcblxuICAgICAgLy8gUmVzdG9yZSB0cmFuc2l0aW9uXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdG9nZ2xlQ2xhc3MoZWxlbWVudHMuY29udHJvbHMsIGNvbmZpZy5jbGFzc05hbWVzLm5vVHJhbnNpdGlvbiwgZmFsc2UpO1xuICAgICAgfSwgMCk7XG5cbiAgICAgIC8vIERlbGF5IGEgbGl0dGxlIG1vcmUgZm9yIG1vdXNlIHVzZXJzXG4gICAgICBjb25zdCBkZWxheSA9IHRoaXMudG91Y2ggPyAzMDAwIDogNDAwMDtcblxuICAgICAgLy8gQ2xlYXIgdGltZXJcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lcnMuY29udHJvbHMpO1xuXG4gICAgICAvLyBIaWRlIGFnYWluIGFmdGVyIGRlbGF5XG4gICAgICB0aW1lcnMuY29udHJvbHMgPSBzZXRUaW1lb3V0KCgpID0+IHVpLnRvZ2dsZUNvbnRyb2xzLmNhbGwocGxheWVyLCBmYWxzZSksIGRlbGF5KTtcbiAgICB9KTtcblxuICAgIC8vIE1vdXNlIHdoZWVsIGZvciB2b2x1bWVcbiAgICB0aGlzLmJpbmQoXG4gICAgICBlbGVtZW50cy5pbnB1dHMudm9sdW1lLFxuICAgICAgJ3doZWVsJyxcbiAgICAgIChldmVudCkgPT4ge1xuICAgICAgICAvLyBEZXRlY3QgXCJuYXR1cmFsXCIgc2Nyb2xsIC0gc3VwcG9ydGVkIG9uIE9TIFggU2FmYXJpIG9ubHlcbiAgICAgICAgLy8gT3RoZXIgYnJvd3NlcnMgb24gT1MgWCB3aWxsIGJlIGludmVydGVkIHVudGlsIHN1cHBvcnQgaW1wcm92ZXNcbiAgICAgICAgY29uc3QgaW52ZXJ0ZWQgPSBldmVudC53ZWJraXREaXJlY3Rpb25JbnZlcnRlZEZyb21EZXZpY2U7XG4gICAgICAgIC8vIEdldCBkZWx0YSBmcm9tIGV2ZW50LiBJbnZlcnQgaWYgYGludmVydGVkYCBpcyB0cnVlXG4gICAgICAgIGNvbnN0IFt4LCB5XSA9IFtldmVudC5kZWx0YVgsIC1ldmVudC5kZWx0YVldLm1hcCgodmFsdWUpID0+IChpbnZlcnRlZCA/IC12YWx1ZSA6IHZhbHVlKSk7XG4gICAgICAgIC8vIFVzaW5nIHRoZSBiaWdnZXN0IGRlbHRhLCBub3JtYWxpemUgdG8gMSBvciAtMSAob3IgMCBpZiBubyBkZWx0YSlcbiAgICAgICAgY29uc3QgZGlyZWN0aW9uID0gTWF0aC5zaWduKE1hdGguYWJzKHgpID4gTWF0aC5hYnMoeSkgPyB4IDogeSk7XG5cbiAgICAgICAgLy8gQ2hhbmdlIHRoZSB2b2x1bWUgYnkgMiVcbiAgICAgICAgcGxheWVyLmluY3JlYXNlVm9sdW1lKGRpcmVjdGlvbiAvIDUwKTtcblxuICAgICAgICAvLyBEb24ndCBicmVhayBwYWdlIHNjcm9sbGluZyBhdCBtYXggYW5kIG1pblxuICAgICAgICBjb25zdCB7IHZvbHVtZSB9ID0gcGxheWVyLm1lZGlhO1xuICAgICAgICBpZiAoKGRpcmVjdGlvbiA9PT0gMSAmJiB2b2x1bWUgPCAxKSB8fCAoZGlyZWN0aW9uID09PSAtMSAmJiB2b2x1bWUgPiAwKSkge1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAndm9sdW1lJyxcbiAgICAgIGZhbHNlLFxuICAgICk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IExpc3RlbmVycztcbiIsIihmdW5jdGlvbihyb290LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoW10sIGZhY3RvcnkpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9IGVsc2Uge1xuICAgIHJvb3QubG9hZGpzID0gZmFjdG9yeSgpO1xuICB9XG59KHRoaXMsIGZ1bmN0aW9uKCkge1xuLyoqXG4gKiBHbG9iYWwgZGVwZW5kZW5jaWVzLlxuICogQGdsb2JhbCB7T2JqZWN0fSBkb2N1bWVudCAtIERPTVxuICovXG5cbnZhciBkZXZudWxsID0gZnVuY3Rpb24oKSB7fSxcbiAgICBidW5kbGVJZENhY2hlID0ge30sXG4gICAgYnVuZGxlUmVzdWx0Q2FjaGUgPSB7fSxcbiAgICBidW5kbGVDYWxsYmFja1F1ZXVlID0ge307XG5cblxuLyoqXG4gKiBTdWJzY3JpYmUgdG8gYnVuZGxlIGxvYWQgZXZlbnQuXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBidW5kbGVJZHMgLSBCdW5kbGUgaWRzXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja0ZuIC0gVGhlIGNhbGxiYWNrIGZ1bmN0aW9uXG4gKi9cbmZ1bmN0aW9uIHN1YnNjcmliZShidW5kbGVJZHMsIGNhbGxiYWNrRm4pIHtcbiAgLy8gbGlzdGlmeVxuICBidW5kbGVJZHMgPSBidW5kbGVJZHMucHVzaCA/IGJ1bmRsZUlkcyA6IFtidW5kbGVJZHNdO1xuXG4gIHZhciBkZXBzTm90Rm91bmQgPSBbXSxcbiAgICAgIGkgPSBidW5kbGVJZHMubGVuZ3RoLFxuICAgICAgbnVtV2FpdGluZyA9IGksXG4gICAgICBmbixcbiAgICAgIGJ1bmRsZUlkLFxuICAgICAgcixcbiAgICAgIHE7XG5cbiAgLy8gZGVmaW5lIGNhbGxiYWNrIGZ1bmN0aW9uXG4gIGZuID0gZnVuY3Rpb24gKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKSB7XG4gICAgaWYgKHBhdGhzTm90Rm91bmQubGVuZ3RoKSBkZXBzTm90Rm91bmQucHVzaChidW5kbGVJZCk7XG5cbiAgICBudW1XYWl0aW5nLS07XG4gICAgaWYgKCFudW1XYWl0aW5nKSBjYWxsYmFja0ZuKGRlcHNOb3RGb3VuZCk7XG4gIH07XG5cbiAgLy8gcmVnaXN0ZXIgY2FsbGJhY2tcbiAgd2hpbGUgKGktLSkge1xuICAgIGJ1bmRsZUlkID0gYnVuZGxlSWRzW2ldO1xuXG4gICAgLy8gZXhlY3V0ZSBjYWxsYmFjayBpZiBpbiByZXN1bHQgY2FjaGVcbiAgICByID0gYnVuZGxlUmVzdWx0Q2FjaGVbYnVuZGxlSWRdO1xuICAgIGlmIChyKSB7XG4gICAgICBmbihidW5kbGVJZCwgcik7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICAvLyBhZGQgdG8gY2FsbGJhY2sgcXVldWVcbiAgICBxID0gYnVuZGxlQ2FsbGJhY2tRdWV1ZVtidW5kbGVJZF0gPSBidW5kbGVDYWxsYmFja1F1ZXVlW2J1bmRsZUlkXSB8fCBbXTtcbiAgICBxLnB1c2goZm4pO1xuICB9XG59XG5cblxuLyoqXG4gKiBQdWJsaXNoIGJ1bmRsZSBsb2FkIGV2ZW50LlxuICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlkIC0gQnVuZGxlIGlkXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBwYXRoc05vdEZvdW5kIC0gTGlzdCBvZiBmaWxlcyBub3QgZm91bmRcbiAqL1xuZnVuY3Rpb24gcHVibGlzaChidW5kbGVJZCwgcGF0aHNOb3RGb3VuZCkge1xuICAvLyBleGl0IGlmIGlkIGlzbid0IGRlZmluZWRcbiAgaWYgKCFidW5kbGVJZCkgcmV0dXJuO1xuXG4gIHZhciBxID0gYnVuZGxlQ2FsbGJhY2tRdWV1ZVtidW5kbGVJZF07XG5cbiAgLy8gY2FjaGUgcmVzdWx0XG4gIGJ1bmRsZVJlc3VsdENhY2hlW2J1bmRsZUlkXSA9IHBhdGhzTm90Rm91bmQ7XG5cbiAgLy8gZXhpdCBpZiBxdWV1ZSBpcyBlbXB0eVxuICBpZiAoIXEpIHJldHVybjtcblxuICAvLyBlbXB0eSBjYWxsYmFjayBxdWV1ZVxuICB3aGlsZSAocS5sZW5ndGgpIHtcbiAgICBxWzBdKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKTtcbiAgICBxLnNwbGljZSgwLCAxKTtcbiAgfVxufVxuXG5cbi8qKlxuICogRXhlY3V0ZSBjYWxsYmFja3MuXG4gKiBAcGFyYW0ge09iamVjdCBvciBGdW5jdGlvbn0gYXJncyAtIFRoZSBjYWxsYmFjayBhcmdzXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBkZXBzTm90Rm91bmQgLSBMaXN0IG9mIGRlcGVuZGVuY2llcyBub3QgZm91bmRcbiAqL1xuZnVuY3Rpb24gZXhlY3V0ZUNhbGxiYWNrcyhhcmdzLCBkZXBzTm90Rm91bmQpIHtcbiAgLy8gYWNjZXB0IGZ1bmN0aW9uIGFzIGFyZ3VtZW50XG4gIGlmIChhcmdzLmNhbGwpIGFyZ3MgPSB7c3VjY2VzczogYXJnc307XG5cbiAgLy8gc3VjY2VzcyBhbmQgZXJyb3IgY2FsbGJhY2tzXG4gIGlmIChkZXBzTm90Rm91bmQubGVuZ3RoKSAoYXJncy5lcnJvciB8fCBkZXZudWxsKShkZXBzTm90Rm91bmQpO1xuICBlbHNlIChhcmdzLnN1Y2Nlc3MgfHwgZGV2bnVsbCkoYXJncyk7XG59XG5cblxuLyoqXG4gKiBMb2FkIGluZGl2aWR1YWwgZmlsZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIC0gVGhlIGZpbGUgcGF0aFxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tGbiAtIFRoZSBjYWxsYmFjayBmdW5jdGlvblxuICovXG5mdW5jdGlvbiBsb2FkRmlsZShwYXRoLCBjYWxsYmFja0ZuLCBhcmdzLCBudW1Ucmllcykge1xuICB2YXIgZG9jID0gZG9jdW1lbnQsXG4gICAgICBhc3luYyA9IGFyZ3MuYXN5bmMsXG4gICAgICBtYXhUcmllcyA9IChhcmdzLm51bVJldHJpZXMgfHwgMCkgKyAxLFxuICAgICAgYmVmb3JlQ2FsbGJhY2tGbiA9IGFyZ3MuYmVmb3JlIHx8IGRldm51bGwsXG4gICAgICBwYXRobmFtZSA9IHBhdGgucmVwbGFjZSgvW1xcP3wjXS4qJC8sICcnKSxcbiAgICAgIHBhdGhTdHJpcHBlZCA9IHBhdGgucmVwbGFjZSgvXihjc3N8aW1nKSEvLCAnJyksXG4gICAgICBpc0xlZ2FjeUlFQ3NzLFxuICAgICAgZTtcblxuICBudW1UcmllcyA9IG51bVRyaWVzIHx8IDA7XG5cbiAgaWYgKC8oXmNzcyF8XFwuY3NzJCkvLnRlc3QocGF0aG5hbWUpKSB7XG4gICAgLy8gY3NzXG4gICAgZSA9IGRvYy5jcmVhdGVFbGVtZW50KCdsaW5rJyk7XG4gICAgZS5yZWwgPSAnc3R5bGVzaGVldCc7XG4gICAgZS5ocmVmID0gcGF0aFN0cmlwcGVkO1xuXG4gICAgLy8gdGFnIElFOStcbiAgICBpc0xlZ2FjeUlFQ3NzID0gJ2hpZGVGb2N1cycgaW4gZTtcblxuICAgIC8vIHVzZSBwcmVsb2FkIGluIElFIEVkZ2UgKHRvIGRldGVjdCBsb2FkIGVycm9ycylcbiAgICBpZiAoaXNMZWdhY3lJRUNzcyAmJiBlLnJlbExpc3QpIHtcbiAgICAgIGlzTGVnYWN5SUVDc3MgPSAwO1xuICAgICAgZS5yZWwgPSAncHJlbG9hZCc7XG4gICAgICBlLmFzID0gJ3N0eWxlJztcbiAgICB9XG4gIH0gZWxzZSBpZiAoLyheaW1nIXxcXC4ocG5nfGdpZnxqcGd8c3ZnfHdlYnApJCkvLnRlc3QocGF0aG5hbWUpKSB7XG4gICAgLy8gaW1hZ2VcbiAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIGUuc3JjID0gcGF0aFN0cmlwcGVkOyAgICBcbiAgfSBlbHNlIHtcbiAgICAvLyBqYXZhc2NyaXB0XG4gICAgZSA9IGRvYy5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICBlLnNyYyA9IHBhdGg7XG4gICAgZS5hc3luYyA9IGFzeW5jID09PSB1bmRlZmluZWQgPyB0cnVlIDogYXN5bmM7XG4gIH1cblxuICBlLm9ubG9hZCA9IGUub25lcnJvciA9IGUub25iZWZvcmVsb2FkID0gZnVuY3Rpb24gKGV2KSB7XG4gICAgdmFyIHJlc3VsdCA9IGV2LnR5cGVbMF07XG5cbiAgICAvLyB0cmVhdCBlbXB0eSBzdHlsZXNoZWV0cyBhcyBmYWlsdXJlcyB0byBnZXQgYXJvdW5kIGxhY2sgb2Ygb25lcnJvclxuICAgIC8vIHN1cHBvcnQgaW4gSUU5LTExXG4gICAgaWYgKGlzTGVnYWN5SUVDc3MpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmICghZS5zaGVldC5jc3NUZXh0Lmxlbmd0aCkgcmVzdWx0ID0gJ2UnO1xuICAgICAgfSBjYXRjaCAoeCkge1xuICAgICAgICAvLyBzaGVldHMgb2JqZWN0cyBjcmVhdGVkIGZyb20gbG9hZCBlcnJvcnMgZG9uJ3QgYWxsb3cgYWNjZXNzIHRvXG4gICAgICAgIC8vIGBjc3NUZXh0YCAodW5sZXNzIGVycm9yIGlzIENvZGU6MTggU2VjdXJpdHlFcnJvcilcbiAgICAgICAgaWYgKHguY29kZSAhPSAxOCkgcmVzdWx0ID0gJ2UnO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGhhbmRsZSByZXRyaWVzIGluIGNhc2Ugb2YgbG9hZCBmYWlsdXJlXG4gICAgaWYgKHJlc3VsdCA9PSAnZScpIHtcbiAgICAgIC8vIGluY3JlbWVudCBjb3VudGVyXG4gICAgICBudW1UcmllcyArPSAxO1xuXG4gICAgICAvLyBleGl0IGZ1bmN0aW9uIGFuZCB0cnkgYWdhaW5cbiAgICAgIGlmIChudW1UcmllcyA8IG1heFRyaWVzKSB7XG4gICAgICAgIHJldHVybiBsb2FkRmlsZShwYXRoLCBjYWxsYmFja0ZuLCBhcmdzLCBudW1Ucmllcyk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChlLnJlbCA9PSAncHJlbG9hZCcgJiYgZS5hcyA9PSAnc3R5bGUnKSB7XG4gICAgICAvLyBhY3RpdmF0ZSBwcmVsb2FkZWQgc3R5bGVzaGVldHNcbiAgICAgIHJldHVybiBlLnJlbCA9ICdzdHlsZXNoZWV0JzsgLy8ganNoaW50IGlnbm9yZTpsaW5lXG4gICAgfVxuICAgIFxuICAgIC8vIGV4ZWN1dGUgY2FsbGJhY2tcbiAgICBjYWxsYmFja0ZuKHBhdGgsIHJlc3VsdCwgZXYuZGVmYXVsdFByZXZlbnRlZCk7XG4gIH07XG5cbiAgLy8gYWRkIHRvIGRvY3VtZW50ICh1bmxlc3MgY2FsbGJhY2sgcmV0dXJucyBgZmFsc2VgKVxuICBpZiAoYmVmb3JlQ2FsbGJhY2tGbihwYXRoLCBlKSAhPT0gZmFsc2UpIGRvYy5oZWFkLmFwcGVuZENoaWxkKGUpO1xufVxuXG5cbi8qKlxuICogTG9hZCBtdWx0aXBsZSBmaWxlcy5cbiAqIEBwYXJhbSB7c3RyaW5nW119IHBhdGhzIC0gVGhlIGZpbGUgcGF0aHNcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrRm4gLSBUaGUgY2FsbGJhY2sgZnVuY3Rpb25cbiAqL1xuZnVuY3Rpb24gbG9hZEZpbGVzKHBhdGhzLCBjYWxsYmFja0ZuLCBhcmdzKSB7XG4gIC8vIGxpc3RpZnkgcGF0aHNcbiAgcGF0aHMgPSBwYXRocy5wdXNoID8gcGF0aHMgOiBbcGF0aHNdO1xuXG4gIHZhciBudW1XYWl0aW5nID0gcGF0aHMubGVuZ3RoLFxuICAgICAgeCA9IG51bVdhaXRpbmcsXG4gICAgICBwYXRoc05vdEZvdW5kID0gW10sXG4gICAgICBmbixcbiAgICAgIGk7XG5cbiAgLy8gZGVmaW5lIGNhbGxiYWNrIGZ1bmN0aW9uXG4gIGZuID0gZnVuY3Rpb24ocGF0aCwgcmVzdWx0LCBkZWZhdWx0UHJldmVudGVkKSB7XG4gICAgLy8gaGFuZGxlIGVycm9yXG4gICAgaWYgKHJlc3VsdCA9PSAnZScpIHBhdGhzTm90Rm91bmQucHVzaChwYXRoKTtcblxuICAgIC8vIGhhbmRsZSBiZWZvcmVsb2FkIGV2ZW50LiBJZiBkZWZhdWx0UHJldmVudGVkIHRoZW4gdGhhdCBtZWFucyB0aGUgbG9hZFxuICAgIC8vIHdpbGwgYmUgYmxvY2tlZCAoZXguIEdob3N0ZXJ5L0FCUCBvbiBTYWZhcmkpXG4gICAgaWYgKHJlc3VsdCA9PSAnYicpIHtcbiAgICAgIGlmIChkZWZhdWx0UHJldmVudGVkKSBwYXRoc05vdEZvdW5kLnB1c2gocGF0aCk7XG4gICAgICBlbHNlIHJldHVybjtcbiAgICB9XG5cbiAgICBudW1XYWl0aW5nLS07XG4gICAgaWYgKCFudW1XYWl0aW5nKSBjYWxsYmFja0ZuKHBhdGhzTm90Rm91bmQpO1xuICB9O1xuXG4gIC8vIGxvYWQgc2NyaXB0c1xuICBmb3IgKGk9MDsgaSA8IHg7IGkrKykgbG9hZEZpbGUocGF0aHNbaV0sIGZuLCBhcmdzKTtcbn1cblxuXG4vKipcbiAqIEluaXRpYXRlIHNjcmlwdCBsb2FkIGFuZCByZWdpc3RlciBidW5kbGUuXG4gKiBAcGFyYW0geyhzdHJpbmd8c3RyaW5nW10pfSBwYXRocyAtIFRoZSBmaWxlIHBhdGhzXG4gKiBAcGFyYW0geyhzdHJpbmd8RnVuY3Rpb258T2JqZWN0KX0gW2FyZzFdIC0gVGhlICgxKSBidW5kbGVJZCBvciAoMikgc3VjY2Vzc1xuICogICBjYWxsYmFjayBvciAoMykgb2JqZWN0IGxpdGVyYWwgd2l0aCBzdWNjZXNzL2Vycm9yIGFyZ3VtZW50cywgbnVtUmV0cmllcyxcbiAqICAgZXRjLlxuICogQHBhcmFtIHsoRnVuY3Rpb258T2JqZWN0KX0gW2FyZzJdIC0gVGhlICgxKSBzdWNjZXNzIGNhbGxiYWNrIG9yICgyKSBvYmplY3RcbiAqICAgbGl0ZXJhbCB3aXRoIHN1Y2Nlc3MvZXJyb3IgYXJndW1lbnRzLCBudW1SZXRyaWVzLCBldGMuXG4gKi9cbmZ1bmN0aW9uIGxvYWRqcyhwYXRocywgYXJnMSwgYXJnMikge1xuICB2YXIgYnVuZGxlSWQsXG4gICAgICBhcmdzO1xuXG4gIC8vIGJ1bmRsZUlkIChpZiBzdHJpbmcpXG4gIGlmIChhcmcxICYmIGFyZzEudHJpbSkgYnVuZGxlSWQgPSBhcmcxO1xuXG4gIC8vIGFyZ3MgKGRlZmF1bHQgaXMge30pXG4gIGFyZ3MgPSAoYnVuZGxlSWQgPyBhcmcyIDogYXJnMSkgfHwge307XG5cbiAgLy8gdGhyb3cgZXJyb3IgaWYgYnVuZGxlIGlzIGFscmVhZHkgZGVmaW5lZFxuICBpZiAoYnVuZGxlSWQpIHtcbiAgICBpZiAoYnVuZGxlSWQgaW4gYnVuZGxlSWRDYWNoZSkge1xuICAgICAgdGhyb3cgXCJMb2FkSlNcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgYnVuZGxlSWRDYWNoZVtidW5kbGVJZF0gPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGxvYWRGbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICBsb2FkRmlsZXMocGF0aHMsIGZ1bmN0aW9uIChwYXRoc05vdEZvdW5kKSB7XG4gICAgICAvLyBleGVjdXRlIGNhbGxiYWNrc1xuICAgICAgZXhlY3V0ZUNhbGxiYWNrcyhhcmdzLCBwYXRoc05vdEZvdW5kKTtcbiAgICAgIFxuICAgICAgLy8gcmVzb2x2ZSBQcm9taXNlXG4gICAgICBpZiAocmVzb2x2ZSkge1xuICAgICAgICBleGVjdXRlQ2FsbGJhY2tzKHtzdWNjZXNzOiByZXNvbHZlLCBlcnJvcjogcmVqZWN0fSwgcGF0aHNOb3RGb3VuZCk7XG4gICAgICB9XG5cbiAgICAgIC8vIHB1Ymxpc2ggYnVuZGxlIGxvYWQgZXZlbnRcbiAgICAgIHB1Ymxpc2goYnVuZGxlSWQsIHBhdGhzTm90Rm91bmQpO1xuICAgIH0sIGFyZ3MpO1xuICB9XG4gIFxuICBpZiAoYXJncy5yZXR1cm5Qcm9taXNlKSByZXR1cm4gbmV3IFByb21pc2UobG9hZEZuKTtcbiAgZWxzZSBsb2FkRm4oKTtcbn1cblxuXG4vKipcbiAqIEV4ZWN1dGUgY2FsbGJhY2tzIHdoZW4gZGVwZW5kZW5jaWVzIGhhdmUgYmVlbiBzYXRpc2ZpZWQuXG4gKiBAcGFyYW0geyhzdHJpbmd8c3RyaW5nW10pfSBkZXBzIC0gTGlzdCBvZiBidW5kbGUgaWRzXG4gKiBAcGFyYW0ge09iamVjdH0gYXJncyAtIHN1Y2Nlc3MvZXJyb3IgYXJndW1lbnRzXG4gKi9cbmxvYWRqcy5yZWFkeSA9IGZ1bmN0aW9uIHJlYWR5KGRlcHMsIGFyZ3MpIHtcbiAgLy8gc3Vic2NyaWJlIHRvIGJ1bmRsZSBsb2FkIGV2ZW50XG4gIHN1YnNjcmliZShkZXBzLCBmdW5jdGlvbiAoZGVwc05vdEZvdW5kKSB7XG4gICAgLy8gZXhlY3V0ZSBjYWxsYmFja3NcbiAgICBleGVjdXRlQ2FsbGJhY2tzKGFyZ3MsIGRlcHNOb3RGb3VuZCk7XG4gIH0pO1xuXG4gIHJldHVybiBsb2FkanM7XG59O1xuXG5cbi8qKlxuICogTWFudWFsbHkgc2F0aXNmeSBidW5kbGUgZGVwZW5kZW5jaWVzLlxuICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlkIC0gVGhlIGJ1bmRsZSBpZFxuICovXG5sb2FkanMuZG9uZSA9IGZ1bmN0aW9uIGRvbmUoYnVuZGxlSWQpIHtcbiAgcHVibGlzaChidW5kbGVJZCwgW10pO1xufTtcblxuXG4vKipcbiAqIFJlc2V0IGxvYWRqcyBkZXBlbmRlbmNpZXMgc3RhdHVzZXNcbiAqL1xubG9hZGpzLnJlc2V0ID0gZnVuY3Rpb24gcmVzZXQoKSB7XG4gIGJ1bmRsZUlkQ2FjaGUgPSB7fTtcbiAgYnVuZGxlUmVzdWx0Q2FjaGUgPSB7fTtcbiAgYnVuZGxlQ2FsbGJhY2tRdWV1ZSA9IHt9O1xufTtcblxuXG4vKipcbiAqIERldGVybWluZSBpZiBidW5kbGUgaGFzIGFscmVhZHkgYmVlbiBkZWZpbmVkXG4gKiBAcGFyYW0gU3RyaW5nfSBidW5kbGVJZCAtIFRoZSBidW5kbGUgaWRcbiAqL1xubG9hZGpzLmlzRGVmaW5lZCA9IGZ1bmN0aW9uIGlzRGVmaW5lZChidW5kbGVJZCkge1xuICByZXR1cm4gYnVuZGxlSWQgaW4gYnVuZGxlSWRDYWNoZTtcbn07XG5cblxuLy8gZXhwb3J0XG5yZXR1cm4gbG9hZGpzO1xuXG59KSk7XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gTG9hZCBhbiBleHRlcm5hbCBzY3JpcHRcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBsb2FkanMgZnJvbSAnbG9hZGpzJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbG9hZFNjcmlwdCh1cmwpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBsb2FkanModXJsLCB7XG4gICAgICBzdWNjZXNzOiByZXNvbHZlLFxuICAgICAgZXJyb3I6IHJlamVjdCxcbiAgICB9KTtcbiAgfSk7XG59XG4iLCIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVmltZW8gcGx1Z2luXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgY2FwdGlvbnMgZnJvbSAnLi4vY2FwdGlvbnMnO1xuaW1wb3J0IGNvbnRyb2xzIGZyb20gJy4uL2NvbnRyb2xzJztcbmltcG9ydCB1aSBmcm9tICcuLi91aSc7XG5pbXBvcnQgeyBjcmVhdGVFbGVtZW50LCByZXBsYWNlRWxlbWVudCwgdG9nZ2xlQ2xhc3MgfSBmcm9tICcuLi91dGlscy9lbGVtZW50cyc7XG5pbXBvcnQgeyB0cmlnZ2VyRXZlbnQgfSBmcm9tICcuLi91dGlscy9ldmVudHMnO1xuaW1wb3J0IGZldGNoIGZyb20gJy4uL3V0aWxzL2ZldGNoJztcbmltcG9ydCBpcyBmcm9tICcuLi91dGlscy9pcyc7XG5pbXBvcnQgbG9hZFNjcmlwdCBmcm9tICcuLi91dGlscy9sb2FkLXNjcmlwdCc7XG5pbXBvcnQgeyBmb3JtYXQsIHN0cmlwSFRNTCB9IGZyb20gJy4uL3V0aWxzL3N0cmluZ3MnO1xuaW1wb3J0IHsgcm91bmRBc3BlY3RSYXRpbywgc2V0QXNwZWN0UmF0aW8gfSBmcm9tICcuLi91dGlscy9zdHlsZSc7XG5pbXBvcnQgeyBidWlsZFVybFBhcmFtcyB9IGZyb20gJy4uL3V0aWxzL3VybHMnO1xuXG4vLyBQYXJzZSBWaW1lbyBJRCBmcm9tIFVSTFxuZnVuY3Rpb24gcGFyc2VJZCh1cmwpIHtcbiAgaWYgKGlzLmVtcHR5KHVybCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGlmIChpcy5udW1iZXIoTnVtYmVyKHVybCkpKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuXG4gIGNvbnN0IHJlZ2V4ID0gL14uKih2aW1lby5jb21cXC98dmlkZW9cXC8pKFxcZCspLiovO1xuICByZXR1cm4gdXJsLm1hdGNoKHJlZ2V4KSA/IFJlZ0V4cC4kMiA6IHVybDtcbn1cblxuLy8gVHJ5IHRvIGV4dHJhY3QgYSBoYXNoIGZvciBwcml2YXRlIHZpZGVvcyBmcm9tIHRoZSBVUkxcbmZ1bmN0aW9uIHBhcnNlSGFzaCh1cmwpIHtcbiAgLyogVGhpcyByZWdleCBtYXRjaGVzIGEgaGV4YWRlY2ltYWwgaGFzaCBpZiBnaXZlbiBpbiBhbnkgb2YgdGhlc2UgZm9ybXM6XG4gICAqICAtIFtodHRwczovL3BsYXllci5ddmltZW8uY29tL3ZpZGVvL3tpZH0ve2hhc2h9Wz9wYXJhbXNdXG4gICAqICAtIFtodHRwczovL3BsYXllci5ddmltZW8uY29tL3ZpZGVvL3tpZH0/aD17aGFzaH1bJnBhcmFtc11cbiAgICogIC0gW2h0dHBzOi8vcGxheWVyLl12aW1lby5jb20vdmlkZW8ve2lkfT9bcGFyYW1zXSZoPXtoYXNofVxuICAgKiAgLSB2aWRlby97aWR9L3toYXNofVxuICAgKiBJZiBtYXRjaGVkLCB0aGUgaGFzaCBpcyBhdmFpbGFibGUgaW4gY2FwdHVyZSBncm91cCA0XG4gICAqL1xuICBjb25zdCByZWdleCA9IC9eLioodmltZW8uY29tXFwvfHZpZGVvXFwvKShcXGQrKShcXD8uKiYqaD18XFwvKSsoW1xcZCxhLWZdKykvO1xuICBjb25zdCBmb3VuZCA9IHVybC5tYXRjaChyZWdleCk7XG5cbiAgcmV0dXJuIGZvdW5kICYmIGZvdW5kLmxlbmd0aCA9PT0gNSA/IGZvdW5kWzRdIDogbnVsbDtcbn1cblxuLy8gU2V0IHBsYXliYWNrIHN0YXRlIGFuZCB0cmlnZ2VyIGNoYW5nZSAob25seSBvbiBhY3R1YWwgY2hhbmdlKVxuZnVuY3Rpb24gYXNzdXJlUGxheWJhY2tTdGF0ZShwbGF5KSB7XG4gIGlmIChwbGF5ICYmICF0aGlzLmVtYmVkLmhhc1BsYXllZCkge1xuICAgIHRoaXMuZW1iZWQuaGFzUGxheWVkID0gdHJ1ZTtcbiAgfVxuICBpZiAodGhpcy5tZWRpYS5wYXVzZWQgPT09IHBsYXkpIHtcbiAgICB0aGlzLm1lZGlhLnBhdXNlZCA9ICFwbGF5O1xuICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsIHBsYXkgPyAncGxheScgOiAncGF1c2UnKTtcbiAgfVxufVxuXG5jb25zdCB2aW1lbyA9IHtcbiAgc2V0dXAoKSB7XG4gICAgY29uc3QgcGxheWVyID0gdGhpcztcblxuICAgIC8vIEFkZCBlbWJlZCBjbGFzcyBmb3IgcmVzcG9uc2l2ZVxuICAgIHRvZ2dsZUNsYXNzKHBsYXllci5lbGVtZW50cy53cmFwcGVyLCBwbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMuZW1iZWQsIHRydWUpO1xuXG4gICAgLy8gU2V0IHNwZWVkIG9wdGlvbnMgZnJvbSBjb25maWdcbiAgICBwbGF5ZXIub3B0aW9ucy5zcGVlZCA9IHBsYXllci5jb25maWcuc3BlZWQub3B0aW9ucztcblxuICAgIC8vIFNldCBpbnRpYWwgcmF0aW9cbiAgICBzZXRBc3BlY3RSYXRpby5jYWxsKHBsYXllcik7XG5cbiAgICAvLyBMb2FkIHRoZSBTREsgaWYgbm90IGFscmVhZHlcbiAgICBpZiAoIWlzLm9iamVjdCh3aW5kb3cuVmltZW8pKSB7XG4gICAgICBsb2FkU2NyaXB0KHBsYXllci5jb25maWcudXJscy52aW1lby5zZGspXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICB2aW1lby5yZWFkeS5jYWxsKHBsYXllcik7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICBwbGF5ZXIuZGVidWcud2FybignVmltZW8gU0RLIChwbGF5ZXIuanMpIGZhaWxlZCB0byBsb2FkJywgZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmltZW8ucmVhZHkuY2FsbChwbGF5ZXIpO1xuICAgIH1cbiAgfSxcblxuICAvLyBBUEkgUmVhZHlcbiAgcmVhZHkoKSB7XG4gICAgY29uc3QgcGxheWVyID0gdGhpcztcbiAgICBjb25zdCBjb25maWcgPSBwbGF5ZXIuY29uZmlnLnZpbWVvO1xuICAgIGNvbnN0IHsgcHJlbWl1bSwgcmVmZXJyZXJQb2xpY3ksIC4uLmZyYW1lUGFyYW1zIH0gPSBjb25maWc7XG4gICAgLy8gR2V0IHRoZSBzb3VyY2UgVVJMIG9yIElEXG4gICAgbGV0IHNvdXJjZSA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuICAgIGxldCBoYXNoID0gJyc7XG4gICAgLy8gR2V0IGZyb20gPGRpdj4gaWYgbmVlZGVkXG4gICAgaWYgKGlzLmVtcHR5KHNvdXJjZSkpIHtcbiAgICAgIHNvdXJjZSA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUocGxheWVyLmNvbmZpZy5hdHRyaWJ1dGVzLmVtYmVkLmlkKTtcbiAgICAgIC8vIGhhc2ggY2FuIGFsc28gYmUgc2V0IGFzIGF0dHJpYnV0ZSBvbiB0aGUgPGRpdj5cbiAgICAgIGhhc2ggPSBwbGF5ZXIubWVkaWEuZ2V0QXR0cmlidXRlKHBsYXllci5jb25maWcuYXR0cmlidXRlcy5lbWJlZC5oYXNoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaGFzaCA9IHBhcnNlSGFzaChzb3VyY2UpO1xuICAgIH1cbiAgICBjb25zdCBoYXNoUGFyYW0gPSBoYXNoID8geyBoOiBoYXNoIH0gOiB7fTtcblxuICAgIC8vIElmIHRoZSBvd25lciBoYXMgYSBwcm8gb3IgcHJlbWl1bSBhY2NvdW50IHRoZW4gd2UgY2FuIGhpZGUgY29udHJvbHMgZXRjXG4gICAgaWYgKHByZW1pdW0pIHtcbiAgICAgIE9iamVjdC5hc3NpZ24oZnJhbWVQYXJhbXMsIHtcbiAgICAgICAgY29udHJvbHM6IGZhbHNlLFxuICAgICAgICBzaWRlZG9jazogZmFsc2UsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBHZXQgVmltZW8gcGFyYW1zIGZvciB0aGUgaWZyYW1lXG4gICAgY29uc3QgcGFyYW1zID0gYnVpbGRVcmxQYXJhbXMoe1xuICAgICAgbG9vcDogcGxheWVyLmNvbmZpZy5sb29wLmFjdGl2ZSxcbiAgICAgIGF1dG9wbGF5OiBwbGF5ZXIuYXV0b3BsYXksXG4gICAgICBtdXRlZDogcGxheWVyLm11dGVkLFxuICAgICAgZ2VzdHVyZTogJ21lZGlhJyxcbiAgICAgIHBsYXlzaW5saW5lOiAhdGhpcy5jb25maWcuZnVsbHNjcmVlbi5pb3NOYXRpdmUsXG4gICAgICAvLyBoYXNoIGhhcyB0byBiZSBhZGRlZCB0byBpZnJhbWUtVVJMXG4gICAgICAuLi5oYXNoUGFyYW0sXG4gICAgICAuLi5mcmFtZVBhcmFtcyxcbiAgICB9KTtcblxuICAgIGNvbnN0IGlkID0gcGFyc2VJZChzb3VyY2UpO1xuICAgIC8vIEJ1aWxkIGFuIGlmcmFtZVxuICAgIGNvbnN0IGlmcmFtZSA9IGNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpO1xuICAgIGNvbnN0IHNyYyA9IGZvcm1hdChwbGF5ZXIuY29uZmlnLnVybHMudmltZW8uaWZyYW1lLCBpZCwgcGFyYW1zKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdzcmMnLCBzcmMpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2FsbG93ZnVsbHNjcmVlbicsICcnKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFxuICAgICAgJ2FsbG93JyxcbiAgICAgIFsnYXV0b3BsYXknLCAnZnVsbHNjcmVlbicsICdwaWN0dXJlLWluLXBpY3R1cmUnLCAnZW5jcnlwdGVkLW1lZGlhJywgJ2FjY2VsZXJvbWV0ZXInLCAnZ3lyb3Njb3BlJ10uam9pbignOyAnKSxcbiAgICApO1xuXG4gICAgLy8gU2V0IHRoZSByZWZlcnJlciBwb2xpY3kgaWYgcmVxdWlyZWRcbiAgICBpZiAoIWlzLmVtcHR5KHJlZmVycmVyUG9saWN5KSkge1xuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgncmVmZXJyZXJQb2xpY3knLCByZWZlcnJlclBvbGljeSk7XG4gICAgfVxuXG4gICAgLy8gSW5qZWN0IHRoZSBwYWNrYWdlXG4gICAgaWYgKHByZW1pdW0gfHwgIWNvbmZpZy5jdXN0b21Db250cm9scykge1xuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnZGF0YS1wb3N0ZXInLCBwbGF5ZXIucG9zdGVyKTtcbiAgICAgIHBsYXllci5tZWRpYSA9IHJlcGxhY2VFbGVtZW50KGlmcmFtZSwgcGxheWVyLm1lZGlhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgICAgY2xhc3M6IHBsYXllci5jb25maWcuY2xhc3NOYW1lcy5lbWJlZENvbnRhaW5lcixcbiAgICAgICAgJ2RhdGEtcG9zdGVyJzogcGxheWVyLnBvc3RlcixcbiAgICAgIH0pO1xuICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChpZnJhbWUpO1xuICAgICAgcGxheWVyLm1lZGlhID0gcmVwbGFjZUVsZW1lbnQod3JhcHBlciwgcGxheWVyLm1lZGlhKTtcbiAgICB9XG5cbiAgICAvLyBHZXQgcG9zdGVyIGltYWdlXG4gICAgaWYgKCFjb25maWcuY3VzdG9tQ29udHJvbHMpIHtcbiAgICAgIGZldGNoKGZvcm1hdChwbGF5ZXIuY29uZmlnLnVybHMudmltZW8uYXBpLCBzcmMpKS50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICBpZiAoaXMuZW1wdHkocmVzcG9uc2UpIHx8ICFyZXNwb25zZS50aHVtYm5haWxfdXJsKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0IGFuZCBzaG93IHBvc3RlclxuICAgICAgICB1aS5zZXRQb3N0ZXIuY2FsbChwbGF5ZXIsIHJlc3BvbnNlLnRodW1ibmFpbF91cmwpLmNhdGNoKCgpID0+IHt9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFNldHVwIGluc3RhbmNlXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3ZpbWVvL3BsYXllci5qc1xuICAgIHBsYXllci5lbWJlZCA9IG5ldyB3aW5kb3cuVmltZW8uUGxheWVyKGlmcmFtZSwge1xuICAgICAgYXV0b3BhdXNlOiBwbGF5ZXIuY29uZmlnLmF1dG9wYXVzZSxcbiAgICAgIG11dGVkOiBwbGF5ZXIubXV0ZWQsXG4gICAgfSk7XG5cbiAgICBwbGF5ZXIubWVkaWEucGF1c2VkID0gdHJ1ZTtcbiAgICBwbGF5ZXIubWVkaWEuY3VycmVudFRpbWUgPSAwO1xuXG4gICAgLy8gRGlzYWJsZSBuYXRpdmUgdGV4dCB0cmFjayByZW5kZXJpbmdcbiAgICBpZiAocGxheWVyLnN1cHBvcnRlZC51aSkge1xuICAgICAgcGxheWVyLmVtYmVkLmRpc2FibGVUZXh0VHJhY2soKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYSBmYXV4IEhUTUw1IEFQSSB1c2luZyB0aGUgVmltZW8gQVBJXG4gICAgcGxheWVyLm1lZGlhLnBsYXkgPSAoKSA9PiB7XG4gICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCB0cnVlKTtcbiAgICAgIHJldHVybiBwbGF5ZXIuZW1iZWQucGxheSgpO1xuICAgIH07XG5cbiAgICBwbGF5ZXIubWVkaWEucGF1c2UgPSAoKSA9PiB7XG4gICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCBmYWxzZSk7XG4gICAgICByZXR1cm4gcGxheWVyLmVtYmVkLnBhdXNlKCk7XG4gICAgfTtcblxuICAgIHBsYXllci5tZWRpYS5zdG9wID0gKCkgPT4ge1xuICAgICAgcGxheWVyLnBhdXNlKCk7XG4gICAgICBwbGF5ZXIuY3VycmVudFRpbWUgPSAwO1xuICAgIH07XG5cbiAgICAvLyBTZWVraW5nXG4gICAgbGV0IHsgY3VycmVudFRpbWUgfSA9IHBsYXllci5tZWRpYTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnY3VycmVudFRpbWUnLCB7XG4gICAgICBnZXQoKSB7XG4gICAgICAgIHJldHVybiBjdXJyZW50VGltZTtcbiAgICAgIH0sXG4gICAgICBzZXQodGltZSkge1xuICAgICAgICAvLyBWaW1lbyB3aWxsIGF1dG9tYXRpY2FsbHkgcGxheSBvbiBzZWVrIGlmIHRoZSB2aWRlbyBoYXNuJ3QgYmVlbiBwbGF5ZWQgYmVmb3JlXG5cbiAgICAgICAgLy8gR2V0IGN1cnJlbnQgcGF1c2VkIHN0YXRlIGFuZCB2b2x1bWUgZXRjXG4gICAgICAgIGNvbnN0IHsgZW1iZWQsIG1lZGlhLCBwYXVzZWQsIHZvbHVtZSB9ID0gcGxheWVyO1xuICAgICAgICBjb25zdCByZXN0b3JlUGF1c2UgPSBwYXVzZWQgJiYgIWVtYmVkLmhhc1BsYXllZDtcblxuICAgICAgICAvLyBTZXQgc2Vla2luZyBzdGF0ZSBhbmQgdHJpZ2dlciBldmVudFxuICAgICAgICBtZWRpYS5zZWVraW5nID0gdHJ1ZTtcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBtZWRpYSwgJ3NlZWtpbmcnKTtcblxuICAgICAgICAvLyBJZiBwYXVzZWQsIG11dGUgdW50aWwgc2VlayBpcyBjb21wbGV0ZVxuICAgICAgICBQcm9taXNlLnJlc29sdmUocmVzdG9yZVBhdXNlICYmIGVtYmVkLnNldFZvbHVtZSgwKSlcbiAgICAgICAgICAvLyBTZWVrXG4gICAgICAgICAgLnRoZW4oKCkgPT4gZW1iZWQuc2V0Q3VycmVudFRpbWUodGltZSkpXG4gICAgICAgICAgLy8gUmVzdG9yZSBwYXVzZWRcbiAgICAgICAgICAudGhlbigoKSA9PiByZXN0b3JlUGF1c2UgJiYgZW1iZWQucGF1c2UoKSlcbiAgICAgICAgICAvLyBSZXN0b3JlIHZvbHVtZVxuICAgICAgICAgIC50aGVuKCgpID0+IHJlc3RvcmVQYXVzZSAmJiBlbWJlZC5zZXRWb2x1bWUodm9sdW1lKSlcbiAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgLy8gRG8gbm90aGluZ1xuICAgICAgICAgIH0pO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIFBsYXliYWNrIHNwZWVkXG4gICAgbGV0IHNwZWVkID0gcGxheWVyLmNvbmZpZy5zcGVlZC5zZWxlY3RlZDtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAncGxheWJhY2tSYXRlJywge1xuICAgICAgZ2V0KCkge1xuICAgICAgICByZXR1cm4gc3BlZWQ7XG4gICAgICB9LFxuICAgICAgc2V0KGlucHV0KSB7XG4gICAgICAgIHBsYXllci5lbWJlZFxuICAgICAgICAgIC5zZXRQbGF5YmFja1JhdGUoaW5wdXQpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgc3BlZWQgPSBpbnB1dDtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncmF0ZWNoYW5nZScpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAgIC8vIENhbm5vdCBzZXQgUGxheWJhY2sgUmF0ZSwgVmlkZW8gaXMgcHJvYmFibHkgbm90IG9uIFBybyBhY2NvdW50XG4gICAgICAgICAgICBwbGF5ZXIub3B0aW9ucy5zcGVlZCA9IFsxXTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBWb2x1bWVcbiAgICBsZXQgeyB2b2x1bWUgfSA9IHBsYXllci5jb25maWc7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ3ZvbHVtZScsIHtcbiAgICAgIGdldCgpIHtcbiAgICAgICAgcmV0dXJuIHZvbHVtZTtcbiAgICAgIH0sXG4gICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgcGxheWVyLmVtYmVkLnNldFZvbHVtZShpbnB1dCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgdm9sdW1lID0gaW5wdXQ7XG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd2b2x1bWVjaGFuZ2UnKTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gTXV0ZWRcbiAgICBsZXQgeyBtdXRlZCB9ID0gcGxheWVyLmNvbmZpZztcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnbXV0ZWQnLCB7XG4gICAgICBnZXQoKSB7XG4gICAgICAgIHJldHVybiBtdXRlZDtcbiAgICAgIH0sXG4gICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgY29uc3QgdG9nZ2xlID0gaXMuYm9vbGVhbihpbnB1dCkgPyBpbnB1dCA6IGZhbHNlO1xuXG4gICAgICAgIHBsYXllci5lbWJlZC5zZXRWb2x1bWUodG9nZ2xlID8gMCA6IHBsYXllci5jb25maWcudm9sdW1lKS50aGVuKCgpID0+IHtcbiAgICAgICAgICBtdXRlZCA9IHRvZ2dsZTtcbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3ZvbHVtZWNoYW5nZScpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBMb29wXG4gICAgbGV0IHsgbG9vcCB9ID0gcGxheWVyLmNvbmZpZztcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnbG9vcCcsIHtcbiAgICAgIGdldCgpIHtcbiAgICAgICAgcmV0dXJuIGxvb3A7XG4gICAgICB9LFxuICAgICAgc2V0KGlucHV0KSB7XG4gICAgICAgIGNvbnN0IHRvZ2dsZSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiBwbGF5ZXIuY29uZmlnLmxvb3AuYWN0aXZlO1xuXG4gICAgICAgIHBsYXllci5lbWJlZC5zZXRMb29wKHRvZ2dsZSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgbG9vcCA9IHRvZ2dsZTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gU291cmNlXG4gICAgbGV0IGN1cnJlbnRTcmM7XG4gICAgcGxheWVyLmVtYmVkXG4gICAgICAuZ2V0VmlkZW9VcmwoKVxuICAgICAgLnRoZW4oKHZhbHVlKSA9PiB7XG4gICAgICAgIGN1cnJlbnRTcmMgPSB2YWx1ZTtcbiAgICAgICAgY29udHJvbHMuc2V0RG93bmxvYWRVcmwuY2FsbChwbGF5ZXIpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgdGhpcy5kZWJ1Zy53YXJuKGVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ2N1cnJlbnRTcmMnLCB7XG4gICAgICBnZXQoKSB7XG4gICAgICAgIHJldHVybiBjdXJyZW50U3JjO1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIEVuZGVkXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ2VuZGVkJywge1xuICAgICAgZ2V0KCkge1xuICAgICAgICByZXR1cm4gcGxheWVyLmN1cnJlbnRUaW1lID09PSBwbGF5ZXIuZHVyYXRpb247XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gU2V0IGFzcGVjdCByYXRpbyBiYXNlZCBvbiB2aWRlbyBzaXplXG4gICAgUHJvbWlzZS5hbGwoW3BsYXllci5lbWJlZC5nZXRWaWRlb1dpZHRoKCksIHBsYXllci5lbWJlZC5nZXRWaWRlb0hlaWdodCgpXSkudGhlbigoZGltZW5zaW9ucykgPT4ge1xuICAgICAgY29uc3QgW3dpZHRoLCBoZWlnaHRdID0gZGltZW5zaW9ucztcbiAgICAgIHBsYXllci5lbWJlZC5yYXRpbyA9IHJvdW5kQXNwZWN0UmF0aW8od2lkdGgsIGhlaWdodCk7XG4gICAgICBzZXRBc3BlY3RSYXRpby5jYWxsKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgLy8gU2V0IGF1dG9wYXVzZVxuICAgIHBsYXllci5lbWJlZC5zZXRBdXRvcGF1c2UocGxheWVyLmNvbmZpZy5hdXRvcGF1c2UpLnRoZW4oKHN0YXRlKSA9PiB7XG4gICAgICBwbGF5ZXIuY29uZmlnLmF1dG9wYXVzZSA9IHN0YXRlO1xuICAgIH0pO1xuXG4gICAgLy8gR2V0IHRpdGxlXG4gICAgcGxheWVyLmVtYmVkLmdldFZpZGVvVGl0bGUoKS50aGVuKCh0aXRsZSkgPT4ge1xuICAgICAgcGxheWVyLmNvbmZpZy50aXRsZSA9IHRpdGxlO1xuICAgICAgdWkuc2V0VGl0bGUuY2FsbCh0aGlzKTtcbiAgICB9KTtcblxuICAgIC8vIEdldCBjdXJyZW50IHRpbWVcbiAgICBwbGF5ZXIuZW1iZWQuZ2V0Q3VycmVudFRpbWUoKS50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgY3VycmVudFRpbWUgPSB2YWx1ZTtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZScpO1xuICAgIH0pO1xuXG4gICAgLy8gR2V0IGR1cmF0aW9uXG4gICAgcGxheWVyLmVtYmVkLmdldER1cmF0aW9uKCkudGhlbigodmFsdWUpID0+IHtcbiAgICAgIHBsYXllci5tZWRpYS5kdXJhdGlvbiA9IHZhbHVlO1xuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdkdXJhdGlvbmNoYW5nZScpO1xuICAgIH0pO1xuXG4gICAgLy8gR2V0IGNhcHRpb25zXG4gICAgcGxheWVyLmVtYmVkLmdldFRleHRUcmFja3MoKS50aGVuKCh0cmFja3MpID0+IHtcbiAgICAgIHBsYXllci5tZWRpYS50ZXh0VHJhY2tzID0gdHJhY2tzO1xuICAgICAgY2FwdGlvbnMuc2V0dXAuY2FsbChwbGF5ZXIpO1xuICAgIH0pO1xuXG4gICAgcGxheWVyLmVtYmVkLm9uKCdjdWVjaGFuZ2UnLCAoeyBjdWVzID0gW10gfSkgPT4ge1xuICAgICAgY29uc3Qgc3RyaXBwZWRDdWVzID0gY3Vlcy5tYXAoKGN1ZSkgPT4gc3RyaXBIVE1MKGN1ZS50ZXh0KSk7XG4gICAgICBjYXB0aW9ucy51cGRhdGVDdWVzLmNhbGwocGxheWVyLCBzdHJpcHBlZEN1ZXMpO1xuICAgIH0pO1xuXG4gICAgcGxheWVyLmVtYmVkLm9uKCdsb2FkZWQnLCAoKSA9PiB7XG4gICAgICAvLyBBc3N1cmUgc3RhdGUgYW5kIGV2ZW50cyBhcmUgdXBkYXRlZCBvbiBhdXRvcGxheVxuICAgICAgcGxheWVyLmVtYmVkLmdldFBhdXNlZCgpLnRoZW4oKHBhdXNlZCkgPT4ge1xuICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCAhcGF1c2VkKTtcbiAgICAgICAgaWYgKCFwYXVzZWQpIHtcbiAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3BsYXlpbmcnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGlmIChpcy5lbGVtZW50KHBsYXllci5lbWJlZC5lbGVtZW50KSAmJiBwbGF5ZXIuc3VwcG9ydGVkLnVpKSB7XG4gICAgICAgIGNvbnN0IGZyYW1lID0gcGxheWVyLmVtYmVkLmVsZW1lbnQ7XG5cbiAgICAgICAgLy8gRml4IGtleWJvYXJkIGZvY3VzIGlzc3Vlc1xuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vc2FtcG90dHMvcGx5ci9pc3N1ZXMvMzE3XG4gICAgICAgIGZyYW1lLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAtMSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBwbGF5ZXIuZW1iZWQub24oJ2J1ZmZlcnN0YXJ0JywgKCkgPT4ge1xuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd3YWl0aW5nJyk7XG4gICAgfSk7XG5cbiAgICBwbGF5ZXIuZW1iZWQub24oJ2J1ZmZlcmVuZCcsICgpID0+IHtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncGxheWluZycpO1xuICAgIH0pO1xuXG4gICAgcGxheWVyLmVtYmVkLm9uKCdwbGF5JywgKCkgPT4ge1xuICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZS5jYWxsKHBsYXllciwgdHJ1ZSk7XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3BsYXlpbmcnKTtcbiAgICB9KTtcblxuICAgIHBsYXllci5lbWJlZC5vbigncGF1c2UnLCAoKSA9PiB7XG4gICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCBmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBwbGF5ZXIuZW1iZWQub24oJ3RpbWV1cGRhdGUnLCAoZGF0YSkgPT4ge1xuICAgICAgcGxheWVyLm1lZGlhLnNlZWtpbmcgPSBmYWxzZTtcbiAgICAgIGN1cnJlbnRUaW1lID0gZGF0YS5zZWNvbmRzO1xuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG4gICAgfSk7XG5cbiAgICBwbGF5ZXIuZW1iZWQub24oJ3Byb2dyZXNzJywgKGRhdGEpID0+IHtcbiAgICAgIHBsYXllci5tZWRpYS5idWZmZXJlZCA9IGRhdGEucGVyY2VudDtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncHJvZ3Jlc3MnKTtcblxuICAgICAgLy8gQ2hlY2sgYWxsIGxvYWRlZFxuICAgICAgaWYgKHBhcnNlSW50KGRhdGEucGVyY2VudCwgMTApID09PSAxKSB7XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnY2FucGxheXRocm91Z2gnKTtcbiAgICAgIH1cblxuICAgICAgLy8gR2V0IGR1cmF0aW9uIGFzIGlmIHdlIGRvIGl0IGJlZm9yZSBsb2FkLCBpdCBnaXZlcyBhbiBpbmNvcnJlY3QgdmFsdWVcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1wb3R0cy9wbHlyL2lzc3Vlcy84OTFcbiAgICAgIHBsYXllci5lbWJlZC5nZXREdXJhdGlvbigpLnRoZW4oKHZhbHVlKSA9PiB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gcGxheWVyLm1lZGlhLmR1cmF0aW9uKSB7XG4gICAgICAgICAgcGxheWVyLm1lZGlhLmR1cmF0aW9uID0gdmFsdWU7XG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdkdXJhdGlvbmNoYW5nZScpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHBsYXllci5lbWJlZC5vbignc2Vla2VkJywgKCkgPT4ge1xuICAgICAgcGxheWVyLm1lZGlhLnNlZWtpbmcgPSBmYWxzZTtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnc2Vla2VkJyk7XG4gICAgfSk7XG5cbiAgICBwbGF5ZXIuZW1iZWQub24oJ2VuZGVkJywgKCkgPT4ge1xuICAgICAgcGxheWVyLm1lZGlhLnBhdXNlZCA9IHRydWU7XG4gICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2VuZGVkJyk7XG4gICAgfSk7XG5cbiAgICBwbGF5ZXIuZW1iZWQub24oJ2Vycm9yJywgKGRldGFpbCkgPT4ge1xuICAgICAgcGxheWVyLm1lZGlhLmVycm9yID0gZGV0YWlsO1xuICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdlcnJvcicpO1xuICAgIH0pO1xuXG4gICAgLy8gUmVidWlsZCBVSVxuICAgIGlmIChjb25maWcuY3VzdG9tQ29udHJvbHMpIHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gdWkuYnVpbGQuY2FsbChwbGF5ZXIpLCAwKTtcbiAgICB9XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCB2aW1lbztcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBZb3VUdWJlIHBsdWdpblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IHVpIGZyb20gJy4uL3VpJztcbmltcG9ydCB7IGNyZWF0ZUVsZW1lbnQsIHJlcGxhY2VFbGVtZW50LCB0b2dnbGVDbGFzcyB9IGZyb20gJy4uL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IHRyaWdnZXJFdmVudCB9IGZyb20gJy4uL3V0aWxzL2V2ZW50cyc7XG5pbXBvcnQgZmV0Y2ggZnJvbSAnLi4vdXRpbHMvZmV0Y2gnO1xuaW1wb3J0IGlzIGZyb20gJy4uL3V0aWxzL2lzJztcbmltcG9ydCBsb2FkSW1hZ2UgZnJvbSAnLi4vdXRpbHMvbG9hZC1pbWFnZSc7XG5pbXBvcnQgbG9hZFNjcmlwdCBmcm9tICcuLi91dGlscy9sb2FkLXNjcmlwdCc7XG5pbXBvcnQgeyBleHRlbmQgfSBmcm9tICcuLi91dGlscy9vYmplY3RzJztcbmltcG9ydCB7IGZvcm1hdCwgZ2VuZXJhdGVJZCB9IGZyb20gJy4uL3V0aWxzL3N0cmluZ3MnO1xuaW1wb3J0IHsgcm91bmRBc3BlY3RSYXRpbywgc2V0QXNwZWN0UmF0aW8gfSBmcm9tICcuLi91dGlscy9zdHlsZSc7XG5cbi8vIFBhcnNlIFlvdVR1YmUgSUQgZnJvbSBVUkxcbmZ1bmN0aW9uIHBhcnNlSWQodXJsKSB7XG4gIGlmIChpcy5lbXB0eSh1cmwpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBjb25zdCByZWdleCA9IC9eLiooeW91dHUuYmVcXC98dlxcL3x1XFwvXFx3XFwvfGVtYmVkXFwvfHdhdGNoXFw/dj18JnY9KShbXiMmP10qKS4qLztcbiAgcmV0dXJuIHVybC5tYXRjaChyZWdleCkgPyBSZWdFeHAuJDIgOiB1cmw7XG59XG5cbi8vIFNldCBwbGF5YmFjayBzdGF0ZSBhbmQgdHJpZ2dlciBjaGFuZ2UgKG9ubHkgb24gYWN0dWFsIGNoYW5nZSlcbmZ1bmN0aW9uIGFzc3VyZVBsYXliYWNrU3RhdGUocGxheSkge1xuICBpZiAocGxheSAmJiAhdGhpcy5lbWJlZC5oYXNQbGF5ZWQpIHtcbiAgICB0aGlzLmVtYmVkLmhhc1BsYXllZCA9IHRydWU7XG4gIH1cbiAgaWYgKHRoaXMubWVkaWEucGF1c2VkID09PSBwbGF5KSB7XG4gICAgdGhpcy5tZWRpYS5wYXVzZWQgPSAhcGxheTtcbiAgICB0cmlnZ2VyRXZlbnQuY2FsbCh0aGlzLCB0aGlzLm1lZGlhLCBwbGF5ID8gJ3BsYXknIDogJ3BhdXNlJyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0SG9zdChjb25maWcpIHtcbiAgaWYgKGNvbmZpZy5ub0Nvb2tpZSkge1xuICAgIHJldHVybiAnaHR0cHM6Ly93d3cueW91dHViZS1ub2Nvb2tpZS5jb20nO1xuICB9XG5cbiAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHA6Jykge1xuICAgIHJldHVybiAnaHR0cDovL3d3dy55b3V0dWJlLmNvbSc7XG4gIH1cblxuICAvLyBVc2UgWW91VHViZSdzIGRlZmF1bHRcbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuY29uc3QgeW91dHViZSA9IHtcbiAgc2V0dXAoKSB7XG4gICAgLy8gQWRkIGVtYmVkIGNsYXNzIGZvciByZXNwb25zaXZlXG4gICAgdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy53cmFwcGVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLmVtYmVkLCB0cnVlKTtcblxuICAgIC8vIFNldHVwIEFQSVxuICAgIGlmIChpcy5vYmplY3Qod2luZG93LllUKSAmJiBpcy5mdW5jdGlvbih3aW5kb3cuWVQuUGxheWVyKSkge1xuICAgICAgeW91dHViZS5yZWFkeS5jYWxsKHRoaXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZWZlcmVuY2UgY3VycmVudCBnbG9iYWwgY2FsbGJhY2tcbiAgICAgIGNvbnN0IGNhbGxiYWNrID0gd2luZG93Lm9uWW91VHViZUlmcmFtZUFQSVJlYWR5O1xuXG4gICAgICAvLyBTZXQgY2FsbGJhY2sgdG8gcHJvY2VzcyBxdWV1ZVxuICAgICAgd2luZG93Lm9uWW91VHViZUlmcmFtZUFQSVJlYWR5ID0gKCkgPT4ge1xuICAgICAgICAvLyBDYWxsIGdsb2JhbCBjYWxsYmFjayBpZiBzZXRcbiAgICAgICAgaWYgKGlzLmZ1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cblxuICAgICAgICB5b3V0dWJlLnJlYWR5LmNhbGwodGhpcyk7XG4gICAgICB9O1xuXG4gICAgICAvLyBMb2FkIHRoZSBTREtcbiAgICAgIGxvYWRTY3JpcHQodGhpcy5jb25maWcudXJscy55b3V0dWJlLnNkaykuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIHRoaXMuZGVidWcud2FybignWW91VHViZSBBUEkgZmFpbGVkIHRvIGxvYWQnLCBlcnJvcik7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gR2V0IHRoZSBtZWRpYSB0aXRsZVxuICBnZXRUaXRsZSh2aWRlb0lkKSB7XG4gICAgY29uc3QgdXJsID0gZm9ybWF0KHRoaXMuY29uZmlnLnVybHMueW91dHViZS5hcGksIHZpZGVvSWQpO1xuXG4gICAgZmV0Y2godXJsKVxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgaWYgKGlzLm9iamVjdChkYXRhKSkge1xuICAgICAgICAgIGNvbnN0IHsgdGl0bGUsIGhlaWdodCwgd2lkdGggfSA9IGRhdGE7XG5cbiAgICAgICAgICAvLyBTZXQgdGl0bGVcbiAgICAgICAgICB0aGlzLmNvbmZpZy50aXRsZSA9IHRpdGxlO1xuICAgICAgICAgIHVpLnNldFRpdGxlLmNhbGwodGhpcyk7XG5cbiAgICAgICAgICAvLyBTZXQgYXNwZWN0IHJhdGlvXG4gICAgICAgICAgdGhpcy5lbWJlZC5yYXRpbyA9IHJvdW5kQXNwZWN0UmF0aW8od2lkdGgsIGhlaWdodCk7XG4gICAgICAgIH1cblxuICAgICAgICBzZXRBc3BlY3RSYXRpby5jYWxsKHRoaXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICAgIC8vIFNldCBhc3BlY3QgcmF0aW9cbiAgICAgICAgc2V0QXNwZWN0UmF0aW8uY2FsbCh0aGlzKTtcbiAgICAgIH0pO1xuICB9LFxuXG4gIC8vIEFQSSByZWFkeVxuICByZWFkeSgpIHtcbiAgICBjb25zdCBwbGF5ZXIgPSB0aGlzO1xuICAgIGNvbnN0IGNvbmZpZyA9IHBsYXllci5jb25maWcueW91dHViZTtcbiAgICAvLyBJZ25vcmUgYWxyZWFkeSBzZXR1cCAocmFjZSBjb25kaXRpb24pXG4gICAgY29uc3QgY3VycmVudElkID0gcGxheWVyLm1lZGlhICYmIHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUoJ2lkJyk7XG4gICAgaWYgKCFpcy5lbXB0eShjdXJyZW50SWQpICYmIGN1cnJlbnRJZC5zdGFydHNXaXRoKCd5b3V0dWJlLScpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gR2V0IHRoZSBzb3VyY2UgVVJMIG9yIElEXG4gICAgbGV0IHNvdXJjZSA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuXG4gICAgLy8gR2V0IGZyb20gPGRpdj4gaWYgbmVlZGVkXG4gICAgaWYgKGlzLmVtcHR5KHNvdXJjZSkpIHtcbiAgICAgIHNvdXJjZSA9IHBsYXllci5tZWRpYS5nZXRBdHRyaWJ1dGUodGhpcy5jb25maWcuYXR0cmlidXRlcy5lbWJlZC5pZCk7XG4gICAgfVxuXG4gICAgLy8gUmVwbGFjZSB0aGUgPGlmcmFtZT4gd2l0aCBhIDxkaXY+IGR1ZSB0byBZb3VUdWJlIEFQSSBpc3N1ZXNcbiAgICBjb25zdCB2aWRlb0lkID0gcGFyc2VJZChzb3VyY2UpO1xuICAgIGNvbnN0IGlkID0gZ2VuZXJhdGVJZChwbGF5ZXIucHJvdmlkZXIpO1xuICAgIC8vIFJlcGxhY2UgbWVkaWEgZWxlbWVudFxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgaWQsICdkYXRhLXBvc3Rlcic6IGNvbmZpZy5jdXN0b21Db250cm9scyA/IHBsYXllci5wb3N0ZXIgOiB1bmRlZmluZWQgfSk7XG4gICAgcGxheWVyLm1lZGlhID0gcmVwbGFjZUVsZW1lbnQoY29udGFpbmVyLCBwbGF5ZXIubWVkaWEpO1xuXG4gICAgLy8gT25seSBsb2FkIHRoZSBwb3N0ZXIgd2hlbiB1c2luZyBjdXN0b20gY29udHJvbHNcbiAgICBpZiAoY29uZmlnLmN1c3RvbUNvbnRyb2xzKSB7XG4gICAgICBjb25zdCBwb3N0ZXJTcmMgPSAocykgPT4gYGh0dHBzOi8vaS55dGltZy5jb20vdmkvJHt2aWRlb0lkfS8ke3N9ZGVmYXVsdC5qcGdgO1xuXG4gICAgICAvLyBDaGVjayB0aHVtYm5haWwgaW1hZ2VzIGluIG9yZGVyIG9mIHF1YWxpdHksIGJ1dCByZWplY3QgZmFsbGJhY2sgdGh1bWJuYWlscyAoMTIwcHggd2lkZSlcbiAgICAgIGxvYWRJbWFnZShwb3N0ZXJTcmMoJ21heHJlcycpLCAxMjEpIC8vIEhpZ2VzdCBxdWFsaXR5IGFuZCB1bnBhZGRlZFxuICAgICAgICAuY2F0Y2goKCkgPT4gbG9hZEltYWdlKHBvc3RlclNyYygnc2QnKSwgMTIxKSkgLy8gNDgwcCBwYWRkZWQgNDozXG4gICAgICAgIC5jYXRjaCgoKSA9PiBsb2FkSW1hZ2UocG9zdGVyU3JjKCdocScpKSkgLy8gMzYwcCBwYWRkZWQgNDozLiBBbHdheXMgZXhpc3RzXG4gICAgICAgIC50aGVuKChpbWFnZSkgPT4gdWkuc2V0UG9zdGVyLmNhbGwocGxheWVyLCBpbWFnZS5zcmMpKVxuICAgICAgICAudGhlbigoc3JjKSA9PiB7XG4gICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHBhZGRlZCwgdXNlIGJhY2tncm91bmQtc2l6ZSBcImNvdmVyXCIgaW5zdGVhZCAobGlrZSB5b3V0dWJlIGRvZXMgdG9vIHdpdGggdGhlaXIgcG9zdGVycylcbiAgICAgICAgICBpZiAoIXNyYy5pbmNsdWRlcygnbWF4cmVzJykpIHtcbiAgICAgICAgICAgIHBsYXllci5lbGVtZW50cy5wb3N0ZXIuc3R5bGUuYmFja2dyb3VuZFNpemUgPSAnY292ZXInO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKCgpID0+IHt9KTtcbiAgICB9XG5cbiAgICAvLyBTZXR1cCBpbnN0YW5jZVxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3lvdXR1YmUvaWZyYW1lX2FwaV9yZWZlcmVuY2VcbiAgICBwbGF5ZXIuZW1iZWQgPSBuZXcgd2luZG93LllULlBsYXllcihwbGF5ZXIubWVkaWEsIHtcbiAgICAgIHZpZGVvSWQsXG4gICAgICBob3N0OiBnZXRIb3N0KGNvbmZpZyksXG4gICAgICBwbGF5ZXJWYXJzOiBleHRlbmQoXG4gICAgICAgIHt9LFxuICAgICAgICB7XG4gICAgICAgICAgLy8gQXV0b3BsYXlcbiAgICAgICAgICBhdXRvcGxheTogcGxheWVyLmNvbmZpZy5hdXRvcGxheSA/IDEgOiAwLFxuICAgICAgICAgIC8vIGlmcmFtZSBpbnRlcmZhY2UgbGFuZ3VhZ2VcbiAgICAgICAgICBobDogcGxheWVyLmNvbmZpZy5obCxcbiAgICAgICAgICAvLyBPbmx5IHNob3cgY29udHJvbHMgaWYgbm90IGZ1bGx5IHN1cHBvcnRlZCBvciBvcHRlZCBvdXRcbiAgICAgICAgICBjb250cm9sczogcGxheWVyLnN1cHBvcnRlZC51aSAmJiBjb25maWcuY3VzdG9tQ29udHJvbHMgPyAwIDogMSxcbiAgICAgICAgICAvLyBEaXNhYmxlIGtleWJvYXJkIGFzIHdlIGhhbmRsZSBpdFxuICAgICAgICAgIGRpc2FibGVrYjogMSxcbiAgICAgICAgICAvLyBBbGxvdyBpT1MgaW5saW5lIHBsYXliYWNrXG4gICAgICAgICAgcGxheXNpbmxpbmU6ICFwbGF5ZXIuY29uZmlnLmZ1bGxzY3JlZW4uaW9zTmF0aXZlID8gMSA6IDAsXG4gICAgICAgICAgLy8gQ2FwdGlvbnMgYXJlIGZsYWt5IG9uIFlvdVR1YmVcbiAgICAgICAgICBjY19sb2FkX3BvbGljeTogcGxheWVyLmNhcHRpb25zLmFjdGl2ZSA/IDEgOiAwLFxuICAgICAgICAgIGNjX2xhbmdfcHJlZjogcGxheWVyLmNvbmZpZy5jYXB0aW9ucy5sYW5ndWFnZSxcbiAgICAgICAgICAvLyBUcmFja2luZyBmb3Igc3RhdHNcbiAgICAgICAgICB3aWRnZXRfcmVmZXJyZXI6IHdpbmRvdyA/IHdpbmRvdy5sb2NhdGlvbi5ocmVmIDogbnVsbCxcbiAgICAgICAgfSxcbiAgICAgICAgY29uZmlnLFxuICAgICAgKSxcbiAgICAgIGV2ZW50czoge1xuICAgICAgICBvbkVycm9yKGV2ZW50KSB7XG4gICAgICAgICAgLy8gWW91VHViZSBtYXkgZmlyZSBvbkVycm9yIHR3aWNlLCBzbyBvbmx5IGhhbmRsZSBpdCBvbmNlXG4gICAgICAgICAgaWYgKCFwbGF5ZXIubWVkaWEuZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvZGUgPSBldmVudC5kYXRhO1xuICAgICAgICAgICAgLy8gTWVzc2FnZXMgY29waWVkIGZyb20gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20veW91dHViZS9pZnJhbWVfYXBpX3JlZmVyZW5jZSNvbkVycm9yXG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID1cbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIDI6ICdUaGUgcmVxdWVzdCBjb250YWlucyBhbiBpbnZhbGlkIHBhcmFtZXRlciB2YWx1ZS4gRm9yIGV4YW1wbGUsIHRoaXMgZXJyb3Igb2NjdXJzIGlmIHlvdSBzcGVjaWZ5IGEgdmlkZW8gSUQgdGhhdCBkb2VzIG5vdCBoYXZlIDExIGNoYXJhY3RlcnMsIG9yIGlmIHRoZSB2aWRlbyBJRCBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMsIHN1Y2ggYXMgZXhjbGFtYXRpb24gcG9pbnRzIG9yIGFzdGVyaXNrcy4nLFxuICAgICAgICAgICAgICAgIDU6ICdUaGUgcmVxdWVzdGVkIGNvbnRlbnQgY2Fubm90IGJlIHBsYXllZCBpbiBhbiBIVE1MNSBwbGF5ZXIgb3IgYW5vdGhlciBlcnJvciByZWxhdGVkIHRvIHRoZSBIVE1MNSBwbGF5ZXIgaGFzIG9jY3VycmVkLicsXG4gICAgICAgICAgICAgICAgMTAwOiAnVGhlIHZpZGVvIHJlcXVlc3RlZCB3YXMgbm90IGZvdW5kLiBUaGlzIGVycm9yIG9jY3VycyB3aGVuIGEgdmlkZW8gaGFzIGJlZW4gcmVtb3ZlZCAoZm9yIGFueSByZWFzb24pIG9yIGhhcyBiZWVuIG1hcmtlZCBhcyBwcml2YXRlLicsXG4gICAgICAgICAgICAgICAgMTAxOiAnVGhlIG93bmVyIG9mIHRoZSByZXF1ZXN0ZWQgdmlkZW8gZG9lcyBub3QgYWxsb3cgaXQgdG8gYmUgcGxheWVkIGluIGVtYmVkZGVkIHBsYXllcnMuJyxcbiAgICAgICAgICAgICAgICAxNTA6ICdUaGUgb3duZXIgb2YgdGhlIHJlcXVlc3RlZCB2aWRlbyBkb2VzIG5vdCBhbGxvdyBpdCB0byBiZSBwbGF5ZWQgaW4gZW1iZWRkZWQgcGxheWVycy4nLFxuICAgICAgICAgICAgICB9W2NvZGVdIHx8ICdBbiB1bmtub3duIGVycm9yIG9jY3VyZWQnO1xuXG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEuZXJyb3IgPSB7IGNvZGUsIG1lc3NhZ2UgfTtcblxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdlcnJvcicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgb25QbGF5YmFja1JhdGVDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgICAvLyBHZXQgdGhlIGluc3RhbmNlXG4gICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBldmVudC50YXJnZXQ7XG5cbiAgICAgICAgICAvLyBHZXQgY3VycmVudCBzcGVlZFxuICAgICAgICAgIHBsYXllci5tZWRpYS5wbGF5YmFja1JhdGUgPSBpbnN0YW5jZS5nZXRQbGF5YmFja1JhdGUoKTtcblxuICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAncmF0ZWNoYW5nZScpO1xuICAgICAgICB9LFxuICAgICAgICBvblJlYWR5KGV2ZW50KSB7XG4gICAgICAgICAgLy8gQmFpbCBpZiBvblJlYWR5IGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkLiBTZWUgaXNzdWUgIzExMDhcbiAgICAgICAgICBpZiAoaXMuZnVuY3Rpb24ocGxheWVyLm1lZGlhLnBsYXkpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIEdldCB0aGUgaW5zdGFuY2VcbiAgICAgICAgICBjb25zdCBpbnN0YW5jZSA9IGV2ZW50LnRhcmdldDtcblxuICAgICAgICAgIC8vIEdldCB0aGUgdGl0bGVcbiAgICAgICAgICB5b3V0dWJlLmdldFRpdGxlLmNhbGwocGxheWVyLCB2aWRlb0lkKTtcblxuICAgICAgICAgIC8vIENyZWF0ZSBhIGZhdXggSFRNTDUgQVBJIHVzaW5nIHRoZSBZb3VUdWJlIEFQSVxuICAgICAgICAgIHBsYXllci5tZWRpYS5wbGF5ID0gKCkgPT4ge1xuICAgICAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZS5jYWxsKHBsYXllciwgdHJ1ZSk7XG4gICAgICAgICAgICBpbnN0YW5jZS5wbGF5VmlkZW8oKTtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgcGxheWVyLm1lZGlhLnBhdXNlID0gKCkgPT4ge1xuICAgICAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZS5jYWxsKHBsYXllciwgZmFsc2UpO1xuICAgICAgICAgICAgaW5zdGFuY2UucGF1c2VWaWRlbygpO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBwbGF5ZXIubWVkaWEuc3RvcCA9ICgpID0+IHtcbiAgICAgICAgICAgIGluc3RhbmNlLnN0b3BWaWRlbygpO1xuICAgICAgICAgIH07XG5cbiAgICAgICAgICBwbGF5ZXIubWVkaWEuZHVyYXRpb24gPSBpbnN0YW5jZS5nZXREdXJhdGlvbigpO1xuICAgICAgICAgIHBsYXllci5tZWRpYS5wYXVzZWQgPSB0cnVlO1xuXG4gICAgICAgICAgLy8gU2Vla2luZ1xuICAgICAgICAgIHBsYXllci5tZWRpYS5jdXJyZW50VGltZSA9IDA7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ2N1cnJlbnRUaW1lJywge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gTnVtYmVyKGluc3RhbmNlLmdldEN1cnJlbnRUaW1lKCkpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldCh0aW1lKSB7XG4gICAgICAgICAgICAgIC8vIElmIHBhdXNlZCBhbmQgbmV2ZXIgcGxheWVkLCBtdXRlIGF1ZGlvIHByZXZlbnRpdmVseSAoWW91VHViZSBzdGFydHMgcGxheWluZyBvbiBzZWVrIGlmIHRoZSB2aWRlbyBoYXNuJ3QgYmVlbiBwbGF5ZWQgeWV0KS5cbiAgICAgICAgICAgICAgaWYgKHBsYXllci5wYXVzZWQgJiYgIXBsYXllci5lbWJlZC5oYXNQbGF5ZWQpIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuZW1iZWQubXV0ZSgpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLy8gU2V0IHNlZWtpbmcgc3RhdGUgYW5kIHRyaWdnZXIgZXZlbnRcbiAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLnNlZWtpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3NlZWtpbmcnKTtcblxuICAgICAgICAgICAgICAvLyBTZWVrIGFmdGVyIGV2ZW50cyBzZW50XG4gICAgICAgICAgICAgIGluc3RhbmNlLnNlZWtUbyh0aW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBQbGF5YmFjayBzcGVlZFxuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwbGF5ZXIubWVkaWEsICdwbGF5YmFja1JhdGUnLCB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBpbnN0YW5jZS5nZXRQbGF5YmFja1JhdGUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgICAgICAgaW5zdGFuY2Uuc2V0UGxheWJhY2tSYXRlKGlucHV0KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBWb2x1bWVcbiAgICAgICAgICBsZXQgeyB2b2x1bWUgfSA9IHBsYXllci5jb25maWc7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ3ZvbHVtZScsIHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHZvbHVtZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQoaW5wdXQpIHtcbiAgICAgICAgICAgICAgdm9sdW1lID0gaW5wdXQ7XG4gICAgICAgICAgICAgIGluc3RhbmNlLnNldFZvbHVtZSh2b2x1bWUgKiAxMDApO1xuICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3ZvbHVtZWNoYW5nZScpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIE11dGVkXG4gICAgICAgICAgbGV0IHsgbXV0ZWQgfSA9IHBsYXllci5jb25maWc7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHBsYXllci5tZWRpYSwgJ211dGVkJywge1xuICAgICAgICAgICAgZ2V0KCkge1xuICAgICAgICAgICAgICByZXR1cm4gbXV0ZWQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0KGlucHV0KSB7XG4gICAgICAgICAgICAgIGNvbnN0IHRvZ2dsZSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiBtdXRlZDtcbiAgICAgICAgICAgICAgbXV0ZWQgPSB0b2dnbGU7XG4gICAgICAgICAgICAgIGluc3RhbmNlW3RvZ2dsZSA/ICdtdXRlJyA6ICd1bk11dGUnXSgpO1xuICAgICAgICAgICAgICBpbnN0YW5jZS5zZXRWb2x1bWUodm9sdW1lICogMTAwKTtcbiAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd2b2x1bWVjaGFuZ2UnKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBTb3VyY2VcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnY3VycmVudFNyYycsIHtcbiAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGluc3RhbmNlLmdldFZpZGVvVXJsKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gRW5kZWRcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocGxheWVyLm1lZGlhLCAnZW5kZWQnLCB7XG4gICAgICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICAgIHJldHVybiBwbGF5ZXIuY3VycmVudFRpbWUgPT09IHBsYXllci5kdXJhdGlvbjtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBHZXQgYXZhaWxhYmxlIHNwZWVkc1xuICAgICAgICAgIGNvbnN0IHNwZWVkcyA9IGluc3RhbmNlLmdldEF2YWlsYWJsZVBsYXliYWNrUmF0ZXMoKTtcbiAgICAgICAgICAvLyBGaWx0ZXIgYmFzZWQgb24gY29uZmlnXG4gICAgICAgICAgcGxheWVyLm9wdGlvbnMuc3BlZWQgPSBzcGVlZHMuZmlsdGVyKChzKSA9PiBwbGF5ZXIuY29uZmlnLnNwZWVkLm9wdGlvbnMuaW5jbHVkZXMocykpO1xuXG4gICAgICAgICAgLy8gU2V0IHRoZSB0YWJpbmRleCB0byBhdm9pZCBmb2N1cyBlbnRlcmluZyBpZnJhbWVcbiAgICAgICAgICBpZiAocGxheWVyLnN1cHBvcnRlZC51aSAmJiBjb25maWcuY3VzdG9tQ29udHJvbHMpIHtcbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgLTEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZScpO1xuICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAnZHVyYXRpb25jaGFuZ2UnKTtcblxuICAgICAgICAgIC8vIFJlc2V0IHRpbWVyXG4gICAgICAgICAgY2xlYXJJbnRlcnZhbChwbGF5ZXIudGltZXJzLmJ1ZmZlcmluZyk7XG5cbiAgICAgICAgICAvLyBTZXR1cCBidWZmZXJpbmdcbiAgICAgICAgICBwbGF5ZXIudGltZXJzLmJ1ZmZlcmluZyA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgIC8vIEdldCBsb2FkZWQgJSBmcm9tIFlvdVR1YmVcbiAgICAgICAgICAgIHBsYXllci5tZWRpYS5idWZmZXJlZCA9IGluc3RhbmNlLmdldFZpZGVvTG9hZGVkRnJhY3Rpb24oKTtcblxuICAgICAgICAgICAgLy8gVHJpZ2dlciBwcm9ncmVzcyBvbmx5IHdoZW4gd2UgYWN0dWFsbHkgYnVmZmVyIHNvbWV0aGluZ1xuICAgICAgICAgICAgaWYgKHBsYXllci5tZWRpYS5sYXN0QnVmZmVyZWQgPT09IG51bGwgfHwgcGxheWVyLm1lZGlhLmxhc3RCdWZmZXJlZCA8IHBsYXllci5tZWRpYS5idWZmZXJlZCkge1xuICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3Byb2dyZXNzJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNldCBsYXN0IGJ1ZmZlciBwb2ludFxuICAgICAgICAgICAgcGxheWVyLm1lZGlhLmxhc3RCdWZmZXJlZCA9IHBsYXllci5tZWRpYS5idWZmZXJlZDtcblxuICAgICAgICAgICAgLy8gQmFpbCBpZiB3ZSdyZSBhdCAxMDAlXG4gICAgICAgICAgICBpZiAocGxheWVyLm1lZGlhLmJ1ZmZlcmVkID09PSAxKSB7XG4gICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwocGxheWVyLnRpbWVycy5idWZmZXJpbmcpO1xuXG4gICAgICAgICAgICAgIC8vIFRyaWdnZXIgZXZlbnRcbiAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdjYW5wbGF5dGhyb3VnaCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sIDIwMCk7XG5cbiAgICAgICAgICAvLyBSZWJ1aWxkIFVJXG4gICAgICAgICAgaWYgKGNvbmZpZy5jdXN0b21Db250cm9scykge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB1aS5idWlsZC5jYWxsKHBsYXllciksIDUwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9uU3RhdGVDaGFuZ2UoZXZlbnQpIHtcbiAgICAgICAgICAvLyBHZXQgdGhlIGluc3RhbmNlXG4gICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSBldmVudC50YXJnZXQ7XG5cbiAgICAgICAgICAvLyBSZXNldCB0aW1lclxuICAgICAgICAgIGNsZWFySW50ZXJ2YWwocGxheWVyLnRpbWVycy5wbGF5aW5nKTtcblxuICAgICAgICAgIGNvbnN0IHNlZWtlZCA9IHBsYXllci5tZWRpYS5zZWVraW5nICYmIFsxLCAyXS5pbmNsdWRlcyhldmVudC5kYXRhKTtcblxuICAgICAgICAgIGlmIChzZWVrZWQpIHtcbiAgICAgICAgICAgIC8vIFVuc2V0IHNlZWtpbmcgYW5kIGZpcmUgc2Vla2VkIGV2ZW50XG4gICAgICAgICAgICBwbGF5ZXIubWVkaWEuc2Vla2luZyA9IGZhbHNlO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdzZWVrZWQnKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBIYW5kbGUgZXZlbnRzXG4gICAgICAgICAgLy8gLTEgICBVbnN0YXJ0ZWRcbiAgICAgICAgICAvLyAwICAgIEVuZGVkXG4gICAgICAgICAgLy8gMSAgICBQbGF5aW5nXG4gICAgICAgICAgLy8gMiAgICBQYXVzZWRcbiAgICAgICAgICAvLyAzICAgIEJ1ZmZlcmluZ1xuICAgICAgICAgIC8vIDUgICAgVmlkZW8gY3VlZFxuICAgICAgICAgIHN3aXRjaCAoZXZlbnQuZGF0YSkge1xuICAgICAgICAgICAgY2FzZSAtMTpcbiAgICAgICAgICAgICAgLy8gVXBkYXRlIHNjcnViYmVyXG4gICAgICAgICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHBsYXllciwgcGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZScpO1xuXG4gICAgICAgICAgICAgIC8vIEdldCBsb2FkZWQgJSBmcm9tIFlvdVR1YmVcbiAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLmJ1ZmZlcmVkID0gaW5zdGFuY2UuZ2V0VmlkZW9Mb2FkZWRGcmFjdGlvbigpO1xuICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3Byb2dyZXNzJyk7XG5cbiAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZS5jYWxsKHBsYXllciwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgIC8vIFlvdVR1YmUgZG9lc24ndCBzdXBwb3J0IGxvb3AgZm9yIGEgc2luZ2xlIHZpZGVvLCBzbyBtaW1pY2sgaXQuXG4gICAgICAgICAgICAgIGlmIChwbGF5ZXIubWVkaWEubG9vcCkge1xuICAgICAgICAgICAgICAgIC8vIFlvdVR1YmUgbmVlZHMgYSBjYWxsIHRvIGBzdG9wVmlkZW9gIGJlZm9yZSBwbGF5aW5nIGFnYWluXG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uuc3RvcFZpZGVvKCk7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UucGxheVZpZGVvKCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICdlbmRlZCcpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgLy8gUmVzdG9yZSBwYXVzZWQgc3RhdGUgKFlvdVR1YmUgc3RhcnRzIHBsYXlpbmcgb24gc2VlayBpZiB0aGUgdmlkZW8gaGFzbid0IGJlZW4gcGxheWVkIHlldClcbiAgICAgICAgICAgICAgaWYgKGNvbmZpZy5jdXN0b21Db250cm9scyAmJiAhcGxheWVyLmNvbmZpZy5hdXRvcGxheSAmJiBwbGF5ZXIubWVkaWEucGF1c2VkICYmICFwbGF5ZXIuZW1iZWQuaGFzUGxheWVkKSB7XG4gICAgICAgICAgICAgICAgcGxheWVyLm1lZGlhLnBhdXNlKCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXNzdXJlUGxheWJhY2tTdGF0ZS5jYWxsKHBsYXllciwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3BsYXlpbmcnKTtcblxuICAgICAgICAgICAgICAgIC8vIFBvbGwgdG8gZ2V0IHBsYXliYWNrIHByb2dyZXNzXG4gICAgICAgICAgICAgICAgcGxheWVyLnRpbWVycy5wbGF5aW5nID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIubWVkaWEsICd0aW1ldXBkYXRlJyk7XG4gICAgICAgICAgICAgICAgfSwgNTApO1xuXG4gICAgICAgICAgICAgICAgLy8gQ2hlY2sgZHVyYXRpb24gYWdhaW4gZHVlIHRvIFlvdVR1YmUgYnVnXG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXIvaXNzdWVzLzM3NFxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvZ2RhdGEtaXNzdWVzL2lzc3Vlcy9kZXRhaWw/aWQ9ODY5MFxuICAgICAgICAgICAgICAgIGlmIChwbGF5ZXIubWVkaWEuZHVyYXRpb24gIT09IGluc3RhbmNlLmdldER1cmF0aW9uKCkpIHtcbiAgICAgICAgICAgICAgICAgIHBsYXllci5tZWRpYS5kdXJhdGlvbiA9IGluc3RhbmNlLmdldER1cmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ2R1cmF0aW9uY2hhbmdlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgLy8gUmVzdG9yZSBhdWRpbyAoWW91VHViZSBzdGFydHMgcGxheWluZyBvbiBzZWVrIGlmIHRoZSB2aWRlbyBoYXNuJ3QgYmVlbiBwbGF5ZWQgeWV0KVxuICAgICAgICAgICAgICBpZiAoIXBsYXllci5tdXRlZCkge1xuICAgICAgICAgICAgICAgIHBsYXllci5lbWJlZC51bk11dGUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBhc3N1cmVQbGF5YmFja1N0YXRlLmNhbGwocGxheWVyLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgLy8gVHJpZ2dlciB3YWl0aW5nIGV2ZW50IHRvIGFkZCBsb2FkaW5nIGNsYXNzZXMgdG8gY29udGFpbmVyIGFzIHRoZSB2aWRlbyBidWZmZXJzLlxuICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQuY2FsbChwbGF5ZXIsIHBsYXllci5tZWRpYSwgJ3dhaXRpbmcnKTtcblxuICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwocGxheWVyLCBwbGF5ZXIuZWxlbWVudHMuY29udGFpbmVyLCAnc3RhdGVjaGFuZ2UnLCBmYWxzZSwge1xuICAgICAgICAgICAgY29kZTogZXZlbnQuZGF0YSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCB5b3V0dWJlO1xuIiwiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBseXIgTWVkaWFcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCBodG1sNSBmcm9tICcuL2h0bWw1JztcbmltcG9ydCB2aW1lbyBmcm9tICcuL3BsdWdpbnMvdmltZW8nO1xuaW1wb3J0IHlvdXR1YmUgZnJvbSAnLi9wbHVnaW5zL3lvdXR1YmUnO1xuaW1wb3J0IHsgY3JlYXRlRWxlbWVudCwgdG9nZ2xlQ2xhc3MsIHdyYXAgfSBmcm9tICcuL3V0aWxzL2VsZW1lbnRzJztcblxuY29uc3QgbWVkaWEgPSB7XG4gIC8vIFNldHVwIG1lZGlhXG4gIHNldHVwKCkge1xuICAgIC8vIElmIHRoZXJlJ3Mgbm8gbWVkaWEsIGJhaWxcbiAgICBpZiAoIXRoaXMubWVkaWEpIHtcbiAgICAgIHRoaXMuZGVidWcud2FybignTm8gbWVkaWEgZWxlbWVudCBmb3VuZCEnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBBZGQgdHlwZSBjbGFzc1xuICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnR5cGUucmVwbGFjZSgnezB9JywgdGhpcy50eXBlKSwgdHJ1ZSk7XG5cbiAgICAvLyBBZGQgcHJvdmlkZXIgY2xhc3NcbiAgICB0b2dnbGVDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5wcm92aWRlci5yZXBsYWNlKCd7MH0nLCB0aGlzLnByb3ZpZGVyKSwgdHJ1ZSk7XG5cbiAgICAvLyBBZGQgdmlkZW8gY2xhc3MgZm9yIGVtYmVkc1xuICAgIC8vIFRoaXMgd2lsbCByZXF1aXJlIGNoYW5nZXMgaWYgYXVkaW8gZW1iZWRzIGFyZSBhZGRlZFxuICAgIGlmICh0aGlzLmlzRW1iZWQpIHtcbiAgICAgIHRvZ2dsZUNsYXNzKHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnR5cGUucmVwbGFjZSgnezB9JywgJ3ZpZGVvJyksIHRydWUpO1xuICAgIH1cblxuICAgIC8vIEluamVjdCB0aGUgcGxheWVyIHdyYXBwZXJcbiAgICBpZiAodGhpcy5pc1ZpZGVvKSB7XG4gICAgICAvLyBDcmVhdGUgdGhlIHdyYXBwZXIgZGl2XG4gICAgICB0aGlzLmVsZW1lbnRzLndyYXBwZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgIGNsYXNzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnZpZGVvLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFdyYXAgdGhlIHZpZGVvIGluIGEgY29udGFpbmVyXG4gICAgICB3cmFwKHRoaXMubWVkaWEsIHRoaXMuZWxlbWVudHMud3JhcHBlcik7XG5cbiAgICAgIC8vIFBvc3RlciBpbWFnZSBjb250YWluZXJcbiAgICAgIHRoaXMuZWxlbWVudHMucG9zdGVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgICBjbGFzczogdGhpcy5jb25maWcuY2xhc3NOYW1lcy5wb3N0ZXIsXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5lbGVtZW50cy53cmFwcGVyLmFwcGVuZENoaWxkKHRoaXMuZWxlbWVudHMucG9zdGVyKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICBodG1sNS5zZXR1cC5jYWxsKHRoaXMpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5pc1lvdVR1YmUpIHtcbiAgICAgIHlvdXR1YmUuc2V0dXAuY2FsbCh0aGlzKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNWaW1lbykge1xuICAgICAgdmltZW8uc2V0dXAuY2FsbCh0aGlzKTtcbiAgICB9XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBtZWRpYTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBZHZlcnRpc2VtZW50IHBsdWdpbiB1c2luZyBHb29nbGUgSU1BIEhUTUw1IFNES1xuLy8gQ3JlYXRlIGFuIGFjY291bnQgd2l0aCBvdXIgYWQgcGFydG5lciwgdmkgaGVyZTpcbi8vIGh0dHBzOi8vd3d3LnZpLmFpL3B1Ymxpc2hlci12aWRlby1tb25ldGl6YXRpb24vXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKiBnbG9iYWwgZ29vZ2xlICovXG5cbmltcG9ydCB7IGNyZWF0ZUVsZW1lbnQgfSBmcm9tICcuLi91dGlscy9lbGVtZW50cyc7XG5pbXBvcnQgeyB0cmlnZ2VyRXZlbnQgfSBmcm9tICcuLi91dGlscy9ldmVudHMnO1xuaW1wb3J0IGkxOG4gZnJvbSAnLi4vdXRpbHMvaTE4bic7XG5pbXBvcnQgaXMgZnJvbSAnLi4vdXRpbHMvaXMnO1xuaW1wb3J0IGxvYWRTY3JpcHQgZnJvbSAnLi4vdXRpbHMvbG9hZC1zY3JpcHQnO1xuaW1wb3J0IHsgc2lsZW5jZVByb21pc2UgfSBmcm9tICcuLi91dGlscy9wcm9taXNlJztcbmltcG9ydCB7IGZvcm1hdFRpbWUgfSBmcm9tICcuLi91dGlscy90aW1lJztcbmltcG9ydCB7IGJ1aWxkVXJsUGFyYW1zIH0gZnJvbSAnLi4vdXRpbHMvdXJscyc7XG5cbmNvbnN0IGRlc3Ryb3kgPSAoaW5zdGFuY2UpID0+IHtcbiAgLy8gRGVzdHJveSBvdXIgYWRzTWFuYWdlclxuICBpZiAoaW5zdGFuY2UubWFuYWdlcikge1xuICAgIGluc3RhbmNlLm1hbmFnZXIuZGVzdHJveSgpO1xuICB9XG5cbiAgLy8gRGVzdHJveSBvdXIgYWRzTWFuYWdlclxuICBpZiAoaW5zdGFuY2UuZWxlbWVudHMuZGlzcGxheUNvbnRhaW5lcikge1xuICAgIGluc3RhbmNlLmVsZW1lbnRzLmRpc3BsYXlDb250YWluZXIuZGVzdHJveSgpO1xuICB9XG5cbiAgaW5zdGFuY2UuZWxlbWVudHMuY29udGFpbmVyLnJlbW92ZSgpO1xufTtcblxuY2xhc3MgQWRzIHtcbiAgLyoqXG4gICAqIEFkcyBjb25zdHJ1Y3Rvci5cbiAgICogQHBhcmFtIHtPYmplY3R9IHBsYXllclxuICAgKiBAcmV0dXJuIHtBZHN9XG4gICAqL1xuICBjb25zdHJ1Y3RvcihwbGF5ZXIpIHtcbiAgICB0aGlzLnBsYXllciA9IHBsYXllcjtcbiAgICB0aGlzLmNvbmZpZyA9IHBsYXllci5jb25maWcuYWRzO1xuICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xuICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmVsZW1lbnRzID0ge1xuICAgICAgY29udGFpbmVyOiBudWxsLFxuICAgICAgZGlzcGxheUNvbnRhaW5lcjogbnVsbCxcbiAgICB9O1xuICAgIHRoaXMubWFuYWdlciA9IG51bGw7XG4gICAgdGhpcy5sb2FkZXIgPSBudWxsO1xuICAgIHRoaXMuY3VlUG9pbnRzID0gbnVsbDtcbiAgICB0aGlzLmV2ZW50cyA9IHt9O1xuICAgIHRoaXMuc2FmZXR5VGltZXIgPSBudWxsO1xuICAgIHRoaXMuY291bnRkb3duVGltZXIgPSBudWxsO1xuXG4gICAgLy8gU2V0dXAgYSBwcm9taXNlIHRvIHJlc29sdmUgd2hlbiB0aGUgSU1BIG1hbmFnZXIgaXMgcmVhZHlcbiAgICB0aGlzLm1hbmFnZXJQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgLy8gVGhlIGFkIGlzIGxvYWRlZCBhbmQgcmVhZHlcbiAgICAgIHRoaXMub24oJ2xvYWRlZCcsIHJlc29sdmUpO1xuXG4gICAgICAvLyBBZHMgZmFpbGVkXG4gICAgICB0aGlzLm9uKCdlcnJvcicsIHJlamVjdCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLmxvYWQoKTtcbiAgfVxuXG4gIGdldCBlbmFibGVkKCkge1xuICAgIGNvbnN0IHsgY29uZmlnIH0gPSB0aGlzO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMucGxheWVyLmlzSFRNTDUgJiZcbiAgICAgIHRoaXMucGxheWVyLmlzVmlkZW8gJiZcbiAgICAgIGNvbmZpZy5lbmFibGVkICYmXG4gICAgICAoIWlzLmVtcHR5KGNvbmZpZy5wdWJsaXNoZXJJZCkgfHwgaXMudXJsKGNvbmZpZy50YWdVcmwpKVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogTG9hZCB0aGUgSU1BIFNES1xuICAgKi9cbiAgbG9hZCA9ICgpID0+IHtcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHRoZSBHb29nbGUgSU1BMyBTREsgaXMgbG9hZGVkIG9yIGxvYWQgaXQgb3Vyc2VsdmVzXG4gICAgaWYgKCFpcy5vYmplY3Qod2luZG93Lmdvb2dsZSkgfHwgIWlzLm9iamVjdCh3aW5kb3cuZ29vZ2xlLmltYSkpIHtcbiAgICAgIGxvYWRTY3JpcHQodGhpcy5wbGF5ZXIuY29uZmlnLnVybHMuZ29vZ2xlSU1BLnNkaylcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHRoaXMucmVhZHkoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgICAgICAvLyBTY3JpcHQgZmFpbGVkIHRvIGxvYWQgb3IgaXMgYmxvY2tlZFxuICAgICAgICAgIHRoaXMudHJpZ2dlcignZXJyb3InLCBuZXcgRXJyb3IoJ0dvb2dsZSBJTUEgU0RLIGZhaWxlZCB0byBsb2FkJykpO1xuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZWFkeSgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogR2V0IHRoZSBhZHMgaW5zdGFuY2UgcmVhZHlcbiAgICovXG4gIHJlYWR5ID0gKCkgPT4ge1xuICAgIC8vIERvdWJsZSBjaGVjayB3ZSdyZSBlbmFibGVkXG4gICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgIGRlc3Ryb3kodGhpcyk7XG4gICAgfVxuXG4gICAgLy8gU3RhcnQgdGlja2luZyBvdXIgc2FmZXR5IHRpbWVyLiBJZiB0aGUgd2hvbGUgYWR2ZXJ0aXNlbWVudFxuICAgIC8vIHRoaW5nIGRvZXNuJ3QgcmVzb2x2ZSB3aXRoaW4gb3VyIHNldCB0aW1lOyB3ZSBiYWlsXG4gICAgdGhpcy5zdGFydFNhZmV0eVRpbWVyKDEyMDAwLCAncmVhZHkoKScpO1xuXG4gICAgLy8gQ2xlYXIgdGhlIHNhZmV0eSB0aW1lclxuICAgIHRoaXMubWFuYWdlclByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLmNsZWFyU2FmZXR5VGltZXIoJ29uQWRzTWFuYWdlckxvYWRlZCgpJyk7XG4gICAgfSk7XG5cbiAgICAvLyBTZXQgbGlzdGVuZXJzIG9uIHRoZSBQbHlyIGluc3RhbmNlXG4gICAgdGhpcy5saXN0ZW5lcnMoKTtcblxuICAgIC8vIFNldHVwIHRoZSBJTUEgU0RLXG4gICAgdGhpcy5zZXR1cElNQSgpO1xuICB9O1xuXG4gIC8vIEJ1aWxkIHRoZSB0YWcgVVJMXG4gIGdldCB0YWdVcmwoKSB7XG4gICAgY29uc3QgeyBjb25maWcgfSA9IHRoaXM7XG5cbiAgICBpZiAoaXMudXJsKGNvbmZpZy50YWdVcmwpKSB7XG4gICAgICByZXR1cm4gY29uZmlnLnRhZ1VybDtcbiAgICB9XG5cbiAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICBBVl9QVUJMSVNIRVJJRDogJzU4YzI1YmIwMDczZWY0NDhiMTA4N2FkNicsXG4gICAgICBBVl9DSEFOTkVMSUQ6ICc1YTA0NThkYzI4YTA2MTQ1ZTQ1MTlkMjEnLFxuICAgICAgQVZfVVJMOiB3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUsXG4gICAgICBjYjogRGF0ZS5ub3coKSxcbiAgICAgIEFWX1dJRFRIOiA2NDAsXG4gICAgICBBVl9IRUlHSFQ6IDQ4MCxcbiAgICAgIEFWX0NESU0yOiBjb25maWcucHVibGlzaGVySWQsXG4gICAgfTtcblxuICAgIGNvbnN0IGJhc2UgPSAnaHR0cHM6Ly9nby5hbml2aWV3LmNvbS9hcGkvYWRzZXJ2ZXI2L3Zhc3QvJztcblxuICAgIHJldHVybiBgJHtiYXNlfT8ke2J1aWxkVXJsUGFyYW1zKHBhcmFtcyl9YDtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbiBvcmRlciBmb3IgdGhlIFNESyB0byBkaXNwbGF5IGFkcyBmb3Igb3VyIHZpZGVvLCB3ZSBuZWVkIHRvIHRlbGwgaXQgd2hlcmUgdG8gcHV0IHRoZW0sXG4gICAqIHNvIGhlcmUgd2UgZGVmaW5lIG91ciBhZCBjb250YWluZXIuIFRoaXMgZGl2IGlzIHNldCB1cCB0byByZW5kZXIgb24gdG9wIG9mIHRoZSB2aWRlbyBwbGF5ZXIuXG4gICAqIFVzaW5nIHRoZSBjb2RlIGJlbG93LCB3ZSB0ZWxsIHRoZSBTREsgdG8gcmVuZGVyIGFkcyB3aXRoaW4gdGhhdCBkaXYuIFdlIGFsc28gcHJvdmlkZSBhXG4gICAqIGhhbmRsZSB0byB0aGUgY29udGVudCB2aWRlbyBwbGF5ZXIgLSB0aGUgU0RLIHdpbGwgcG9sbCB0aGUgY3VycmVudCB0aW1lIG9mIG91ciBwbGF5ZXIgdG9cbiAgICogcHJvcGVybHkgcGxhY2UgbWlkLXJvbGxzLiBBZnRlciB3ZSBjcmVhdGUgdGhlIGFkIGRpc3BsYXkgY29udGFpbmVyLCB3ZSBpbml0aWFsaXplIGl0LiBPblxuICAgKiBtb2JpbGUgZGV2aWNlcywgdGhpcyBpbml0aWFsaXphdGlvbiBpcyBkb25lIGFzIHRoZSByZXN1bHQgb2YgYSB1c2VyIGFjdGlvbi5cbiAgICovXG4gIHNldHVwSU1BID0gKCkgPT4ge1xuICAgIC8vIENyZWF0ZSB0aGUgY29udGFpbmVyIGZvciBvdXIgYWR2ZXJ0aXNlbWVudHNcbiAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgIGNsYXNzOiB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5hZHMsXG4gICAgfSk7XG5cbiAgICB0aGlzLnBsYXllci5lbGVtZW50cy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50cy5jb250YWluZXIpO1xuXG4gICAgLy8gU28gd2UgY2FuIHJ1biBWUEFJRDJcbiAgICBnb29nbGUuaW1hLnNldHRpbmdzLnNldFZwYWlkTW9kZShnb29nbGUuaW1hLkltYVNka1NldHRpbmdzLlZwYWlkTW9kZS5FTkFCTEVEKTtcblxuICAgIC8vIFNldCBsYW5ndWFnZVxuICAgIGdvb2dsZS5pbWEuc2V0dGluZ3Muc2V0TG9jYWxlKHRoaXMucGxheWVyLmNvbmZpZy5hZHMubGFuZ3VhZ2UpO1xuXG4gICAgLy8gU2V0IHBsYXliYWNrIGZvciBpT1MxMCtcbiAgICBnb29nbGUuaW1hLnNldHRpbmdzLnNldERpc2FibGVDdXN0b21QbGF5YmFja0ZvcklPUzEwUGx1cyh0aGlzLnBsYXllci5jb25maWcucGxheXNpbmxpbmUpO1xuXG4gICAgLy8gV2UgYXNzdW1lIHRoZSBhZENvbnRhaW5lciBpcyB0aGUgdmlkZW8gY29udGFpbmVyIG9mIHRoZSBwbHlyIGVsZW1lbnQgdGhhdCB3aWxsIGhvdXNlIHRoZSBhZHNcbiAgICB0aGlzLmVsZW1lbnRzLmRpc3BsYXlDb250YWluZXIgPSBuZXcgZ29vZ2xlLmltYS5BZERpc3BsYXlDb250YWluZXIodGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMucGxheWVyLm1lZGlhKTtcblxuICAgIC8vIENyZWF0ZSBhZHMgbG9hZGVyXG4gICAgdGhpcy5sb2FkZXIgPSBuZXcgZ29vZ2xlLmltYS5BZHNMb2FkZXIodGhpcy5lbGVtZW50cy5kaXNwbGF5Q29udGFpbmVyKTtcblxuICAgIC8vIExpc3RlbiBhbmQgcmVzcG9uZCB0byBhZHMgbG9hZGVkIGFuZCBlcnJvciBldmVudHNcbiAgICB0aGlzLmxvYWRlci5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgZ29vZ2xlLmltYS5BZHNNYW5hZ2VyTG9hZGVkRXZlbnQuVHlwZS5BRFNfTUFOQUdFUl9MT0FERUQsXG4gICAgICAoZXZlbnQpID0+IHRoaXMub25BZHNNYW5hZ2VyTG9hZGVkKGV2ZW50KSxcbiAgICAgIGZhbHNlLFxuICAgICk7XG4gICAgdGhpcy5sb2FkZXIuYWRkRXZlbnRMaXN0ZW5lcihnb29nbGUuaW1hLkFkRXJyb3JFdmVudC5UeXBlLkFEX0VSUk9SLCAoZXJyb3IpID0+IHRoaXMub25BZEVycm9yKGVycm9yKSwgZmFsc2UpO1xuXG4gICAgLy8gUmVxdWVzdCB2aWRlbyBhZHMgdG8gYmUgcHJlLWxvYWRlZFxuICAgIHRoaXMucmVxdWVzdEFkcygpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXF1ZXN0IGFkdmVydGlzZW1lbnRzXG4gICAqL1xuICByZXF1ZXN0QWRzID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSB0aGlzLnBsYXllci5lbGVtZW50cztcblxuICAgIHRyeSB7XG4gICAgICAvLyBSZXF1ZXN0IHZpZGVvIGFkc1xuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBnb29nbGUuaW1hLkFkc1JlcXVlc3QoKTtcbiAgICAgIHJlcXVlc3QuYWRUYWdVcmwgPSB0aGlzLnRhZ1VybDtcblxuICAgICAgLy8gU3BlY2lmeSB0aGUgbGluZWFyIGFuZCBub25saW5lYXIgc2xvdCBzaXplcy4gVGhpcyBoZWxwcyB0aGUgU0RLXG4gICAgICAvLyB0byBzZWxlY3QgdGhlIGNvcnJlY3QgY3JlYXRpdmUgaWYgbXVsdGlwbGUgYXJlIHJldHVybmVkXG4gICAgICByZXF1ZXN0LmxpbmVhckFkU2xvdFdpZHRoID0gY29udGFpbmVyLm9mZnNldFdpZHRoO1xuICAgICAgcmVxdWVzdC5saW5lYXJBZFNsb3RIZWlnaHQgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0O1xuICAgICAgcmVxdWVzdC5ub25MaW5lYXJBZFNsb3RXaWR0aCA9IGNvbnRhaW5lci5vZmZzZXRXaWR0aDtcbiAgICAgIHJlcXVlc3Qubm9uTGluZWFyQWRTbG90SGVpZ2h0ID0gY29udGFpbmVyLm9mZnNldEhlaWdodDtcblxuICAgICAgLy8gV2Ugb25seSBvdmVybGF5IGFkcyBhcyB3ZSBvbmx5IHN1cHBvcnQgdmlkZW8uXG4gICAgICByZXF1ZXN0LmZvcmNlTm9uTGluZWFyRnVsbFNsb3QgPSBmYWxzZTtcblxuICAgICAgLy8gTXV0ZSBiYXNlZCBvbiBjdXJyZW50IHN0YXRlXG4gICAgICByZXF1ZXN0LnNldEFkV2lsbFBsYXlNdXRlZCghdGhpcy5wbGF5ZXIubXV0ZWQpO1xuXG4gICAgICB0aGlzLmxvYWRlci5yZXF1ZXN0QWRzKHJlcXVlc3QpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLm9uQWRFcnJvcihlcnJvcik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIGFkIGNvdW50ZG93blxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IHN0YXJ0XG4gICAqL1xuICBwb2xsQ291bnRkb3duID0gKHN0YXJ0ID0gZmFsc2UpID0+IHtcbiAgICBpZiAoIXN0YXJ0KSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuY291bnRkb3duVGltZXIpO1xuICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWJhZGdlLXRleHQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB1cGRhdGUgPSAoKSA9PiB7XG4gICAgICBjb25zdCB0aW1lID0gZm9ybWF0VGltZShNYXRoLm1heCh0aGlzLm1hbmFnZXIuZ2V0UmVtYWluaW5nVGltZSgpLCAwKSk7XG4gICAgICBjb25zdCBsYWJlbCA9IGAke2kxOG4uZ2V0KCdhZHZlcnRpc2VtZW50JywgdGhpcy5wbGF5ZXIuY29uZmlnKX0gLSAke3RpbWV9YDtcbiAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnNldEF0dHJpYnV0ZSgnZGF0YS1iYWRnZS10ZXh0JywgbGFiZWwpO1xuICAgIH07XG5cbiAgICB0aGlzLmNvdW50ZG93blRpbWVyID0gc2V0SW50ZXJ2YWwodXBkYXRlLCAxMDApO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUaGlzIG1ldGhvZCBpcyBjYWxsZWQgd2hlbmV2ZXIgdGhlIGFkcyBhcmUgcmVhZHkgaW5zaWRlIHRoZSBBZERpc3BsYXlDb250YWluZXJcbiAgICogQHBhcmFtIHtFdmVudH0gZXZlbnQgLSBhZHNNYW5hZ2VyTG9hZGVkRXZlbnRcbiAgICovXG4gIG9uQWRzTWFuYWdlckxvYWRlZCA9IChldmVudCkgPT4ge1xuICAgIC8vIExvYWQgY291bGQgb2NjdXIgYWZ0ZXIgYSBzb3VyY2UgY2hhbmdlIChyYWNlIGNvbmRpdGlvbilcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgYWRzIG1hbmFnZXJcbiAgICBjb25zdCBzZXR0aW5ncyA9IG5ldyBnb29nbGUuaW1hLkFkc1JlbmRlcmluZ1NldHRpbmdzKCk7XG5cbiAgICAvLyBUZWxsIHRoZSBTREsgdG8gc2F2ZSBhbmQgcmVzdG9yZSBjb250ZW50IHZpZGVvIHN0YXRlIG9uIG91ciBiZWhhbGZcbiAgICBzZXR0aW5ncy5yZXN0b3JlQ3VzdG9tUGxheWJhY2tTdGF0ZU9uQWRCcmVha0NvbXBsZXRlID0gdHJ1ZTtcbiAgICBzZXR0aW5ncy5lbmFibGVQcmVsb2FkaW5nID0gdHJ1ZTtcblxuICAgIC8vIFRoZSBTREsgaXMgcG9sbGluZyBjdXJyZW50VGltZSBvbiB0aGUgY29udGVudFBsYXliYWNrLiBBbmQgbmVlZHMgYSBkdXJhdGlvblxuICAgIC8vIHNvIGl0IGNhbiBkZXRlcm1pbmUgd2hlbiB0byBzdGFydCB0aGUgbWlkLSBhbmQgcG9zdC1yb2xsXG4gICAgdGhpcy5tYW5hZ2VyID0gZXZlbnQuZ2V0QWRzTWFuYWdlcih0aGlzLnBsYXllciwgc2V0dGluZ3MpO1xuXG4gICAgLy8gR2V0IHRoZSBjdWUgcG9pbnRzIGZvciBhbnkgbWlkLXJvbGxzIGJ5IGZpbHRlcmluZyBvdXQgdGhlIHByZS0gYW5kIHBvc3Qtcm9sbFxuICAgIHRoaXMuY3VlUG9pbnRzID0gdGhpcy5tYW5hZ2VyLmdldEN1ZVBvaW50cygpO1xuXG4gICAgLy8gQWRkIGxpc3RlbmVycyB0byB0aGUgcmVxdWlyZWQgZXZlbnRzXG4gICAgLy8gQWR2ZXJ0aXNlbWVudCBlcnJvciBldmVudHNcbiAgICB0aGlzLm1hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihnb29nbGUuaW1hLkFkRXJyb3JFdmVudC5UeXBlLkFEX0VSUk9SLCAoZXJyb3IpID0+IHRoaXMub25BZEVycm9yKGVycm9yKSk7XG5cbiAgICAvLyBBZHZlcnRpc2VtZW50IHJlZ3VsYXIgZXZlbnRzXG4gICAgT2JqZWN0LmtleXMoZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUpLmZvckVhY2goKHR5cGUpID0+IHtcbiAgICAgIHRoaXMubWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlW3R5cGVdLCAoZSkgPT4gdGhpcy5vbkFkRXZlbnQoZSkpO1xuICAgIH0pO1xuXG4gICAgLy8gUmVzb2x2ZSBvdXIgYWRzTWFuYWdlclxuICAgIHRoaXMudHJpZ2dlcignbG9hZGVkJyk7XG4gIH07XG5cbiAgYWRkQ3VlUG9pbnRzID0gKCkgPT4ge1xuICAgIC8vIEFkZCBhZHZlcnRpc2VtZW50IGN1ZSdzIHdpdGhpbiB0aGUgdGltZSBsaW5lIGlmIGF2YWlsYWJsZVxuICAgIGlmICghaXMuZW1wdHkodGhpcy5jdWVQb2ludHMpKSB7XG4gICAgICB0aGlzLmN1ZVBvaW50cy5mb3JFYWNoKChjdWVQb2ludCkgPT4ge1xuICAgICAgICBpZiAoY3VlUG9pbnQgIT09IDAgJiYgY3VlUG9pbnQgIT09IC0xICYmIGN1ZVBvaW50IDwgdGhpcy5wbGF5ZXIuZHVyYXRpb24pIHtcbiAgICAgICAgICBjb25zdCBzZWVrRWxlbWVudCA9IHRoaXMucGxheWVyLmVsZW1lbnRzLnByb2dyZXNzO1xuXG4gICAgICAgICAgaWYgKGlzLmVsZW1lbnQoc2Vla0VsZW1lbnQpKSB7XG4gICAgICAgICAgICBjb25zdCBjdWVQZXJjZW50YWdlID0gKDEwMCAvIHRoaXMucGxheWVyLmR1cmF0aW9uKSAqIGN1ZVBvaW50O1xuICAgICAgICAgICAgY29uc3QgY3VlID0gY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLmN1ZXMsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY3VlLnN0eWxlLmxlZnQgPSBgJHtjdWVQZXJjZW50YWdlLnRvU3RyaW5nKCl9JWA7XG4gICAgICAgICAgICBzZWVrRWxlbWVudC5hcHBlbmRDaGlsZChjdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBUaGlzIGlzIHdoZXJlIGFsbCB0aGUgZXZlbnQgaGFuZGxpbmcgdGFrZXMgcGxhY2UuIFJldHJpZXZlIHRoZSBhZCBmcm9tIHRoZSBldmVudC4gU29tZVxuICAgKiBldmVudHMgKGUuZy4gQUxMX0FEU19DT01QTEVURUQpIGRvbid0IGhhdmUgdGhlIGFkIG9iamVjdCBhc3NvY2lhdGVkXG4gICAqIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL2ludGVyYWN0aXZlLW1lZGlhLWFkcy9kb2NzL3Nka3MvaHRtbDUvdjMvYXBpcyNpbWEuQWRFdmVudC5UeXBlXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqL1xuICBvbkFkRXZlbnQgPSAoZXZlbnQpID0+IHtcbiAgICBjb25zdCB7IGNvbnRhaW5lciB9ID0gdGhpcy5wbGF5ZXIuZWxlbWVudHM7XG4gICAgLy8gUmV0cmlldmUgdGhlIGFkIGZyb20gdGhlIGV2ZW50LiBTb21lIGV2ZW50cyAoZS5nLiBBTExfQURTX0NPTVBMRVRFRClcbiAgICAvLyBkb24ndCBoYXZlIGFkIG9iamVjdCBhc3NvY2lhdGVkXG4gICAgY29uc3QgYWQgPSBldmVudC5nZXRBZCgpO1xuICAgIGNvbnN0IGFkRGF0YSA9IGV2ZW50LmdldEFkRGF0YSgpO1xuXG4gICAgLy8gUHJveHkgZXZlbnRcbiAgICBjb25zdCBkaXNwYXRjaEV2ZW50ID0gKHR5cGUpID0+IHtcbiAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMucGxheWVyLCB0aGlzLnBsYXllci5tZWRpYSwgYGFkcyR7dHlwZS5yZXBsYWNlKC9fL2csICcnKS50b0xvd2VyQ2FzZSgpfWApO1xuICAgIH07XG5cbiAgICAvLyBCdWJibGUgdGhlIGV2ZW50XG4gICAgZGlzcGF0Y2hFdmVudChldmVudC50eXBlKTtcblxuICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5MT0FERUQ6XG4gICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IGV2ZW50IHNlbnQgZm9yIGFuIGFkIC0gaXQgaXMgcG9zc2libGUgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlXG4gICAgICAgIC8vIGFkIGlzIGEgdmlkZW8gYWQgb3IgYW4gb3ZlcmxheVxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2xvYWRlZCcpO1xuXG4gICAgICAgIC8vIFN0YXJ0IGNvdW50ZG93blxuICAgICAgICB0aGlzLnBvbGxDb3VudGRvd24odHJ1ZSk7XG5cbiAgICAgICAgaWYgKCFhZC5pc0xpbmVhcigpKSB7XG4gICAgICAgICAgLy8gUG9zaXRpb24gQWREaXNwbGF5Q29udGFpbmVyIGNvcnJlY3RseSBmb3Igb3ZlcmxheVxuICAgICAgICAgIGFkLndpZHRoID0gY29udGFpbmVyLm9mZnNldFdpZHRoO1xuICAgICAgICAgIGFkLmhlaWdodCA9IGNvbnRhaW5lci5vZmZzZXRIZWlnaHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBjb25zb2xlLmluZm8oJ0FkIHR5cGU6ICcgKyBldmVudC5nZXRBZCgpLmdldEFkUG9kSW5mbygpLmdldFBvZEluZGV4KCkpO1xuICAgICAgICAvLyBjb25zb2xlLmluZm8oJ0FkIHRpbWU6ICcgKyBldmVudC5nZXRBZCgpLmdldEFkUG9kSW5mbygpLmdldFRpbWVPZmZzZXQoKSk7XG5cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuU1RBUlRFRDpcbiAgICAgICAgLy8gU2V0IHZvbHVtZSB0byBtYXRjaCBwbGF5ZXJcbiAgICAgICAgdGhpcy5tYW5hZ2VyLnNldFZvbHVtZSh0aGlzLnBsYXllci52b2x1bWUpO1xuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkFMTF9BRFNfQ09NUExFVEVEOlxuICAgICAgICAvLyBBbGwgYWRzIGZvciB0aGUgY3VycmVudCB2aWRlb3MgYXJlIGRvbmUuIFdlIGNhbiBub3cgcmVxdWVzdCBuZXcgYWR2ZXJ0aXNlbWVudHNcbiAgICAgICAgLy8gaW4gY2FzZSB0aGUgdmlkZW8gaXMgcmUtcGxheWVkXG5cbiAgICAgICAgLy8gVE9ETzogRXhhbXBsZSBmb3Igd2hhdCBoYXBwZW5zIHdoZW4gYSBuZXh0IHZpZGVvIGluIGEgcGxheWxpc3Qgd291bGQgYmUgbG9hZGVkLlxuICAgICAgICAvLyBTbyBoZXJlIHdlIGxvYWQgYSBuZXcgdmlkZW8gd2hlbiBhbGwgYWRzIGFyZSBkb25lLlxuICAgICAgICAvLyBUaGVuIHdlIGxvYWQgbmV3IGFkcyB3aXRoaW4gYSBuZXcgYWRzTWFuYWdlci4gV2hlbiB0aGUgdmlkZW9cbiAgICAgICAgLy8gSXMgc3RhcnRlZCAtIGFmdGVyIC0gdGhlIGFkcyBhcmUgbG9hZGVkLCB0aGVuIHdlIGdldCBhZHMuXG4gICAgICAgIC8vIFlvdSBjYW4gYWxzbyBlYXNpbHkgdGVzdCBjYW5jZWxsaW5nIGFuZCByZWxvYWRpbmcgYnkgcnVubmluZ1xuICAgICAgICAvLyBwbGF5ZXIuYWRzLmNhbmNlbCgpIGFuZCBwbGF5ZXIuYWRzLnBsYXkgZnJvbSB0aGUgY29uc29sZSBJIGd1ZXNzLlxuICAgICAgICAvLyB0aGlzLnBsYXllci5zb3VyY2UgPSB7XG4gICAgICAgIC8vICAgICB0eXBlOiAndmlkZW8nLFxuICAgICAgICAvLyAgICAgdGl0bGU6ICdWaWV3IEZyb20gQSBCbHVlIE1vb24nLFxuICAgICAgICAvLyAgICAgc291cmNlczogW3tcbiAgICAgICAgLy8gICAgICAgICBzcmM6XG4gICAgICAgIC8vICdodHRwczovL2Nkbi5wbHlyLmlvL3N0YXRpYy9kZW1vL1ZpZXdfRnJvbV9BX0JsdWVfTW9vbl9UcmFpbGVyLUhELm1wNCcsIHR5cGU6XG4gICAgICAgIC8vICd2aWRlby9tcDQnLCB9XSwgcG9zdGVyOlxuICAgICAgICAvLyAnaHR0cHM6Ly9jZG4ucGx5ci5pby9zdGF0aWMvZGVtby9WaWV3X0Zyb21fQV9CbHVlX01vb25fVHJhaWxlci1IRC5qcGcnLCB0cmFja3M6XG4gICAgICAgIC8vIFsgeyBraW5kOiAnY2FwdGlvbnMnLCBsYWJlbDogJ0VuZ2xpc2gnLCBzcmNsYW5nOiAnZW4nLCBzcmM6XG4gICAgICAgIC8vICdodHRwczovL2Nkbi5wbHlyLmlvL3N0YXRpYy9kZW1vL1ZpZXdfRnJvbV9BX0JsdWVfTW9vbl9UcmFpbGVyLUhELmVuLnZ0dCcsXG4gICAgICAgIC8vIGRlZmF1bHQ6IHRydWUsIH0sIHsga2luZDogJ2NhcHRpb25zJywgbGFiZWw6ICdGcmVuY2gnLCBzcmNsYW5nOiAnZnInLCBzcmM6XG4gICAgICAgIC8vICdodHRwczovL2Nkbi5wbHlyLmlvL3N0YXRpYy9kZW1vL1ZpZXdfRnJvbV9BX0JsdWVfTW9vbl9UcmFpbGVyLUhELmZyLnZ0dCcsIH0sIF0sXG4gICAgICAgIC8vIH07XG5cbiAgICAgICAgLy8gVE9ETzogU28gdGhlcmUgaXMgc3RpbGwgdGhpcyB0aGluZyB3aGVyZSBhIHZpZGVvIHNob3VsZCBvbmx5IGJlIGFsbG93ZWQgdG8gc3RhcnRcbiAgICAgICAgLy8gcGxheWluZyB3aGVuIHRoZSBJTUEgU0RLIGlzIHJlYWR5IG9yIGhhcyBmYWlsZWRcblxuICAgICAgICBpZiAodGhpcy5wbGF5ZXIuZW5kZWQpIHtcbiAgICAgICAgICB0aGlzLmxvYWRBZHMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBUaGUgU0RLIHdvbid0IGFsbG93IG5ldyBhZHMgdG8gYmUgY2FsbGVkIHdpdGhvdXQgcmVjZWl2aW5nIGEgY29udGVudENvbXBsZXRlKClcbiAgICAgICAgICB0aGlzLmxvYWRlci5jb250ZW50Q29tcGxldGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkNPTlRFTlRfUEFVU0VfUkVRVUVTVEVEOlxuICAgICAgICAvLyBUaGlzIGV2ZW50IGluZGljYXRlcyB0aGUgYWQgaGFzIHN0YXJ0ZWQgLSB0aGUgdmlkZW8gcGxheWVyIGNhbiBhZGp1c3QgdGhlIFVJLFxuICAgICAgICAvLyBmb3IgZXhhbXBsZSBkaXNwbGF5IGEgcGF1c2UgYnV0dG9uIGFuZCByZW1haW5pbmcgdGltZS4gRmlyZWQgd2hlbiBjb250ZW50IHNob3VsZFxuICAgICAgICAvLyBiZSBwYXVzZWQuIFRoaXMgdXN1YWxseSBoYXBwZW5zIHJpZ2h0IGJlZm9yZSBhbiBhZCBpcyBhYm91dCB0byBjb3ZlciB0aGUgY29udGVudFxuXG4gICAgICAgIHRoaXMucGF1c2VDb250ZW50KCk7XG5cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuQ09OVEVOVF9SRVNVTUVfUkVRVUVTVEVEOlxuICAgICAgICAvLyBUaGlzIGV2ZW50IGluZGljYXRlcyB0aGUgYWQgaGFzIGZpbmlzaGVkIC0gdGhlIHZpZGVvIHBsYXllciBjYW4gcGVyZm9ybVxuICAgICAgICAvLyBhcHByb3ByaWF0ZSBVSSBhY3Rpb25zLCBzdWNoIGFzIHJlbW92aW5nIHRoZSB0aW1lciBmb3IgcmVtYWluaW5nIHRpbWUgZGV0ZWN0aW9uLlxuICAgICAgICAvLyBGaXJlZCB3aGVuIGNvbnRlbnQgc2hvdWxkIGJlIHJlc3VtZWQuIFRoaXMgdXN1YWxseSBoYXBwZW5zIHdoZW4gYW4gYWQgZmluaXNoZXNcbiAgICAgICAgLy8gb3IgY29sbGFwc2VzXG5cbiAgICAgICAgdGhpcy5wb2xsQ291bnRkb3duKCk7XG5cbiAgICAgICAgdGhpcy5yZXN1bWVDb250ZW50KCk7XG5cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuTE9HOlxuICAgICAgICBpZiAoYWREYXRhLmFkRXJyb3IpIHtcbiAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy53YXJuKGBOb24tZmF0YWwgYWQgZXJyb3I6ICR7YWREYXRhLmFkRXJyb3IuZ2V0TWVzc2FnZSgpfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQW55IGFkIGVycm9yIGhhbmRsaW5nIGNvbWVzIHRocm91Z2ggaGVyZVxuICAgKiBAcGFyYW0ge0V2ZW50fSBldmVudFxuICAgKi9cbiAgb25BZEVycm9yID0gKGV2ZW50KSA9PiB7XG4gICAgdGhpcy5jYW5jZWwoKTtcbiAgICB0aGlzLnBsYXllci5kZWJ1Zy53YXJuKCdBZHMgZXJyb3InLCBldmVudCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldHVwIGhvb2tzIGZvciBQbHlyIGFuZCB3aW5kb3cgZXZlbnRzLiBUaGlzIGVuc3VyZXNcbiAgICogdGhlIG1pZC0gYW5kIHBvc3Qtcm9sbCBsYXVuY2ggYXQgdGhlIGNvcnJlY3QgdGltZS4gQW5kXG4gICAqIHJlc2l6ZSB0aGUgYWR2ZXJ0aXNlbWVudCB3aGVuIHRoZSBwbGF5ZXIgcmVzaXplc1xuICAgKi9cbiAgbGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSB0aGlzLnBsYXllci5lbGVtZW50cztcbiAgICBsZXQgdGltZTtcblxuICAgIHRoaXMucGxheWVyLm9uKCdjYW5wbGF5JywgKCkgPT4ge1xuICAgICAgdGhpcy5hZGRDdWVQb2ludHMoKTtcbiAgICB9KTtcblxuICAgIHRoaXMucGxheWVyLm9uKCdlbmRlZCcsICgpID0+IHtcbiAgICAgIHRoaXMubG9hZGVyLmNvbnRlbnRDb21wbGV0ZSgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5wbGF5ZXIub24oJ3RpbWV1cGRhdGUnLCAoKSA9PiB7XG4gICAgICB0aW1lID0gdGhpcy5wbGF5ZXIuY3VycmVudFRpbWU7XG4gICAgfSk7XG5cbiAgICB0aGlzLnBsYXllci5vbignc2Vla2VkJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2Vla2VkVGltZSA9IHRoaXMucGxheWVyLmN1cnJlbnRUaW1lO1xuXG4gICAgICBpZiAoaXMuZW1wdHkodGhpcy5jdWVQb2ludHMpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jdWVQb2ludHMuZm9yRWFjaCgoY3VlUG9pbnQsIGluZGV4KSA9PiB7XG4gICAgICAgIGlmICh0aW1lIDwgY3VlUG9pbnQgJiYgY3VlUG9pbnQgPCBzZWVrZWRUaW1lKSB7XG4gICAgICAgICAgdGhpcy5tYW5hZ2VyLmRpc2NhcmRBZEJyZWFrKCk7XG4gICAgICAgICAgdGhpcy5jdWVQb2ludHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBMaXN0ZW4gdG8gdGhlIHJlc2l6aW5nIG9mIHRoZSB3aW5kb3cuIEFuZCByZXNpemUgYWQgYWNjb3JkaW5nbHlcbiAgICAvLyBUT0RPOiBldmVudHVhbGx5IGltcGxlbWVudCBSZXNpemVPYnNlcnZlclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5tYW5hZ2VyKSB7XG4gICAgICAgIHRoaXMubWFuYWdlci5yZXNpemUoY29udGFpbmVyLm9mZnNldFdpZHRoLCBjb250YWluZXIub2Zmc2V0SGVpZ2h0LCBnb29nbGUuaW1hLlZpZXdNb2RlLk5PUk1BTCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIGFkc01hbmFnZXIgYW5kIHN0YXJ0IHBsYXlpbmcgYWR2ZXJ0aXNlbWVudHNcbiAgICovXG4gIHBsYXkgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBjb250YWluZXIgfSA9IHRoaXMucGxheWVyLmVsZW1lbnRzO1xuXG4gICAgaWYgKCF0aGlzLm1hbmFnZXJQcm9taXNlKSB7XG4gICAgICB0aGlzLnJlc3VtZUNvbnRlbnQoKTtcbiAgICB9XG5cbiAgICAvLyBQbGF5IHRoZSByZXF1ZXN0ZWQgYWR2ZXJ0aXNlbWVudCB3aGVuZXZlciB0aGUgYWRzTWFuYWdlciBpcyByZWFkeVxuICAgIHRoaXMubWFuYWdlclByb21pc2VcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgLy8gU2V0IHZvbHVtZSB0byBtYXRjaCBwbGF5ZXJcbiAgICAgICAgdGhpcy5tYW5hZ2VyLnNldFZvbHVtZSh0aGlzLnBsYXllci52b2x1bWUpO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGNvbnRhaW5lci4gTXVzdCBiZSBkb25lIHZpYSBhIHVzZXIgYWN0aW9uIG9uIG1vYmlsZSBkZXZpY2VzXG4gICAgICAgIHRoaXMuZWxlbWVudHMuZGlzcGxheUNvbnRhaW5lci5pbml0aWFsaXplKCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAoIXRoaXMuaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGFkcyBtYW5hZ2VyLiBBZCBydWxlcyBwbGF5bGlzdCB3aWxsIHN0YXJ0IGF0IHRoaXMgdGltZVxuICAgICAgICAgICAgdGhpcy5tYW5hZ2VyLmluaXQoY29udGFpbmVyLm9mZnNldFdpZHRoLCBjb250YWluZXIub2Zmc2V0SGVpZ2h0LCBnb29nbGUuaW1hLlZpZXdNb2RlLk5PUk1BTCk7XG5cbiAgICAgICAgICAgIC8vIENhbGwgcGxheSB0byBzdGFydCBzaG93aW5nIHRoZSBhZC4gU2luZ2xlIHZpZGVvIGFuZCBvdmVybGF5IGFkcyB3aWxsXG4gICAgICAgICAgICAvLyBzdGFydCBhdCB0aGlzIHRpbWU7IHRoZSBjYWxsIHdpbGwgYmUgaWdub3JlZCBmb3IgYWQgcnVsZXNcbiAgICAgICAgICAgIHRoaXMubWFuYWdlci5zdGFydCgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICB9IGNhdGNoIChhZEVycm9yKSB7XG4gICAgICAgICAgLy8gQW4gZXJyb3IgbWF5IGJlIHRocm93biBpZiB0aGVyZSB3YXMgYSBwcm9ibGVtIHdpdGggdGhlXG4gICAgICAgICAgLy8gVkFTVCByZXNwb25zZVxuICAgICAgICAgIHRoaXMub25BZEVycm9yKGFkRXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKCgpID0+IHt9KTtcbiAgfTtcblxuICAvKipcbiAgICogUmVzdW1lIG91ciB2aWRlb1xuICAgKi9cbiAgcmVzdW1lQ29udGVudCA9ICgpID0+IHtcbiAgICAvLyBIaWRlIHRoZSBhZHZlcnRpc2VtZW50IGNvbnRhaW5lclxuICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnN0eWxlLnpJbmRleCA9ICcnO1xuXG4gICAgLy8gQWQgaXMgc3RvcHBlZFxuICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xuXG4gICAgLy8gUGxheSB2aWRlb1xuICAgIHNpbGVuY2VQcm9taXNlKHRoaXMucGxheWVyLm1lZGlhLnBsYXkoKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhdXNlIG91ciB2aWRlb1xuICAgKi9cbiAgcGF1c2VDb250ZW50ID0gKCkgPT4ge1xuICAgIC8vIFNob3cgdGhlIGFkdmVydGlzZW1lbnQgY29udGFpbmVyXG4gICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIuc3R5bGUuekluZGV4ID0gMztcblxuICAgIC8vIEFkIGlzIHBsYXlpbmdcbiAgICB0aGlzLnBsYXlpbmcgPSB0cnVlO1xuXG4gICAgLy8gUGF1c2Ugb3VyIHZpZGVvLlxuICAgIHRoaXMucGxheWVyLm1lZGlhLnBhdXNlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIERlc3Ryb3kgdGhlIGFkc01hbmFnZXIgc28gd2UgY2FuIGdyYWIgbmV3IGFkcyBhZnRlciB0aGlzLiBJZiB3ZSBkb24ndCB0aGVuIHdlJ3JlIG5vdFxuICAgKiBhbGxvd2VkIHRvIGNhbGwgbmV3IGFkcyBiYXNlZCBvbiBnb29nbGUgcG9saWNpZXMsIGFzIHRoZXkgaW50ZXJwcmV0IHRoaXMgYXMgYW4gYWNjaWRlbnRhbFxuICAgKiB2aWRlbyByZXF1ZXN0cy4gaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vaW50ZXJhY3RpdmUtXG4gICAqIG1lZGlhLWFkcy9kb2NzL3Nka3MvYW5kcm9pZC9mYXEjOFxuICAgKi9cbiAgY2FuY2VsID0gKCkgPT4ge1xuICAgIC8vIFBhdXNlIG91ciB2aWRlb1xuICAgIGlmICh0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICB0aGlzLnJlc3VtZUNvbnRlbnQoKTtcbiAgICB9XG5cbiAgICAvLyBUZWxsIG91ciBpbnN0YW5jZSB0aGF0IHdlJ3JlIGRvbmUgZm9yIG5vd1xuICAgIHRoaXMudHJpZ2dlcignZXJyb3InKTtcblxuICAgIC8vIFJlLWNyZWF0ZSBvdXIgYWRzTWFuYWdlclxuICAgIHRoaXMubG9hZEFkcygpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZS1jcmVhdGUgb3VyIGFkc01hbmFnZXJcbiAgICovXG4gIGxvYWRBZHMgPSAoKSA9PiB7XG4gICAgLy8gVGVsbCBvdXIgYWRzTWFuYWdlciB0byBnbyBieWUgYnllXG4gICAgdGhpcy5tYW5hZ2VyUHJvbWlzZVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAvLyBEZXN0cm95IG91ciBhZHNNYW5hZ2VyXG4gICAgICAgIGlmICh0aGlzLm1hbmFnZXIpIHtcbiAgICAgICAgICB0aGlzLm1hbmFnZXIuZGVzdHJveSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmUtc2V0IG91ciBhZHNNYW5hZ2VyIHByb21pc2VzXG4gICAgICAgIHRoaXMubWFuYWdlclByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgIHRoaXMub24oJ2xvYWRlZCcsIHJlc29sdmUpO1xuICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyh0aGlzLm1hbmFnZXIpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gTm93IHRoYXQgdGhlIG1hbmFnZXIgaGFzIGJlZW4gZGVzdHJveWVkIHNldCBpdCB0byBhbHNvIGJlIHVuLWluaXRpYWxpemVkXG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuICAgICAgICAvLyBOb3cgcmVxdWVzdCBzb21lIG5ldyBhZHZlcnRpc2VtZW50c1xuICAgICAgICB0aGlzLnJlcXVlc3RBZHMoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKCkgPT4ge30pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBIYW5kbGVzIGNhbGxiYWNrcyBhZnRlciBhbiBhZCBldmVudCB3YXMgaW52b2tlZFxuICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgLSBFdmVudCB0eXBlXG4gICAqIEBwYXJhbSBhcmdzXG4gICAqL1xuICB0cmlnZ2VyID0gKGV2ZW50LCAuLi5hcmdzKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlcnMgPSB0aGlzLmV2ZW50c1tldmVudF07XG5cbiAgICBpZiAoaXMuYXJyYXkoaGFuZGxlcnMpKSB7XG4gICAgICBoYW5kbGVycy5mb3JFYWNoKChoYW5kbGVyKSA9PiB7XG4gICAgICAgIGlmIChpcy5mdW5jdGlvbihoYW5kbGVyKSkge1xuICAgICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQWRkIGV2ZW50IGxpc3RlbmVyc1xuICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgLSBFdmVudCB0eXBlXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZm9yIHdoZW4gZXZlbnQgb2NjdXJzXG4gICAqIEByZXR1cm4ge0Fkc31cbiAgICovXG4gIG9uID0gKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xuICAgIGlmICghaXMuYXJyYXkodGhpcy5ldmVudHNbZXZlbnRdKSkge1xuICAgICAgdGhpcy5ldmVudHNbZXZlbnRdID0gW107XG4gICAgfVxuXG4gICAgdGhpcy5ldmVudHNbZXZlbnRdLnB1c2goY2FsbGJhY2spO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldHVwIGEgc2FmZXR5IHRpbWVyIGZvciB3aGVuIHRoZSBhZCBuZXR3b3JrIGRvZXNuJ3QgcmVzcG9uZCBmb3Igd2hhdGV2ZXIgcmVhc29uLlxuICAgKiBUaGUgYWR2ZXJ0aXNlbWVudCBoYXMgMTIgc2Vjb25kcyB0byBnZXQgaXRzIHRoaW5ncyB0b2dldGhlci4gV2Ugc3RvcCB0aGlzIHRpbWVyIHdoZW4gdGhlXG4gICAqIGFkdmVydGlzZW1lbnQgaXMgcGxheWluZywgb3Igd2hlbiBhIHVzZXIgYWN0aW9uIGlzIHJlcXVpcmVkIHRvIHN0YXJ0LCB0aGVuIHdlIGNsZWFyIHRoZVxuICAgKiB0aW1lciBvbiBhZCByZWFkeVxuICAgKiBAcGFyYW0ge051bWJlcn0gdGltZVxuICAgKiBAcGFyYW0ge1N0cmluZ30gZnJvbVxuICAgKi9cbiAgc3RhcnRTYWZldHlUaW1lciA9ICh0aW1lLCBmcm9tKSA9PiB7XG4gICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBTYWZldHkgdGltZXIgaW52b2tlZCBmcm9tOiAke2Zyb219YCk7XG5cbiAgICB0aGlzLnNhZmV0eVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLmNhbmNlbCgpO1xuICAgICAgdGhpcy5jbGVhclNhZmV0eVRpbWVyKCdzdGFydFNhZmV0eVRpbWVyKCknKTtcbiAgICB9LCB0aW1lKTtcbiAgfTtcblxuICAvKipcbiAgICogQ2xlYXIgb3VyIHNhZmV0eSB0aW1lcihzKVxuICAgKiBAcGFyYW0ge1N0cmluZ30gZnJvbVxuICAgKi9cbiAgY2xlYXJTYWZldHlUaW1lciA9IChmcm9tKSA9PiB7XG4gICAgaWYgKCFpcy5udWxsT3JVbmRlZmluZWQodGhpcy5zYWZldHlUaW1lcikpIHtcbiAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgU2FmZXR5IHRpbWVyIGNsZWFyZWQgZnJvbTogJHtmcm9tfWApO1xuXG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5zYWZldHlUaW1lcik7XG4gICAgICB0aGlzLnNhZmV0eVRpbWVyID0gbnVsbDtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFkcztcbiIsIi8qKlxuICogUmV0dXJucyBhIG51bWJlciB3aG9zZSB2YWx1ZSBpcyBsaW1pdGVkIHRvIHRoZSBnaXZlbiByYW5nZS5cbiAqXG4gKiBFeGFtcGxlOiBsaW1pdCB0aGUgb3V0cHV0IG9mIHRoaXMgY29tcHV0YXRpb24gdG8gYmV0d2VlbiAwIGFuZCAyNTVcbiAqICh4ICogMjU1KS5jbGFtcCgwLCAyNTUpXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0XG4gKiBAcGFyYW0ge051bWJlcn0gbWluIFRoZSBsb3dlciBib3VuZGFyeSBvZiB0aGUgb3V0cHV0IHJhbmdlXG4gKiBAcGFyYW0ge051bWJlcn0gbWF4IFRoZSB1cHBlciBib3VuZGFyeSBvZiB0aGUgb3V0cHV0IHJhbmdlXG4gKiBAcmV0dXJucyBBIG51bWJlciB3aXRoaW4gdGhlIGJvdW5kcyBvZiBtaW4gYW5kIG1heFxuICogQHR5cGUgTnVtYmVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGFtcChpbnB1dCA9IDAsIG1pbiA9IDAsIG1heCA9IDI1NSkge1xuICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgoaW5wdXQsIG1pbiksIG1heCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHsgY2xhbXAgfTtcbiIsImltcG9ydCB7IGNyZWF0ZUVsZW1lbnQgfSBmcm9tICcuLi91dGlscy9lbGVtZW50cyc7XG5pbXBvcnQgeyBvbmNlIH0gZnJvbSAnLi4vdXRpbHMvZXZlbnRzJztcbmltcG9ydCBmZXRjaCBmcm9tICcuLi91dGlscy9mZXRjaCc7XG5pbXBvcnQgaXMgZnJvbSAnLi4vdXRpbHMvaXMnO1xuaW1wb3J0IHsgY2xhbXAgfSBmcm9tICcuLi91dGlscy9udW1iZXJzJztcbmltcG9ydCB7IGZvcm1hdFRpbWUgfSBmcm9tICcuLi91dGlscy90aW1lJztcblxuLy8gQXJnOiB2dHREYXRhU3RyaW5nIGV4YW1wbGU6IFwiV0VCVlRUXFxuXFxuMVxcbjAwOjAwOjA1LjAwMCAtLT4gMDA6MDA6MTAuMDAwXFxuMTA4MHAtMDAwMDEuanBnXCJcbmNvbnN0IHBhcnNlVnR0ID0gKHZ0dERhdGFTdHJpbmcpID0+IHtcbiAgY29uc3QgcHJvY2Vzc2VkTGlzdCA9IFtdO1xuICBjb25zdCBmcmFtZXMgPSB2dHREYXRhU3RyaW5nLnNwbGl0KC9cXHJcXG5cXHJcXG58XFxuXFxufFxcclxcci8pO1xuXG4gIGZyYW1lcy5mb3JFYWNoKChmcmFtZSkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGNvbnN0IGxpbmVzID0gZnJhbWUuc3BsaXQoL1xcclxcbnxcXG58XFxyLyk7XG5cbiAgICBsaW5lcy5mb3JFYWNoKChsaW5lKSA9PiB7XG4gICAgICBpZiAoIWlzLm51bWJlcihyZXN1bHQuc3RhcnRUaW1lKSkge1xuICAgICAgICAvLyBUaGUgbGluZSB3aXRoIHN0YXJ0IGFuZCBlbmQgdGltZXMgb24gaXQgaXMgdGhlIGZpcnN0IGxpbmUgb2YgaW50ZXJlc3RcbiAgICAgICAgY29uc3QgbWF0Y2hUaW1lcyA9IGxpbmUubWF0Y2goXG4gICAgICAgICAgLyhbMC05XXsyfSk/Oj8oWzAtOV17Mn0pOihbMC05XXsyfSkuKFswLTldezIsM30pKCA/LS0+ID8pKFswLTldezJ9KT86PyhbMC05XXsyfSk6KFswLTldezJ9KS4oWzAtOV17MiwzfSkvLFxuICAgICAgICApOyAvLyBOb3RlIHRoYXQgdGhpcyBjdXJyZW50bHkgaWdub3JlcyBjYXB0aW9uIGZvcm1hdHRpbmcgZGlyZWN0aXZlcyB0aGF0IGFyZSBvcHRpb25hbGx5IG9uIHRoZSBlbmQgb2YgdGhpcyBsaW5lIC0gZmluZSBmb3Igbm9uLWNhcHRpb25zIFZUVFxuXG4gICAgICAgIGlmIChtYXRjaFRpbWVzKSB7XG4gICAgICAgICAgcmVzdWx0LnN0YXJ0VGltZSA9XG4gICAgICAgICAgICBOdW1iZXIobWF0Y2hUaW1lc1sxXSB8fCAwKSAqIDYwICogNjAgK1xuICAgICAgICAgICAgTnVtYmVyKG1hdGNoVGltZXNbMl0pICogNjAgK1xuICAgICAgICAgICAgTnVtYmVyKG1hdGNoVGltZXNbM10pICtcbiAgICAgICAgICAgIE51bWJlcihgMC4ke21hdGNoVGltZXNbNF19YCk7XG4gICAgICAgICAgcmVzdWx0LmVuZFRpbWUgPVxuICAgICAgICAgICAgTnVtYmVyKG1hdGNoVGltZXNbNl0gfHwgMCkgKiA2MCAqIDYwICtcbiAgICAgICAgICAgIE51bWJlcihtYXRjaFRpbWVzWzddKSAqIDYwICtcbiAgICAgICAgICAgIE51bWJlcihtYXRjaFRpbWVzWzhdKSArXG4gICAgICAgICAgICBOdW1iZXIoYDAuJHttYXRjaFRpbWVzWzldfWApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKCFpcy5lbXB0eShsaW5lLnRyaW0oKSkgJiYgaXMuZW1wdHkocmVzdWx0LnRleHQpKSB7XG4gICAgICAgIC8vIElmIHdlIGFscmVhZHkgaGF2ZSB0aGUgc3RhcnRUaW1lLCB0aGVuIHdlJ3JlIGRlZmluaXRlbHkgdXAgdG8gdGhlIHRleHQgbGluZShzKVxuICAgICAgICBjb25zdCBsaW5lU3BsaXQgPSBsaW5lLnRyaW0oKS5zcGxpdCgnI3h5d2g9Jyk7XG4gICAgICAgIFtyZXN1bHQudGV4dF0gPSBsaW5lU3BsaXQ7XG5cbiAgICAgICAgLy8gSWYgdGhlcmUncyBjb250ZW50IGluIGxpbmVTcGxpdFsxXSwgdGhlbiB3ZSBoYXZlIHNwcml0ZXMuIElmIG5vdCwgdGhlbiBpdCdzIGp1c3Qgb25lIGZyYW1lIHBlciBpbWFnZVxuICAgICAgICBpZiAobGluZVNwbGl0WzFdKSB7XG4gICAgICAgICAgW3Jlc3VsdC54LCByZXN1bHQueSwgcmVzdWx0LncsIHJlc3VsdC5oXSA9IGxpbmVTcGxpdFsxXS5zcGxpdCgnLCcpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAocmVzdWx0LnRleHQpIHtcbiAgICAgIHByb2Nlc3NlZExpc3QucHVzaChyZXN1bHQpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHByb2Nlc3NlZExpc3Q7XG59O1xuXG4vKipcbiAqIFByZXZpZXcgdGh1bWJuYWlscyBmb3Igc2VlayBob3ZlciBhbmQgc2NydWJiaW5nXG4gKiBTZWVraW5nOiBIb3ZlciBvdmVyIHRoZSBzZWVrIGJhciAoZGVza3RvcCBvbmx5KTogc2hvd3MgYSBzbWFsbCBwcmV2aWV3IGNvbnRhaW5lciBhYm92ZSB0aGUgc2VlayBiYXJcbiAqIFNjcnViYmluZzogQ2xpY2sgYW5kIGRyYWcgdGhlIHNlZWsgYmFyIChkZXNrdG9wIGFuZCBtb2JpbGUpOiBzaG93cyB0aGUgcHJldmlldyBpbWFnZSBvdmVyIHRoZSBlbnRpcmUgdmlkZW8sIGFzIGlmIHRoZSB2aWRlbyBpcyBzY3J1YmJpbmcgYXQgdmVyeSBoaWdoIHNwZWVkXG4gKlxuICogTm90ZXM6XG4gKiAtIFRodW1icyBhcmUgc2V0IHZpYSBKUyBzZXR0aW5ncyBvbiBQbHlyIGluaXQsIG5vdCBIVE1MNSAndHJhY2snIHByb3BlcnR5LiBVc2luZyB0aGUgdHJhY2sgcHJvcGVydHkgd291bGQgYmUgYSBiaXQgZ3Jvc3MsIGJlY2F1c2UgaXQgZG9lc24ndCBzdXBwb3J0IGN1c3RvbSAna2luZHMnLiBraW5kPW1ldGFkYXRhIG1pZ2h0IGJlIHVzZWQgZm9yIHNvbWV0aGluZyBlbHNlLCBhbmQgd2Ugd2FudCB0byBhbGxvdyBtdWx0aXBsZSB0aHVtYm5haWxzIHRyYWNrcy4gVHJhY2tzIG11c3QgaGF2ZSBhIHVuaXF1ZSBjb21iaW5hdGlvbiBvZiAna2luZCcgYW5kICdsYWJlbCcuIFdlIHdvdWxkIGhhdmUgdG8gZG8gc29tZXRoaW5nIGxpa2Uga2luZD1tZXRhZGF0YSxsYWJlbD10aHVtYm5haWxzMSAvIGtpbmQ9bWV0YWRhdGEsbGFiZWw9dGh1bWJuYWlsczIuIFNxdWFyZSBwZWcsIHJvdW5kIGhvbGVcbiAqIC0gVlRUIGluZm86IHRoZSBpbWFnZSBVUkwgaXMgcmVsYXRpdmUgdG8gdGhlIFZUVCwgbm90IHRoZSBjdXJyZW50IGRvY3VtZW50LiBCdXQgaWYgdGhlIHVybCBzdGFydHMgd2l0aCBhIHNsYXNoLCBpdCB3aWxsIG5hdHVyYWxseSBiZSByZWxhdGl2ZSB0byB0aGUgY3VycmVudCBkb21haW4uIGh0dHBzOi8vc3VwcG9ydC5qd3BsYXllci5jb20vYXJ0aWNsZXMvaG93LXRvLWFkZC1wcmV2aWV3LXRodW1ibmFpbHNcbiAqIC0gVGhpcyBpbXBsZW1lbnRhdGlvbiB1c2VzIG11bHRpcGxlIHNlcGFyYXRlIGltZyBlbGVtZW50cy4gT3RoZXIgaW1wbGVtZW50YXRpb25zIHVzZSBiYWNrZ3JvdW5kLWltYWdlIG9uIG9uZSBlbGVtZW50LiBUaGlzIHdvdWxkIGJlIG5pY2UgYW5kIHNpbXBsZSwgYnV0IEZpcmVmb3ggYW5kIFNhZmFyaSBoYXZlIGZsaWNrZXJpbmcgaXNzdWVzIHdpdGggcmVwbGFjaW5nIGJhY2tncm91bmRzIG9mIGxhcmdlciBpbWFnZXMuIEl0IHNlZW1zIHRoYXQgWW91VHViZSBwZXJoYXBzIG9ubHkgYXZvaWRzIHRoaXMgYmVjYXVzZSB0aGV5IGRvbid0IGhhdmUgdGhlIG9wdGlvbiBmb3IgaGlnaC1yZXMgcHJldmlld3MgKGV2ZW4gdGhlIGZ1bGxzY3JlZW4gb25lcywgd2hlbiBtb3VzZWRvd24vc2Vla2luZykuIEltYWdlcyBhcHBlYXIgb3ZlciB0aGUgdG9wIG9mIGVhY2ggb3RoZXIsIGFuZCBwcmV2aW91cyBvbmVzIGFyZSBkaXNjYXJkZWQgb25jZSB0aGUgbmV3IG9uZXMgaGF2ZSBiZWVuIHJlbmRlcmVkXG4gKi9cblxuY29uc3QgZml0UmF0aW8gPSAocmF0aW8sIG91dGVyKSA9PiB7XG4gIGNvbnN0IHRhcmdldFJhdGlvID0gb3V0ZXIud2lkdGggLyBvdXRlci5oZWlnaHQ7XG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xuICBpZiAocmF0aW8gPiB0YXJnZXRSYXRpbykge1xuICAgIHJlc3VsdC53aWR0aCA9IG91dGVyLndpZHRoO1xuICAgIHJlc3VsdC5oZWlnaHQgPSAoMSAvIHJhdGlvKSAqIG91dGVyLndpZHRoO1xuICB9IGVsc2Uge1xuICAgIHJlc3VsdC5oZWlnaHQgPSBvdXRlci5oZWlnaHQ7XG4gICAgcmVzdWx0LndpZHRoID0gcmF0aW8gKiBvdXRlci5oZWlnaHQ7XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufTtcblxuY2xhc3MgUHJldmlld1RodW1ibmFpbHMge1xuICAvKipcbiAgICogUHJldmlld1RodW1ibmFpbHMgY29uc3RydWN0b3IuXG4gICAqIEBwYXJhbSB7UGx5cn0gcGxheWVyXG4gICAqIEByZXR1cm4ge1ByZXZpZXdUaHVtYm5haWxzfVxuICAgKi9cbiAgY29uc3RydWN0b3IocGxheWVyKSB7XG4gICAgdGhpcy5wbGF5ZXIgPSBwbGF5ZXI7XG4gICAgdGhpcy50aHVtYm5haWxzID0gW107XG4gICAgdGhpcy5sb2FkZWQgPSBmYWxzZTtcbiAgICB0aGlzLmxhc3RNb3VzZU1vdmVUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLm1vdXNlRG93biA9IGZhbHNlO1xuICAgIHRoaXMubG9hZGVkSW1hZ2VzID0gW107XG5cbiAgICB0aGlzLmVsZW1lbnRzID0ge1xuICAgICAgdGh1bWI6IHt9LFxuICAgICAgc2NydWJiaW5nOiB7fSxcbiAgICB9O1xuXG4gICAgdGhpcy5sb2FkKCk7XG4gIH1cblxuICBnZXQgZW5hYmxlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5wbGF5ZXIuaXNIVE1MNSAmJiB0aGlzLnBsYXllci5pc1ZpZGVvICYmIHRoaXMucGxheWVyLmNvbmZpZy5wcmV2aWV3VGh1bWJuYWlscy5lbmFibGVkO1xuICB9XG5cbiAgbG9hZCA9ICgpID0+IHtcbiAgICAvLyBUb2dnbGUgdGhlIHJlZ3VsYXIgc2VlayB0b29sdGlwXG4gICAgaWYgKHRoaXMucGxheWVyLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXApIHtcbiAgICAgIHRoaXMucGxheWVyLmVsZW1lbnRzLmRpc3BsYXkuc2Vla1Rvb2x0aXAuaGlkZGVuID0gdGhpcy5lbmFibGVkO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5lbmFibGVkKSByZXR1cm47XG5cbiAgICB0aGlzLmdldFRodW1ibmFpbHMoKS50aGVuKCgpID0+IHtcbiAgICAgIGlmICghdGhpcy5lbmFibGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gUmVuZGVyIERPTSBlbGVtZW50c1xuICAgICAgdGhpcy5yZW5kZXIoKTtcblxuICAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRodW1iIGNvbnRhaW5lciBzaXplIHdhcyBzcGVjaWZpZWQgbWFudWFsbHkgaW4gQ1NTXG4gICAgICB0aGlzLmRldGVybWluZUNvbnRhaW5lckF1dG9TaXppbmcoKTtcblxuICAgICAgdGhpcy5sb2FkZWQgPSB0cnVlO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIERvd25sb2FkIFZUVCBmaWxlcyBhbmQgcGFyc2UgdGhlbVxuICBnZXRUaHVtYm5haWxzID0gKCkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgY29uc3QgeyBzcmMgfSA9IHRoaXMucGxheWVyLmNvbmZpZy5wcmV2aWV3VGh1bWJuYWlscztcblxuICAgICAgaWYgKGlzLmVtcHR5KHNyYykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIHByZXZpZXdUaHVtYm5haWxzLnNyYyBjb25maWcgYXR0cmlidXRlJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFJlc29sdmUgcHJvbWlzZVxuICAgICAgY29uc3Qgc29ydEFuZFJlc29sdmUgPSAoKSA9PiB7XG4gICAgICAgIC8vIFNvcnQgc21hbGxlc3QgdG8gYmlnZ2VzdCAoZS5nLiwgWzEyMHAsIDQ4MHAsIDEwODBwXSlcbiAgICAgICAgdGhpcy50aHVtYm5haWxzLnNvcnQoKHgsIHkpID0+IHguaGVpZ2h0IC0geS5oZWlnaHQpO1xuXG4gICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZygnUHJldmlldyB0aHVtYm5haWxzJywgdGhpcy50aHVtYm5haWxzKTtcblxuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuXG4gICAgICAvLyBWaWEgY2FsbGJhY2soKVxuICAgICAgaWYgKGlzLmZ1bmN0aW9uKHNyYykpIHtcbiAgICAgICAgc3JjKCh0aHVtYm5haWxzKSA9PiB7XG4gICAgICAgICAgdGhpcy50aHVtYm5haWxzID0gdGh1bWJuYWlscztcbiAgICAgICAgICBzb3J0QW5kUmVzb2x2ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIC8vIFZUVCB1cmxzXG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gSWYgc3RyaW5nLCBjb252ZXJ0IGludG8gc2luZ2xlLWVsZW1lbnQgbGlzdFxuICAgICAgICBjb25zdCB1cmxzID0gaXMuc3RyaW5nKHNyYykgPyBbc3JjXSA6IHNyYztcbiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIGVhY2ggc3JjIFVSTC4gRG93bmxvYWQgYW5kIHByb2Nlc3MgdGhlIFZUVCBmaWxlLCBzdG9yaW5nIHRoZSByZXN1bHRpbmcgZGF0YSBpbiB0aGlzLnRodW1ibmFpbHNcbiAgICAgICAgY29uc3QgcHJvbWlzZXMgPSB1cmxzLm1hcCgodSkgPT4gdGhpcy5nZXRUaHVtYm5haWwodSkpO1xuICAgICAgICAvLyBSZXNvbHZlXG4gICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKHNvcnRBbmRSZXNvbHZlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICAvLyBQcm9jZXNzIGluZGl2aWR1YWwgVlRUIGZpbGVcbiAgZ2V0VGh1bWJuYWlsID0gKHVybCkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgZmV0Y2godXJsKS50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICBjb25zdCB0aHVtYm5haWwgPSB7XG4gICAgICAgICAgZnJhbWVzOiBwYXJzZVZ0dChyZXNwb25zZSksXG4gICAgICAgICAgaGVpZ2h0OiBudWxsLFxuICAgICAgICAgIHVybFByZWZpeDogJycsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gSWYgdGhlIFVSTHMgZG9uJ3Qgc3RhcnQgd2l0aCAnLycsIHRoZW4gd2UgbmVlZCB0byBzZXQgdGhlaXIgcmVsYXRpdmUgcGF0aCB0byBiZSB0aGUgbG9jYXRpb24gb2YgdGhlIFZUVCBmaWxlXG4gICAgICAgIC8vIElmIHRoZSBVUkxzIGRvIHN0YXJ0IHdpdGggJy8nLCB0aGVuIHRoZXkgb2J2aW91c2x5IGRvbid0IG5lZWQgYSBwcmVmaXgsIHNvIGl0IHdpbGwgcmVtYWluIGJsYW5rXG4gICAgICAgIC8vIElmIHRoZSB0aHVtYm5haWwgVVJMcyBzdGFydCB3aXRoIHdpdGggbm9uZSBvZiAnLycsICdodHRwOi8vJyBvciAnaHR0cHM6Ly8nLCB0aGVuIHdlIG5lZWQgdG8gc2V0IHRoZWlyIHJlbGF0aXZlIHBhdGggdG8gYmUgdGhlIGxvY2F0aW9uIG9mIHRoZSBWVFQgZmlsZVxuICAgICAgICBpZiAoXG4gICAgICAgICAgIXRodW1ibmFpbC5mcmFtZXNbMF0udGV4dC5zdGFydHNXaXRoKCcvJykgJiZcbiAgICAgICAgICAhdGh1bWJuYWlsLmZyYW1lc1swXS50ZXh0LnN0YXJ0c1dpdGgoJ2h0dHA6Ly8nKSAmJlxuICAgICAgICAgICF0aHVtYm5haWwuZnJhbWVzWzBdLnRleHQuc3RhcnRzV2l0aCgnaHR0cHM6Ly8nKVxuICAgICAgICApIHtcbiAgICAgICAgICB0aHVtYm5haWwudXJsUHJlZml4ID0gdXJsLnN1YnN0cmluZygwLCB1cmwubGFzdEluZGV4T2YoJy8nKSArIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRG93bmxvYWQgdGhlIGZpcnN0IGZyYW1lLCBzbyB0aGF0IHdlIGNhbiBkZXRlcm1pbmUvc2V0IHRoZSBoZWlnaHQgb2YgdGhpcyB0aHVtYm5haWxzRGVmXG4gICAgICAgIGNvbnN0IHRlbXBJbWFnZSA9IG5ldyBJbWFnZSgpO1xuXG4gICAgICAgIHRlbXBJbWFnZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgdGh1bWJuYWlsLmhlaWdodCA9IHRlbXBJbWFnZS5uYXR1cmFsSGVpZ2h0O1xuICAgICAgICAgIHRodW1ibmFpbC53aWR0aCA9IHRlbXBJbWFnZS5uYXR1cmFsV2lkdGg7XG5cbiAgICAgICAgICB0aGlzLnRodW1ibmFpbHMucHVzaCh0aHVtYm5haWwpO1xuXG4gICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRlbXBJbWFnZS5zcmMgPSB0aHVtYm5haWwudXJsUHJlZml4ICsgdGh1bWJuYWlsLmZyYW1lc1swXS50ZXh0O1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgc3RhcnRNb3ZlID0gKGV2ZW50KSA9PiB7XG4gICAgaWYgKCF0aGlzLmxvYWRlZCkgcmV0dXJuO1xuXG4gICAgaWYgKCFpcy5ldmVudChldmVudCkgfHwgIVsndG91Y2htb3ZlJywgJ21vdXNlbW92ZSddLmluY2x1ZGVzKGV2ZW50LnR5cGUpKSByZXR1cm47XG5cbiAgICAvLyBXYWl0IHVudGlsIG1lZGlhIGhhcyBhIGR1cmF0aW9uXG4gICAgaWYgKCF0aGlzLnBsYXllci5tZWRpYS5kdXJhdGlvbikgcmV0dXJuO1xuXG4gICAgaWYgKGV2ZW50LnR5cGUgPT09ICd0b3VjaG1vdmUnKSB7XG4gICAgICAvLyBDYWxjdWxhdGUgc2VlayBob3ZlciBwb3NpdGlvbiBhcyBhcHByb3ggdmlkZW8gc2Vjb25kc1xuICAgICAgdGhpcy5zZWVrVGltZSA9IHRoaXMucGxheWVyLm1lZGlhLmR1cmF0aW9uICogKHRoaXMucGxheWVyLmVsZW1lbnRzLmlucHV0cy5zZWVrLnZhbHVlIC8gMTAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQ2FsY3VsYXRlIHNlZWsgaG92ZXIgcG9zaXRpb24gYXMgYXBwcm94IHZpZGVvIHNlY29uZHNcbiAgICAgIGNvbnN0IGNsaWVudFJlY3QgPSB0aGlzLnBsYXllci5lbGVtZW50cy5wcm9ncmVzcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgIGNvbnN0IHBlcmNlbnRhZ2UgPSAoMTAwIC8gY2xpZW50UmVjdC53aWR0aCkgKiAoZXZlbnQucGFnZVggLSBjbGllbnRSZWN0LmxlZnQpO1xuICAgICAgdGhpcy5zZWVrVGltZSA9IHRoaXMucGxheWVyLm1lZGlhLmR1cmF0aW9uICogKHBlcmNlbnRhZ2UgLyAxMDApO1xuXG4gICAgICBpZiAodGhpcy5zZWVrVGltZSA8IDApIHtcbiAgICAgICAgLy8gVGhlIG1vdXNlbW92ZSBmaXJlcyBmb3IgMTArcHggb3V0IHRvIHRoZSBsZWZ0XG4gICAgICAgIHRoaXMuc2Vla1RpbWUgPSAwO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5zZWVrVGltZSA+IHRoaXMucGxheWVyLm1lZGlhLmR1cmF0aW9uIC0gMSkge1xuICAgICAgICAvLyBUb29rIDEgc2Vjb25kIG9mZiB0aGUgZHVyYXRpb24gZm9yIHNhZmV0eSwgYmVjYXVzZSBkaWZmZXJlbnQgcGxheWVycyBjYW4gZGlzYWdyZWUgb24gdGhlIHJlYWwgZHVyYXRpb24gb2YgYSB2aWRlb1xuICAgICAgICB0aGlzLnNlZWtUaW1lID0gdGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24gLSAxO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm1vdXNlUG9zWCA9IGV2ZW50LnBhZ2VYO1xuXG4gICAgICAvLyBTZXQgdGltZSB0ZXh0IGluc2lkZSBpbWFnZSBjb250YWluZXJcbiAgICAgIHRoaXMuZWxlbWVudHMudGh1bWIudGltZS5pbm5lclRleHQgPSBmb3JtYXRUaW1lKHRoaXMuc2Vla1RpbWUpO1xuXG4gICAgICAvLyBHZXQgbWFya2VyIHBvaW50IGZvciB0aW1lXG4gICAgICBjb25zdCBwb2ludCA9IHRoaXMucGxheWVyLmNvbmZpZy5tYXJrZXJzPy5wb2ludHM/LmZpbmQoKHsgdGltZTogdCB9KSA9PiB0ID09PSBNYXRoLnJvdW5kKHRoaXMuc2Vla1RpbWUpKTtcblxuICAgICAgLy8gQXBwZW5kIHRoZSBwb2ludCBsYWJlbCB0byB0aGUgdG9vbHRpcFxuICAgICAgaWYgKHBvaW50KSB7XG4gICAgICAgIC8vIHRoaXMuZWxlbWVudHMudGh1bWIudGltZS5pbm5lclRleHQuY29uY2F0KCdcXG4nKTtcbiAgICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi50aW1lLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIGAke3BvaW50LmxhYmVsfTxicj5gKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEb3dubG9hZCBhbmQgc2hvdyBpbWFnZVxuICAgIHRoaXMuc2hvd0ltYWdlQXRDdXJyZW50VGltZSgpO1xuICB9O1xuXG4gIGVuZE1vdmUgPSAoKSA9PiB7XG4gICAgdGhpcy50b2dnbGVUaHVtYkNvbnRhaW5lcihmYWxzZSwgdHJ1ZSk7XG4gIH07XG5cbiAgc3RhcnRTY3J1YmJpbmcgPSAoZXZlbnQpID0+IHtcbiAgICAvLyBPbmx5IGFjdCBvbiBsZWZ0IG1vdXNlIGJ1dHRvbiAoMCksIG9yIHRvdWNoIGRldmljZSAoZXZlbnQuYnV0dG9uIGRvZXMgbm90IGV4aXN0IG9yIGlzIGZhbHNlKVxuICAgIGlmIChpcy5udWxsT3JVbmRlZmluZWQoZXZlbnQuYnV0dG9uKSB8fCBldmVudC5idXR0b24gPT09IGZhbHNlIHx8IGV2ZW50LmJ1dHRvbiA9PT0gMCkge1xuICAgICAgdGhpcy5tb3VzZURvd24gPSB0cnVlO1xuXG4gICAgICAvLyBXYWl0IHVudGlsIG1lZGlhIGhhcyBhIGR1cmF0aW9uXG4gICAgICBpZiAodGhpcy5wbGF5ZXIubWVkaWEuZHVyYXRpb24pIHtcbiAgICAgICAgdGhpcy50b2dnbGVTY3J1YmJpbmdDb250YWluZXIodHJ1ZSk7XG4gICAgICAgIHRoaXMudG9nZ2xlVGh1bWJDb250YWluZXIoZmFsc2UsIHRydWUpO1xuXG4gICAgICAgIC8vIERvd25sb2FkIGFuZCBzaG93IGltYWdlXG4gICAgICAgIHRoaXMuc2hvd0ltYWdlQXRDdXJyZW50VGltZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBlbmRTY3J1YmJpbmcgPSAoKSA9PiB7XG4gICAgdGhpcy5tb3VzZURvd24gPSBmYWxzZTtcblxuICAgIC8vIEhpZGUgc2NydWJiaW5nIHByZXZpZXcuIEJ1dCB3YWl0IHVudGlsIHRoZSB2aWRlbyBoYXMgc3VjY2Vzc2Z1bGx5IHNlZWtlZCBiZWZvcmUgaGlkaW5nIHRoZSBzY3J1YmJpbmcgcHJldmlld1xuICAgIGlmIChNYXRoLmNlaWwodGhpcy5sYXN0VGltZSkgPT09IE1hdGguY2VpbCh0aGlzLnBsYXllci5tZWRpYS5jdXJyZW50VGltZSkpIHtcbiAgICAgIC8vIFRoZSB2aWRlbyB3YXMgYWxyZWFkeSBzZWVrZWQvbG9hZGVkIGF0IHRoZSBjaG9zZW4gdGltZSAtIGhpZGUgaW1tZWRpYXRlbHlcbiAgICAgIHRoaXMudG9nZ2xlU2NydWJiaW5nQ29udGFpbmVyKGZhbHNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVGhlIHZpZGVvIGhhc24ndCBzZWVrZWQgeWV0LiBXYWl0IGZvciB0aGF0XG4gICAgICBvbmNlLmNhbGwodGhpcy5wbGF5ZXIsIHRoaXMucGxheWVyLm1lZGlhLCAndGltZXVwZGF0ZScsICgpID0+IHtcbiAgICAgICAgLy8gUmUtY2hlY2sgbW91c2Vkb3duIC0gd2UgbWlnaHQgaGF2ZSBhbHJlYWR5IHN0YXJ0ZWQgc2NydWJiaW5nIGFnYWluXG4gICAgICAgIGlmICghdGhpcy5tb3VzZURvd24pIHtcbiAgICAgICAgICB0aGlzLnRvZ2dsZVNjcnViYmluZ0NvbnRhaW5lcihmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogU2V0dXAgaG9va3MgZm9yIFBseXIgYW5kIHdpbmRvdyBldmVudHNcbiAgICovXG4gIGxpc3RlbmVycyA9ICgpID0+IHtcbiAgICAvLyBIaWRlIHRodW1ibmFpbCBwcmV2aWV3IC0gb24gbW91c2UgY2xpY2ssIG1vdXNlIGxlYXZlIChpbiBsaXN0ZW5lcnMuanMgZm9yIG5vdyksIGFuZCB2aWRlbyBwbGF5L3NlZWsuIEFsbCBmb3VyIGFyZSByZXF1aXJlZCwgZS5nLiwgZm9yIGJ1ZmZlcmluZ1xuICAgIHRoaXMucGxheWVyLm9uKCdwbGF5JywgKCkgPT4ge1xuICAgICAgdGhpcy50b2dnbGVUaHVtYkNvbnRhaW5lcihmYWxzZSwgdHJ1ZSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnBsYXllci5vbignc2Vla2VkJywgKCkgPT4ge1xuICAgICAgdGhpcy50b2dnbGVUaHVtYkNvbnRhaW5lcihmYWxzZSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnBsYXllci5vbigndGltZXVwZGF0ZScsICgpID0+IHtcbiAgICAgIHRoaXMubGFzdFRpbWUgPSB0aGlzLnBsYXllci5tZWRpYS5jdXJyZW50VGltZTtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogQ3JlYXRlIEhUTUwgZWxlbWVudHMgZm9yIGltYWdlIGNvbnRhaW5lcnNcbiAgICovXG4gIHJlbmRlciA9ICgpID0+IHtcbiAgICAvLyBDcmVhdGUgSFRNTCBlbGVtZW50OiBwbHlyX19wcmV2aWV3LXRodW1ibmFpbC1jb250YWluZXJcbiAgICB0aGlzLmVsZW1lbnRzLnRodW1iLmNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHtcbiAgICAgIGNsYXNzOiB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5wcmV2aWV3VGh1bWJuYWlscy50aHVtYkNvbnRhaW5lcixcbiAgICB9KTtcblxuICAgIC8vIFdyYXBwZXIgZm9yIHRoZSBpbWFnZSBmb3Igc3R5bGluZ1xuICAgIHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICBjbGFzczogdGhpcy5wbGF5ZXIuY29uZmlnLmNsYXNzTmFtZXMucHJldmlld1RodW1ibmFpbHMuaW1hZ2VDb250YWluZXIsXG4gICAgfSk7XG4gICAgdGhpcy5lbGVtZW50cy50aHVtYi5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lcik7XG5cbiAgICAvLyBDcmVhdGUgSFRNTCBlbGVtZW50LCBwYXJlbnQrc3BhbjogdGltZSB0ZXh0IChlLmcuLCAwMTozMjowMClcbiAgICBjb25zdCB0aW1lQ29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLnByZXZpZXdUaHVtYm5haWxzLnRpbWVDb250YWluZXIsXG4gICAgfSk7XG5cbiAgICB0aGlzLmVsZW1lbnRzLnRodW1iLnRpbWUgPSBjcmVhdGVFbGVtZW50KCdzcGFuJywge30sICcwMDowMCcpO1xuICAgIHRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50cy50aHVtYi50aW1lKTtcblxuICAgIHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQodGltZUNvbnRhaW5lcik7XG5cbiAgICAvLyBJbmplY3QgdGhlIHdob2xlIHRodW1iXG4gICAgaWYgKGlzLmVsZW1lbnQodGhpcy5wbGF5ZXIuZWxlbWVudHMucHJvZ3Jlc3MpKSB7XG4gICAgICB0aGlzLnBsYXllci5lbGVtZW50cy5wcm9ncmVzcy5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnRzLnRodW1iLmNvbnRhaW5lcik7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIEhUTUwgZWxlbWVudDogcGx5cl9fcHJldmlldy1zY3J1YmJpbmctY29udGFpbmVyXG4gICAgdGhpcy5lbGVtZW50cy5zY3J1YmJpbmcuY29udGFpbmVyID0gY3JlYXRlRWxlbWVudCgnZGl2Jywge1xuICAgICAgY2xhc3M6IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLnByZXZpZXdUaHVtYm5haWxzLnNjcnViYmluZ0NvbnRhaW5lcixcbiAgICB9KTtcblxuICAgIHRoaXMucGxheWVyLmVsZW1lbnRzLndyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50cy5zY3J1YmJpbmcuY29udGFpbmVyKTtcbiAgfTtcblxuICBkZXN0cm95ID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLmVsZW1lbnRzLnRodW1iLmNvbnRhaW5lcikge1xuICAgICAgdGhpcy5lbGVtZW50cy50aHVtYi5jb250YWluZXIucmVtb3ZlKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIpIHtcbiAgICAgIHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lci5yZW1vdmUoKTtcbiAgICB9XG4gIH07XG5cbiAgc2hvd0ltYWdlQXRDdXJyZW50VGltZSA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5tb3VzZURvd24pIHtcbiAgICAgIHRoaXMuc2V0U2NydWJiaW5nQ29udGFpbmVyU2l6ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldFRodW1iQ29udGFpbmVyU2l6ZUFuZFBvcygpO1xuICAgIH1cblxuICAgIC8vIEZpbmQgdGhlIGRlc2lyZWQgdGh1bWJuYWlsIGluZGV4XG4gICAgLy8gVE9ETzogSGFuZGxlIGEgdmlkZW8gbG9uZ2VyIHRoYW4gdGhlIHRodW1icyB3aGVyZSB0aHVtYk51bSBpcyBudWxsXG4gICAgY29uc3QgdGh1bWJOdW0gPSB0aGlzLnRodW1ibmFpbHNbMF0uZnJhbWVzLmZpbmRJbmRleChcbiAgICAgIChmcmFtZSkgPT4gdGhpcy5zZWVrVGltZSA+PSBmcmFtZS5zdGFydFRpbWUgJiYgdGhpcy5zZWVrVGltZSA8PSBmcmFtZS5lbmRUaW1lLFxuICAgICk7XG4gICAgY29uc3QgaGFzVGh1bWIgPSB0aHVtYk51bSA+PSAwO1xuICAgIGxldCBxdWFsaXR5SW5kZXggPSAwO1xuXG4gICAgLy8gU2hvdyB0aGUgdGh1bWIgY29udGFpbmVyIGlmIHdlJ3JlIG5vdCBzY3J1YmJpbmdcbiAgICBpZiAoIXRoaXMubW91c2VEb3duKSB7XG4gICAgICB0aGlzLnRvZ2dsZVRodW1iQ29udGFpbmVyKGhhc1RodW1iKTtcbiAgICB9XG5cbiAgICAvLyBObyBtYXRjaGluZyB0aHVtYiBmb3VuZFxuICAgIGlmICghaGFzVGh1bWIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDaGVjayB0byBzZWUgaWYgd2UndmUgYWxyZWFkeSBkb3dubG9hZGVkIGhpZ2hlciBxdWFsaXR5IHZlcnNpb25zIG9mIHRoaXMgaW1hZ2VcbiAgICB0aGlzLnRodW1ibmFpbHMuZm9yRWFjaCgodGh1bWJuYWlsLCBpbmRleCkgPT4ge1xuICAgICAgaWYgKHRoaXMubG9hZGVkSW1hZ2VzLmluY2x1ZGVzKHRodW1ibmFpbC5mcmFtZXNbdGh1bWJOdW1dLnRleHQpKSB7XG4gICAgICAgIHF1YWxpdHlJbmRleCA9IGluZGV4O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gT25seSBwcm9jZWVkIGlmIGVpdGhlciB0aHVtYiBudW0gb3IgdGh1bWJmaWxlbmFtZSBoYXMgY2hhbmdlZFxuICAgIGlmICh0aHVtYk51bSAhPT0gdGhpcy5zaG93aW5nVGh1bWIpIHtcbiAgICAgIHRoaXMuc2hvd2luZ1RodW1iID0gdGh1bWJOdW07XG4gICAgICB0aGlzLmxvYWRJbWFnZShxdWFsaXR5SW5kZXgpO1xuICAgIH1cbiAgfTtcblxuICAvLyBTaG93IHRoZSBpbWFnZSB0aGF0J3MgY3VycmVudGx5IHNwZWNpZmllZCBpbiB0aGlzLnNob3dpbmdUaHVtYlxuICBsb2FkSW1hZ2UgPSAocXVhbGl0eUluZGV4ID0gMCkgPT4ge1xuICAgIGNvbnN0IHRodW1iTnVtID0gdGhpcy5zaG93aW5nVGh1bWI7XG4gICAgY29uc3QgdGh1bWJuYWlsID0gdGhpcy50aHVtYm5haWxzW3F1YWxpdHlJbmRleF07XG4gICAgY29uc3QgeyB1cmxQcmVmaXggfSA9IHRodW1ibmFpbDtcbiAgICBjb25zdCBmcmFtZSA9IHRodW1ibmFpbC5mcmFtZXNbdGh1bWJOdW1dO1xuICAgIGNvbnN0IHRodW1iRmlsZW5hbWUgPSB0aHVtYm5haWwuZnJhbWVzW3RodW1iTnVtXS50ZXh0O1xuICAgIGNvbnN0IHRodW1iVXJsID0gdXJsUHJlZml4ICsgdGh1bWJGaWxlbmFtZTtcblxuICAgIGlmICghdGhpcy5jdXJyZW50SW1hZ2VFbGVtZW50IHx8IHRoaXMuY3VycmVudEltYWdlRWxlbWVudC5kYXRhc2V0LmZpbGVuYW1lICE9PSB0aHVtYkZpbGVuYW1lKSB7XG4gICAgICAvLyBJZiB3ZSdyZSBhbHJlYWR5IGxvYWRpbmcgYSBwcmV2aW91cyBpbWFnZSwgcmVtb3ZlIGl0cyBvbmxvYWQgaGFuZGxlciAtIHdlIGRvbid0IHdhbnQgaXQgdG8gbG9hZCBhZnRlciB0aGlzIG9uZVxuICAgICAgLy8gT25seSBkbyB0aGlzIGlmIG5vdCB1c2luZyBzcHJpdGVzLiBXaXRob3V0IHNwcml0ZXMgd2UgcmVhbGx5IHdhbnQgdG8gc2hvdyBhcyBtYW55IGltYWdlcyBhcyBwb3NzaWJsZSwgYXMgYSBiZXN0LWVmZm9ydFxuICAgICAgaWYgKHRoaXMubG9hZGluZ0ltYWdlICYmIHRoaXMudXNpbmdTcHJpdGVzKSB7XG4gICAgICAgIHRoaXMubG9hZGluZ0ltYWdlLm9ubG9hZCA9IG51bGw7XG4gICAgICB9XG5cbiAgICAgIC8vIFdlJ3JlIGJ1aWxkaW5nIGFuZCBhZGRpbmcgYSBuZXcgaW1hZ2UuIEluIG90aGVyIGltcGxlbWVudGF0aW9ucyBvZiBzaW1pbGFyIGZ1bmN0aW9uYWxpdHkgKFlvdVR1YmUpLCBiYWNrZ3JvdW5kIGltYWdlXG4gICAgICAvLyBpcyBpbnN0ZWFkIHVzZWQuIEJ1dCB0aGlzIGNhdXNlcyBpc3N1ZXMgd2l0aCBsYXJnZXIgaW1hZ2VzIGluIEZpcmVmb3ggYW5kIFNhZmFyaSAtIHN3aXRjaGluZyBiZXR3ZWVuIGJhY2tncm91bmRcbiAgICAgIC8vIGltYWdlcyBjYXVzZXMgYSBmbGlja2VyLiBQdXR0aW5nIGEgbmV3IGltYWdlIG92ZXIgdGhlIHRvcCBkb2VzIG5vdFxuICAgICAgY29uc3QgcHJldmlld0ltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICBwcmV2aWV3SW1hZ2Uuc3JjID0gdGh1bWJVcmw7XG4gICAgICBwcmV2aWV3SW1hZ2UuZGF0YXNldC5pbmRleCA9IHRodW1iTnVtO1xuICAgICAgcHJldmlld0ltYWdlLmRhdGFzZXQuZmlsZW5hbWUgPSB0aHVtYkZpbGVuYW1lO1xuICAgICAgdGhpcy5zaG93aW5nVGh1bWJGaWxlbmFtZSA9IHRodW1iRmlsZW5hbWU7XG5cbiAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgTG9hZGluZyBpbWFnZTogJHt0aHVtYlVybH1gKTtcblxuICAgICAgLy8gRm9yIHNvbWUgcmVhc29uLCBwYXNzaW5nIHRoZSBuYW1lZCBmdW5jdGlvbiBkaXJlY3RseSBjYXVzZXMgaXQgdG8gZXhlY3V0ZSBpbW1lZGlhdGVseS4gU28gSSd2ZSB3cmFwcGVkIGl0IGluIGFuIGFub255bW91cyBmdW5jdGlvbi4uLlxuICAgICAgcHJldmlld0ltYWdlLm9ubG9hZCA9ICgpID0+IHRoaXMuc2hvd0ltYWdlKHByZXZpZXdJbWFnZSwgZnJhbWUsIHF1YWxpdHlJbmRleCwgdGh1bWJOdW0sIHRodW1iRmlsZW5hbWUsIHRydWUpO1xuICAgICAgdGhpcy5sb2FkaW5nSW1hZ2UgPSBwcmV2aWV3SW1hZ2U7XG4gICAgICB0aGlzLnJlbW92ZU9sZEltYWdlcyhwcmV2aWV3SW1hZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBVcGRhdGUgdGhlIGV4aXN0aW5nIGltYWdlXG4gICAgICB0aGlzLnNob3dJbWFnZSh0aGlzLmN1cnJlbnRJbWFnZUVsZW1lbnQsIGZyYW1lLCBxdWFsaXR5SW5kZXgsIHRodW1iTnVtLCB0aHVtYkZpbGVuYW1lLCBmYWxzZSk7XG4gICAgICB0aGlzLmN1cnJlbnRJbWFnZUVsZW1lbnQuZGF0YXNldC5pbmRleCA9IHRodW1iTnVtO1xuICAgICAgdGhpcy5yZW1vdmVPbGRJbWFnZXModGhpcy5jdXJyZW50SW1hZ2VFbGVtZW50KTtcbiAgICB9XG4gIH07XG5cbiAgc2hvd0ltYWdlID0gKHByZXZpZXdJbWFnZSwgZnJhbWUsIHF1YWxpdHlJbmRleCwgdGh1bWJOdW0sIHRodW1iRmlsZW5hbWUsIG5ld0ltYWdlID0gdHJ1ZSkgPT4ge1xuICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhcbiAgICAgIGBTaG93aW5nIHRodW1iOiAke3RodW1iRmlsZW5hbWV9LiBudW06ICR7dGh1bWJOdW19LiBxdWFsOiAke3F1YWxpdHlJbmRleH0uIG5ld2ltZzogJHtuZXdJbWFnZX1gLFxuICAgICk7XG4gICAgdGhpcy5zZXRJbWFnZVNpemVBbmRPZmZzZXQocHJldmlld0ltYWdlLCBmcmFtZSk7XG5cbiAgICBpZiAobmV3SW1hZ2UpIHtcbiAgICAgIHRoaXMuY3VycmVudEltYWdlQ29udGFpbmVyLmFwcGVuZENoaWxkKHByZXZpZXdJbWFnZSk7XG4gICAgICB0aGlzLmN1cnJlbnRJbWFnZUVsZW1lbnQgPSBwcmV2aWV3SW1hZ2U7XG5cbiAgICAgIGlmICghdGhpcy5sb2FkZWRJbWFnZXMuaW5jbHVkZXModGh1bWJGaWxlbmFtZSkpIHtcbiAgICAgICAgdGhpcy5sb2FkZWRJbWFnZXMucHVzaCh0aHVtYkZpbGVuYW1lKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBQcmVsb2FkIGltYWdlcyBiZWZvcmUgYW5kIGFmdGVyIHRoZSBjdXJyZW50IG9uZVxuICAgIC8vIFNob3cgaGlnaGVyIHF1YWxpdHkgb2YgdGhlIHNhbWUgZnJhbWVcbiAgICAvLyBFYWNoIHN0ZXAgaGVyZSBoYXMgYSBzaG9ydCB0aW1lIGRlbGF5LCBhbmQgb25seSBjb250aW51ZXMgaWYgc3RpbGwgaG92ZXJpbmcvc2Vla2luZyB0aGUgc2FtZSBzcG90LiBUaGlzIGlzIHRvIHByb3RlY3Qgc2xvdyBjb25uZWN0aW9ucyBmcm9tIG92ZXJsb2FkaW5nXG4gICAgdGhpcy5wcmVsb2FkTmVhcmJ5KHRodW1iTnVtLCB0cnVlKVxuICAgICAgLnRoZW4odGhpcy5wcmVsb2FkTmVhcmJ5KHRodW1iTnVtLCBmYWxzZSkpXG4gICAgICAudGhlbih0aGlzLmdldEhpZ2hlclF1YWxpdHkocXVhbGl0eUluZGV4LCBwcmV2aWV3SW1hZ2UsIGZyYW1lLCB0aHVtYkZpbGVuYW1lKSk7XG4gIH07XG5cbiAgLy8gUmVtb3ZlIGFsbCBwcmV2aWV3IGltYWdlcyB0aGF0IGFyZW4ndCB0aGUgZGVzaWduYXRlZCBjdXJyZW50IGltYWdlXG4gIHJlbW92ZU9sZEltYWdlcyA9IChjdXJyZW50SW1hZ2UpID0+IHtcbiAgICAvLyBHZXQgYSBsaXN0IG9mIGFsbCBpbWFnZXMsIGNvbnZlcnQgaXQgZnJvbSBhIERPTSBsaXN0IHRvIGFuIGFycmF5XG4gICAgQXJyYXkuZnJvbSh0aGlzLmN1cnJlbnRJbWFnZUNvbnRhaW5lci5jaGlsZHJlbikuZm9yRWFjaCgoaW1hZ2UpID0+IHtcbiAgICAgIGlmIChpbWFnZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT09ICdpbWcnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVtb3ZlRGVsYXkgPSB0aGlzLnVzaW5nU3ByaXRlcyA/IDUwMCA6IDEwMDA7XG5cbiAgICAgIGlmIChpbWFnZS5kYXRhc2V0LmluZGV4ICE9PSBjdXJyZW50SW1hZ2UuZGF0YXNldC5pbmRleCAmJiAhaW1hZ2UuZGF0YXNldC5kZWxldGluZykge1xuICAgICAgICAvLyBXYWl0IDIwMG1zLCBhcyB0aGUgbmV3IGltYWdlIGNhbiB0YWtlIHNvbWUgdGltZSB0byBzaG93IG9uIGNlcnRhaW4gYnJvd3NlcnMgKGV2ZW4gdGhvdWdoIGl0IHdhcyBkb3dubG9hZGVkIGJlZm9yZSBzaG93aW5nKS4gVGhpcyB3aWxsIHByZXZlbnQgZmxpY2tlciwgYW5kIHNob3cgc29tZSBnZW5lcm9zaXR5IHRvd2FyZHMgc2xvd2VyIGNsaWVudHNcbiAgICAgICAgLy8gRmlyc3Qgc2V0IGF0dHJpYnV0ZSAnZGVsZXRpbmcnIHRvIHByZXZlbnQgbXVsdGktaGFuZGxpbmcgb2YgdGhpcyBvbiByZXBlYXQgZmlyaW5nIG9mIHRoaXMgZnVuY3Rpb25cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgICAgIGltYWdlLmRhdGFzZXQuZGVsZXRpbmcgPSB0cnVlO1xuXG4gICAgICAgIC8vIFRoaXMgaGFzIHRvIGJlIHNldCBiZWZvcmUgdGhlIHRpbWVvdXQgLSB0byBwcmV2ZW50IGlzc3VlcyBzd2l0Y2hpbmcgYmV0d2VlbiBob3ZlciBhbmQgc2NydWJcbiAgICAgICAgY29uc3QgeyBjdXJyZW50SW1hZ2VDb250YWluZXIgfSA9IHRoaXM7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgY3VycmVudEltYWdlQ29udGFpbmVyLnJlbW92ZUNoaWxkKGltYWdlKTtcbiAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYFJlbW92aW5nIHRodW1iOiAke2ltYWdlLmRhdGFzZXQuZmlsZW5hbWV9YCk7XG4gICAgICAgIH0sIHJlbW92ZURlbGF5KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICAvLyBQcmVsb2FkIGltYWdlcyBiZWZvcmUgYW5kIGFmdGVyIHRoZSBjdXJyZW50IG9uZS4gT25seSBpZiB0aGUgdXNlciBpcyBzdGlsbCBob3ZlcmluZy9zZWVraW5nIHRoZSBzYW1lIGZyYW1lXG4gIC8vIFRoaXMgd2lsbCBvbmx5IHByZWxvYWQgdGhlIGxvd2VzdCBxdWFsaXR5XG4gIHByZWxvYWROZWFyYnkgPSAodGh1bWJOdW0sIGZvcndhcmQgPSB0cnVlKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29uc3Qgb2xkVGh1bWJGaWxlbmFtZSA9IHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXNbdGh1bWJOdW1dLnRleHQ7XG5cbiAgICAgICAgaWYgKHRoaXMuc2hvd2luZ1RodW1iRmlsZW5hbWUgPT09IG9sZFRodW1iRmlsZW5hbWUpIHtcbiAgICAgICAgICAvLyBGaW5kIHRoZSBuZWFyZXN0IHRodW1icyB3aXRoIGRpZmZlcmVudCBmaWxlbmFtZXMuIFNvbWV0aW1lcyBpdCdsbCBiZSB0aGUgbmV4dCBpbmRleCwgYnV0IGluIHRoZSBjYXNlIG9mIHNwcml0ZXMsIGl0IG1pZ2h0IGJlIDEwMCsgYXdheVxuICAgICAgICAgIGxldCB0aHVtYm5haWxzQ2xvbmU7XG4gICAgICAgICAgaWYgKGZvcndhcmQpIHtcbiAgICAgICAgICAgIHRodW1ibmFpbHNDbG9uZSA9IHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXMuc2xpY2UodGh1bWJOdW0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHVtYm5haWxzQ2xvbmUgPSB0aGlzLnRodW1ibmFpbHNbMF0uZnJhbWVzLnNsaWNlKDAsIHRodW1iTnVtKS5yZXZlcnNlKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbGV0IGZvdW5kT25lID0gZmFsc2U7XG5cbiAgICAgICAgICB0aHVtYm5haWxzQ2xvbmUuZm9yRWFjaCgoZnJhbWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld1RodW1iRmlsZW5hbWUgPSBmcmFtZS50ZXh0O1xuXG4gICAgICAgICAgICBpZiAobmV3VGh1bWJGaWxlbmFtZSAhPT0gb2xkVGh1bWJGaWxlbmFtZSkge1xuICAgICAgICAgICAgICAvLyBGb3VuZCBvbmUgd2l0aCBhIGRpZmZlcmVudCBmaWxlbmFtZS4gTWFrZSBzdXJlIGl0IGhhc24ndCBhbHJlYWR5IGJlZW4gbG9hZGVkIG9uIHRoaXMgcGFnZSB2aXNpdFxuICAgICAgICAgICAgICBpZiAoIXRoaXMubG9hZGVkSW1hZ2VzLmluY2x1ZGVzKG5ld1RodW1iRmlsZW5hbWUpKSB7XG4gICAgICAgICAgICAgICAgZm91bmRPbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLmRlYnVnLmxvZyhgUHJlbG9hZGluZyB0aHVtYiBmaWxlbmFtZTogJHtuZXdUaHVtYkZpbGVuYW1lfWApO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgeyB1cmxQcmVmaXggfSA9IHRoaXMudGh1bWJuYWlsc1swXTtcbiAgICAgICAgICAgICAgICBjb25zdCB0aHVtYlVSTCA9IHVybFByZWZpeCArIG5ld1RodW1iRmlsZW5hbWU7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJldmlld0ltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICAgICAgcHJldmlld0ltYWdlLnNyYyA9IHRodW1iVVJMO1xuICAgICAgICAgICAgICAgIHByZXZpZXdJbWFnZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5kZWJ1Zy5sb2coYFByZWxvYWRlZCB0aHVtYiBmaWxlbmFtZTogJHtuZXdUaHVtYkZpbGVuYW1lfWApO1xuICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmxvYWRlZEltYWdlcy5pbmNsdWRlcyhuZXdUaHVtYkZpbGVuYW1lKSkgdGhpcy5sb2FkZWRJbWFnZXMucHVzaChuZXdUaHVtYkZpbGVuYW1lKTtcblxuICAgICAgICAgICAgICAgICAgLy8gV2UgZG9uJ3QgcmVzb2x2ZSB1bnRpbCB0aGUgdGh1bWIgaXMgbG9hZGVkXG4gICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIG5vbmUgdG8gcHJlbG9hZCB0aGVuIHdlIHdhbnQgdG8gcmVzb2x2ZSBpbW1lZGlhdGVseVxuICAgICAgICAgIGlmICghZm91bmRPbmUpIHtcbiAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sIDMwMCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gSWYgdXNlciBoYXMgYmVlbiBob3ZlcmluZyBjdXJyZW50IGltYWdlIGZvciBoYWxmIGEgc2Vjb25kLCBsb29rIGZvciBhIGhpZ2hlciBxdWFsaXR5IG9uZVxuICBnZXRIaWdoZXJRdWFsaXR5ID0gKGN1cnJlbnRRdWFsaXR5SW5kZXgsIHByZXZpZXdJbWFnZSwgZnJhbWUsIHRodW1iRmlsZW5hbWUpID0+IHtcbiAgICBpZiAoY3VycmVudFF1YWxpdHlJbmRleCA8IHRoaXMudGh1bWJuYWlscy5sZW5ndGggLSAxKSB7XG4gICAgICAvLyBPbmx5IHVzZSB0aGUgaGlnaGVyIHF1YWxpdHkgdmVyc2lvbiBpZiBpdCdzIGdvaW5nIHRvIGxvb2sgYW55IGJldHRlciAtIGlmIHRoZSBjdXJyZW50IHRodW1iIGlzIG9mIGEgbG93ZXIgcGl4ZWwgZGVuc2l0eSB0aGFuIHRoZSB0aHVtYm5haWwgY29udGFpbmVyXG4gICAgICBsZXQgcHJldmlld0ltYWdlSGVpZ2h0ID0gcHJldmlld0ltYWdlLm5hdHVyYWxIZWlnaHQ7XG5cbiAgICAgIGlmICh0aGlzLnVzaW5nU3ByaXRlcykge1xuICAgICAgICBwcmV2aWV3SW1hZ2VIZWlnaHQgPSBmcmFtZS5oO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJldmlld0ltYWdlSGVpZ2h0IDwgdGhpcy50aHVtYkNvbnRhaW5lckhlaWdodCkge1xuICAgICAgICAvLyBSZWN1cnNlIGJhY2sgdG8gdGhlIGxvYWRJbWFnZSBmdW5jdGlvbiAtIHNob3cgYSBoaWdoZXIgcXVhbGl0eSBvbmUsIGJ1dCBvbmx5IGlmIHRoZSB2aWV3ZXIgaXMgb24gdGhpcyBmcmFtZSBmb3IgYSB3aGlsZVxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhlIG1vdXNlIGhhc24ndCBhbHJlYWR5IG1vdmVkIG9uIGFuZCBzdGFydGVkIGhvdmVyaW5nIGF0IGFub3RoZXIgaW1hZ2VcbiAgICAgICAgICBpZiAodGhpcy5zaG93aW5nVGh1bWJGaWxlbmFtZSA9PT0gdGh1bWJGaWxlbmFtZSkge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVidWcubG9nKGBTaG93aW5nIGhpZ2hlciBxdWFsaXR5IHRodW1iIGZvcjogJHt0aHVtYkZpbGVuYW1lfWApO1xuICAgICAgICAgICAgdGhpcy5sb2FkSW1hZ2UoY3VycmVudFF1YWxpdHlJbmRleCArIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgMzAwKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgZ2V0IGN1cnJlbnRJbWFnZUNvbnRhaW5lcigpIHtcbiAgICByZXR1cm4gdGhpcy5tb3VzZURvd24gPyB0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIgOiB0aGlzLmVsZW1lbnRzLnRodW1iLmltYWdlQ29udGFpbmVyO1xuICB9XG5cbiAgZ2V0IHVzaW5nU3ByaXRlcygpIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy50aHVtYm5haWxzWzBdLmZyYW1lc1swXSkuaW5jbHVkZXMoJ3cnKTtcbiAgfVxuXG4gIGdldCB0aHVtYkFzcGVjdFJhdGlvKCkge1xuICAgIGlmICh0aGlzLnVzaW5nU3ByaXRlcykge1xuICAgICAgcmV0dXJuIHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXNbMF0udyAvIHRoaXMudGh1bWJuYWlsc1swXS5mcmFtZXNbMF0uaDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy50aHVtYm5haWxzWzBdLndpZHRoIC8gdGhpcy50aHVtYm5haWxzWzBdLmhlaWdodDtcbiAgfVxuXG4gIGdldCB0aHVtYkNvbnRhaW5lckhlaWdodCgpIHtcbiAgICBpZiAodGhpcy5tb3VzZURvd24pIHtcbiAgICAgIGNvbnN0IHsgaGVpZ2h0IH0gPSBmaXRSYXRpbyh0aGlzLnRodW1iQXNwZWN0UmF0aW8sIHtcbiAgICAgICAgd2lkdGg6IHRoaXMucGxheWVyLm1lZGlhLmNsaWVudFdpZHRoLFxuICAgICAgICBoZWlnaHQ6IHRoaXMucGxheWVyLm1lZGlhLmNsaWVudEhlaWdodCxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGhlaWdodDtcbiAgICB9XG5cbiAgICAvLyBJZiBjc3MgaXMgdXNlZCB0aGlzIG5lZWRzIHRvIHJldHVybiB0aGUgY3NzIGhlaWdodCBmb3Igc3ByaXRlcyB0byB3b3JrIChzZWUgc2V0SW1hZ2VTaXplQW5kT2Zmc2V0KVxuICAgIGlmICh0aGlzLnNpemVTcGVjaWZpZWRJbkNTUykge1xuICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXIuY2xpZW50SGVpZ2h0O1xuICAgIH1cblxuICAgIHJldHVybiBNYXRoLmZsb29yKHRoaXMucGxheWVyLm1lZGlhLmNsaWVudFdpZHRoIC8gdGhpcy50aHVtYkFzcGVjdFJhdGlvIC8gNCk7XG4gIH1cblxuICBnZXQgY3VycmVudEltYWdlRWxlbWVudCgpIHtcbiAgICByZXR1cm4gdGhpcy5tb3VzZURvd24gPyB0aGlzLmN1cnJlbnRTY3J1YmJpbmdJbWFnZUVsZW1lbnQgOiB0aGlzLmN1cnJlbnRUaHVtYm5haWxJbWFnZUVsZW1lbnQ7XG4gIH1cblxuICBzZXQgY3VycmVudEltYWdlRWxlbWVudChlbGVtZW50KSB7XG4gICAgaWYgKHRoaXMubW91c2VEb3duKSB7XG4gICAgICB0aGlzLmN1cnJlbnRTY3J1YmJpbmdJbWFnZUVsZW1lbnQgPSBlbGVtZW50O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmN1cnJlbnRUaHVtYm5haWxJbWFnZUVsZW1lbnQgPSBlbGVtZW50O1xuICAgIH1cbiAgfVxuXG4gIHRvZ2dsZVRodW1iQ29udGFpbmVyID0gKHRvZ2dsZSA9IGZhbHNlLCBjbGVhclNob3dpbmcgPSBmYWxzZSkgPT4ge1xuICAgIGNvbnN0IGNsYXNzTmFtZSA9IHRoaXMucGxheWVyLmNvbmZpZy5jbGFzc05hbWVzLnByZXZpZXdUaHVtYm5haWxzLnRodW1iQ29udGFpbmVyU2hvd247XG4gICAgdGhpcy5lbGVtZW50cy50aHVtYi5jb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShjbGFzc05hbWUsIHRvZ2dsZSk7XG5cbiAgICBpZiAoIXRvZ2dsZSAmJiBjbGVhclNob3dpbmcpIHtcbiAgICAgIHRoaXMuc2hvd2luZ1RodW1iID0gbnVsbDtcbiAgICAgIHRoaXMuc2hvd2luZ1RodW1iRmlsZW5hbWUgPSBudWxsO1xuICAgIH1cbiAgfTtcblxuICB0b2dnbGVTY3J1YmJpbmdDb250YWluZXIgPSAodG9nZ2xlID0gZmFsc2UpID0+IHtcbiAgICBjb25zdCBjbGFzc05hbWUgPSB0aGlzLnBsYXllci5jb25maWcuY2xhc3NOYW1lcy5wcmV2aWV3VGh1bWJuYWlscy5zY3J1YmJpbmdDb250YWluZXJTaG93bjtcbiAgICB0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShjbGFzc05hbWUsIHRvZ2dsZSk7XG5cbiAgICBpZiAoIXRvZ2dsZSkge1xuICAgICAgdGhpcy5zaG93aW5nVGh1bWIgPSBudWxsO1xuICAgICAgdGhpcy5zaG93aW5nVGh1bWJGaWxlbmFtZSA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIGRldGVybWluZUNvbnRhaW5lckF1dG9TaXppbmcgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuZWxlbWVudHMudGh1bWIuaW1hZ2VDb250YWluZXIuY2xpZW50SGVpZ2h0ID4gMjAgfHwgdGhpcy5lbGVtZW50cy50aHVtYi5pbWFnZUNvbnRhaW5lci5jbGllbnRXaWR0aCA+IDIwKSB7XG4gICAgICAvLyBUaGlzIHdpbGwgcHJldmVudCBhdXRvIHNpemluZyBpbiB0aGlzLnNldFRodW1iQ29udGFpbmVyU2l6ZUFuZFBvcygpXG4gICAgICB0aGlzLnNpemVTcGVjaWZpZWRJbkNTUyA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIC8vIFNldCB0aGUgc2l6ZSB0byBiZSBhYm91dCBhIHF1YXJ0ZXIgb2YgdGhlIHNpemUgb2YgdmlkZW8uIFVubGVzcyBvcHRpb24gZHluYW1pY1NpemUgPT09IGZhbHNlLCBpbiB3aGljaCBjYXNlIGl0IG5lZWRzIHRvIGJlIHNldCBpbiBDU1NcbiAgc2V0VGh1bWJDb250YWluZXJTaXplQW5kUG9zID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgaW1hZ2VDb250YWluZXIgfSA9IHRoaXMuZWxlbWVudHMudGh1bWI7XG5cbiAgICBpZiAoIXRoaXMuc2l6ZVNwZWNpZmllZEluQ1NTKSB7XG4gICAgICBjb25zdCB0aHVtYldpZHRoID0gTWF0aC5mbG9vcih0aGlzLnRodW1iQ29udGFpbmVySGVpZ2h0ICogdGhpcy50aHVtYkFzcGVjdFJhdGlvKTtcbiAgICAgIGltYWdlQ29udGFpbmVyLnN0eWxlLmhlaWdodCA9IGAke3RoaXMudGh1bWJDb250YWluZXJIZWlnaHR9cHhgO1xuICAgICAgaW1hZ2VDb250YWluZXIuc3R5bGUud2lkdGggPSBgJHt0aHVtYldpZHRofXB4YDtcbiAgICB9IGVsc2UgaWYgKGltYWdlQ29udGFpbmVyLmNsaWVudEhlaWdodCA+IDIwICYmIGltYWdlQ29udGFpbmVyLmNsaWVudFdpZHRoIDwgMjApIHtcbiAgICAgIGNvbnN0IHRodW1iV2lkdGggPSBNYXRoLmZsb29yKGltYWdlQ29udGFpbmVyLmNsaWVudEhlaWdodCAqIHRoaXMudGh1bWJBc3BlY3RSYXRpbyk7XG4gICAgICBpbWFnZUNvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke3RodW1iV2lkdGh9cHhgO1xuICAgIH0gZWxzZSBpZiAoaW1hZ2VDb250YWluZXIuY2xpZW50SGVpZ2h0IDwgMjAgJiYgaW1hZ2VDb250YWluZXIuY2xpZW50V2lkdGggPiAyMCkge1xuICAgICAgY29uc3QgdGh1bWJIZWlnaHQgPSBNYXRoLmZsb29yKGltYWdlQ29udGFpbmVyLmNsaWVudFdpZHRoIC8gdGhpcy50aHVtYkFzcGVjdFJhdGlvKTtcbiAgICAgIGltYWdlQ29udGFpbmVyLnN0eWxlLmhlaWdodCA9IGAke3RodW1iSGVpZ2h0fXB4YDtcbiAgICB9XG5cbiAgICB0aGlzLnNldFRodW1iQ29udGFpbmVyUG9zKCk7XG4gIH07XG5cbiAgc2V0VGh1bWJDb250YWluZXJQb3MgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2NydWJiZXJSZWN0ID0gdGhpcy5wbGF5ZXIuZWxlbWVudHMucHJvZ3Jlc3MuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3QgY29udGFpbmVyUmVjdCA9IHRoaXMucGxheWVyLmVsZW1lbnRzLmNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCB7IGNvbnRhaW5lciB9ID0gdGhpcy5lbGVtZW50cy50aHVtYjtcbiAgICAvLyBGaW5kIHRoZSBsb3dlc3QgYW5kIGhpZ2hlc3QgZGVzaXJlZCBsZWZ0LXBvc2l0aW9uLCBzbyB3ZSBkb24ndCBzbGlkZSBvdXQgdGhlIHNpZGUgb2YgdGhlIHZpZGVvIGNvbnRhaW5lclxuICAgIGNvbnN0IG1pbiA9IGNvbnRhaW5lclJlY3QubGVmdCAtIHNjcnViYmVyUmVjdC5sZWZ0ICsgMTA7XG4gICAgY29uc3QgbWF4ID0gY29udGFpbmVyUmVjdC5yaWdodCAtIHNjcnViYmVyUmVjdC5sZWZ0IC0gY29udGFpbmVyLmNsaWVudFdpZHRoIC0gMTA7XG4gICAgLy8gU2V0IHByZXZpZXcgY29udGFpbmVyIHBvc2l0aW9uIHRvOiBtb3VzZXBvcywgbWludXMgc2Vla2Jhci5sZWZ0LCBtaW51cyBoYWxmIG9mIHByZXZpZXdDb250YWluZXIuY2xpZW50V2lkdGhcbiAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMubW91c2VQb3NYIC0gc2NydWJiZXJSZWN0LmxlZnQgLSBjb250YWluZXIuY2xpZW50V2lkdGggLyAyO1xuICAgIGNvbnN0IGNsYW1wZWQgPSBjbGFtcChwb3NpdGlvbiwgbWluLCBtYXgpO1xuXG4gICAgLy8gTW92ZSB0aGUgcG9wb3ZlciBwb3NpdGlvblxuICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gYCR7Y2xhbXBlZH1weGA7XG5cbiAgICAvLyBUaGUgYXJyb3cgY2FuIGZvbGxvdyB0aGUgY3Vyc29yXG4gICAgY29udGFpbmVyLnN0eWxlLnNldFByb3BlcnR5KCctLXByZXZpZXctYXJyb3ctb2Zmc2V0JywgYCR7cG9zaXRpb24gLSBjbGFtcGVkfXB4YCk7XG4gIH07XG5cbiAgLy8gQ2FuJ3QgdXNlIDEwMCUgd2lkdGgsIGluIGNhc2UgdGhlIHZpZGVvIGlzIGEgZGlmZmVyZW50IGFzcGVjdCByYXRpbyB0byB0aGUgdmlkZW8gY29udGFpbmVyXG4gIHNldFNjcnViYmluZ0NvbnRhaW5lclNpemUgPSAoKSA9PiB7XG4gICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBmaXRSYXRpbyh0aGlzLnRodW1iQXNwZWN0UmF0aW8sIHtcbiAgICAgIHdpZHRoOiB0aGlzLnBsYXllci5tZWRpYS5jbGllbnRXaWR0aCxcbiAgICAgIGhlaWdodDogdGhpcy5wbGF5ZXIubWVkaWEuY2xpZW50SGVpZ2h0LFxuICAgIH0pO1xuICAgIHRoaXMuZWxlbWVudHMuc2NydWJiaW5nLmNvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke3dpZHRofXB4YDtcbiAgICB0aGlzLmVsZW1lbnRzLnNjcnViYmluZy5jb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDtcbiAgfTtcblxuICAvLyBTcHJpdGVzIG5lZWQgdG8gYmUgb2Zmc2V0IHRvIHRoZSBjb3JyZWN0IGxvY2F0aW9uXG4gIHNldEltYWdlU2l6ZUFuZE9mZnNldCA9IChwcmV2aWV3SW1hZ2UsIGZyYW1lKSA9PiB7XG4gICAgaWYgKCF0aGlzLnVzaW5nU3ByaXRlcykgcmV0dXJuO1xuXG4gICAgLy8gRmluZCBkaWZmZXJlbmNlIGJldHdlZW4gaGVpZ2h0IGFuZCBwcmV2aWV3IGNvbnRhaW5lciBoZWlnaHRcbiAgICBjb25zdCBtdWx0aXBsaWVyID0gdGhpcy50aHVtYkNvbnRhaW5lckhlaWdodCAvIGZyYW1lLmg7XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICBwcmV2aWV3SW1hZ2Uuc3R5bGUuaGVpZ2h0ID0gYCR7cHJldmlld0ltYWdlLm5hdHVyYWxIZWlnaHQgKiBtdWx0aXBsaWVyfXB4YDtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGFyYW0tcmVhc3NpZ25cbiAgICBwcmV2aWV3SW1hZ2Uuc3R5bGUud2lkdGggPSBgJHtwcmV2aWV3SW1hZ2UubmF0dXJhbFdpZHRoICogbXVsdGlwbGllcn1weGA7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gICAgcHJldmlld0ltYWdlLnN0eWxlLmxlZnQgPSBgLSR7ZnJhbWUueCAqIG11bHRpcGxpZXJ9cHhgO1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgIHByZXZpZXdJbWFnZS5zdHlsZS50b3AgPSBgLSR7ZnJhbWUueSAqIG11bHRpcGxpZXJ9cHhgO1xuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBQcmV2aWV3VGh1bWJuYWlscztcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyIHNvdXJjZSB1cGRhdGVcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCB7IHByb3ZpZGVycyB9IGZyb20gJy4vY29uZmlnL3R5cGVzJztcbmltcG9ydCBodG1sNSBmcm9tICcuL2h0bWw1JztcbmltcG9ydCBtZWRpYSBmcm9tICcuL21lZGlhJztcbmltcG9ydCBQcmV2aWV3VGh1bWJuYWlscyBmcm9tICcuL3BsdWdpbnMvcHJldmlldy10aHVtYm5haWxzJztcbmltcG9ydCBzdXBwb3J0IGZyb20gJy4vc3VwcG9ydCc7XG5pbXBvcnQgdWkgZnJvbSAnLi91aSc7XG5pbXBvcnQgeyBjcmVhdGVFbGVtZW50LCBpbnNlcnRFbGVtZW50LCByZW1vdmVFbGVtZW50IH0gZnJvbSAnLi91dGlscy9lbGVtZW50cyc7XG5pbXBvcnQgaXMgZnJvbSAnLi91dGlscy9pcyc7XG5pbXBvcnQgeyBnZXREZWVwIH0gZnJvbSAnLi91dGlscy9vYmplY3RzJztcblxuY29uc3Qgc291cmNlID0ge1xuICAvLyBBZGQgZWxlbWVudHMgdG8gSFRNTDUgbWVkaWEgKHNvdXJjZSwgdHJhY2tzLCBldGMpXG4gIGluc2VydEVsZW1lbnRzKHR5cGUsIGF0dHJpYnV0ZXMpIHtcbiAgICBpZiAoaXMuc3RyaW5nKGF0dHJpYnV0ZXMpKSB7XG4gICAgICBpbnNlcnRFbGVtZW50KHR5cGUsIHRoaXMubWVkaWEsIHtcbiAgICAgICAgc3JjOiBhdHRyaWJ1dGVzLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChpcy5hcnJheShhdHRyaWJ1dGVzKSkge1xuICAgICAgYXR0cmlidXRlcy5mb3JFYWNoKChhdHRyaWJ1dGUpID0+IHtcbiAgICAgICAgaW5zZXJ0RWxlbWVudCh0eXBlLCB0aGlzLm1lZGlhLCBhdHRyaWJ1dGUpO1xuICAgICAgfSk7XG4gICAgfVxuICB9LFxuXG4gIC8vIFVwZGF0ZSBzb3VyY2VcbiAgLy8gU291cmNlcyBhcmUgbm90IGNoZWNrZWQgZm9yIHN1cHBvcnQgc28gYmUgY2FyZWZ1bFxuICBjaGFuZ2UoaW5wdXQpIHtcbiAgICBpZiAoIWdldERlZXAoaW5wdXQsICdzb3VyY2VzLmxlbmd0aCcpKSB7XG4gICAgICB0aGlzLmRlYnVnLndhcm4oJ0ludmFsaWQgc291cmNlIGZvcm1hdCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENhbmNlbCBjdXJyZW50IG5ldHdvcmsgcmVxdWVzdHNcbiAgICBodG1sNS5jYW5jZWxSZXF1ZXN0cy5jYWxsKHRoaXMpO1xuXG4gICAgLy8gRGVzdHJveSBpbnN0YW5jZSBhbmQgcmUtc2V0dXBcbiAgICB0aGlzLmRlc3Ryb3kuY2FsbChcbiAgICAgIHRoaXMsXG4gICAgICAoKSA9PiB7XG4gICAgICAgIC8vIFJlc2V0IHF1YWxpdHkgb3B0aW9uc1xuICAgICAgICB0aGlzLm9wdGlvbnMucXVhbGl0eSA9IFtdO1xuXG4gICAgICAgIC8vIFJlbW92ZSBlbGVtZW50c1xuICAgICAgICByZW1vdmVFbGVtZW50KHRoaXMubWVkaWEpO1xuICAgICAgICB0aGlzLm1lZGlhID0gbnVsbDtcblxuICAgICAgICAvLyBSZXNldCBjbGFzcyBuYW1lXG4gICAgICAgIGlmIChpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY29udGFpbmVyKSkge1xuICAgICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNldCB0aGUgdHlwZSBhbmQgcHJvdmlkZXJcbiAgICAgICAgY29uc3QgeyBzb3VyY2VzLCB0eXBlIH0gPSBpbnB1dDtcbiAgICAgICAgY29uc3QgW3sgcHJvdmlkZXIgPSBwcm92aWRlcnMuaHRtbDUsIHNyYyB9XSA9IHNvdXJjZXM7XG4gICAgICAgIGNvbnN0IHRhZ05hbWUgPSBwcm92aWRlciA9PT0gJ2h0bWw1JyA/IHR5cGUgOiAnZGl2JztcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHByb3ZpZGVyID09PSAnaHRtbDUnID8ge30gOiB7IHNyYyB9O1xuXG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywge1xuICAgICAgICAgIHByb3ZpZGVyLFxuICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgLy8gQ2hlY2sgZm9yIHN1cHBvcnRcbiAgICAgICAgICBzdXBwb3J0ZWQ6IHN1cHBvcnQuY2hlY2sodHlwZSwgcHJvdmlkZXIsIHRoaXMuY29uZmlnLnBsYXlzaW5saW5lKSxcbiAgICAgICAgICAvLyBDcmVhdGUgbmV3IGVsZW1lbnRcbiAgICAgICAgICBtZWRpYTogY3JlYXRlRWxlbWVudCh0YWdOYW1lLCBhdHRyaWJ1dGVzKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSW5qZWN0IHRoZSBuZXcgZWxlbWVudFxuICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLm1lZGlhKTtcblxuICAgICAgICAvLyBBdXRvcGxheSB0aGUgbmV3IHNvdXJjZT9cbiAgICAgICAgaWYgKGlzLmJvb2xlYW4oaW5wdXQuYXV0b3BsYXkpKSB7XG4gICAgICAgICAgdGhpcy5jb25maWcuYXV0b3BsYXkgPSBpbnB1dC5hdXRvcGxheTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNldCBhdHRyaWJ1dGVzIGZvciBhdWRpbyBhbmQgdmlkZW9cbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5jcm9zc29yaWdpbikge1xuICAgICAgICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ2Nyb3Nzb3JpZ2luJywgJycpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodGhpcy5jb25maWcuYXV0b3BsYXkpIHtcbiAgICAgICAgICAgIHRoaXMubWVkaWEuc2V0QXR0cmlidXRlKCdhdXRvcGxheScsICcnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFpcy5lbXB0eShpbnB1dC5wb3N0ZXIpKSB7XG4gICAgICAgICAgICB0aGlzLnBvc3RlciA9IGlucHV0LnBvc3RlcjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmxvb3AuYWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnbG9vcCcsICcnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLm11dGVkKSB7XG4gICAgICAgICAgICB0aGlzLm1lZGlhLnNldEF0dHJpYnV0ZSgnbXV0ZWQnLCAnJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5wbGF5c2lubGluZSkge1xuICAgICAgICAgICAgdGhpcy5tZWRpYS5zZXRBdHRyaWJ1dGUoJ3BsYXlzaW5saW5lJywgJycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlc3RvcmUgY2xhc3MgaG9va1xuICAgICAgICB1aS5hZGRTdHlsZUhvb2suY2FsbCh0aGlzKTtcblxuICAgICAgICAvLyBTZXQgbmV3IHNvdXJjZXMgZm9yIGh0bWw1XG4gICAgICAgIGlmICh0aGlzLmlzSFRNTDUpIHtcbiAgICAgICAgICBzb3VyY2UuaW5zZXJ0RWxlbWVudHMuY2FsbCh0aGlzLCAnc291cmNlJywgc291cmNlcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgdmlkZW8gdGl0bGVcbiAgICAgICAgdGhpcy5jb25maWcudGl0bGUgPSBpbnB1dC50aXRsZTtcblxuICAgICAgICAvLyBTZXQgdXAgZnJvbSBzY3JhdGNoXG4gICAgICAgIG1lZGlhLnNldHVwLmNhbGwodGhpcyk7XG5cbiAgICAgICAgLy8gSFRNTDUgc3R1ZmZcbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIC8vIFNldHVwIGNhcHRpb25zXG4gICAgICAgICAgaWYgKE9iamVjdC5rZXlzKGlucHV0KS5pbmNsdWRlcygndHJhY2tzJykpIHtcbiAgICAgICAgICAgIHNvdXJjZS5pbnNlcnRFbGVtZW50cy5jYWxsKHRoaXMsICd0cmFjaycsIGlucHV0LnRyYWNrcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgSFRNTDUgb3IgZW1iZWQgYnV0IG5vdCBmdWxseSBzdXBwb3J0ZWQsIHNldHVwSW50ZXJmYWNlIGFuZCBjYWxsIHJlYWR5IG5vd1xuICAgICAgICBpZiAodGhpcy5pc0hUTUw1IHx8ICh0aGlzLmlzRW1iZWQgJiYgIXRoaXMuc3VwcG9ydGVkLnVpKSkge1xuICAgICAgICAgIC8vIFNldHVwIGludGVyZmFjZVxuICAgICAgICAgIHVpLmJ1aWxkLmNhbGwodGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBMb2FkIEhUTUw1IHNvdXJjZXNcbiAgICAgICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgICAgIHRoaXMubWVkaWEubG9hZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBkYXRlIHByZXZpZXdUaHVtYm5haWxzIGNvbmZpZyAmIHJlbG9hZCBwbHVnaW5cbiAgICAgICAgaWYgKCFpcy5lbXB0eShpbnB1dC5wcmV2aWV3VGh1bWJuYWlscykpIHtcbiAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLCBpbnB1dC5wcmV2aWV3VGh1bWJuYWlscyk7XG5cbiAgICAgICAgICAvLyBDbGVhbnVwIHByZXZpZXdUaHVtYm5haWxzIHBsdWdpbiBpZiBpdCB3YXMgbG9hZGVkXG4gICAgICAgICAgaWYgKHRoaXMucHJldmlld1RodW1ibmFpbHMgJiYgdGhpcy5wcmV2aWV3VGh1bWJuYWlscy5sb2FkZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5wcmV2aWV3VGh1bWJuYWlscyA9IG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gQ3JlYXRlIG5ldyBpbnN0YW5jZSBpZiBpdCBpcyBzdGlsbCBlbmFibGVkXG4gICAgICAgICAgaWYgKHRoaXMuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMgPSBuZXcgUHJldmlld1RodW1ibmFpbHModGhpcyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBkYXRlIHRoZSBmdWxsc2NyZWVuIHN1cHBvcnRcbiAgICAgICAgdGhpcy5mdWxsc2NyZWVuLnVwZGF0ZSgpO1xuICAgICAgfSxcbiAgICAgIHRydWUsXG4gICAgKTtcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHNvdXJjZTtcbiIsIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQbHlyXG4vLyBwbHlyLmpzIHYzLjcuMlxuLy8gaHR0cHM6Ly9naXRodWIuY29tL3NhbXBvdHRzL3BseXJcbi8vIExpY2Vuc2U6IFRoZSBNSVQgTGljZW5zZSAoTUlUKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IGNhcHRpb25zIGZyb20gJy4vY2FwdGlvbnMnO1xuaW1wb3J0IGRlZmF1bHRzIGZyb20gJy4vY29uZmlnL2RlZmF1bHRzJztcbmltcG9ydCB7IHBpcCB9IGZyb20gJy4vY29uZmlnL3N0YXRlcyc7XG5pbXBvcnQgeyBnZXRQcm92aWRlckJ5VXJsLCBwcm92aWRlcnMsIHR5cGVzIH0gZnJvbSAnLi9jb25maWcvdHlwZXMnO1xuaW1wb3J0IENvbnNvbGUgZnJvbSAnLi9jb25zb2xlJztcbmltcG9ydCBjb250cm9scyBmcm9tICcuL2NvbnRyb2xzJztcbmltcG9ydCBGdWxsc2NyZWVuIGZyb20gJy4vZnVsbHNjcmVlbic7XG5pbXBvcnQgaHRtbDUgZnJvbSAnLi9odG1sNSc7XG5pbXBvcnQgTGlzdGVuZXJzIGZyb20gJy4vbGlzdGVuZXJzJztcbmltcG9ydCBtZWRpYSBmcm9tICcuL21lZGlhJztcbmltcG9ydCBBZHMgZnJvbSAnLi9wbHVnaW5zL2Fkcyc7XG5pbXBvcnQgUHJldmlld1RodW1ibmFpbHMgZnJvbSAnLi9wbHVnaW5zL3ByZXZpZXctdGh1bWJuYWlscyc7XG5pbXBvcnQgc291cmNlIGZyb20gJy4vc291cmNlJztcbmltcG9ydCBTdG9yYWdlIGZyb20gJy4vc3RvcmFnZSc7XG5pbXBvcnQgc3VwcG9ydCBmcm9tICcuL3N1cHBvcnQnO1xuaW1wb3J0IHVpIGZyb20gJy4vdWknO1xuaW1wb3J0IHsgY2xvc2VzdCB9IGZyb20gJy4vdXRpbHMvYXJyYXlzJztcbmltcG9ydCB7IGNyZWF0ZUVsZW1lbnQsIGhhc0NsYXNzLCByZW1vdmVFbGVtZW50LCByZXBsYWNlRWxlbWVudCwgdG9nZ2xlQ2xhc3MsIHdyYXAgfSBmcm9tICcuL3V0aWxzL2VsZW1lbnRzJztcbmltcG9ydCB7IG9mZiwgb24sIG9uY2UsIHRyaWdnZXJFdmVudCwgdW5iaW5kTGlzdGVuZXJzIH0gZnJvbSAnLi91dGlscy9ldmVudHMnO1xuaW1wb3J0IGlzIGZyb20gJy4vdXRpbHMvaXMnO1xuaW1wb3J0IGxvYWRTcHJpdGUgZnJvbSAnLi91dGlscy9sb2FkLXNwcml0ZSc7XG5pbXBvcnQgeyBjbGFtcCB9IGZyb20gJy4vdXRpbHMvbnVtYmVycyc7XG5pbXBvcnQgeyBjbG9uZURlZXAsIGV4dGVuZCB9IGZyb20gJy4vdXRpbHMvb2JqZWN0cyc7XG5pbXBvcnQgeyBzaWxlbmNlUHJvbWlzZSB9IGZyb20gJy4vdXRpbHMvcHJvbWlzZSc7XG5pbXBvcnQgeyBnZXRBc3BlY3RSYXRpbywgcmVkdWNlQXNwZWN0UmF0aW8sIHNldEFzcGVjdFJhdGlvLCB2YWxpZGF0ZUFzcGVjdFJhdGlvIH0gZnJvbSAnLi91dGlscy9zdHlsZSc7XG5pbXBvcnQgeyBwYXJzZVVybCB9IGZyb20gJy4vdXRpbHMvdXJscyc7XG5cbi8vIFByaXZhdGUgcHJvcGVydGllc1xuLy8gVE9ETzogVXNlIGEgV2Vha01hcCBmb3IgcHJpdmF0ZSBnbG9iYWxzXG4vLyBjb25zdCBnbG9iYWxzID0gbmV3IFdlYWtNYXAoKTtcblxuLy8gUGx5ciBpbnN0YW5jZVxuY2xhc3MgUGx5ciB7XG4gIGNvbnN0cnVjdG9yKHRhcmdldCwgb3B0aW9ucykge1xuICAgIHRoaXMudGltZXJzID0ge307XG5cbiAgICAvLyBTdGF0ZVxuICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmZhaWxlZCA9IGZhbHNlO1xuXG4gICAgLy8gVG91Y2ggZGV2aWNlXG4gICAgdGhpcy50b3VjaCA9IHN1cHBvcnQudG91Y2g7XG5cbiAgICAvLyBTZXQgdGhlIG1lZGlhIGVsZW1lbnRcbiAgICB0aGlzLm1lZGlhID0gdGFyZ2V0O1xuXG4gICAgLy8gU3RyaW5nIHNlbGVjdG9yIHBhc3NlZFxuICAgIGlmIChpcy5zdHJpbmcodGhpcy5tZWRpYSkpIHtcbiAgICAgIHRoaXMubWVkaWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMubWVkaWEpO1xuICAgIH1cblxuICAgIC8vIGpRdWVyeSwgTm9kZUxpc3Qgb3IgQXJyYXkgcGFzc2VkLCB1c2UgZmlyc3QgZWxlbWVudFxuICAgIGlmICgod2luZG93LmpRdWVyeSAmJiB0aGlzLm1lZGlhIGluc3RhbmNlb2YgalF1ZXJ5KSB8fCBpcy5ub2RlTGlzdCh0aGlzLm1lZGlhKSB8fCBpcy5hcnJheSh0aGlzLm1lZGlhKSkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICB0aGlzLm1lZGlhID0gdGhpcy5tZWRpYVswXTtcbiAgICB9XG5cbiAgICAvLyBTZXQgY29uZmlnXG4gICAgdGhpcy5jb25maWcgPSBleHRlbmQoXG4gICAgICB7fSxcbiAgICAgIGRlZmF1bHRzLFxuICAgICAgUGx5ci5kZWZhdWx0cyxcbiAgICAgIG9wdGlvbnMgfHwge30sXG4gICAgICAoKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRoaXMubWVkaWEuZ2V0QXR0cmlidXRlKCdkYXRhLXBseXItY29uZmlnJykpO1xuICAgICAgICB9IGNhdGNoIChfKSB7XG4gICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICB9XG4gICAgICB9KSgpLFxuICAgICk7XG5cbiAgICAvLyBFbGVtZW50cyBjYWNoZVxuICAgIHRoaXMuZWxlbWVudHMgPSB7XG4gICAgICBjb250YWluZXI6IG51bGwsXG4gICAgICBmdWxsc2NyZWVuOiBudWxsLFxuICAgICAgY2FwdGlvbnM6IG51bGwsXG4gICAgICBidXR0b25zOiB7fSxcbiAgICAgIGRpc3BsYXk6IHt9LFxuICAgICAgcHJvZ3Jlc3M6IHt9LFxuICAgICAgaW5wdXRzOiB7fSxcbiAgICAgIHNldHRpbmdzOiB7XG4gICAgICAgIHBvcHVwOiBudWxsLFxuICAgICAgICBtZW51OiBudWxsLFxuICAgICAgICBwYW5lbHM6IHt9LFxuICAgICAgICBidXR0b25zOiB7fSxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIC8vIENhcHRpb25zXG4gICAgdGhpcy5jYXB0aW9ucyA9IHtcbiAgICAgIGFjdGl2ZTogbnVsbCxcbiAgICAgIGN1cnJlbnRUcmFjazogLTEsXG4gICAgICBtZXRhOiBuZXcgV2Vha01hcCgpLFxuICAgIH07XG5cbiAgICAvLyBGdWxsc2NyZWVuXG4gICAgdGhpcy5mdWxsc2NyZWVuID0ge1xuICAgICAgYWN0aXZlOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgLy8gT3B0aW9uc1xuICAgIHRoaXMub3B0aW9ucyA9IHtcbiAgICAgIHNwZWVkOiBbXSxcbiAgICAgIHF1YWxpdHk6IFtdLFxuICAgIH07XG5cbiAgICAvLyBEZWJ1Z2dpbmdcbiAgICAvLyBUT0RPOiBtb3ZlIHRvIGdsb2JhbHNcbiAgICB0aGlzLmRlYnVnID0gbmV3IENvbnNvbGUodGhpcy5jb25maWcuZGVidWcpO1xuXG4gICAgLy8gTG9nIGNvbmZpZyBvcHRpb25zIGFuZCBzdXBwb3J0XG4gICAgdGhpcy5kZWJ1Zy5sb2coJ0NvbmZpZycsIHRoaXMuY29uZmlnKTtcbiAgICB0aGlzLmRlYnVnLmxvZygnU3VwcG9ydCcsIHN1cHBvcnQpO1xuXG4gICAgLy8gV2UgbmVlZCBhbiBlbGVtZW50IHRvIHNldHVwXG4gICAgaWYgKGlzLm51bGxPclVuZGVmaW5lZCh0aGlzLm1lZGlhKSB8fCAhaXMuZWxlbWVudCh0aGlzLm1lZGlhKSkge1xuICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiBubyBzdWl0YWJsZSBlbGVtZW50IHBhc3NlZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEJhaWwgaWYgdGhlIGVsZW1lbnQgaXMgaW5pdGlhbGl6ZWRcbiAgICBpZiAodGhpcy5tZWRpYS5wbHlyKSB7XG4gICAgICB0aGlzLmRlYnVnLndhcm4oJ1RhcmdldCBhbHJlYWR5IHNldHVwJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQmFpbCBpZiBub3QgZW5hYmxlZFxuICAgIGlmICghdGhpcy5jb25maWcuZW5hYmxlZCkge1xuICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiBkaXNhYmxlZCBieSBjb25maWcnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBCYWlsIGlmIGRpc2FibGVkIG9yIG5vIGJhc2ljIHN1cHBvcnRcbiAgICAvLyBZb3UgbWF5IHdhbnQgdG8gZGlzYWJsZSBjZXJ0YWluIFVBcyBldGNcbiAgICBpZiAoIXN1cHBvcnQuY2hlY2soKS5hcGkpIHtcbiAgICAgIHRoaXMuZGVidWcuZXJyb3IoJ1NldHVwIGZhaWxlZDogbm8gc3VwcG9ydCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIENhY2hlIG9yaWdpbmFsIGVsZW1lbnQgc3RhdGUgZm9yIC5kZXN0cm95KClcbiAgICBjb25zdCBjbG9uZSA9IHRoaXMubWVkaWEuY2xvbmVOb2RlKHRydWUpO1xuICAgIGNsb25lLmF1dG9wbGF5ID0gZmFsc2U7XG4gICAgdGhpcy5lbGVtZW50cy5vcmlnaW5hbCA9IGNsb25lO1xuXG4gICAgLy8gU2V0IG1lZGlhIHR5cGUgYmFzZWQgb24gdGFnIG9yIGRhdGEgYXR0cmlidXRlXG4gICAgLy8gU3VwcG9ydGVkOiB2aWRlbywgYXVkaW8sIHZpbWVvLCB5b3V0dWJlXG4gICAgY29uc3QgdHlwZSA9IHRoaXMubWVkaWEudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIC8vIEVtYmVkIHByb3BlcnRpZXNcbiAgICBsZXQgaWZyYW1lID0gbnVsbDtcbiAgICBsZXQgdXJsID0gbnVsbDtcblxuICAgIC8vIERpZmZlcmVudCBzZXR1cCBiYXNlZCBvbiB0eXBlXG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdkaXYnOlxuICAgICAgICAvLyBGaW5kIHRoZSBmcmFtZVxuICAgICAgICBpZnJhbWUgPSB0aGlzLm1lZGlhLnF1ZXJ5U2VsZWN0b3IoJ2lmcmFtZScpO1xuXG4gICAgICAgIC8vIDxpZnJhbWU+IHR5cGVcbiAgICAgICAgaWYgKGlzLmVsZW1lbnQoaWZyYW1lKSkge1xuICAgICAgICAgIC8vIERldGVjdCBwcm92aWRlclxuICAgICAgICAgIHVybCA9IHBhcnNlVXJsKGlmcmFtZS5nZXRBdHRyaWJ1dGUoJ3NyYycpKTtcbiAgICAgICAgICB0aGlzLnByb3ZpZGVyID0gZ2V0UHJvdmlkZXJCeVVybCh1cmwudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgICAvLyBSZXdvcmsgZWxlbWVudHNcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciA9IHRoaXMubWVkaWE7XG4gICAgICAgICAgdGhpcy5tZWRpYSA9IGlmcmFtZTtcblxuICAgICAgICAgIC8vIFJlc2V0IGNsYXNzbmFtZVxuICAgICAgICAgIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLmNsYXNzTmFtZSA9ICcnO1xuXG4gICAgICAgICAgLy8gR2V0IGF0dHJpYnV0ZXMgZnJvbSBVUkwgYW5kIHNldCBjb25maWdcbiAgICAgICAgICBpZiAodXJsLnNlYXJjaC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHRydXRoeSA9IFsnMScsICd0cnVlJ107XG5cbiAgICAgICAgICAgIGlmICh0cnV0aHkuaW5jbHVkZXModXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2F1dG9wbGF5JykpKSB7XG4gICAgICAgICAgICAgIHRoaXMuY29uZmlnLmF1dG9wbGF5ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0cnV0aHkuaW5jbHVkZXModXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2xvb3AnKSkpIHtcbiAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUT0RPOiByZXBsYWNlIGZ1bGxzY3JlZW4uaW9zTmF0aXZlIHdpdGggdGhpcyBwbGF5c2lubGluZSBjb25maWcgb3B0aW9uXG4gICAgICAgICAgICAvLyBZb3VUdWJlIHJlcXVpcmVzIHRoZSBwbGF5c2lubGluZSBpbiB0aGUgVVJMXG4gICAgICAgICAgICBpZiAodGhpcy5pc1lvdVR1YmUpIHtcbiAgICAgICAgICAgICAgdGhpcy5jb25maWcucGxheXNpbmxpbmUgPSB0cnV0aHkuaW5jbHVkZXModXJsLnNlYXJjaFBhcmFtcy5nZXQoJ3BsYXlzaW5saW5lJykpO1xuICAgICAgICAgICAgICB0aGlzLmNvbmZpZy55b3V0dWJlLmhsID0gdXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2hsJyk7IC8vIFRPRE86IFNob3VsZCB0aGlzIGJlIHNldHRpbmcgbGFuZ3VhZ2U/XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5wbGF5c2lubGluZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIDxkaXY+IHdpdGggYXR0cmlidXRlc1xuICAgICAgICAgIHRoaXMucHJvdmlkZXIgPSB0aGlzLm1lZGlhLmdldEF0dHJpYnV0ZSh0aGlzLmNvbmZpZy5hdHRyaWJ1dGVzLmVtYmVkLnByb3ZpZGVyKTtcblxuICAgICAgICAgIC8vIFJlbW92ZSBhdHRyaWJ1dGVcbiAgICAgICAgICB0aGlzLm1lZGlhLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmNvbmZpZy5hdHRyaWJ1dGVzLmVtYmVkLnByb3ZpZGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFVuc3VwcG9ydGVkIG9yIG1pc3NpbmcgcHJvdmlkZXJcbiAgICAgICAgaWYgKGlzLmVtcHR5KHRoaXMucHJvdmlkZXIpIHx8ICFPYmplY3QudmFsdWVzKHByb3ZpZGVycykuaW5jbHVkZXModGhpcy5wcm92aWRlcikpIHtcbiAgICAgICAgICB0aGlzLmRlYnVnLmVycm9yKCdTZXR1cCBmYWlsZWQ6IEludmFsaWQgcHJvdmlkZXInKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBdWRpbyB3aWxsIGNvbWUgbGF0ZXIgZm9yIGV4dGVybmFsIHByb3ZpZGVyc1xuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlcy52aWRlbztcblxuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAndmlkZW8nOlxuICAgICAgY2FzZSAnYXVkaW8nOlxuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLnByb3ZpZGVyID0gcHJvdmlkZXJzLmh0bWw1O1xuXG4gICAgICAgIC8vIEdldCBjb25maWcgZnJvbSBhdHRyaWJ1dGVzXG4gICAgICAgIGlmICh0aGlzLm1lZGlhLmhhc0F0dHJpYnV0ZSgnY3Jvc3NvcmlnaW4nKSkge1xuICAgICAgICAgIHRoaXMuY29uZmlnLmNyb3Nzb3JpZ2luID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tZWRpYS5oYXNBdHRyaWJ1dGUoJ2F1dG9wbGF5JykpIHtcbiAgICAgICAgICB0aGlzLmNvbmZpZy5hdXRvcGxheSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCdwbGF5c2lubGluZScpIHx8IHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCd3ZWJraXQtcGxheXNpbmxpbmUnKSkge1xuICAgICAgICAgIHRoaXMuY29uZmlnLnBsYXlzaW5saW5lID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5tZWRpYS5oYXNBdHRyaWJ1dGUoJ211dGVkJykpIHtcbiAgICAgICAgICB0aGlzLmNvbmZpZy5tdXRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWVkaWEuaGFzQXR0cmlidXRlKCdsb29wJykpIHtcbiAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBicmVhaztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiB1bnN1cHBvcnRlZCB0eXBlJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3Igc3VwcG9ydCBhZ2FpbiBidXQgd2l0aCB0eXBlXG4gICAgdGhpcy5zdXBwb3J0ZWQgPSBzdXBwb3J0LmNoZWNrKHRoaXMudHlwZSwgdGhpcy5wcm92aWRlciwgdGhpcy5jb25maWcucGxheXNpbmxpbmUpO1xuXG4gICAgLy8gSWYgbm8gc3VwcG9ydCBmb3IgZXZlbiBBUEksIGJhaWxcbiAgICBpZiAoIXRoaXMuc3VwcG9ydGVkLmFwaSkge1xuICAgICAgdGhpcy5kZWJ1Zy5lcnJvcignU2V0dXAgZmFpbGVkOiBubyBzdXBwb3J0Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5ldmVudExpc3RlbmVycyA9IFtdO1xuXG4gICAgLy8gQ3JlYXRlIGxpc3RlbmVyc1xuICAgIHRoaXMubGlzdGVuZXJzID0gbmV3IExpc3RlbmVycyh0aGlzKTtcblxuICAgIC8vIFNldHVwIGxvY2FsIHN0b3JhZ2UgZm9yIHVzZXIgc2V0dGluZ3NcbiAgICB0aGlzLnN0b3JhZ2UgPSBuZXcgU3RvcmFnZSh0aGlzKTtcblxuICAgIC8vIFN0b3JlIHJlZmVyZW5jZVxuICAgIHRoaXMubWVkaWEucGx5ciA9IHRoaXM7XG5cbiAgICAvLyBXcmFwIG1lZGlhXG4gICAgaWYgKCFpcy5lbGVtZW50KHRoaXMuZWxlbWVudHMuY29udGFpbmVyKSkge1xuICAgICAgdGhpcy5lbGVtZW50cy5jb250YWluZXIgPSBjcmVhdGVFbGVtZW50KCdkaXYnLCB7IHRhYmluZGV4OiAwIH0pO1xuICAgICAgd3JhcCh0aGlzLm1lZGlhLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcik7XG4gICAgfVxuXG4gICAgLy8gTWlncmF0ZSBjdXN0b20gcHJvcGVydGllcyBmcm9tIG1lZGlhIHRvIGNvbnRhaW5lciAoc28gdGhleSB3b3JrIPCfmIkpXG4gICAgdWkubWlncmF0ZVN0eWxlcy5jYWxsKHRoaXMpO1xuXG4gICAgLy8gQWRkIHN0eWxlIGhvb2tcbiAgICB1aS5hZGRTdHlsZUhvb2suY2FsbCh0aGlzKTtcblxuICAgIC8vIFNldHVwIG1lZGlhXG4gICAgbWVkaWEuc2V0dXAuY2FsbCh0aGlzKTtcblxuICAgIC8vIExpc3RlbiBmb3IgZXZlbnRzIGlmIGRlYnVnZ2luZ1xuICAgIGlmICh0aGlzLmNvbmZpZy5kZWJ1Zykge1xuICAgICAgb24uY2FsbCh0aGlzLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuZXZlbnRzLmpvaW4oJyAnKSwgKGV2ZW50KSA9PiB7XG4gICAgICAgIHRoaXMuZGVidWcubG9nKGBldmVudDogJHtldmVudC50eXBlfWApO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gU2V0dXAgZnVsbHNjcmVlblxuICAgIHRoaXMuZnVsbHNjcmVlbiA9IG5ldyBGdWxsc2NyZWVuKHRoaXMpO1xuXG4gICAgLy8gU2V0dXAgaW50ZXJmYWNlXG4gICAgLy8gSWYgZW1iZWQgYnV0IG5vdCBmdWxseSBzdXBwb3J0ZWQsIGJ1aWxkIGludGVyZmFjZSBub3cgdG8gYXZvaWQgZmxhc2ggb2YgY29udHJvbHNcbiAgICBpZiAodGhpcy5pc0hUTUw1IHx8ICh0aGlzLmlzRW1iZWQgJiYgIXRoaXMuc3VwcG9ydGVkLnVpKSkge1xuICAgICAgdWkuYnVpbGQuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBDb250YWluZXIgbGlzdGVuZXJzXG4gICAgdGhpcy5saXN0ZW5lcnMuY29udGFpbmVyKCk7XG5cbiAgICAvLyBHbG9iYWwgbGlzdGVuZXJzXG4gICAgdGhpcy5saXN0ZW5lcnMuZ2xvYmFsKCk7XG5cbiAgICAvLyBTZXR1cCBhZHMgaWYgcHJvdmlkZWRcbiAgICBpZiAodGhpcy5jb25maWcuYWRzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMuYWRzID0gbmV3IEFkcyh0aGlzKTtcbiAgICB9XG5cbiAgICAvLyBBdXRvcGxheSBpZiByZXF1aXJlZFxuICAgIGlmICh0aGlzLmlzSFRNTDUgJiYgdGhpcy5jb25maWcuYXV0b3BsYXkpIHtcbiAgICAgIHRoaXMub25jZSgnY2FucGxheScsICgpID0+IHNpbGVuY2VQcm9taXNlKHRoaXMucGxheSgpKSk7XG4gICAgfVxuXG4gICAgLy8gU2VlayB0aW1lIHdpbGwgYmUgcmVjb3JkZWQgKGluIGxpc3RlbmVycy5qcykgc28gd2UgY2FuIHByZXZlbnQgaGlkaW5nIGNvbnRyb2xzIGZvciBhIGZldyBzZWNvbmRzIGFmdGVyIHNlZWtcbiAgICB0aGlzLmxhc3RTZWVrVGltZSA9IDA7XG5cbiAgICAvLyBTZXR1cCBwcmV2aWV3IHRodW1ibmFpbHMgaWYgZW5hYmxlZFxuICAgIGlmICh0aGlzLmNvbmZpZy5wcmV2aWV3VGh1bWJuYWlscy5lbmFibGVkKSB7XG4gICAgICB0aGlzLnByZXZpZXdUaHVtYm5haWxzID0gbmV3IFByZXZpZXdUaHVtYm5haWxzKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBBUElcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLyoqXG4gICAqIFR5cGVzIGFuZCBwcm92aWRlciBoZWxwZXJzXG4gICAqL1xuICBnZXQgaXNIVE1MNSgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm92aWRlciA9PT0gcHJvdmlkZXJzLmh0bWw1O1xuICB9XG5cbiAgZ2V0IGlzRW1iZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNZb3VUdWJlIHx8IHRoaXMuaXNWaW1lbztcbiAgfVxuXG4gIGdldCBpc1lvdVR1YmUoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvdmlkZXIgPT09IHByb3ZpZGVycy55b3V0dWJlO1xuICB9XG5cbiAgZ2V0IGlzVmltZW8oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvdmlkZXIgPT09IHByb3ZpZGVycy52aW1lbztcbiAgfVxuXG4gIGdldCBpc1ZpZGVvKCkge1xuICAgIHJldHVybiB0aGlzLnR5cGUgPT09IHR5cGVzLnZpZGVvO1xuICB9XG5cbiAgZ2V0IGlzQXVkaW8oKSB7XG4gICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gdHlwZXMuYXVkaW87XG4gIH1cblxuICAvKipcbiAgICogUGxheSB0aGUgbWVkaWEsIG9yIHBsYXkgdGhlIGFkdmVydGlzZW1lbnQgKGlmIHRoZXkgYXJlIG5vdCBibG9ja2VkKVxuICAgKi9cbiAgcGxheSA9ICgpID0+IHtcbiAgICBpZiAoIWlzLmZ1bmN0aW9uKHRoaXMubWVkaWEucGxheSkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIEludGVjZXB0IHBsYXkgd2l0aCBhZHNcbiAgICBpZiAodGhpcy5hZHMgJiYgdGhpcy5hZHMuZW5hYmxlZCkge1xuICAgICAgdGhpcy5hZHMubWFuYWdlclByb21pc2UudGhlbigoKSA9PiB0aGlzLmFkcy5wbGF5KCkpLmNhdGNoKCgpID0+IHNpbGVuY2VQcm9taXNlKHRoaXMubWVkaWEucGxheSgpKSk7XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHRoZSBwcm9taXNlIChmb3IgSFRNTDUpXG4gICAgcmV0dXJuIHRoaXMubWVkaWEucGxheSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXVzZSB0aGUgbWVkaWFcbiAgICovXG4gIHBhdXNlID0gKCkgPT4ge1xuICAgIGlmICghdGhpcy5wbGF5aW5nIHx8ICFpcy5mdW5jdGlvbih0aGlzLm1lZGlhLnBhdXNlKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMubWVkaWEucGF1c2UoKTtcbiAgfTtcblxuICAvKipcbiAgICogR2V0IHBsYXlpbmcgc3RhdGVcbiAgICovXG4gIGdldCBwbGF5aW5nKCkge1xuICAgIHJldHVybiBCb29sZWFuKHRoaXMucmVhZHkgJiYgIXRoaXMucGF1c2VkICYmICF0aGlzLmVuZGVkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcGF1c2VkIHN0YXRlXG4gICAqL1xuICBnZXQgcGF1c2VkKCkge1xuICAgIHJldHVybiBCb29sZWFuKHRoaXMubWVkaWEucGF1c2VkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3RvcHBlZCBzdGF0ZVxuICAgKi9cbiAgZ2V0IHN0b3BwZWQoKSB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy5wYXVzZWQgJiYgdGhpcy5jdXJyZW50VGltZSA9PT0gMCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGVuZGVkIHN0YXRlXG4gICAqL1xuICBnZXQgZW5kZWQoKSB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy5tZWRpYS5lbmRlZCk7XG4gIH1cblxuICAvKipcbiAgICogVG9nZ2xlIHBsYXliYWNrIGJhc2VkIG9uIGN1cnJlbnQgc3RhdHVzXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaW5wdXRcbiAgICovXG4gIHRvZ2dsZVBsYXkgPSAoaW5wdXQpID0+IHtcbiAgICAvLyBUb2dnbGUgYmFzZWQgb24gY3VycmVudCBzdGF0ZSBpZiBub3RoaW5nIHBhc3NlZFxuICAgIGNvbnN0IHRvZ2dsZSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiAhdGhpcy5wbGF5aW5nO1xuXG4gICAgaWYgKHRvZ2dsZSkge1xuICAgICAgcmV0dXJuIHRoaXMucGxheSgpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnBhdXNlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFN0b3AgcGxheWJhY2tcbiAgICovXG4gIHN0b3AgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuaXNIVE1MNSkge1xuICAgICAgdGhpcy5wYXVzZSgpO1xuICAgICAgdGhpcy5yZXN0YXJ0KCk7XG4gICAgfSBlbHNlIGlmIChpcy5mdW5jdGlvbih0aGlzLm1lZGlhLnN0b3ApKSB7XG4gICAgICB0aGlzLm1lZGlhLnN0b3AoKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlc3RhcnQgcGxheWJhY2tcbiAgICovXG4gIHJlc3RhcnQgPSAoKSA9PiB7XG4gICAgdGhpcy5jdXJyZW50VGltZSA9IDA7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJld2luZFxuICAgKiBAcGFyYW0ge051bWJlcn0gc2Vla1RpbWUgLSBob3cgZmFyIHRvIHJld2luZCBpbiBzZWNvbmRzLiBEZWZhdWx0cyB0byB0aGUgY29uZmlnLnNlZWtUaW1lXG4gICAqL1xuICByZXdpbmQgPSAoc2Vla1RpbWUpID0+IHtcbiAgICB0aGlzLmN1cnJlbnRUaW1lIC09IGlzLm51bWJlcihzZWVrVGltZSkgPyBzZWVrVGltZSA6IHRoaXMuY29uZmlnLnNlZWtUaW1lO1xuICB9O1xuXG4gIC8qKlxuICAgKiBGYXN0IGZvcndhcmRcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHNlZWtUaW1lIC0gaG93IGZhciB0byBmYXN0IGZvcndhcmQgaW4gc2Vjb25kcy4gRGVmYXVsdHMgdG8gdGhlIGNvbmZpZy5zZWVrVGltZVxuICAgKi9cbiAgZm9yd2FyZCA9IChzZWVrVGltZSkgPT4ge1xuICAgIHRoaXMuY3VycmVudFRpbWUgKz0gaXMubnVtYmVyKHNlZWtUaW1lKSA/IHNlZWtUaW1lIDogdGhpcy5jb25maWcuc2Vla1RpbWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNlZWsgdG8gYSB0aW1lXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBpbnB1dCAtIHdoZXJlIHRvIHNlZWsgdG8gaW4gc2Vjb25kcy4gRGVmYXVsdHMgdG8gMCAodGhlIHN0YXJ0KVxuICAgKi9cbiAgc2V0IGN1cnJlbnRUaW1lKGlucHV0KSB7XG4gICAgLy8gQmFpbCBpZiBtZWRpYSBkdXJhdGlvbiBpc24ndCBhdmFpbGFibGUgeWV0XG4gICAgaWYgKCF0aGlzLmR1cmF0aW9uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgaW5wdXRcbiAgICBjb25zdCBpbnB1dElzVmFsaWQgPSBpcy5udW1iZXIoaW5wdXQpICYmIGlucHV0ID4gMDtcblxuICAgIC8vIFNldFxuICAgIHRoaXMubWVkaWEuY3VycmVudFRpbWUgPSBpbnB1dElzVmFsaWQgPyBNYXRoLm1pbihpbnB1dCwgdGhpcy5kdXJhdGlvbikgOiAwO1xuXG4gICAgLy8gTG9nZ2luZ1xuICAgIHRoaXMuZGVidWcubG9nKGBTZWVraW5nIHRvICR7dGhpcy5jdXJyZW50VGltZX0gc2Vjb25kc2ApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjdXJyZW50IHRpbWVcbiAgICovXG4gIGdldCBjdXJyZW50VGltZSgpIHtcbiAgICByZXR1cm4gTnVtYmVyKHRoaXMubWVkaWEuY3VycmVudFRpbWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBidWZmZXJlZFxuICAgKi9cbiAgZ2V0IGJ1ZmZlcmVkKCkge1xuICAgIGNvbnN0IHsgYnVmZmVyZWQgfSA9IHRoaXMubWVkaWE7XG5cbiAgICAvLyBZb3VUdWJlIC8gVmltZW8gcmV0dXJuIGEgZmxvYXQgYmV0d2VlbiAwLTFcbiAgICBpZiAoaXMubnVtYmVyKGJ1ZmZlcmVkKSkge1xuICAgICAgcmV0dXJuIGJ1ZmZlcmVkO1xuICAgIH1cblxuICAgIC8vIEhUTUw1XG4gICAgLy8gVE9ETzogSGFuZGxlIGJ1ZmZlcmVkIGNodW5rcyBvZiB0aGUgbWVkaWFcbiAgICAvLyAoaS5lLiBzZWVrIHRvIGFub3RoZXIgc2VjdGlvbiBidWZmZXJzIG9ubHkgdGhhdCBzZWN0aW9uKVxuICAgIGlmIChidWZmZXJlZCAmJiBidWZmZXJlZC5sZW5ndGggJiYgdGhpcy5kdXJhdGlvbiA+IDApIHtcbiAgICAgIHJldHVybiBidWZmZXJlZC5lbmQoMCkgLyB0aGlzLmR1cmF0aW9uO1xuICAgIH1cblxuICAgIHJldHVybiAwO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzZWVraW5nIHN0YXR1c1xuICAgKi9cbiAgZ2V0IHNlZWtpbmcoKSB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy5tZWRpYS5zZWVraW5nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGR1cmF0aW9uIG9mIHRoZSBjdXJyZW50IG1lZGlhXG4gICAqL1xuICBnZXQgZHVyYXRpb24oKSB7XG4gICAgLy8gRmF1eCBkdXJhdGlvbiBzZXQgdmlhIGNvbmZpZ1xuICAgIGNvbnN0IGZhdXhEdXJhdGlvbiA9IHBhcnNlRmxvYXQodGhpcy5jb25maWcuZHVyYXRpb24pO1xuICAgIC8vIE1lZGlhIGR1cmF0aW9uIGNhbiBiZSBOYU4gb3IgSW5maW5pdHkgYmVmb3JlIHRoZSBtZWRpYSBoYXMgbG9hZGVkXG4gICAgY29uc3QgcmVhbER1cmF0aW9uID0gKHRoaXMubWVkaWEgfHwge30pLmR1cmF0aW9uO1xuICAgIGNvbnN0IGR1cmF0aW9uID0gIWlzLm51bWJlcihyZWFsRHVyYXRpb24pIHx8IHJlYWxEdXJhdGlvbiA9PT0gSW5maW5pdHkgPyAwIDogcmVhbER1cmF0aW9uO1xuXG4gICAgLy8gSWYgY29uZmlnIGR1cmF0aW9uIGlzIGZ1bmt5LCB1c2UgcmVndWxhciBkdXJhdGlvblxuICAgIHJldHVybiBmYXV4RHVyYXRpb24gfHwgZHVyYXRpb247XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSBwbGF5ZXIgdm9sdW1lXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB2YWx1ZSAtIG11c3QgYmUgYmV0d2VlbiAwIGFuZCAxLiBEZWZhdWx0cyB0byB0aGUgdmFsdWUgZnJvbSBsb2NhbCBzdG9yYWdlIGFuZCBjb25maWcudm9sdW1lIGlmIG5vdCBzZXQgaW4gc3RvcmFnZVxuICAgKi9cbiAgc2V0IHZvbHVtZSh2YWx1ZSkge1xuICAgIGxldCB2b2x1bWUgPSB2YWx1ZTtcbiAgICBjb25zdCBtYXggPSAxO1xuICAgIGNvbnN0IG1pbiA9IDA7XG5cbiAgICBpZiAoaXMuc3RyaW5nKHZvbHVtZSkpIHtcbiAgICAgIHZvbHVtZSA9IE51bWJlcih2b2x1bWUpO1xuICAgIH1cblxuICAgIC8vIExvYWQgdm9sdW1lIGZyb20gc3RvcmFnZSBpZiBubyB2YWx1ZSBzcGVjaWZpZWRcbiAgICBpZiAoIWlzLm51bWJlcih2b2x1bWUpKSB7XG4gICAgICB2b2x1bWUgPSB0aGlzLnN0b3JhZ2UuZ2V0KCd2b2x1bWUnKTtcbiAgICB9XG5cbiAgICAvLyBVc2UgY29uZmlnIGlmIGFsbCBlbHNlIGZhaWxzXG4gICAgaWYgKCFpcy5udW1iZXIodm9sdW1lKSkge1xuICAgICAgKHsgdm9sdW1lIH0gPSB0aGlzLmNvbmZpZyk7XG4gICAgfVxuXG4gICAgLy8gTWF4aW11bSBpcyB2b2x1bWVNYXhcbiAgICBpZiAodm9sdW1lID4gbWF4KSB7XG4gICAgICB2b2x1bWUgPSBtYXg7XG4gICAgfVxuICAgIC8vIE1pbmltdW0gaXMgdm9sdW1lTWluXG4gICAgaWYgKHZvbHVtZSA8IG1pbikge1xuICAgICAgdm9sdW1lID0gbWluO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb25maWdcbiAgICB0aGlzLmNvbmZpZy52b2x1bWUgPSB2b2x1bWU7XG5cbiAgICAvLyBTZXQgdGhlIHBsYXllciB2b2x1bWVcbiAgICB0aGlzLm1lZGlhLnZvbHVtZSA9IHZvbHVtZTtcblxuICAgIC8vIElmIG11dGVkLCBhbmQgd2UncmUgaW5jcmVhc2luZyB2b2x1bWUgbWFudWFsbHksIHJlc2V0IG11dGVkIHN0YXRlXG4gICAgaWYgKCFpcy5lbXB0eSh2YWx1ZSkgJiYgdGhpcy5tdXRlZCAmJiB2b2x1bWUgPiAwKSB7XG4gICAgICB0aGlzLm11dGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY3VycmVudCBwbGF5ZXIgdm9sdW1lXG4gICAqL1xuICBnZXQgdm9sdW1lKCkge1xuICAgIHJldHVybiBOdW1iZXIodGhpcy5tZWRpYS52b2x1bWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluY3JlYXNlIHZvbHVtZVxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IHN0ZXAgLSBIb3cgbXVjaCB0byBkZWNyZWFzZSBieSAoYmV0d2VlbiAwIGFuZCAxKVxuICAgKi9cbiAgaW5jcmVhc2VWb2x1bWUgPSAoc3RlcCkgPT4ge1xuICAgIGNvbnN0IHZvbHVtZSA9IHRoaXMubWVkaWEubXV0ZWQgPyAwIDogdGhpcy52b2x1bWU7XG4gICAgdGhpcy52b2x1bWUgPSB2b2x1bWUgKyAoaXMubnVtYmVyKHN0ZXApID8gc3RlcCA6IDApO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEZWNyZWFzZSB2b2x1bWVcbiAgICogQHBhcmFtIHtCb29sZWFufSBzdGVwIC0gSG93IG11Y2ggdG8gZGVjcmVhc2UgYnkgKGJldHdlZW4gMCBhbmQgMSlcbiAgICovXG4gIGRlY3JlYXNlVm9sdW1lID0gKHN0ZXApID0+IHtcbiAgICB0aGlzLmluY3JlYXNlVm9sdW1lKC1zdGVwKTtcbiAgfTtcblxuICAvKipcbiAgICogU2V0IG11dGVkIHN0YXRlXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gbXV0ZVxuICAgKi9cbiAgc2V0IG11dGVkKG11dGUpIHtcbiAgICBsZXQgdG9nZ2xlID0gbXV0ZTtcblxuICAgIC8vIExvYWQgbXV0ZWQgc3RhdGUgZnJvbSBzdG9yYWdlXG4gICAgaWYgKCFpcy5ib29sZWFuKHRvZ2dsZSkpIHtcbiAgICAgIHRvZ2dsZSA9IHRoaXMuc3RvcmFnZS5nZXQoJ211dGVkJyk7XG4gICAgfVxuXG4gICAgLy8gVXNlIGNvbmZpZyBpZiBhbGwgZWxzZSBmYWlsc1xuICAgIGlmICghaXMuYm9vbGVhbih0b2dnbGUpKSB7XG4gICAgICB0b2dnbGUgPSB0aGlzLmNvbmZpZy5tdXRlZDtcbiAgICB9XG5cbiAgICAvLyBVcGRhdGUgY29uZmlnXG4gICAgdGhpcy5jb25maWcubXV0ZWQgPSB0b2dnbGU7XG5cbiAgICAvLyBTZXQgbXV0ZSBvbiB0aGUgcGxheWVyXG4gICAgdGhpcy5tZWRpYS5tdXRlZCA9IHRvZ2dsZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBtdXRlZCBzdGF0ZVxuICAgKi9cbiAgZ2V0IG11dGVkKCkge1xuICAgIHJldHVybiBCb29sZWFuKHRoaXMubWVkaWEubXV0ZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHRoZSBtZWRpYSBoYXMgYXVkaW9cbiAgICovXG4gIGdldCBoYXNBdWRpbygpIHtcbiAgICAvLyBBc3N1bWUgeWVzIGZvciBhbGwgbm9uIEhUTUw1IChhcyB3ZSBjYW4ndCB0ZWxsLi4uKVxuICAgIGlmICghdGhpcy5pc0hUTUw1KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc0F1ZGlvKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBHZXQgYXVkaW8gdHJhY2tzXG4gICAgcmV0dXJuIChcbiAgICAgIEJvb2xlYW4odGhpcy5tZWRpYS5tb3pIYXNBdWRpbykgfHxcbiAgICAgIEJvb2xlYW4odGhpcy5tZWRpYS53ZWJraXRBdWRpb0RlY29kZWRCeXRlQ291bnQpIHx8XG4gICAgICBCb29sZWFuKHRoaXMubWVkaWEuYXVkaW9UcmFja3MgJiYgdGhpcy5tZWRpYS5hdWRpb1RyYWNrcy5sZW5ndGgpXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgcGxheWJhY2sgc3BlZWRcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0IC0gdGhlIHNwZWVkIG9mIHBsYXliYWNrICgwLjUtMi4wKVxuICAgKi9cbiAgc2V0IHNwZWVkKGlucHV0KSB7XG4gICAgbGV0IHNwZWVkID0gbnVsbDtcblxuICAgIGlmIChpcy5udW1iZXIoaW5wdXQpKSB7XG4gICAgICBzcGVlZCA9IGlucHV0O1xuICAgIH1cblxuICAgIGlmICghaXMubnVtYmVyKHNwZWVkKSkge1xuICAgICAgc3BlZWQgPSB0aGlzLnN0b3JhZ2UuZ2V0KCdzcGVlZCcpO1xuICAgIH1cblxuICAgIGlmICghaXMubnVtYmVyKHNwZWVkKSkge1xuICAgICAgc3BlZWQgPSB0aGlzLmNvbmZpZy5zcGVlZC5zZWxlY3RlZDtcbiAgICB9XG5cbiAgICAvLyBDbGFtcCB0byBtaW4vbWF4XG4gICAgY29uc3QgeyBtaW5pbXVtU3BlZWQ6IG1pbiwgbWF4aW11bVNwZWVkOiBtYXggfSA9IHRoaXM7XG4gICAgc3BlZWQgPSBjbGFtcChzcGVlZCwgbWluLCBtYXgpO1xuXG4gICAgLy8gVXBkYXRlIGNvbmZpZ1xuICAgIHRoaXMuY29uZmlnLnNwZWVkLnNlbGVjdGVkID0gc3BlZWQ7XG5cbiAgICAvLyBTZXQgbWVkaWEgc3BlZWRcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGlmICh0aGlzLm1lZGlhKSB7XG4gICAgICAgIHRoaXMubWVkaWEucGxheWJhY2tSYXRlID0gc3BlZWQ7XG4gICAgICB9XG4gICAgfSwgMCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgcGxheWJhY2sgc3BlZWRcbiAgICovXG4gIGdldCBzcGVlZCgpIHtcbiAgICByZXR1cm4gTnVtYmVyKHRoaXMubWVkaWEucGxheWJhY2tSYXRlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIG1pbmltdW0gYWxsb3dlZCBzcGVlZFxuICAgKi9cbiAgZ2V0IG1pbmltdW1TcGVlZCgpIHtcbiAgICBpZiAodGhpcy5pc1lvdVR1YmUpIHtcbiAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3lvdXR1YmUvaWZyYW1lX2FwaV9yZWZlcmVuY2Ujc2V0UGxheWJhY2tSYXRlXG4gICAgICByZXR1cm4gTWF0aC5taW4oLi4udGhpcy5vcHRpb25zLnNwZWVkKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc1ZpbWVvKSB7XG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdmltZW8vcGxheWVyLmpzLyNzZXRwbGF5YmFja3JhdGVwbGF5YmFja3JhdGUtbnVtYmVyLXByb21pc2VudW1iZXItcmFuZ2VlcnJvcmVycm9yXG4gICAgICByZXR1cm4gMC41O1xuICAgIH1cblxuICAgIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zMjMyMDAyMC8xMTkxMzE5XG4gICAgcmV0dXJuIDAuMDYyNTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIG1heGltdW0gYWxsb3dlZCBzcGVlZFxuICAgKi9cbiAgZ2V0IG1heGltdW1TcGVlZCgpIHtcbiAgICBpZiAodGhpcy5pc1lvdVR1YmUpIHtcbiAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3lvdXR1YmUvaWZyYW1lX2FwaV9yZWZlcmVuY2Ujc2V0UGxheWJhY2tSYXRlXG4gICAgICByZXR1cm4gTWF0aC5tYXgoLi4udGhpcy5vcHRpb25zLnNwZWVkKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc1ZpbWVvKSB7XG4gICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vdmltZW8vcGxheWVyLmpzLyNzZXRwbGF5YmFja3JhdGVwbGF5YmFja3JhdGUtbnVtYmVyLXByb21pc2VudW1iZXItcmFuZ2VlcnJvcmVycm9yXG4gICAgICByZXR1cm4gMjtcbiAgICB9XG5cbiAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzIzMjAwMjAvMTE5MTMxOVxuICAgIHJldHVybiAxNjtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgcGxheWJhY2sgcXVhbGl0eVxuICAgKiBDdXJyZW50bHkgSFRNTDUgJiBZb3VUdWJlIG9ubHlcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0IC0gUXVhbGl0eSBsZXZlbFxuICAgKi9cbiAgc2V0IHF1YWxpdHkoaW5wdXQpIHtcbiAgICBjb25zdCBjb25maWcgPSB0aGlzLmNvbmZpZy5xdWFsaXR5O1xuICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMucXVhbGl0eTtcblxuICAgIGlmICghb3B0aW9ucy5sZW5ndGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgcXVhbGl0eSA9IFtcbiAgICAgICFpcy5lbXB0eShpbnB1dCkgJiYgTnVtYmVyKGlucHV0KSxcbiAgICAgIHRoaXMuc3RvcmFnZS5nZXQoJ3F1YWxpdHknKSxcbiAgICAgIGNvbmZpZy5zZWxlY3RlZCxcbiAgICAgIGNvbmZpZy5kZWZhdWx0LFxuICAgIF0uZmluZChpcy5udW1iZXIpO1xuXG4gICAgbGV0IHVwZGF0ZVN0b3JhZ2UgPSB0cnVlO1xuXG4gICAgaWYgKCFvcHRpb25zLmluY2x1ZGVzKHF1YWxpdHkpKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGNsb3Nlc3Qob3B0aW9ucywgcXVhbGl0eSk7XG4gICAgICB0aGlzLmRlYnVnLndhcm4oYFVuc3VwcG9ydGVkIHF1YWxpdHkgb3B0aW9uOiAke3F1YWxpdHl9LCB1c2luZyAke3ZhbHVlfSBpbnN0ZWFkYCk7XG4gICAgICBxdWFsaXR5ID0gdmFsdWU7XG5cbiAgICAgIC8vIERvbid0IHVwZGF0ZSBzdG9yYWdlIGlmIHF1YWxpdHkgaXMgbm90IHN1cHBvcnRlZFxuICAgICAgdXBkYXRlU3RvcmFnZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjb25maWdcbiAgICBjb25maWcuc2VsZWN0ZWQgPSBxdWFsaXR5O1xuXG4gICAgLy8gU2V0IHF1YWxpdHlcbiAgICB0aGlzLm1lZGlhLnF1YWxpdHkgPSBxdWFsaXR5O1xuXG4gICAgLy8gU2F2ZSB0byBzdG9yYWdlXG4gICAgaWYgKHVwZGF0ZVN0b3JhZ2UpIHtcbiAgICAgIHRoaXMuc3RvcmFnZS5zZXQoeyBxdWFsaXR5IH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBxdWFsaXR5IGxldmVsXG4gICAqL1xuICBnZXQgcXVhbGl0eSgpIHtcbiAgICByZXR1cm4gdGhpcy5tZWRpYS5xdWFsaXR5O1xuICB9XG5cbiAgLyoqXG4gICAqIFRvZ2dsZSBsb29wXG4gICAqIFRPRE86IEZpbmlzaCBmYW5jeSBuZXcgbG9naWMuIFNldCB0aGUgaW5kaWNhdG9yIG9uIGxvYWQgYXMgdXNlciBtYXkgcGFzcyBsb29wIGFzIGNvbmZpZ1xuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlucHV0IC0gV2hldGhlciB0byBsb29wIG9yIG5vdFxuICAgKi9cbiAgc2V0IGxvb3AoaW5wdXQpIHtcbiAgICBjb25zdCB0b2dnbGUgPSBpcy5ib29sZWFuKGlucHV0KSA/IGlucHV0IDogdGhpcy5jb25maWcubG9vcC5hY3RpdmU7XG4gICAgdGhpcy5jb25maWcubG9vcC5hY3RpdmUgPSB0b2dnbGU7XG4gICAgdGhpcy5tZWRpYS5sb29wID0gdG9nZ2xlO1xuXG4gICAgLy8gU2V0IGRlZmF1bHQgdG8gYmUgYSB0cnVlIHRvZ2dsZVxuICAgIC8qIGNvbnN0IHR5cGUgPSBbJ3N0YXJ0JywgJ2VuZCcsICdhbGwnLCAnbm9uZScsICd0b2dnbGUnXS5pbmNsdWRlcyhpbnB1dCkgPyBpbnB1dCA6ICd0b2dnbGUnO1xuXG4gICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgY2FzZSAnc3RhcnQnOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5sb29wLmVuZCAmJiB0aGlzLmNvbmZpZy5sb29wLmVuZCA8PSB0aGlzLmN1cnJlbnRUaW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5zdGFydCA9IHRoaXMuY3VycmVudFRpbWU7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5jb25maWcubG9vcC5pbmRpY2F0b3Iuc3RhcnQgPSB0aGlzLmVsZW1lbnRzLmRpc3BsYXkucGxheWVkLnZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID49IHRoaXMuY3VycmVudFRpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gdGhpcy5jdXJyZW50VGltZTtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLmNvbmZpZy5sb29wLmluZGljYXRvci5lbmQgPSB0aGlzLmVsZW1lbnRzLmRpc3BsYXkucGxheWVkLnZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdhbGwnOlxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3Auc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gdGhpcy5kdXJhdGlvbiAtIDI7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5pbmRpY2F0b3Iuc3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuaW5kaWNhdG9yLmVuZCA9IDEwMDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAndG9nZ2xlJzpcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb25maWcubG9vcC5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5zdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmxvb3AuZW5kID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5sb29wLnN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSB0aGlzLmR1cmF0aW9uIC0gMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5zdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcubG9vcC5lbmQgPSBudWxsO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9ICovXG4gIH1cblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgbG9vcCBzdGF0ZVxuICAgKi9cbiAgZ2V0IGxvb3AoKSB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy5tZWRpYS5sb29wKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgbmV3IG1lZGlhIHNvdXJjZVxuICAgKiBAcGFyYW0ge09iamVjdH0gaW5wdXQgLSBUaGUgbmV3IHNvdXJjZSBvYmplY3QgKHNlZSBkb2NzKVxuICAgKi9cbiAgc2V0IHNvdXJjZShpbnB1dCkge1xuICAgIHNvdXJjZS5jaGFuZ2UuY2FsbCh0aGlzLCBpbnB1dCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGN1cnJlbnQgc291cmNlXG4gICAqL1xuICBnZXQgc291cmNlKCkge1xuICAgIHJldHVybiB0aGlzLm1lZGlhLmN1cnJlbnRTcmM7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgZG93bmxvYWQgVVJMIChlaXRoZXIgc291cmNlIG9yIGN1c3RvbSlcbiAgICovXG4gIGdldCBkb3dubG9hZCgpIHtcbiAgICBjb25zdCB7IGRvd25sb2FkIH0gPSB0aGlzLmNvbmZpZy51cmxzO1xuXG4gICAgcmV0dXJuIGlzLnVybChkb3dubG9hZCkgPyBkb3dubG9hZCA6IHRoaXMuc291cmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgZG93bmxvYWQgVVJMXG4gICAqL1xuICBzZXQgZG93bmxvYWQoaW5wdXQpIHtcbiAgICBpZiAoIWlzLnVybChpbnB1dCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmNvbmZpZy51cmxzLmRvd25sb2FkID0gaW5wdXQ7XG5cbiAgICBjb250cm9scy5zZXREb3dubG9hZFVybC5jYWxsKHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgcG9zdGVyIGltYWdlIGZvciBhIHZpZGVvXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCAtIHRoZSBVUkwgZm9yIHRoZSBuZXcgcG9zdGVyIGltYWdlXG4gICAqL1xuICBzZXQgcG9zdGVyKGlucHV0KSB7XG4gICAgaWYgKCF0aGlzLmlzVmlkZW8pIHtcbiAgICAgIHRoaXMuZGVidWcud2FybignUG9zdGVyIGNhbiBvbmx5IGJlIHNldCBmb3IgdmlkZW8nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB1aS5zZXRQb3N0ZXIuY2FsbCh0aGlzLCBpbnB1dCwgZmFsc2UpLmNhdGNoKCgpID0+IHt9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgcG9zdGVyIGltYWdlXG4gICAqL1xuICBnZXQgcG9zdGVyKCkge1xuICAgIGlmICghdGhpcy5pc1ZpZGVvKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5tZWRpYS5nZXRBdHRyaWJ1dGUoJ3Bvc3RlcicpIHx8IHRoaXMubWVkaWEuZ2V0QXR0cmlidXRlKCdkYXRhLXBvc3RlcicpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY3VycmVudCBhc3BlY3QgcmF0aW8gaW4gdXNlXG4gICAqL1xuICBnZXQgcmF0aW8oKSB7XG4gICAgaWYgKCF0aGlzLmlzVmlkZW8pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHJhdGlvID0gcmVkdWNlQXNwZWN0UmF0aW8oZ2V0QXNwZWN0UmF0aW8uY2FsbCh0aGlzKSk7XG5cbiAgICByZXR1cm4gaXMuYXJyYXkocmF0aW8pID8gcmF0aW8uam9pbignOicpIDogcmF0aW87XG4gIH1cblxuICAvKipcbiAgICogU2V0IHZpZGVvIGFzcGVjdCByYXRpb1xuICAgKi9cbiAgc2V0IHJhdGlvKGlucHV0KSB7XG4gICAgaWYgKCF0aGlzLmlzVmlkZW8pIHtcbiAgICAgIHRoaXMuZGVidWcud2FybignQXNwZWN0IHJhdGlvIGNhbiBvbmx5IGJlIHNldCBmb3IgdmlkZW8nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIWlzLnN0cmluZyhpbnB1dCkgfHwgIXZhbGlkYXRlQXNwZWN0UmF0aW8oaW5wdXQpKSB7XG4gICAgICB0aGlzLmRlYnVnLmVycm9yKGBJbnZhbGlkIGFzcGVjdCByYXRpbyBzcGVjaWZpZWQgKCR7aW5wdXR9KWApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuY29uZmlnLnJhdGlvID0gcmVkdWNlQXNwZWN0UmF0aW8oaW5wdXQpO1xuXG4gICAgc2V0QXNwZWN0UmF0aW8uY2FsbCh0aGlzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIGF1dG9wbGF5IHN0YXRlXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaW5wdXQgLSBXaGV0aGVyIHRvIGF1dG9wbGF5IG9yIG5vdFxuICAgKi9cbiAgc2V0IGF1dG9wbGF5KGlucHV0KSB7XG4gICAgdGhpcy5jb25maWcuYXV0b3BsYXkgPSBpcy5ib29sZWFuKGlucHV0KSA/IGlucHV0IDogdGhpcy5jb25maWcuYXV0b3BsYXk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IGF1dG9wbGF5IHN0YXRlXG4gICAqL1xuICBnZXQgYXV0b3BsYXkoKSB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy5jb25maWcuYXV0b3BsYXkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRvZ2dsZSBjYXB0aW9uc1xuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGlucHV0IC0gV2hldGhlciB0byBlbmFibGUgY2FwdGlvbnNcbiAgICovXG4gIHRvZ2dsZUNhcHRpb25zKGlucHV0KSB7XG4gICAgY2FwdGlvbnMudG9nZ2xlLmNhbGwodGhpcywgaW5wdXQsIGZhbHNlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIGNhcHRpb24gdHJhY2sgYnkgaW5kZXhcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGlucHV0IC0gQ2FwdGlvbiBpbmRleFxuICAgKi9cbiAgc2V0IGN1cnJlbnRUcmFjayhpbnB1dCkge1xuICAgIGNhcHRpb25zLnNldC5jYWxsKHRoaXMsIGlucHV0LCBmYWxzZSk7XG4gICAgY2FwdGlvbnMuc2V0dXAuY2FsbCh0aGlzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgY2FwdGlvbiB0cmFjayBpbmRleCAoLTEgaWYgZGlzYWJsZWQpXG4gICAqL1xuICBnZXQgY3VycmVudFRyYWNrKCkge1xuICAgIGNvbnN0IHsgdG9nZ2xlZCwgY3VycmVudFRyYWNrIH0gPSB0aGlzLmNhcHRpb25zO1xuICAgIHJldHVybiB0b2dnbGVkID8gY3VycmVudFRyYWNrIDogLTE7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSB3YW50ZWQgbGFuZ3VhZ2UgZm9yIGNhcHRpb25zXG4gICAqIFNpbmNlIHRyYWNrcyBjYW4gYmUgYWRkZWQgbGF0ZXIgaXQgd29uJ3QgdXBkYXRlIHRoZSBhY3R1YWwgY2FwdGlvbiB0cmFjayB1bnRpbCB0aGVyZSBpcyBhIG1hdGNoaW5nIHRyYWNrXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCAtIFR3byBjaGFyYWN0ZXIgSVNPIGxhbmd1YWdlIGNvZGUgKGUuZy4gRU4sIEZSLCBQVCwgZXRjKVxuICAgKi9cbiAgc2V0IGxhbmd1YWdlKGlucHV0KSB7XG4gICAgY2FwdGlvbnMuc2V0TGFuZ3VhZ2UuY2FsbCh0aGlzLCBpbnB1dCwgZmFsc2UpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY3VycmVudCB0cmFjaydzIGxhbmd1YWdlXG4gICAqL1xuICBnZXQgbGFuZ3VhZ2UoKSB7XG4gICAgcmV0dXJuIChjYXB0aW9ucy5nZXRDdXJyZW50VHJhY2suY2FsbCh0aGlzKSB8fCB7fSkubGFuZ3VhZ2U7XG4gIH1cblxuICAvKipcbiAgICogVG9nZ2xlIHBpY3R1cmUtaW4tcGljdHVyZSBwbGF5YmFjayBvbiBXZWJLaXQvTWFjT1NcbiAgICogVE9ETzogdXBkYXRlIHBsYXllciB3aXRoIHN0YXRlLCBzdXBwb3J0LCBlbmFibGVkXG4gICAqIFRPRE86IGRldGVjdCBvdXRzaWRlIGNoYW5nZXNcbiAgICovXG4gIHNldCBwaXAoaW5wdXQpIHtcbiAgICAvLyBCYWlsIGlmIG5vIHN1cHBvcnRcbiAgICBpZiAoIXN1cHBvcnQucGlwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gVG9nZ2xlIGJhc2VkIG9uIGN1cnJlbnQgc3RhdGUgaWYgbm90IHBhc3NlZFxuICAgIGNvbnN0IHRvZ2dsZSA9IGlzLmJvb2xlYW4oaW5wdXQpID8gaW5wdXQgOiAhdGhpcy5waXA7XG5cbiAgICAvLyBUb2dnbGUgYmFzZWQgb24gY3VycmVudCBzdGF0ZVxuICAgIC8vIFNhZmFyaVxuICAgIGlmIChpcy5mdW5jdGlvbih0aGlzLm1lZGlhLndlYmtpdFNldFByZXNlbnRhdGlvbk1vZGUpKSB7XG4gICAgICB0aGlzLm1lZGlhLndlYmtpdFNldFByZXNlbnRhdGlvbk1vZGUodG9nZ2xlID8gcGlwLmFjdGl2ZSA6IHBpcC5pbmFjdGl2ZSk7XG4gICAgfVxuXG4gICAgLy8gQ2hyb21lXG4gICAgaWYgKGlzLmZ1bmN0aW9uKHRoaXMubWVkaWEucmVxdWVzdFBpY3R1cmVJblBpY3R1cmUpKSB7XG4gICAgICBpZiAoIXRoaXMucGlwICYmIHRvZ2dsZSkge1xuICAgICAgICB0aGlzLm1lZGlhLnJlcXVlc3RQaWN0dXJlSW5QaWN0dXJlKCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMucGlwICYmICF0b2dnbGUpIHtcbiAgICAgICAgZG9jdW1lbnQuZXhpdFBpY3R1cmVJblBpY3R1cmUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IHBpY3R1cmUtaW4tcGljdHVyZSBzdGF0ZVxuICAgKi9cbiAgZ2V0IHBpcCgpIHtcbiAgICBpZiAoIXN1cHBvcnQucGlwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBTYWZhcmlcbiAgICBpZiAoIWlzLmVtcHR5KHRoaXMubWVkaWEud2Via2l0UHJlc2VudGF0aW9uTW9kZSkpIHtcbiAgICAgIHJldHVybiB0aGlzLm1lZGlhLndlYmtpdFByZXNlbnRhdGlvbk1vZGUgPT09IHBpcC5hY3RpdmU7XG4gICAgfVxuXG4gICAgLy8gQ2hyb21lXG4gICAgcmV0dXJuIHRoaXMubWVkaWEgPT09IGRvY3VtZW50LnBpY3R1cmVJblBpY3R1cmVFbGVtZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHByZXZpZXcgdGh1Ym1uYWlscyBmb3IgdGhlIGN1cnJlbnQgc291cmNlXG4gICAqL1xuICBzZXRQcmV2aWV3VGh1bWJuYWlscyh0aHVtYm5haWxTb3VyY2UpIHtcbiAgICBpZiAodGhpcy5wcmV2aWV3VGh1bWJuYWlscyAmJiB0aGlzLnByZXZpZXdUaHVtYm5haWxzLmxvYWRlZCkge1xuICAgICAgdGhpcy5wcmV2aWV3VGh1bWJuYWlscy5kZXN0cm95KCk7XG4gICAgICB0aGlzLnByZXZpZXdUaHVtYm5haWxzID0gbnVsbDtcbiAgICB9XG5cbiAgICBPYmplY3QuYXNzaWduKHRoaXMuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLCB0aHVtYm5haWxTb3VyY2UpO1xuXG4gICAgLy8gQ3JlYXRlIG5ldyBpbnN0YW5jZSBpZiBpdCBpcyBzdGlsbCBlbmFibGVkXG4gICAgaWYgKHRoaXMuY29uZmlnLnByZXZpZXdUaHVtYm5haWxzLmVuYWJsZWQpIHtcbiAgICAgIHRoaXMucHJldmlld1RodW1ibmFpbHMgPSBuZXcgUHJldmlld1RodW1ibmFpbHModGhpcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRyaWdnZXIgdGhlIGFpcnBsYXkgZGlhbG9nXG4gICAqIFRPRE86IHVwZGF0ZSBwbGF5ZXIgd2l0aCBzdGF0ZSwgc3VwcG9ydCwgZW5hYmxlZFxuICAgKi9cbiAgYWlycGxheSA9ICgpID0+IHtcbiAgICAvLyBTaG93IGRpYWxvZyBpZiBzdXBwb3J0ZWRcbiAgICBpZiAoc3VwcG9ydC5haXJwbGF5KSB7XG4gICAgICB0aGlzLm1lZGlhLndlYmtpdFNob3dQbGF5YmFja1RhcmdldFBpY2tlcigpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogVG9nZ2xlIHRoZSBwbGF5ZXIgY29udHJvbHNcbiAgICogQHBhcmFtIHtCb29sZWFufSBbdG9nZ2xlXSAtIFdoZXRoZXIgdG8gc2hvdyB0aGUgY29udHJvbHNcbiAgICovXG4gIHRvZ2dsZUNvbnRyb2xzID0gKHRvZ2dsZSkgPT4ge1xuICAgIC8vIERvbid0IHRvZ2dsZSBpZiBtaXNzaW5nIFVJIHN1cHBvcnQgb3IgaWYgaXQncyBhdWRpb1xuICAgIGlmICh0aGlzLnN1cHBvcnRlZC51aSAmJiAhdGhpcy5pc0F1ZGlvKSB7XG4gICAgICAvLyBHZXQgc3RhdGUgYmVmb3JlIGNoYW5nZVxuICAgICAgY29uc3QgaXNIaWRkZW4gPSBoYXNDbGFzcyh0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWRlQ29udHJvbHMpO1xuICAgICAgLy8gTmVnYXRlIHRoZSBhcmd1bWVudCBpZiBub3QgdW5kZWZpbmVkIHNpbmNlIGFkZGluZyB0aGUgY2xhc3MgdG8gaGlkZXMgdGhlIGNvbnRyb2xzXG4gICAgICBjb25zdCBmb3JjZSA9IHR5cGVvZiB0b2dnbGUgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkIDogIXRvZ2dsZTtcbiAgICAgIC8vIEFwcGx5IGFuZCBnZXQgdXBkYXRlZCBzdGF0ZVxuICAgICAgY29uc3QgaGlkaW5nID0gdG9nZ2xlQ2xhc3ModGhpcy5lbGVtZW50cy5jb250YWluZXIsIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaGlkZUNvbnRyb2xzLCBmb3JjZSk7XG5cbiAgICAgIC8vIENsb3NlIG1lbnVcbiAgICAgIGlmIChcbiAgICAgICAgaGlkaW5nICYmXG4gICAgICAgIGlzLmFycmF5KHRoaXMuY29uZmlnLmNvbnRyb2xzKSAmJlxuICAgICAgICB0aGlzLmNvbmZpZy5jb250cm9scy5pbmNsdWRlcygnc2V0dGluZ3MnKSAmJlxuICAgICAgICAhaXMuZW1wdHkodGhpcy5jb25maWcuc2V0dGluZ3MpXG4gICAgICApIHtcbiAgICAgICAgY29udHJvbHMudG9nZ2xlTWVudS5jYWxsKHRoaXMsIGZhbHNlKTtcbiAgICAgIH1cblxuICAgICAgLy8gVHJpZ2dlciBldmVudCBvbiBjaGFuZ2VcbiAgICAgIGlmIChoaWRpbmcgIT09IGlzSGlkZGVuKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50TmFtZSA9IGhpZGluZyA/ICdjb250cm9sc2hpZGRlbicgOiAnY29udHJvbHNzaG93bic7XG4gICAgICAgIHRyaWdnZXJFdmVudC5jYWxsKHRoaXMsIHRoaXMubWVkaWEsIGV2ZW50TmFtZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAhaGlkaW5nO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICAvKipcbiAgICogQWRkIGV2ZW50IGxpc3RlbmVyc1xuICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgLSBFdmVudCB0eXBlXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZm9yIHdoZW4gZXZlbnQgb2NjdXJzXG4gICAqL1xuICBvbiA9IChldmVudCwgY2FsbGJhY2spID0+IHtcbiAgICBvbi5jYWxsKHRoaXMsIHRoaXMuZWxlbWVudHMuY29udGFpbmVyLCBldmVudCwgY2FsbGJhY2spO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzIG9uY2VcbiAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50IC0gRXZlbnQgdHlwZVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZvciB3aGVuIGV2ZW50IG9jY3Vyc1xuICAgKi9cbiAgb25jZSA9IChldmVudCwgY2FsbGJhY2spID0+IHtcbiAgICBvbmNlLmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5jb250YWluZXIsIGV2ZW50LCBjYWxsYmFjayk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBldmVudCBsaXN0ZW5lcnNcbiAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50IC0gRXZlbnQgdHlwZVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZvciB3aGVuIGV2ZW50IG9jY3Vyc1xuICAgKi9cbiAgb2ZmID0gKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xuICAgIG9mZih0aGlzLmVsZW1lbnRzLmNvbnRhaW5lciwgZXZlbnQsIGNhbGxiYWNrKTtcbiAgfTtcblxuICAvKipcbiAgICogRGVzdHJveSBhbiBpbnN0YW5jZVxuICAgKiBFdmVudCBsaXN0ZW5lcnMgYXJlIHJlbW92ZWQgd2hlbiBlbGVtZW50cyBhcmUgcmVtb3ZlZFxuICAgKiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEyNTI4MDQ5L2lmLWEtZG9tLWVsZW1lbnQtaXMtcmVtb3ZlZC1hcmUtaXRzLWxpc3RlbmVycy1hbHNvLXJlbW92ZWQtZnJvbS1tZW1vcnlcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmb3Igd2hlbiBkZXN0cm95IGlzIGNvbXBsZXRlXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gc29mdCAtIFdoZXRoZXIgaXQncyBhIHNvZnQgZGVzdHJveSAoZm9yIHNvdXJjZSBjaGFuZ2VzIGV0YylcbiAgICovXG4gIGRlc3Ryb3kgPSAoY2FsbGJhY2ssIHNvZnQgPSBmYWxzZSkgPT4ge1xuICAgIGlmICghdGhpcy5yZWFkeSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGRvbmUgPSAoKSA9PiB7XG4gICAgICAvLyBSZXNldCBvdmVyZmxvdyAoaW5jYXNlIGRlc3Ryb3llZCB3aGlsZSBpbiBmdWxsc2NyZWVuKVxuICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICcnO1xuXG4gICAgICAvLyBHQyBmb3IgZW1iZWRcbiAgICAgIHRoaXMuZW1iZWQgPSBudWxsO1xuXG4gICAgICAvLyBJZiBpdCdzIGEgc29mdCBkZXN0cm95LCBtYWtlIG1pbmltYWwgY2hhbmdlc1xuICAgICAgaWYgKHNvZnQpIHtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuZWxlbWVudHMpLmxlbmd0aCkge1xuICAgICAgICAgIC8vIFJlbW92ZSBlbGVtZW50c1xuICAgICAgICAgIHJlbW92ZUVsZW1lbnQodGhpcy5lbGVtZW50cy5idXR0b25zLnBsYXkpO1xuICAgICAgICAgIHJlbW92ZUVsZW1lbnQodGhpcy5lbGVtZW50cy5jYXB0aW9ucyk7XG4gICAgICAgICAgcmVtb3ZlRWxlbWVudCh0aGlzLmVsZW1lbnRzLmNvbnRyb2xzKTtcbiAgICAgICAgICByZW1vdmVFbGVtZW50KHRoaXMuZWxlbWVudHMud3JhcHBlcik7XG5cbiAgICAgICAgICAvLyBDbGVhciBmb3IgR0NcbiAgICAgICAgICB0aGlzLmVsZW1lbnRzLmJ1dHRvbnMucGxheSA9IG51bGw7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5jYXB0aW9ucyA9IG51bGw7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy5jb250cm9scyA9IG51bGw7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cy53cmFwcGVyID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENhbGxiYWNrXG4gICAgICAgIGlmIChpcy5mdW5jdGlvbihjYWxsYmFjaykpIHtcbiAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBVbmJpbmQgbGlzdGVuZXJzXG4gICAgICAgIHVuYmluZExpc3RlbmVycy5jYWxsKHRoaXMpO1xuXG4gICAgICAgIC8vIENhbmNlbCBjdXJyZW50IG5ldHdvcmsgcmVxdWVzdHNcbiAgICAgICAgaHRtbDUuY2FuY2VsUmVxdWVzdHMuY2FsbCh0aGlzKTtcblxuICAgICAgICAvLyBSZXBsYWNlIHRoZSBjb250YWluZXIgd2l0aCB0aGUgb3JpZ2luYWwgZWxlbWVudCBwcm92aWRlZFxuICAgICAgICByZXBsYWNlRWxlbWVudCh0aGlzLmVsZW1lbnRzLm9yaWdpbmFsLCB0aGlzLmVsZW1lbnRzLmNvbnRhaW5lcik7XG5cbiAgICAgICAgLy8gRXZlbnRcbiAgICAgICAgdHJpZ2dlckV2ZW50LmNhbGwodGhpcywgdGhpcy5lbGVtZW50cy5vcmlnaW5hbCwgJ2Rlc3Ryb3llZCcsIHRydWUpO1xuXG4gICAgICAgIC8vIENhbGxiYWNrXG4gICAgICAgIGlmIChpcy5mdW5jdGlvbihjYWxsYmFjaykpIHtcbiAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMuZWxlbWVudHMub3JpZ2luYWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVzZXQgc3RhdGVcbiAgICAgICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuXG4gICAgICAgIC8vIENsZWFyIGZvciBnYXJiYWdlIGNvbGxlY3Rpb25cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5lbGVtZW50cyA9IG51bGw7XG4gICAgICAgICAgdGhpcy5tZWRpYSA9IG51bGw7XG4gICAgICAgIH0sIDIwMCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIFN0b3AgcGxheWJhY2tcbiAgICB0aGlzLnN0b3AoKTtcblxuICAgIC8vIENsZWFyIHRpbWVvdXRzXG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLmxvYWRpbmcpO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVycy5jb250cm9scyk7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJzLnJlc2l6ZWQpO1xuXG4gICAgLy8gUHJvdmlkZXIgc3BlY2lmaWMgc3R1ZmZcbiAgICBpZiAodGhpcy5pc0hUTUw1KSB7XG4gICAgICAvLyBSZXN0b3JlIG5hdGl2ZSB2aWRlbyBjb250cm9sc1xuICAgICAgdWkudG9nZ2xlTmF0aXZlQ29udHJvbHMuY2FsbCh0aGlzLCB0cnVlKTtcblxuICAgICAgLy8gQ2xlYW4gdXBcbiAgICAgIGRvbmUoKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuaXNZb3VUdWJlKSB7XG4gICAgICAvLyBDbGVhciB0aW1lcnNcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcnMuYnVmZmVyaW5nKTtcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcnMucGxheWluZyk7XG5cbiAgICAgIC8vIERlc3Ryb3kgWW91VHViZSBBUElcbiAgICAgIGlmICh0aGlzLmVtYmVkICE9PSBudWxsICYmIGlzLmZ1bmN0aW9uKHRoaXMuZW1iZWQuZGVzdHJveSkpIHtcbiAgICAgICAgdGhpcy5lbWJlZC5kZXN0cm95KCk7XG4gICAgICB9XG5cbiAgICAgIC8vIENsZWFuIHVwXG4gICAgICBkb25lKCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzVmltZW8pIHtcbiAgICAgIC8vIERlc3Ryb3kgVmltZW8gQVBJXG4gICAgICAvLyB0aGVuIGNsZWFuIHVwICh3YWl0LCB0byBwcmV2ZW50IHBvc3RtZXNzYWdlIGVycm9ycylcbiAgICAgIGlmICh0aGlzLmVtYmVkICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMuZW1iZWQudW5sb2FkKCkudGhlbihkb25lKTtcbiAgICAgIH1cblxuICAgICAgLy8gVmltZW8gZG9lcyBub3QgYWx3YXlzIHJldHVyblxuICAgICAgc2V0VGltZW91dChkb25lLCAyMDApO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2sgZm9yIHN1cHBvcnQgZm9yIGEgbWltZSB0eXBlIChIVE1MNSBvbmx5KVxuICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZSAtIE1pbWUgdHlwZVxuICAgKi9cbiAgc3VwcG9ydHMgPSAodHlwZSkgPT4gc3VwcG9ydC5taW1lLmNhbGwodGhpcywgdHlwZSk7XG5cbiAgLyoqXG4gICAqIENoZWNrIGZvciBzdXBwb3J0XG4gICAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIC0gUGxheWVyIHR5cGUgKGF1ZGlvL3ZpZGVvKVxuICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvdmlkZXIgLSBQcm92aWRlciAoaHRtbDUveW91dHViZS92aW1lbylcbiAgICogQHBhcmFtIHtCb29sZWFufSBpbmxpbmUgLSBXaGVyZSBwbGF5ZXIgaGFzIGBwbGF5c2lubGluZWAgc3R0cmlidXRlXG4gICAqL1xuICBzdGF0aWMgc3VwcG9ydGVkKHR5cGUsIHByb3ZpZGVyLCBpbmxpbmUpIHtcbiAgICByZXR1cm4gc3VwcG9ydC5jaGVjayh0eXBlLCBwcm92aWRlciwgaW5saW5lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2FkIGFuIFNWRyBzcHJpdGUgaW50byB0aGUgcGFnZVxuICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIC0gVVJMIGZvciB0aGUgU1ZHIHNwcml0ZVxuICAgKiBAcGFyYW0ge1N0cmluZ30gW2lkXSAtIFVuaXF1ZSBJRFxuICAgKi9cbiAgc3RhdGljIGxvYWRTcHJpdGUodXJsLCBpZCkge1xuICAgIHJldHVybiBsb2FkU3ByaXRlKHVybCwgaWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNldHVwIG11bHRpcGxlIGluc3RhbmNlc1xuICAgKiBAcGFyYW0geyp9IHNlbGVjdG9yXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAqL1xuICBzdGF0aWMgc2V0dXAoc2VsZWN0b3IsIG9wdGlvbnMgPSB7fSkge1xuICAgIGxldCB0YXJnZXRzID0gbnVsbDtcblxuICAgIGlmIChpcy5zdHJpbmcoc2VsZWN0b3IpKSB7XG4gICAgICB0YXJnZXRzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7XG4gICAgfSBlbHNlIGlmIChpcy5ub2RlTGlzdChzZWxlY3RvcikpIHtcbiAgICAgIHRhcmdldHMgPSBBcnJheS5mcm9tKHNlbGVjdG9yKTtcbiAgICB9IGVsc2UgaWYgKGlzLmFycmF5KHNlbGVjdG9yKSkge1xuICAgICAgdGFyZ2V0cyA9IHNlbGVjdG9yLmZpbHRlcihpcy5lbGVtZW50KTtcbiAgICB9XG5cbiAgICBpZiAoaXMuZW1wdHkodGFyZ2V0cykpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0YXJnZXRzLm1hcCgodCkgPT4gbmV3IFBseXIodCwgb3B0aW9ucykpO1xuICB9XG59XG5cblBseXIuZGVmYXVsdHMgPSBjbG9uZURlZXAoZGVmYXVsdHMpO1xuXG5leHBvcnQgZGVmYXVsdCBQbHlyO1xuIiwiXCJ1c2UgY3RyaWN0XCI7XG5cbmV4cG9ydCBjb25zdCBTd2lwZXJzID0gKCkgPT4ge1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICB2YXIgc3dpcGVyID0gbmV3IFN3aXBlcihcIi5zbGlkZXItanMtMlwiLCB7XG4gICAgICBzbGlkZXNQZXJWaWV3OiA0LFxuICAgICAgZGlyZWN0aW9uOiBcInZlcnRpY2FsXCIsXG4gICAgICBmcmVlTW9kZTogdHJ1ZSxcbiAgICAgIHdhdGNoU2xpZGVzUHJvZ3Jlc3M6IHRydWUsXG4gICAgICAvLyAgbmF2aWdhdGlvbjoge1xuICAgICAgLy8gICAgICBwcmV2RWw6IFwiLmpzLTEtcHJldlwiLFxuICAgICAgLy8gICAgICBuZXh0RWw6IFwiLmpzLTEtbmV4dFwiLFxuICAgICAgLy8gICAgfSxcbiAgICB9KTtcbiAgICB2YXIgc3dpcGVyMiA9IG5ldyBTd2lwZXIoXCIuc2xpZGVyLWpzLTFcIiwge1xuICAgICAgc3BhY2VCZXR3ZWVuOiAxMCxcbiAgICAgIG5hdmlnYXRpb246IHtcbiAgICAgICAgbmV4dEVsOiBcIi5zd2lwZXItYnV0dG9uLW5leHRcIixcbiAgICAgICAgcHJldkVsOiBcIi5zd2lwZXItYnV0dG9uLXByZXZcIixcbiAgICAgIH0sXG4gICAgICB0aHVtYnM6IHtcbiAgICAgICAgc3dpcGVyOiBzd2lwZXIsXG4gICAgICB9LFxuICAgICAgZWZmZWN0OiBcImZhZGVcIixcbiAgICAgIGZhZGVFZmZlY3Q6IHtcbiAgICAgICAgY3Jvc3NGYWRlOiB0cnVlLFxuICAgICAgfSxcbiAgICB9KTtcbiAgIFxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIGNvbnN0IHN3aXBlckZ1bGwgPSBuZXcgU3dpcGVyKFwiLnNsaWRlci1mdWxsLWpzXCIsIHtcbiAgICAgIHNsaWRlc1BlclZpZXc6IDQsXG4gICAgICBsb29wOiBcInRydWVcIixcbiAgICAgIHNwZWVkOiAzMDAsXG4gICAgICBzcGFjZUJldHdlZW46IDE0LFxuICAgICAgLy8gY2VudGVyZWRTbGlkZXM6IHRydWUsXG4gICAgICBncmFiQ3Vyc29yOiB0cnVlLFxuICAgICAgLy8gZWZmZWN0OiBcImNvdmVyZmxvd1wiLFxuICAgICAgLy8gY292ZXJmbG93RWZmZWN0OiB7XG4gICAgICAvLyAgIHJvdGF0ZTogMCxcbiAgICAgIC8vICAgc3RyZXRjaDogMCxcbiAgICAgIC8vICAgZGVwdGg6IDAsXG4gICAgICAvLyAgIC8vIG1vZGlmaWVyOiAxLFxuICAgICAgLy8gICAvLyBzbGlkZVNoYWRvd3M6IHRydWUsXG4gICAgICAvLyB9LFxuICAgICAgLy8gd2F0Y2hTbGlkZXNQcm9ncmVzczogdHJ1ZSxcblxuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBlbDogXCIuc3dpcGVyLXBhZ2luYXRpb24tcmV3XCIsXG4gICAgICAgIGNsaWNrYWJsZTogdHJ1ZSxcbiAgICAgIH0sXG4gICAgICBuYXZpZ2F0aW9uOiB7XG4gICAgICAgIHByZXZFbDogXCIuanMtcmV3LXByZXZcIixcbiAgICAgICAgbmV4dEVsOiBcIi5qcy1yZXctbmV4dFwiLFxuICAgICAgfSxcblxuICAgICAgYnJlYWtwb2ludHM6IHtcbiAgICAgICAgOTAwOiB7XG4gICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyMixcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9KTtcblxuICBcbiAgfSk7XG59O1xuIiwiXCJ1c2UgY3RyaWN0XCI7XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IEFuaW0gPSAoKSA9PiB7XHJcbiAgZnVuY3Rpb24gQW5pbUZvclNjcm9sbFRvcChjZWxsLCByZWMpIHtcclxuICAgIGlmIChyZWMudG9wIDwgZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQgLSAyMDApIHtcclxuICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKFwiX2lzLWFjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIEFuaW1Gb3JTY3JvbGxsZWZ0KGNlbGwsIHJlYykge1xyXG4gICAgaWYgKHJlYy50b3AgPCBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCAtIDIwMCkge1xyXG4gICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJfaXMtYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gQW5pbUZvclNjcm9sbFJpZ2h0KGNlbGwsIHJlYykge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAocmVjLnRvcCA8IGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0IC0gMjAwKSB7XHJcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKFwiX2lzLWFjdGl2ZVwiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgbGV0IGFuaW1Ub3AgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLl9hbmltLXRvcFwiKTtcclxuICAgIGxldCBhbmltbGVmdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuX2FuaW0tbGVmdFwiKTtcclxuICAgIGxldCBhbmltUmlnaHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLl9hbmltLXJpZ2h0XCIpO1xyXG4gICAgbGV0IHNpbmdsZXNUb3AgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhbmltVG9wKTtcclxuICAgIGxldCBzaW5nbGVzbGVmdCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFuaW1sZWZ0KTtcclxuICAgIGxldCBzaW5nbGVzUmlnaHQgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhbmltUmlnaHQpO1xyXG5cclxuXHJcblxyXG4gICAgaWYgKHNpbmdsZXNUb3AubGVuZ3RoID4gMCkge1xyXG4gICAgICBzaW5nbGVzVG9wLmZvckVhY2goKGNlbGwpID0+IHtcclxuXHJcbiAgICAgICAgIGxldCByZWMgPSBjZWxsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICBpZiAocmVjLnRvcCA8IGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0IC0gMjAwKSB7XHJcbiAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJfaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNpbmdsZXNsZWZ0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgc2luZ2xlc2xlZnQuZm9yRWFjaCgoY2VsbDEpID0+IHtcclxuICAgICAgICAgbGV0IHJlYyA9IGNlbGwxLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgaWYgKHJlYy50b3AgPCBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCAtIDIwMCkge1xyXG4gICAgICAgICAgICAgY2VsbDEuY2xhc3NMaXN0LmFkZChcIl9pcy1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNpbmdsZXNSaWdodC5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHNpbmdsZXNSaWdodC5mb3JFYWNoKChjZWxsMikgPT4ge1xyXG4gICAgICAgICBsZXQgcmVjID0gY2VsbDIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgIGlmIChyZWMudG9wIDwgZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQgLSAyMDApIHtcclxuICAgICAgICAgICAgIGNlbGwyLmNsYXNzTGlzdC5hZGQoXCJfaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbiAgfSk7XHJcblxyXG5cclxufTtcclxuXHJcblxyXG5cclxuXHJcbiIsIlwidXNlIGN0cmljdFwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IEJ1dHRvbiA9IChlKSA9PiB7XHJcbiAgbGV0IHRhcmdldCA9ICBlLnRhcmdldC5jbG9zZXN0KCcuYnV0LXdhdmUnKTtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGxldCBtVmFsdWUgPSBNYXRoLm1heCh0YXJnZXQuY2xpZW50V2lkdGgsIHRhcmdldC5jbGllbnRIZWlnaHQpLFxyXG4gICAgICBhZGREaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxyXG4gICAgICByZWN0ID0gdGFyZ2V0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgYWRkRGl2LmNsYXNzTGlzdC5hZGQoXCJhZGREaXZcIik7XHJcbiAgICBhZGREaXYuc3R5bGUud2lkdGggPSBhZGREaXYuc3R5bGUuaGVpZ2h0ID0gbVZhbHVlICsgXCJweFwiO1xyXG4gICAgYWRkRGl2LnN0eWxlLmxlZnQgPSBlLmNsaWVudFggLSByZWN0LmxlZnQgLSBtVmFsdWUgLyAyICsgXCJweFwiO1xyXG4gICAgYWRkRGl2LnN0eWxlLnRvcCA9IGUuY2xpZW50WSAtIHJlY3QudG9wIC0gbVZhbHVlIC8gMiArIFwicHhcIjtcclxuICAgIHRhcmdldC5jbG9zZXN0KFwiLmJ1dC13YXZlXCIpLmFwcGVuZChhZGREaXYpO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGFkZERpdi5yZW1vdmUoKTtcclxuICAgIH0sIDMwMCk7XHJcbn07XHJcblxyXG4iLCIvLyBpbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xyXG5pbXBvcnQgUGx5ciBmcm9tIFwicGx5clwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKTtcclxuZXhwb3J0IGNvbnN0IHdhdmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5idXQtd2F2ZVwiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwc0luaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwcy1pbml0LWpzXCIpO1xyXG5leHBvcnQgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImhlYWRlclwiKTtcclxuZXhwb3J0IGNvbnN0IHRveXNQbHlyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b3lzX19wbHlyXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHBsYXllcjEgPSBuZXcgUGx5cihcIi5wbGF5ZXItMVwiKTtcclxuZXhwb3J0IGNvbnN0IHBsYXllclJldjEgPSBuZXcgUGx5cihcIi5wbGF5ZXItcmV3LTFcIik7XHJcbmV4cG9ydCBjb25zdCBwbGF5ZXJSZXYyID0gbmV3IFBseXIoXCIucGxheWVyLXJldy0yXCIpO1xyXG5leHBvcnQgY29uc3QgcGxheWVyUmV2MyA9IG5ldyBQbHlyKFwiLnBsYXllci1yZXctM1wiKTtcclxuZXhwb3J0IGNvbnN0IHBsYXllclJldjQgPSBuZXcgUGx5cihcIi5wbGF5ZXItcmV3LTRcIik7XHJcblxyXG4iLCJcInVzZSBjdHJpY3RcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBHYWwgPSAoaXRlbSkgPT4ge1xyXG4gIHZhciBzMiA9IG5ldyBTd2lwZXIoXCIuczJzd2lwZXJcIiwge1xyXG4gICAgc3BlZWQ6IDMwMCxcclxuICAgIGNlbnRlcmVkU2xpZGVzOiB0cnVlLFxyXG4gICAgc3BhY2VCZXR3ZWVuOiAxMSxcclxuICAgIGVmZmVjdDogXCJjb3ZlcmZsb3dcIixcclxuICAgIGNvdmVyZmxvd0VmZmVjdDoge1xyXG4gICAgICByb3RhdGU6IDAsXHJcbiAgICAgIHN0cmV0Y2g6IDAsXHJcbiAgICAgIGRlcHRoOiAwLFxyXG4gICAgICAvLyBtb2RpZmllcjogMSxcclxuICAgICAgLy8gc2xpZGVTaGFkb3dzOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIG5hdmlnYXRpb246IHtcclxuICAgICAgcHJldkVsOiBcIi5zMi1wcmV2XCIsXHJcbiAgICAgIG5leHRFbDogXCIuczItbmV4dFwiLFxyXG4gICAgfSxcclxuICAgIC8vIHNsaWRlc1BlclZpZXc6IFwiYXV0b1wiLFxyXG4gICAgLy8gaW5pdDogZmFsc2UsXHJcbiAgICBsb29wOiB0cnVlLFxyXG4gICAgLy8gc2xpZGVzUGVyR3JvdXA6IDMsXHJcbiAgICBzbGlkZXNQZXJWaWV3OiBcImF1dG9cIixcclxuICAgIHNsaWRlVG9DbGlja2VkU2xpZGU6ICd0cnVlJ1xyXG4gIH0pO1xyXG5cclxuICBsZXQgdGVtcDtcclxuXHJcbiAgaWYgKHMyKSB7XHJcbiAgICBzMi5vbihcInNsaWRlQ2hhbmdlVHJhbnNpdGlvblN0YXJ0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY29uc3QgaGVhZCA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnMyICAuc3dpcGVyLXNsaWRlXCIpXSxcclxuICAgICAgICBzMUl0ZW1zID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuczEgIC5zbGlkZVwiKV07XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgczFJdGVtcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgIGlmIChzMUl0ZW1zW2ldLmNsYXNzTGlzdC5jb250YWlucyhcIl9pcy1zdGFydFwiKSkge1xyXG4gICAgICAgICAgICAgczFJdGVtc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwiX2lzLXN0YXJ0XCIpO1xyXG4gICAgICAgICAgIH1cclxuICAgICAgIFxyXG4gICAgICAgXHJcbiAgICAgICAgaWYgKHMxSXRlbXNbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKFwiX2lzLWFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgczFJdGVtc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFwiX2lzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgIHMxSXRlbXNbaV0uY2xhc3NMaXN0LmFkZChcIl9ub3QtYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG5cclxuICAgICAgfVxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhlYWQubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgIGlmIChoZWFkW2ldLmNsYXNzTGlzdC5jb250YWlucyhcInN3aXBlci1zbGlkZS1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgdGVtcCA9IGhlYWRbaV0uZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKTtcclxuICAgICAgICAgICAgczFJdGVtc1t0ZW1wXS5jbGFzc0xpc3QucmVtb3ZlKFwiX25vdC1hY3RpdmVcIik7XHJcbiAgICAgICAgICAgIHMxSXRlbXNbdGVtcF0uY2xhc3NMaXN0LmFkZChcIl9pcy1hY3RpdmVcIik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCAxMCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn07XHJcbiIsIlwidXNlIGN0cmljdFwiO1xuXG5leHBvcnQgY29uc3QgSGVhZGVycyA9ICgpID0+IHtcbiAgLy8gY29uc3QgYnVyZ2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2J1cmdlclwiKTtcbiAgLy8gY29uc3QgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudVwiKTtcbiAgLy8gY29uc3QgaW5mbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgLy8gYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgLy8gICBtZW51LmNsYXNzTGlzdC5hZGQoXCJtZW51LWFjdGl2ZVwiKTtcbiAgLy8gICBpbmZvLmNsYXNzTGlzdC5hZGQoXCJoZWFkZXJfX2luZm9cIiwgXCJpbmZvXCIpO1xuICAvLyAgIGluZm8uaW5uZXJIVE1MID1cbiAgLy8gICAgIFwiPGEgY2xhc3M9J2luZm9fX3Bob25lJyBocmVmPScjISc+KzcoMDAwKSAxMjMgNDUgNjU8L2E+PGZvcm0gY2xhc3M9J2luZm9fX3NlYXJjaCAnPjxpbnB1dCB0eXBlPSd0ZXh0JyBwbGFjZWhvbGRlcj0n0J/QvtC40YHQuicgLz48c3ZnPiA8dXNlIHhsaW5rOmhyZWY9JyNzZWFyY2gnPjwvdXNlPjwvc3ZnPjxpbnB1dCB0eXBlPSdzdWJtaXQnLz48L2Zvcm0+XCI7XG4gIC8vICAgbWVudS5hcHBlbmQoaW5mbyk7XG4gIC8vICAgZnVuY3Rpb24gYWN0aXZlSW5mbygpIHtcbiAgLy8gICAgIGluZm8uY2xhc3NMaXN0LmFkZChcImluZm8tYWN0aXZlXCIpO1xuICAvLyAgIH1cbiAgLy8gICBzZXRUaW1lb3V0KGFjdGl2ZUluZm8sIDIwMCk7XG4gIC8vICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIikuY2xhc3NMaXN0LmFkZChcImxvY2tcIik7XG4gIC8vIH0pO1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgLy8gZG9jdW1lbnRcbiAgLy8gICAucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2Nsb3NlXCIpXG4gIC8vICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgLy8gICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShcIm1lbnUtYWN0aXZlXCIpO1xuICAvLyAgICAgbWVudS5xdWVyeVNlbGVjdG9yKFwiLmluZm9cIikucmVtb3ZlKCk7XG4gIC8vICAgICBpbmZvLmNsYXNzTGlzdC5yZW1vdmUoXCJpbmZvLWFjdGl2ZVwiKTtcbiAgLy8gICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5XCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJsb2NrXCIpO1xuICAvLyAgIH0pO1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgaWYgKHdpbmRvdy5wYWdlWU9mZnNldCA+IDEwMCkge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kb3BfaGVhZGVyXCIpLmNsYXNzTGlzdC5hZGQoXCJyZXNwb25jaXZlSGVhZGVyXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRvcF9oZWFkZXJcIikuY2xhc3NMaXN0LnJlbW92ZShcInJlc3BvbmNpdmVIZWFkZXJcIik7XG4gICAgfVxuICB9KTtcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSA5OTkpIHtcbiAgICAgIGlmIChtZW51LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyX19pbmZvXCIpKSB7XG4gICAgICAgIG1lbnUucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2luZm9cIikucmVtb3ZlKCk7XG4gICAgICB9XG5cbiAgICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShcIm1lbnUtYWN0aXZlXCIpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbmZvXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJpbmZvLWFjdGl2ZVwiKTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5XCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJsb2NrXCIpO1xuICAgIH1cbiAgfTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxufTtcblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5pbXBvcnQgUGx5ciBmcm9tIFwicGx5clwiO1xuaW1wb3J0IHsgYm9keSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuXG5leHBvcnQgY29uc3QgUG9wdXBzID0gKCkgPT4ge1xuICBjb25zdCBwb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtanNcIiksXG4gICAgY29udGVudHMgPSBwb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19jb250ZW50XCIpLFxuICAgIFBsZWVycyA9IFtdO1xuXG4gIGxldCB0ZW1wb3IgPSBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZXItdmlkZW9cIildO1xuXG4gIHRlbXBvci5mb3JFYWNoKChjZWxsKSA9PiB7XG4gICAgbGV0IGlkID0gY2VsbC5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcbiAgICBpZiAoaWQpIHtcbiAgICAgIGxldCByID0gYCMke2lkfWA7XG4gICAgICBjb25zdCBlID0gbmV3IFBseXIocik7XG4gICAgICBQbGVlcnMucHVzaCh7IGlkOiBpZCwgZTogZSB9KTtcbiAgICB9XG4gIH0pO1xuXG5cbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gIC8vICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICBjb25zdCBvcGVuUG9wID0gKCkgPT4ge1xuXG4gICAgICBjb25zdCBpbml0VGFyZ2V0ID0gcG9wdXAucXVlcnlTZWxlY3RvcihcbiAgICAgICAgdGFyZ2V0LmNsb3Nlc3QoXCIucG9wdXBzLWluaXQtanNcIikuZ2V0QXR0cmlidXRlKFwicmVsXCIpXG4gICAgICApO1xuXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJfbm90LWFjdGl2ZVwiKTtcbiAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKFwiX2lzLWFjdGl2ZVwiKTtcblxuICAgIGNvbnRlbnRzLmZvckVhY2goKGNlbGwpID0+IHtcbiAgICAgIGlmIChjZWxsID09IGluaXRUYXJnZXQpIHtcbiAgICAgICAgaW5pdFRhcmdldC5zdHlsZS5kaXNwbGF5ID0gXCJncmlkXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjZWxsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgICAgfSwgMjAwKTtcblxuICAgICAgbGV0IGxpbmtQbHlyID0gaW5pdFRhcmdldC5xdWVyeVNlbGVjdG9yKFwidmlkZW9cIikuZ2V0QXR0cmlidXRlKFwiaWRcIik7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGVtcG9yLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGlmIChQbGVlcnNbaV0uaWQgPT09IGxpbmtQbHlyKSB7XG4gICAgICAgICAgUGxlZXJzW2ldLmUucGxheSgpO1xuICAgICAgICB9XG4gICAgICB9XG5cblxuICAgICAgYm9keS5zdHlsZS5jc3NUZXh0ID0gXCJvdmVyZmxvdzogaGlkZGVuXCI7XG4gICAgfTtcbiAgLy8gICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIGNvbnN0IGNsb3NlUG9wID0gKCkgPT4ge1xuXG5wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwiX2lzLWFjdGl2ZVwiKTtcbnBvcHVwLmNsYXNzTGlzdC5hZGQoXCJfbm90LWFjdGl2ZVwiKTtcblxuc2V0VGltZW91dCgoKSA9PiB7XG4gcG9wdXAuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuY29udGVudHMuZm9yRWFjaCgoY2VsbCkgPT4ge1xuICBjZWxsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbn0pO1xufSwgMzAwKTtcblxuXG5cbiAgICAgIGJvZHkuc3R5bGUuY3NzVGV4dCA9IFwib3ZlcmZsb3c6IHZpc2libGVcIjtcbiBcblxuICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgUGxlZXJzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgIFBsZWVyc1tpXS5lLnN0b3AoKTtcbiAgICAgICB9XG4gICAgfTtcbiAgLy8gICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgaWYgKFxuICAgICAgdGFyZ2V0LmNsb3Nlc3QoXCIucG9wdXBzLWluaXQtanNcIilcbiAgICAgIC8vICAmJlxuICAgICAgLy8gdGFyZ2V0LmNsb3Nlc3QoXCIuc2xpZGVyX19pdGVtXCIpLmNsYXNzTGlzdC5jb250YWlucyhcInN3aXBlci1zbGlkZS1hY3RpdmVcIilcbiAgICApIHtcbiAgICAgIG9wZW5Qb3AoKTtcbiAgICB9IGVsc2UgaWYgKFxuICAgICAgdGFyZ2V0Lm1hdGNoZXMoXCIucG9wdXAtb3ZlcmxheS1qc1wiKSB8fFxuICAgICAgdGFyZ2V0LmNsb3Nlc3QoXCIucG9wdXAtY2xvc2UtanNcIilcbiAgICApIHtcbiAgICAgIGNsb3NlUG9wKCk7XG4gICAgfVxuICB9KTtcbn07XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcblx0XHRmdW5jdGlvbigpIHsgcmV0dXJuIG1vZHVsZTsgfTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmosIHByb3ApIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOyB9IiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCIvLyBpbXBvcnQgYXhpb3MgZnJvbSBcImF4aW9zXCI7XHJcbmltcG9ydCB7IEFuaW0gfSBmcm9tIFwiLi9hc3NldHMvanMvYW5pbWF0aW9uXCI7XHJcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gXCIuL2Fzc2V0cy9qcy9idXR0b25cIjtcclxuaW1wb3J0IHsgSGVhZGVycyB9IGZyb20gXCIuL2Fzc2V0cy9qcy9oZWFkZXJcIjtcclxuaW1wb3J0IHsgU3dpcGVycyB9IGZyb20gXCIuL2Fzc2V0cy9qcy9NeVN3aXBlclwiO1xyXG5pbXBvcnQgeyBQb3B1cHMgfSBmcm9tIFwiLi9hc3NldHMvanMvcG9wdXBcIjtcclxuaW1wb3J0IHsgR2FsIH0gZnJvbSBcIi4vYXNzZXRzL2pzL2dhbFN3aXBlclwiO1xyXG5pbXBvcnQge1xyXG4gIHdhdmVzLFxyXG4gIHBvcHVwc0luaXQsXHJcbiAgaGVhZGVyLFxyXG4gIHRveXNQbHlyLFxyXG4gIHBsYXllcjEsXHJcbiAgcGxheWVyUmV2MSxcclxufSBmcm9tIFwiLi9hc3NldHMvanMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG4vLyAtLS0tLS0tLXN0eWxlcy0tLS0tLS0tLS0tLS1cclxuaW1wb3J0IFwiLi9hc3NldHMvc2Nzcy9hcHAuc2Nzc1wiO1xyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbkFuaW0oKTtcclxuU3dpcGVycygpO1xyXG5HYWwoKTtcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcclxuICBpZiAocG9wdXBzSW5pdC5sZW5ndGggPiAwKSB7XHJcbiAgICBQb3B1cHMoKTtcclxuICB9XHJcblxyXG4gIGlmIChoZWFkZXIpIHtcclxuICAgIEhlYWRlcnMoKTtcclxuICB9XHJcblxyXG4gIHdhdmVzLmZvckVhY2goKGNlbGwpID0+IHtcclxuICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIEJ1dHRvbik7XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IHBseXJQbGF5ID0gKCkgPT4ge1xyXG4gICAgbGV0IHBsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50b3lzIC5wbHlyX19jb250cm9sc1wiKTtcclxuICAgIGlmIChwbGF5ZXIxICkge1xyXG4gICAgICBsZXQgdGVydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgICBcIi50b3lzX192aWRlbyAucGx5clwiXHJcbiAgICAgICAgKSxcclxuICAgICAgIHNoZWFwPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgICAgXCIudG95c19fdmlkZW8gLnRveXNfX3NoZWFwXCJcclxuICAgICAgICApXHJcbiAgICAgICAgXHJcbiAgICAgICAgc2hlYXAuaW5uZXJIVE1MID0gXCIwOjAwXCI7XHJcbiAgICAgIHRlcnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgIHBsLmNsYXNzTGlzdC5hZGQoXCJfaXMtYWN0aXZlXCIpO1xyXG4gICAgICAgIGxldCB0ciA9IHBsYXllcjEuY3VycmVudFRpbWUudG9GaXhlZCgyKTtcclxuICAgICAgICAgdHIgPSB0ci5yZXBsYWNlKFwiLlwiLCBcIjpcIik7XHJcbiAgICAgICAgICBzaGVhcC5pbm5lckhUTUwgPSB0cjtcclxuICAgICAgfSk7IFxyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHBseXJQbGF5KCk7XHJcblxyXG59KTtcclxuIl0sIm5hbWVzIjpbIm5hdmlnYXRvciIsIm1vZHVsZSIsImV4cG9ydHMiLCJfZGVmaW5lUHJvcGVydHkkMSIsIm9iaiIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJfZGVmaW5lUHJvcGVydGllcyIsImUiLCJ0IiwibiIsImxlbmd0aCIsInIiLCJfZGVmaW5lUHJvcGVydHkiLCJvd25LZXlzIiwia2V5cyIsImdldE93blByb3BlcnR5U3ltYm9scyIsImZpbHRlciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInB1c2giLCJhcHBseSIsIl9vYmplY3RTcHJlYWQyIiwiYXJndW1lbnRzIiwiZm9yRWFjaCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvcnMiLCJkZWZpbmVQcm9wZXJ0aWVzIiwiZGVmYXVsdHMiLCJhZGRDU1MiLCJ0aHVtYldpZHRoIiwid2F0Y2giLCJtYXRjaGVzIiwiQXJyYXkiLCJmcm9tIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5jbHVkZXMiLCJ0aGlzIiwiY2FsbCIsImdldENvbnN0cnVjdG9yIiwiY29uc3RydWN0b3IiLCJpbnN0YW5jZU9mIiwiaXNTdHJpbmciLCJTdHJpbmciLCJpc0FycmF5IiwiaXNOb2RlTGlzdCIsIk5vZGVMaXN0IiwiaXMiLCJFbGVtZW50IiwiRXZlbnQiLCJpc051bGxPclVuZGVmaW5lZCIsImlzT2JqZWN0IiwiUmFuZ2VUb3VjaCIsIlR5cGVFcnJvciIsImVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicmFuZ2VUb3VjaCIsImNvbmZpZyIsImluaXQiLCJwcm90b3R5cGUiLCJfY3JlYXRlQ2xhc3MiLCJlbmFibGVkIiwic3R5bGUiLCJ1c2VyU2VsZWN0Iiwid2ViS2l0VXNlclNlbGVjdCIsInRvdWNoQWN0aW9uIiwibGlzdGVuZXJzIiwic2V0IiwidGFyZ2V0IiwiaSIsImNoYW5nZWRUb3VjaGVzIiwibyIsInBhcnNlRmxvYXQiLCJnZXRBdHRyaWJ1dGUiLCJzIiwidSIsImMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJhIiwid2lkdGgiLCJjbGllbnRYIiwibGVmdCIsImNvbmNhdCIsIm1hdGNoIiwiTWF0aCIsIm1heCIsImdldERlY2ltYWxQbGFjZXMiLCJ0b0ZpeGVkIiwicm91bmQiLCJkaXNhYmxlZCIsInByZXZlbnREZWZhdWx0IiwiZ2V0IiwiYnViYmxlcyIsImRpc3BhdGNoRXZlbnQiLCJ0cmlnZ2VyIiwidHlwZSIsIk11dGF0aW9uT2JzZXJ2ZXIiLCJhZGRlZE5vZGVzIiwib2JzZXJ2ZSIsImJvZHkiLCJjaGlsZExpc3QiLCJzdWJ0cmVlIiwibWFwIiwiZG9jdW1lbnRFbGVtZW50IiwiaW5wdXQiLCJCb29sZWFuIiwiaXNGdW5jdGlvbiIsIkZ1bmN0aW9uIiwiaXNFbXB0eSIsIk51bWJlciIsImlzTmFOIiwibm9kZVR5cGUiLCJvd25lckRvY3VtZW50IiwiS2V5Ym9hcmRFdmVudCIsIlRleHRUcmFjayIsImtpbmQiLCJ3aW5kb3ciLCJVUkwiLCJzdHJpbmciLCJzdGFydHNXaXRoIiwiaG9zdG5hbWUiLCJfIiwidHJhbnNpdGlvbkVuZEV2ZW50IiwiY3JlYXRlRWxlbWVudCIsImV2ZW50cyIsIldlYmtpdFRyYW5zaXRpb24iLCJNb3pUcmFuc2l0aW9uIiwiT1RyYW5zaXRpb24iLCJ0cmFuc2l0aW9uIiwiZmluZCIsImV2ZW50IiwicmVwYWludCIsImRlbGF5Iiwic2V0VGltZW91dCIsImhpZGRlbiIsIm9mZnNldEhlaWdodCIsImJyb3dzZXIiLCJpc0lFIiwiZG9jdW1lbnRNb2RlIiwiaXNFZGdlIiwidXNlckFnZW50IiwiaXNXZWJraXQiLCJ0ZXN0IiwiaXNJUGhvbmUiLCJwbGF0Zm9ybSIsImlzSW9zIiwibWF4VG91Y2hQb2ludHMiLCJnZXREZWVwIiwib2JqZWN0IiwicGF0aCIsInNwbGl0IiwicmVkdWNlIiwiZXh0ZW5kIiwic291cmNlcyIsInNvdXJjZSIsInNoaWZ0IiwiYXNzaWduIiwid3JhcCIsImVsZW1lbnRzIiwid3JhcHBlciIsInRhcmdldHMiLCJyZXZlcnNlIiwiaW5kZXgiLCJjaGlsZCIsImNsb25lTm9kZSIsInBhcmVudCIsInBhcmVudE5vZGUiLCJzaWJsaW5nIiwibmV4dFNpYmxpbmciLCJhcHBlbmRDaGlsZCIsImluc2VydEJlZm9yZSIsInNldEF0dHJpYnV0ZXMiLCJhdHRyaWJ1dGVzIiwiZW50cmllcyIsInNldEF0dHJpYnV0ZSIsInRleHQiLCJpbm5lclRleHQiLCJpbnNlcnRFbGVtZW50IiwicmVtb3ZlRWxlbWVudCIsInJlbW92ZUNoaWxkIiwiZW1wdHlFbGVtZW50IiwiY2hpbGROb2RlcyIsImxhc3RDaGlsZCIsInJlcGxhY2VFbGVtZW50IiwibmV3Q2hpbGQiLCJvbGRDaGlsZCIsInJlcGxhY2VDaGlsZCIsImdldEF0dHJpYnV0ZXNGcm9tU2VsZWN0b3IiLCJzZWwiLCJleGlzdGluZ0F0dHJpYnV0ZXMiLCJleGlzdGluZyIsInNlbGVjdG9yIiwidHJpbSIsImNsYXNzTmFtZSIsInJlcGxhY2UiLCJwYXJ0cyIsImNoYXJBdCIsImNsYXNzIiwiaWQiLCJ0b2dnbGVIaWRkZW4iLCJoaWRlIiwidG9nZ2xlQ2xhc3MiLCJmb3JjZSIsIm1ldGhvZCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiaGFzQ2xhc3MiLCJ3ZWJraXRNYXRjaGVzU2VsZWN0b3IiLCJtb3pNYXRjaGVzU2VsZWN0b3IiLCJtc01hdGNoZXNTZWxlY3RvciIsImdldEVsZW1lbnRzIiwiY29udGFpbmVyIiwiZ2V0RWxlbWVudCIsInNldEZvY3VzIiwidGFiRm9jdXMiLCJmb2N1cyIsInByZXZlbnRTY3JvbGwiLCJjbGFzc05hbWVzIiwiZGVmYXVsdENvZGVjcyIsInN1cHBvcnQiLCJhdWRpbyIsInZpZGVvIiwiY2hlY2siLCJwcm92aWRlciIsInBsYXlzaW5saW5lIiwiY2FuUGxheUlubGluZSIsImFwaSIsInVpIiwicmFuZ2VJbnB1dCIsInBpcCIsIndlYmtpdFNldFByZXNlbnRhdGlvbk1vZGUiLCJwaWN0dXJlSW5QaWN0dXJlRW5hYmxlZCIsImRpc2FibGVQaWN0dXJlSW5QaWN0dXJlIiwiYWlycGxheSIsIldlYktpdFBsYXliYWNrVGFyZ2V0QXZhaWxhYmlsaXR5RXZlbnQiLCJtaW1lIiwibWVkaWFUeXBlIiwiaXNIVE1MNSIsIm1lZGlhIiwiY2FuUGxheVR5cGUiLCJ0ZXh0VHJhY2tzIiwicmFuZ2UiLCJ0b3VjaCIsInRyYW5zaXRpb25zIiwicmVkdWNlZE1vdGlvbiIsIm1hdGNoTWVkaWEiLCJzdXBwb3J0c1Bhc3NpdmVMaXN0ZW5lcnMiLCJzdXBwb3J0ZWQiLCJvcHRpb25zIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ0b2dnbGVMaXN0ZW5lciIsImNhbGxiYWNrIiwidG9nZ2xlIiwicGFzc2l2ZSIsImNhcHR1cmUiLCJldmVudExpc3RlbmVycyIsIm9uIiwib2ZmIiwib25jZSIsIm9uY2VDYWxsYmFjayIsImFyZ3MiLCJ0cmlnZ2VyRXZlbnQiLCJkZXRhaWwiLCJDdXN0b21FdmVudCIsInBseXIiLCJ1bmJpbmRMaXN0ZW5lcnMiLCJpdGVtIiwicmVhZHkiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJzaWxlbmNlUHJvbWlzZSIsImRlZHVwZSIsImFycmF5IiwiaW5kZXhPZiIsImNsb3Nlc3QiLCJwcmV2IiwiY3VyciIsImFicyIsInN1cHBvcnRzQ1NTIiwiZGVjbGFyYXRpb24iLCJDU1MiLCJzdXBwb3J0cyIsInN0YW5kYXJkUmF0aW9zIiwib3V0IiwieCIsInkiLCJ2YWxpZGF0ZUFzcGVjdFJhdGlvIiwiZXZlcnkiLCJyZWR1Y2VBc3BlY3RSYXRpbyIsInJhdGlvIiwiaGVpZ2h0IiwiZGl2aWRlciIsImdldERpdmlkZXIiLCJ3IiwiaCIsImdldEFzcGVjdFJhdGlvIiwicGFyc2UiLCJlbWJlZCIsInNldEFzcGVjdFJhdGlvIiwiaXNWaWRlbyIsInBhZGRpbmciLCJhc3BlY3RSYXRpbyIsInBhZGRpbmdCb3R0b20iLCJpc1ZpbWVvIiwidmltZW8iLCJwcmVtaXVtIiwib2Zmc2V0V2lkdGgiLCJwYXJzZUludCIsImdldENvbXB1dGVkU3R5bGUiLCJvZmZzZXQiLCJmdWxsc2NyZWVuIiwiYWN0aXZlIiwidHJhbnNmb3JtIiwiYWRkIiwidmlkZW9GaXhlZFJhdGlvIiwicm91bmRBc3BlY3RSYXRpbyIsInRvbGVyYW5jZSIsImNsb3Nlc3RSYXRpbyIsImh0bWw1IiwiZ2V0U291cmNlcyIsImdldFF1YWxpdHlPcHRpb25zIiwicXVhbGl0eSIsImZvcmNlZCIsInNldHVwIiwicGxheWVyIiwic3BlZWQiLCJvbkNoYW5nZSIsImN1cnJlbnRUaW1lIiwicGF1c2VkIiwicHJlbG9hZCIsInJlYWR5U3RhdGUiLCJwbGF5YmFja1JhdGUiLCJzcmMiLCJwbGF5IiwibG9hZCIsImNhbmNlbFJlcXVlc3RzIiwiYmxhbmtWaWRlbyIsImRlYnVnIiwibG9nIiwiZm9ybWF0IiwidG9TdHJpbmciLCJyZXBsYWNlQWxsIiwiUmVnRXhwIiwidG9UaXRsZUNhc2UiLCJ0b1VwcGVyQ2FzZSIsInNsaWNlIiwidG9Mb3dlckNhc2UiLCJnZXRIVE1MIiwiaW5uZXJIVE1MIiwicmVzb3VyY2VzIiwieW91dHViZSIsImkxOG4iLCJzZWVrVGltZSIsInRpdGxlIiwidiIsImsiLCJTdG9yYWdlIiwic3RvcmUiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwianNvbiIsIkpTT04iLCJzdG9yYWdlIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsInJlbW92ZUl0ZW0iLCJmZXRjaCIsInVybCIsInJlc3BvbnNlVHlwZSIsInJlamVjdCIsInJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsInJlc3BvbnNlVGV4dCIsInJlc3BvbnNlIiwiRXJyb3IiLCJzdGF0dXMiLCJvcGVuIiwic2VuZCIsImVycm9yIiwibG9hZFNwcml0ZSIsInByZWZpeCIsImhhc0lkIiwiZXhpc3RzIiwiZ2V0RWxlbWVudEJ5SWQiLCJ1cGRhdGUiLCJkYXRhIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwidXNlU3RvcmFnZSIsImNhY2hlZCIsImNvbnRlbnQiLCJyZXN1bHQiLCJjYXRjaCIsImdldEhvdXJzIiwidHJ1bmMiLCJmb3JtYXRUaW1lIiwidGltZSIsImRpc3BsYXlIb3VycyIsImludmVydGVkIiwiaG91cnMiLCJtaW5zIiwic2VjcyIsImNvbnRyb2xzIiwiZ2V0SWNvblVybCIsImljb25VcmwiLCJsb2NhdGlvbiIsImhvc3QiLCJ0b3AiLCJjb3JzIiwic3ZnNGV2ZXJ5Ym9keSIsImZpbmRFbGVtZW50cyIsInNlbGVjdG9ycyIsImJ1dHRvbnMiLCJwYXVzZSIsInJlc3RhcnQiLCJyZXdpbmQiLCJmYXN0Rm9yd2FyZCIsIm11dGUiLCJzZXR0aW5ncyIsImNhcHRpb25zIiwicHJvZ3Jlc3MiLCJpbnB1dHMiLCJzZWVrIiwidm9sdW1lIiwiZGlzcGxheSIsImJ1ZmZlciIsImR1cmF0aW9uIiwic2Vla1Rvb2x0aXAiLCJ0b29sdGlwIiwid2FybiIsInRvZ2dsZU5hdGl2ZUNvbnRyb2xzIiwiY3JlYXRlSWNvbiIsIm5hbWVzcGFjZSIsImljb25QYXRoIiwiaWNvblByZWZpeCIsImljb24iLCJjcmVhdGVFbGVtZW50TlMiLCJmb2N1c2FibGUiLCJ1c2UiLCJzZXRBdHRyaWJ1dGVOUyIsImNyZWF0ZUxhYmVsIiwiYXR0ciIsImpvaW4iLCJjcmVhdGVCYWRnZSIsImJhZGdlIiwibWVudSIsImNyZWF0ZUJ1dHRvbiIsImJ1dHRvblR5cGUiLCJ0b1Bhc2NhbENhc2UiLCJ0b0NhbWVsQ2FzZSIsInByb3BzIiwibGFiZWwiLCJsYWJlbFByZXNzZWQiLCJpY29uUHJlc3NlZCIsInNvbWUiLCJjb250cm9sIiwiYnV0dG9uIiwiY3JlYXRlUmFuZ2UiLCJtaW4iLCJzdGVwIiwiYXV0b2NvbXBsZXRlIiwicm9sZSIsInVwZGF0ZVJhbmdlRmlsbCIsImNyZWF0ZVByb2dyZXNzIiwic3VmZml4S2V5IiwicGxheWVkIiwic3VmZml4IiwiY3JlYXRlVGltZSIsImF0dHJzIiwiYmluZE1lbnVJdGVtU2hvcnRjdXRzIiwibWVudUl0ZW0iLCJzdG9wUHJvcGFnYXRpb24iLCJpc1JhZGlvQnV0dG9uIiwic2hvd01lbnVQYW5lbCIsIm5leHRFbGVtZW50U2libGluZyIsImZpcnN0RWxlbWVudENoaWxkIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImxhc3RFbGVtZW50Q2hpbGQiLCJmb2N1c0ZpcnN0TWVudUl0ZW0iLCJjcmVhdGVNZW51SXRlbSIsImxpc3QiLCJjaGVja2VkIiwiZmxleCIsImNoaWxkcmVuIiwibm9kZSIsImJpbmQiLCJjdXJyZW50VHJhY2siLCJ1cGRhdGVUaW1lRGlzcGxheSIsInVwZGF0ZVZvbHVtZSIsInNldFJhbmdlIiwibXV0ZWQiLCJwcmVzc2VkIiwidXBkYXRlUHJvZ3Jlc3MiLCJjdXJyZW50IiwidmFsIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJub2RlVmFsdWUiLCJzZXRQcm9ncmVzcyIsImJ1ZmZlcmVkIiwicGVyY2VudCIsInNldFByb3BlcnR5IiwidXBkYXRlU2Vla1Rvb2x0aXAiLCJ0b29sdGlwcyIsInRpcEVsZW1lbnQiLCJ2aXNpYmxlIiwic2hvdyIsImNsaWVudFJlY3QiLCJwYWdlWCIsInBvaW50IiwiX3RoaXMkY29uZmlnJG1hcmtlcnMiLCJtYXJrZXJzIiwiX3RoaXMkY29uZmlnJG1hcmtlcnMkIiwicG9pbnRzIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwidGltZVVwZGF0ZSIsImludmVydCIsImludmVydFRpbWUiLCJzZWVraW5nIiwiZHVyYXRpb25VcGRhdGUiLCJoYXNEdXJhdGlvbiIsImRpc3BsYXlEdXJhdGlvbiIsInNldE1hcmtlcnMiLCJ0b2dnbGVNZW51QnV0dG9uIiwic2V0dGluZyIsInVwZGF0ZVNldHRpbmciLCJwYW5lIiwicGFuZWxzIiwiZGVmYXVsdCIsImdldExhYmVsIiwic2V0UXVhbGl0eU1lbnUiLCJjaGVja01lbnUiLCJnZXRCYWRnZSIsInNvcnQiLCJiIiwic29ydGluZyIsInNldENhcHRpb25zTWVudSIsInRyYWNrcyIsImdldFRyYWNrcyIsInRyYWNrIiwidG9nZ2xlZCIsImxhbmd1YWdlIiwidW5zaGlmdCIsInNldFNwZWVkTWVudSIsIm1pbmltdW1TcGVlZCIsIm1heGltdW1TcGVlZCIsInZhbHVlcyIsInBvcHVwIiwicCIsImZpcnN0SXRlbSIsInRvZ2dsZU1lbnUiLCJjb21wb3NlZFBhdGgiLCJpc01lbnVJdGVtIiwiZ2V0TWVudVNpemUiLCJ0YWIiLCJjbG9uZSIsInBvc2l0aW9uIiwib3BhY2l0eSIsInJlbW92ZUF0dHJpYnV0ZSIsInNjcm9sbFdpZHRoIiwic2Nyb2xsSGVpZ2h0Iiwic2l6ZSIsInJlc3RvcmUiLCJwcm9wZXJ0eU5hbWUiLCJzZXREb3dubG9hZFVybCIsImRvd25sb2FkIiwiY3JlYXRlIiwiZGVmYXVsdEF0dHJpYnV0ZXMiLCJwcm9ncmVzc0NvbnRhaW5lciIsImlubmVyIiwiaG9tZSIsImJhY2tCdXR0b24iLCJocmVmIiwidXJscyIsImlzRW1iZWQiLCJpbmplY3QiLCJmbG9vciIsInJhbmRvbSIsInNlZWt0aW1lIiwiYWRkUHJvcGVydHkiLCJjb250cm9sUHJlc3NlZCIsImxhYmVscyIsInNldE1lZGlhTWV0YWRhdGEiLCJtZWRpYVNlc3Npb24iLCJtZXRhZGF0YSIsIk1lZGlhTWV0YWRhdGEiLCJtZWRpYU1ldGFkYXRhIiwiYXJ0aXN0IiwiYWxidW0iLCJhcnR3b3JrIiwiX3RoaXMkY29uZmlnJG1hcmtlcnMyIiwiX3RoaXMkY29uZmlnJG1hcmtlcnMzIiwiY29udGFpbmVyRnJhZ21lbnQiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwicG9pbnRzRnJhZ21lbnQiLCJ0aXBWaXNpYmxlIiwidG9nZ2xlVGlwIiwibWFya2VyRWxlbWVudCIsIm1hcmtlciIsInRpcCIsInBhcnNlVXJsIiwicGFyc2VyIiwiYnVpbGRVcmxQYXJhbXMiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJpc1lvdVR1YmUiLCJwcm90b2NvbCIsImJsb2IiLCJjcmVhdGVPYmplY3RVUkwiLCJsYW5ndWFnZXMiLCJ1c2VyTGFuZ3VhZ2UiLCJ0cmFja0V2ZW50cyIsIm1ldGEiLCJjdXJyZW50VHJhY2tOb2RlIiwibGFuZ3VhZ2VFeGlzdHMiLCJtb2RlIiwidXBkYXRlQ3VlcyIsInNldExhbmd1YWdlIiwiYWN0aXZlQ2xhc3MiLCJmaW5kVHJhY2siLCJlbmFibGVUZXh0VHJhY2siLCJoYXMiLCJzb3J0SXNEZWZhdWx0Iiwic29ydGVkIiwidW5kZWZpbmVkIiwiZ2V0Q3VycmVudFRyYWNrIiwiY3VlcyIsImFjdGl2ZUN1ZXMiLCJjdWUiLCJnZXRDdWVBc0hUTUwiLCJjdWVUZXh0IiwiY2FwdGlvbiIsImF1dG9wbGF5IiwiYXV0b3BhdXNlIiwidG9nZ2xlSW52ZXJ0IiwiY2xpY2tUb1BsYXkiLCJoaWRlQ29udHJvbHMiLCJyZXNldE9uRW5kIiwiZGlzYWJsZUNvbnRleHRNZW51IiwibG9vcCIsInNlbGVjdGVkIiwia2V5Ym9hcmQiLCJmb2N1c2VkIiwiZ2xvYmFsIiwiZmFsbGJhY2siLCJpb3NOYXRpdmUiLCJzZWVrTGFiZWwiLCJ1bm11dGUiLCJlbmFibGVDYXB0aW9ucyIsImRpc2FibGVDYXB0aW9ucyIsImVudGVyRnVsbHNjcmVlbiIsImV4aXRGdWxsc2NyZWVuIiwiZnJhbWVUaXRsZSIsIm1lbnVCYWNrIiwibm9ybWFsIiwic3RhcnQiLCJlbmQiLCJhbGwiLCJyZXNldCIsImFkdmVydGlzZW1lbnQiLCJxdWFsaXR5QmFkZ2UiLCJzZGsiLCJpZnJhbWUiLCJnb29nbGVJTUEiLCJlZGl0YWJsZSIsImVtYmVkQ29udGFpbmVyIiwicG9zdGVyIiwicG9zdGVyRW5hYmxlZCIsImFkcyIsInBsYXlpbmciLCJzdG9wcGVkIiwibG9hZGluZyIsImhvdmVyIiwiaXNUb3VjaCIsInVpU3VwcG9ydGVkIiwibm9UcmFuc2l0aW9uIiwicHJldmlld1RodW1ibmFpbHMiLCJ0aHVtYkNvbnRhaW5lciIsInRodW1iQ29udGFpbmVyU2hvd24iLCJpbWFnZUNvbnRhaW5lciIsInRpbWVDb250YWluZXIiLCJzY3J1YmJpbmdDb250YWluZXIiLCJzY3J1YmJpbmdDb250YWluZXJTaG93biIsImhhc2giLCJwdWJsaXNoZXJJZCIsInRhZ1VybCIsImJ5bGluZSIsInBvcnRyYWl0IiwidHJhbnNwYXJlbnQiLCJjdXN0b21Db250cm9scyIsInJlZmVycmVyUG9saWN5IiwicmVsIiwic2hvd2luZm8iLCJpdl9sb2FkX3BvbGljeSIsIm1vZGVzdGJyYW5kaW5nIiwibm9Db29raWUiLCJwcm92aWRlcnMiLCJ0eXBlcyIsIm5vb3AiLCJDb25zb2xlIiwiY29uc29sZSIsIkZ1bGxzY3JlZW4iLCJzY3JvbGxQb3NpdGlvbiIsInNjcm9sbFgiLCJzY3JvbGxZIiwic2Nyb2xsVG8iLCJvdmVyZmxvdyIsInZpZXdwb3J0IiwiaGVhZCIsInByb3BlcnR5IiwiaGFzUHJvcGVydHkiLCJjbGVhbnVwVmlld3BvcnQiLCJwYXJ0IiwiYWN0aXZlRWxlbWVudCIsImZpcnN0IiwibGFzdCIsInNoaWZ0S2V5IiwiZm9yY2VGYWxsYmFjayIsIm5hdGl2ZSIsInJlcXVlc3RGdWxsc2NyZWVuIiwid2Via2l0RW50ZXJGdWxsc2NyZWVuIiwidG9nZ2xlRmFsbGJhY2siLCJuYXZpZ2F0aW9uVUkiLCJ3ZWJraXRFeGl0RnVsbHNjcmVlbiIsImFjdGlvbiIsImNhbmNlbEZ1bGxTY3JlZW4iLCJleGl0IiwiZW50ZXIiLCJlbCIsInBhcmVudEVsZW1lbnQiLCJwcm94eSIsInRyYXBGb2N1cyIsInVzaW5nTmF0aXZlIiwiZ2V0Um9vdE5vZGUiLCJmdWxsc2NyZWVuRWxlbWVudCIsInNoYWRvd1Jvb3QiLCJmdWxsc2NyZWVuRW5hYmxlZCIsIndlYmtpdEZ1bGxzY3JlZW5FbmFibGVkIiwibW96RnVsbFNjcmVlbkVuYWJsZWQiLCJtc0Z1bGxzY3JlZW5FbmFibGVkIiwicHJlIiwibG9hZEltYWdlIiwibWluV2lkdGgiLCJpbWFnZSIsIkltYWdlIiwiaGFuZGxlciIsIm9ubG9hZCIsIm9uZXJyb3IiLCJuYXR1cmFsV2lkdGgiLCJhZGRTdHlsZUhvb2siLCJidWlsZCIsImNoZWNrUGxheWluZyIsInNldFRpdGxlIiwic2V0UG9zdGVyIiwidG9nZ2xlUG9zdGVyIiwiZW5hYmxlIiwiYmFja2dyb3VuZEltYWdlIiwiYmFja2dyb3VuZFNpemUiLCJ0b2dnbGVDb250cm9scyIsImNoZWNrTG9hZGluZyIsImNsZWFyVGltZW91dCIsInRpbWVycyIsImNvbnRyb2xzRWxlbWVudCIsInJlY2VudFRvdWNoU2VlayIsImxhc3RTZWVrVGltZSIsIkRhdGUiLCJub3ciLCJtaWdyYXRlU3R5bGVzIiwiZ2V0UHJvcGVydHlWYWx1ZSIsInJlbW92ZVByb3BlcnR5IiwiTGlzdGVuZXJzIiwidGltZVN0YW1wIiwiZm9jdXNUaW1lciIsImxhc3RLZXlEb3duIiwicmVtb3ZlQ3VycmVudCIsIndhc0tleURvd24iLCJoYW5kbGVLZXkiLCJmaXJzdFRvdWNoIiwic2V0VGFiRm9jdXMiLCJzZXRHdXR0ZXIiLCJ2aWRlb1dpZHRoIiwidmlkZW9IZWlnaHQiLCJ1c2VOYXRpdmVBc3BlY3RSYXRpbyIsImNsaWVudFdpZHRoIiwiaW5uZXJXaWR0aCIsImNsaWVudEhlaWdodCIsImlubmVySGVpZ2h0Iiwidmlld3BvcnRIZWlnaHQiLCJtYXhXaWR0aCIsIm1hcmdpbiIsInJlc2l6ZWQiLCJpc0F1ZGlvIiwiZW5kZWQiLCJ0b2dnbGVQbGF5IiwicHJveHlFdmVudHMiLCJkZWZhdWx0SGFuZGxlciIsImN1c3RvbUhhbmRsZXJLZXkiLCJjdXN0b21IYW5kbGVyIiwicmV0dXJuZWQiLCJoYXNDdXN0b21IYW5kbGVyIiwiaW5wdXRFdmVudCIsImZvcndhcmQiLCJ0b2dnbGVDYXB0aW9ucyIsInJlY3QiLCJjdXJyZW50VGFyZ2V0IiwiYXR0cmlidXRlIiwiaGFzQXR0cmlidXRlIiwiZG9uZSIsInNlZWtUbyIsImxvYWRlZCIsInN0YXJ0TW92ZSIsImVuZE1vdmUiLCJzdGFydFNjcnViYmluZyIsImVuZFNjcnViYmluZyIsIndlYmtpdERpcmVjdGlvbkludmVydGVkRnJvbURldmljZSIsImRlbHRhWCIsImRlbHRhWSIsImRpcmVjdGlvbiIsInNpZ24iLCJpbmNyZWFzZVZvbHVtZSIsImxhc3RLZXkiLCJpbmNyZW1lbnQiLCJhbHRLZXkiLCJjdHJsS2V5IiwibWV0YUtleSIsInJlcGVhdCIsImRlY3JlYXNlVm9sdW1lIiwiZ2xvYmFsVGhpcyIsInNlbGYiLCJsb2FkanNfdW1kIiwiZm4iLCJkZXZudWxsIiwiYnVuZGxlSWRDYWNoZSIsImJ1bmRsZVJlc3VsdENhY2hlIiwiYnVuZGxlQ2FsbGJhY2tRdWV1ZSIsInN1YnNjcmliZSIsImJ1bmRsZUlkcyIsImNhbGxiYWNrRm4iLCJkZXBzTm90Rm91bmQiLCJidW5kbGVJZCIsIm51bVdhaXRpbmciLCJwYXRoc05vdEZvdW5kIiwicHVibGlzaCIsInEiLCJzcGxpY2UiLCJleGVjdXRlQ2FsbGJhY2tzIiwic3VjY2VzcyIsImxvYWRGaWxlIiwibnVtVHJpZXMiLCJkb2MiLCJpc0xlZ2FjeUlFQ3NzIiwiYXN5bmMiLCJtYXhUcmllcyIsIm51bVJldHJpZXMiLCJiZWZvcmVDYWxsYmFja0ZuIiwiYmVmb3JlIiwicGF0aG5hbWUiLCJwYXRoU3RyaXBwZWQiLCJyZWxMaXN0IiwiYXMiLCJvbmJlZm9yZWxvYWQiLCJldiIsInNoZWV0IiwiY3NzVGV4dCIsImNvZGUiLCJkZWZhdWx0UHJldmVudGVkIiwibG9hZEZpbGVzIiwicGF0aHMiLCJsb2FkanMiLCJhcmcxIiwiYXJnMiIsImxvYWRGbiIsInJldHVyblByb21pc2UiLCJkZXBzIiwiaXNEZWZpbmVkIiwiZmFjdG9yeSIsImNyZWF0ZUNvbW1vbmpzTW9kdWxlIiwibG9hZFNjcmlwdCIsImFzc3VyZVBsYXliYWNrU3RhdGUiLCJoYXNQbGF5ZWQiLCJWaW1lbyIsImZyYW1lUGFyYW1zIiwicmVnZXgiLCJmb3VuZCIsInBhcnNlSGFzaCIsImhhc2hQYXJhbSIsInNpZGVkb2NrIiwiZ2VzdHVyZSIsIiQyIiwidGh1bWJuYWlsX3VybCIsIlBsYXllciIsImRpc2FibGVUZXh0VHJhY2siLCJzdG9wIiwicmVzdG9yZVBhdXNlIiwic2V0Vm9sdW1lIiwic2V0Q3VycmVudFRpbWUiLCJzZXRQbGF5YmFja1JhdGUiLCJjdXJyZW50U3JjIiwic2V0TG9vcCIsImdldFZpZGVvVXJsIiwiZ2V0VmlkZW9XaWR0aCIsImdldFZpZGVvSGVpZ2h0IiwiZGltZW5zaW9ucyIsInNldEF1dG9wYXVzZSIsInN0YXRlIiwiZ2V0VmlkZW9UaXRsZSIsImdldEN1cnJlbnRUaW1lIiwiZ2V0RHVyYXRpb24iLCJnZXRUZXh0VHJhY2tzIiwic3RyaXBwZWRDdWVzIiwiZnJhZ21lbnQiLCJmaXJzdENoaWxkIiwic3RyaXBIVE1MIiwiZ2V0UGF1c2VkIiwic2Vjb25kcyIsImdldEhvc3QiLCJZVCIsIm9uWW91VHViZUlmcmFtZUFQSVJlYWR5IiwiZ2V0VGl0bGUiLCJ2aWRlb0lkIiwiY3VycmVudElkIiwicG9zdGVyU3JjIiwicGxheWVyVmFycyIsImhsIiwiZGlzYWJsZWtiIiwiY2NfbG9hZF9wb2xpY3kiLCJjY19sYW5nX3ByZWYiLCJ3aWRnZXRfcmVmZXJyZXIiLCJvbkVycm9yIiwibWVzc2FnZSIsIm9uUGxheWJhY2tSYXRlQ2hhbmdlIiwiaW5zdGFuY2UiLCJnZXRQbGF5YmFja1JhdGUiLCJvblJlYWR5IiwicGxheVZpZGVvIiwicGF1c2VWaWRlbyIsInN0b3BWaWRlbyIsInNwZWVkcyIsImdldEF2YWlsYWJsZVBsYXliYWNrUmF0ZXMiLCJjbGVhckludGVydmFsIiwiYnVmZmVyaW5nIiwic2V0SW50ZXJ2YWwiLCJnZXRWaWRlb0xvYWRlZEZyYWN0aW9uIiwibGFzdEJ1ZmZlcmVkIiwib25TdGF0ZUNoYW5nZSIsInVuTXV0ZSIsIkFkcyIsImdvb2dsZSIsImltYSIsIm1hbmFnZXIiLCJkZXN0cm95IiwiZGlzcGxheUNvbnRhaW5lciIsInJlbW92ZSIsInN0YXJ0U2FmZXR5VGltZXIiLCJtYW5hZ2VyUHJvbWlzZSIsImNsZWFyU2FmZXR5VGltZXIiLCJzZXR1cElNQSIsInNldFZwYWlkTW9kZSIsIkltYVNka1NldHRpbmdzIiwiVnBhaWRNb2RlIiwiRU5BQkxFRCIsInNldExvY2FsZSIsInNldERpc2FibGVDdXN0b21QbGF5YmFja0ZvcklPUzEwUGx1cyIsIkFkRGlzcGxheUNvbnRhaW5lciIsImxvYWRlciIsIkFkc0xvYWRlciIsIkFkc01hbmFnZXJMb2FkZWRFdmVudCIsIlR5cGUiLCJBRFNfTUFOQUdFUl9MT0FERUQiLCJvbkFkc01hbmFnZXJMb2FkZWQiLCJBZEVycm9yRXZlbnQiLCJBRF9FUlJPUiIsIm9uQWRFcnJvciIsInJlcXVlc3RBZHMiLCJBZHNSZXF1ZXN0IiwiYWRUYWdVcmwiLCJsaW5lYXJBZFNsb3RXaWR0aCIsImxpbmVhckFkU2xvdEhlaWdodCIsIm5vbkxpbmVhckFkU2xvdFdpZHRoIiwibm9uTGluZWFyQWRTbG90SGVpZ2h0IiwiZm9yY2VOb25MaW5lYXJGdWxsU2xvdCIsInNldEFkV2lsbFBsYXlNdXRlZCIsImNvdW50ZG93blRpbWVyIiwiZ2V0UmVtYWluaW5nVGltZSIsIkFkc1JlbmRlcmluZ1NldHRpbmdzIiwicmVzdG9yZUN1c3RvbVBsYXliYWNrU3RhdGVPbkFkQnJlYWtDb21wbGV0ZSIsImVuYWJsZVByZWxvYWRpbmciLCJnZXRBZHNNYW5hZ2VyIiwiY3VlUG9pbnRzIiwiZ2V0Q3VlUG9pbnRzIiwiQWRFdmVudCIsIm9uQWRFdmVudCIsImN1ZVBvaW50Iiwic2Vla0VsZW1lbnQiLCJjdWVQZXJjZW50YWdlIiwiYWQiLCJnZXRBZCIsImFkRGF0YSIsImdldEFkRGF0YSIsIkxPQURFRCIsInBvbGxDb3VudGRvd24iLCJpc0xpbmVhciIsIlNUQVJURUQiLCJBTExfQURTX0NPTVBMRVRFRCIsImxvYWRBZHMiLCJjb250ZW50Q29tcGxldGUiLCJDT05URU5UX1BBVVNFX1JFUVVFU1RFRCIsInBhdXNlQ29udGVudCIsIkNPTlRFTlRfUkVTVU1FX1JFUVVFU1RFRCIsInJlc3VtZUNvbnRlbnQiLCJMT0ciLCJhZEVycm9yIiwiZ2V0TWVzc2FnZSIsImNhbmNlbCIsImFkZEN1ZVBvaW50cyIsInNlZWtlZFRpbWUiLCJkaXNjYXJkQWRCcmVhayIsInJlc2l6ZSIsIlZpZXdNb2RlIiwiTk9STUFMIiwiaW5pdGlhbGl6ZSIsImluaXRpYWxpemVkIiwiekluZGV4IiwiaGFuZGxlcnMiLCJzYWZldHlUaW1lciIsIkFWX1BVQkxJU0hFUklEIiwiQVZfQ0hBTk5FTElEIiwiQVZfVVJMIiwiY2IiLCJBVl9XSURUSCIsIkFWX0hFSUdIVCIsIkFWX0NESU0yIiwiY2xhbXAiLCJwYXJzZVZ0dCIsInZ0dERhdGFTdHJpbmciLCJwcm9jZXNzZWRMaXN0IiwiZnJhbWUiLCJsaW5lIiwic3RhcnRUaW1lIiwibGluZVNwbGl0IiwibWF0Y2hUaW1lcyIsImVuZFRpbWUiLCJmaXRSYXRpbyIsIm91dGVyIiwidGFyZ2V0UmF0aW8iLCJQcmV2aWV3VGh1bWJuYWlscyIsImdldFRodW1ibmFpbHMiLCJyZW5kZXIiLCJkZXRlcm1pbmVDb250YWluZXJBdXRvU2l6aW5nIiwic29ydEFuZFJlc29sdmUiLCJ0aHVtYm5haWxzIiwicHJvbWlzZXMiLCJnZXRUaHVtYm5haWwiLCJ0aHVtYm5haWwiLCJmcmFtZXMiLCJ1cmxQcmVmaXgiLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsInRlbXBJbWFnZSIsIm5hdHVyYWxIZWlnaHQiLCJwZXJjZW50YWdlIiwibW91c2VQb3NYIiwidGh1bWIiLCJfdGhpcyRwbGF5ZXIkY29uZmlnJG0iLCJfdGhpcyRwbGF5ZXIkY29uZmlnJG0yIiwic2hvd0ltYWdlQXRDdXJyZW50VGltZSIsInRvZ2dsZVRodW1iQ29udGFpbmVyIiwibW91c2VEb3duIiwidG9nZ2xlU2NydWJiaW5nQ29udGFpbmVyIiwiY2VpbCIsImxhc3RUaW1lIiwic2NydWJiaW5nIiwic2V0U2NydWJiaW5nQ29udGFpbmVyU2l6ZSIsInNldFRodW1iQ29udGFpbmVyU2l6ZUFuZFBvcyIsInRodW1iTnVtIiwiZmluZEluZGV4IiwiaGFzVGh1bWIiLCJxdWFsaXR5SW5kZXgiLCJsb2FkZWRJbWFnZXMiLCJzaG93aW5nVGh1bWIiLCJ0aHVtYkZpbGVuYW1lIiwidGh1bWJVcmwiLCJjdXJyZW50SW1hZ2VFbGVtZW50IiwiZGF0YXNldCIsImZpbGVuYW1lIiwic2hvd0ltYWdlIiwicmVtb3ZlT2xkSW1hZ2VzIiwibG9hZGluZ0ltYWdlIiwidXNpbmdTcHJpdGVzIiwicHJldmlld0ltYWdlIiwic2hvd2luZ1RodW1iRmlsZW5hbWUiLCJuZXdJbWFnZSIsInNldEltYWdlU2l6ZUFuZE9mZnNldCIsImN1cnJlbnRJbWFnZUNvbnRhaW5lciIsInByZWxvYWROZWFyYnkiLCJnZXRIaWdoZXJRdWFsaXR5IiwiY3VycmVudEltYWdlIiwidGFnTmFtZSIsInJlbW92ZURlbGF5IiwiZGVsZXRpbmciLCJvbGRUaHVtYkZpbGVuYW1lIiwidGh1bWJuYWlsc0Nsb25lIiwiZm91bmRPbmUiLCJuZXdUaHVtYkZpbGVuYW1lIiwidGh1bWJVUkwiLCJjdXJyZW50UXVhbGl0eUluZGV4IiwicHJldmlld0ltYWdlSGVpZ2h0IiwidGh1bWJDb250YWluZXJIZWlnaHQiLCJjbGVhclNob3dpbmciLCJzaXplU3BlY2lmaWVkSW5DU1MiLCJ0aHVtYkFzcGVjdFJhdGlvIiwidGh1bWJIZWlnaHQiLCJzZXRUaHVtYkNvbnRhaW5lclBvcyIsInNjcnViYmVyUmVjdCIsImNvbnRhaW5lclJlY3QiLCJyaWdodCIsImNsYW1wZWQiLCJtdWx0aXBsaWVyIiwibGFzdE1vdXNlTW92ZVRpbWUiLCJjdXJyZW50U2NydWJiaW5nSW1hZ2VFbGVtZW50IiwiY3VycmVudFRodW1ibmFpbEltYWdlRWxlbWVudCIsImluc2VydEVsZW1lbnRzIiwiY2hhbmdlIiwiY3Jvc3NvcmlnaW4iLCJQbHlyIiwid2Via2l0U2hvd1BsYXliYWNrVGFyZ2V0UGlja2VyIiwiaXNIaWRkZW4iLCJoaWRpbmciLCJldmVudE5hbWUiLCJzb2Z0Iiwib3JpZ2luYWwiLCJ1bmxvYWQiLCJmYWlsZWQiLCJqUXVlcnkiLCJXZWFrTWFwIiwiZ2V0UHJvdmlkZXJCeVVybCIsInNlYXJjaCIsInRydXRoeSIsInNlYXJjaFBhcmFtcyIsInRhYmluZGV4IiwiaW5wdXRJc1ZhbGlkIiwiZmF1eER1cmF0aW9uIiwicmVhbER1cmF0aW9uIiwiSW5maW5pdHkiLCJoYXNBdWRpbyIsIm1vekhhc0F1ZGlvIiwid2Via2l0QXVkaW9EZWNvZGVkQnl0ZUNvdW50IiwiYXVkaW9UcmFja3MiLCJ1cGRhdGVTdG9yYWdlIiwid2Via2l0UHJlc2VudGF0aW9uTW9kZSIsInBpY3R1cmVJblBpY3R1cmVFbGVtZW50Iiwic2V0UHJldmlld1RodW1ibmFpbHMiLCJyZXF1ZXN0UGljdHVyZUluUGljdHVyZSIsImV4aXRQaWN0dXJlSW5QaWN0dXJlIiwidGh1bWJuYWlsU291cmNlIiwic3RhdGljIiwiaW5saW5lIiwiU3dpcGVycyIsInN3aXBlciIsIlN3aXBlciIsInNsaWRlc1BlclZpZXciLCJmcmVlTW9kZSIsIndhdGNoU2xpZGVzUHJvZ3Jlc3MiLCJzcGFjZUJldHdlZW4iLCJuYXZpZ2F0aW9uIiwibmV4dEVsIiwicHJldkVsIiwidGh1bWJzIiwiZWZmZWN0IiwiZmFkZUVmZmVjdCIsImNyb3NzRmFkZSIsImdyYWJDdXJzb3IiLCJwYWdpbmF0aW9uIiwiY2xpY2thYmxlIiwiYnJlYWtwb2ludHMiLCJBbmltIiwiYW5pbVRvcCIsImFuaW1sZWZ0IiwiYW5pbVJpZ2h0Iiwic2luZ2xlc1RvcCIsInNpbmdsZXNsZWZ0Iiwic2luZ2xlc1JpZ2h0IiwiY2VsbCIsInJlYyIsImNlbGwxIiwiY2VsbDIiLCJCdXR0b24iLCJtVmFsdWUiLCJhZGREaXYiLCJjbGllbnRZIiwiYXBwZW5kIiwid2F2ZXMiLCJwb3B1cHNJbml0IiwiaGVhZGVyIiwidG95c1BseXIiLCJwbGF5ZXIxIiwicGxheWVyUmV2MSIsInBsYXllclJldjIiLCJwbGF5ZXJSZXYzIiwicGxheWVyUmV2NCIsIkdhbCIsInRlbXAiLCJzMiIsImNlbnRlcmVkU2xpZGVzIiwiY292ZXJmbG93RWZmZWN0Iiwicm90YXRlIiwic3RyZXRjaCIsImRlcHRoIiwic2xpZGVUb0NsaWNrZWRTbGlkZSIsInMxSXRlbXMiLCJIZWFkZXJzIiwicGFnZVlPZmZzZXQiLCJvbnJlc2l6ZSIsIlBvcHVwcyIsImNvbnRlbnRzIiwiUGxlZXJzIiwidGVtcG9yIiwiaW5pdFRhcmdldCIsImxpbmtQbHlyIiwib3BlblBvcCIsImNsb3NlUG9wIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImdldHRlciIsIl9fZXNNb2R1bGUiLCJkIiwiZGVmaW5pdGlvbiIsImciLCJwcm9wIiwiaGFzT3duUHJvcGVydHkiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInBsIiwidGVydCIsInNoZWFwIiwidHIiLCJwbHlyUGxheSJdLCJzb3VyY2VSb290IjoiIn0=